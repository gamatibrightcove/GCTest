"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n,i,s,a,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return i=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){i=!0,s=e},f:function(){try{n||null==o.return||o.return()}finally{if(i)throw s}}};if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function set(e,t,n,i){return(set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,i){var s,e=_superPropBase(e,t);if(e){if((s=Object.getOwnPropertyDescriptor(e,t)).set)return s.set.call(i,n),!0;if(!s.writable)return!1}if(s=Object.getOwnPropertyDescriptor(i,t)){if(!s.writable)return!1;s.value=n,Object.defineProperty(i,t,s)}else _defineProperty(i,t,n);return!0})(e,t,n,i)}function _set(e,t,n,i,s){if(!set(e,t,n,i||e)&&s)throw new TypeError("failed to set property");return n}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,s,a,o,r=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(r.push(i.value),r.length!==t);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw s}}return r}}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _regeneratorRuntime(){_regeneratorRuntime=function(){return o};var o={},e=Object.prototype,l=e.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",s=t.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function r(e,t,n,i){var s,a,o,r,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),i=new k(i||[]);return c(t,"_invoke",{value:(s=e,a=n,o=i,r="suspendedStart",function(e,t){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===e)throw t;return T()}for(o.method=e,o.arg=t;;){var n=o.delegate;if(n){n=function e(t,n){var i=n.method,s=t.iterator[i];if(void 0===s)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;i=u(s,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,d):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}(n,o);if(n){if(n===d)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===r)throw r="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r="executing";n=u(s,a,o);if("normal"===n.type){if(r=o.done?"completed":"suspendedYield",n.arg===d)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(r="completed",o.method="throw",o.arg=n.arg)}})}),t}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=r;var d={};function h(){}function p(){}function m(){}var t={},_=(a(t,i,function(){return this}),Object.getPrototypeOf),_=_&&_(_(C([]))),g=(_&&_!==e&&l.call(_,i)&&(t=_),m.prototype=h.prototype=Object.create(t));function f(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function y(o,r){var t;c(this,"_invoke",{value:function(n,i){function e(){return new r(function(e,t){!function t(e,n,i,s){var a,e=u(o[e],o,n);if("throw"!==e.type)return(n=(a=e.arg).value)&&"object"==_typeof(n)&&l.call(n,"__await")?r.resolve(n.__await).then(function(e){t("next",e,i,s)},function(e){t("throw",e,i,s)}):r.resolve(n).then(function(e){a.value=e,i(a)},function(e){return t("throw",e,i,s)});s(e.arg)}(n,i,e,t)})}return t=t?t.then(e,e):e()}})}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function C(t){if(t){var n,e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:T}}function T(){return{value:void 0,done:!0}}return c(g,"constructor",{value:p.prototype=m,configurable:!0}),c(m,"constructor",{value:p,configurable:!0}),p.displayName=a(m,s,"GeneratorFunction"),o.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},o.awrap=function(e){return{__await:e}},f(y.prototype),a(y.prototype,n,function(){return this}),o.AsyncIterator=y,o.async=function(e,t,n,i,s){void 0===s&&(s=Promise);var a=new y(r(e,t,n,i),s);return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},f(g),a(g,s,"Generator"),a(g,i,function(){return this}),a(g,"toString",function(){return"[object Generator]"}),o.keys=function(e){var t,n=Object(e),i=[];for(t in n)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function e(e,t){return a.type="throw",a.arg=n,i.next=e,t&&(i.method="next",i.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var s=this.tryEntries[t],a=s.completion;if("root"===s.tryLoc)return e("end");if(s.tryLoc<=this.prev){var o=l.call(s,"catchLoc"),r=l.call(s,"finallyLoc");if(o&&r){if(this.prev<s.catchLoc)return e(s.catchLoc,!0);if(this.prev<s.finallyLoc)return e(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return e(s.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return e(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}var a=(s=s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc?null:s)?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,i,s=this.tryEntries[t];if(s.tryLoc===e)return"throw"===(n=s.completion).type&&(i=n.arg,b(s)),i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},o}function asyncGeneratorStep(e,t,n,i,s,a,o){try{var r=e[a](o),l=r.value}catch(e){return void n(e)}r.done?t(l):Promise.resolve(l).then(i,s)}function _asyncToGenerator(r){return function(){var e=this,o=arguments;return new Promise(function(t,n){var i=r.apply(e,o);function s(e){asyncGeneratorStep(i,t,n,s,a,"next",e)}function a(e){asyncGeneratorStep(i,t,n,s,a,"throw",e)}s(void 0)})}}function _wrapNativeSuper(e){var n="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);t=new(Function.bind.apply(e,i));return n&&_setPrototypeOf(t,n.prototype),t}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=_superPropBase(e,t);if(i)return(i=Object.getOwnPropertyDescriptor(i,t)).get?i.get.call(arguments.length<3?e:n):i.value}).apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){var i=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,i?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}window.n2=window.n2||{},window.n2.de={event:{},data:{},enum:{distributor:{},team:{},distributionHours:{}},illustration:{},icon:{},mixins:{},util:{logicFilter:{}},component:{form:{updateFields:{}},field:{teamMemberPicker:{},userPicker:{},userOrQueueField:{},tagPicker:{tagPickerPopover:{}}},distributors:{},tags:{modifyTagAssignments:{}},recordList:{},hours:{},header:{},summary:{},team:{summary:{}},wizard:{},availabilityCalendar:{slideOutPanel:{}},accordion:{}},page:{analytics:{distribution:{}},assignmentSimulation:{newSimulationModal:{},assignmentSimulationResults:{teamResult:{distributorResult:{testResultPopover:{}}}}},availability:{outOfOffice:{},regionalHolidays:{regions:{regionList:{}},holidays:{holidayList:{}}},shifts:{shiftList:{},slideOutPanel:{}}},classifier:{autoConversionSettings:{autoConversionRules:{ruleModal:{autoConvertActionSettings:{}}}},backfill:{backfillWizard:{}}},console:{component:{},applicationMonitoring:{},sourceList:{dataTable:{}},todaysDistributionList:{dataTable:{}},calendar:{calendarRecordList:{}}},objectSync:{objectSyncActions:{actionsList:{}}},logs:{component:{recordList:{}},distributionLogList:{distributionLogsRecordList:{}},territoriesLogList:{territoriesLogsRecordList:{}},leadMatchingLogList:{leadMatchingLogsRecordList:{}},objectSyncLogList:{objectSyncLogsRecordList:{}},autoConversionLogList:{autoConversionLogsRecordList:{}},archiveLogList:{archiveLogsRecordList:{}},schedulerLogList:{schedulerLogsRecordList:{}}},tags:{tagCollectionList:{tagCollectionRecordList:{}},tagValueList:{tagValueRecordList:{}},tagAssignmentList:{tagAssignmentRecordList:{dataTable:{},toolbar:{}},modifyAssignments:{},cloneAssignments:{}},component:{field:{tagPillList:{}}}},team:{assignmentRejection:{distributorLevelRejection:{}},availability:{availabilityRecordList:{}},teamList:{apv:{},teamsDataTable:{},newTeamModal:{}},teamSettings:{},teamMemberList:{teamMembersDataTable:{},addStandardMemberModal:{},addStandardMemberWizard:{assignTags:{},assignTeamMemberHours:{}}},distributorList:{distributorRecordList:{distributorDataTable:{}},distributorSlideOutPanel:{},distributorsDataTable:{}},distributorSettings:{distributorSettingsForm:{methodSettings:{lookupOwnerFields:{}},sourceSettings:{campaignPillList:{}},teamMemberFilter:{tagFilter:{}}}},postAssignment:{postAssignmentDataTable:{},postAssignmentForm:{},postAssignmentObjectSync:{}},distributionHours:{teamMemberHours:{memberHours:{},shiftPlanner:{shiftSelector:{}}},teamHolidayRegion:{}},trackingAndSlas:{distributorSettings:{distributorSettingsForm:{slasFieldGroup:{}}},teamSettings:{actionTracking:{autoAction:{}},slas:{logicFilter:{filters:{}}}}},teamPerformance:{teamPerformanceRecordList:{dataTable:{}},modifyAssignments:{}},weightingAndCaps:{weighting:{individual:{},tagBased:{}},distributorSettings:{weightingAndCapsForm:{}},teamCaps:{tagCaps:{dataTable:{}}}},teamSummary:{teamMembersList:{},stats:{}}},settings:{appSettings:{appSettingsForm:{operations:{},loggingAndArchiving:{},distributionSettings:{userAvailabilitySettings:{}}}},exportImport:{enum:{},export:{exportModal:{}},import:{importWizard:{summary:{}}}},licensedUsers:{licensedUsersRecordList:{}}}}},n2.de.ApplicationContext=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.USER_DISPLAY_LIMIT=1e3,this.OOO_DISPLAY_LIMIT=500,this.LOGS_DISPLAY_LIMIT=500,this._mixins=[n2.mixin.Singleton],this._lazyLoad=!0,this._locale=null,this._timeZone=null,this._userPermission=null,this._namespace="",this._orgNamespace="",this._isSandbox=!1,this._isDeveloperOrg=!1,this._isTrialOrg=!1,this._currentUserId=null,this._isMobileApp=null,this._currentRelativePageURL=null}},{key:"locale",get:function(){return this._locale}},{key:"timeZone",get:function(){return this._timeZone}},{key:"namespace",get:function(){return this._namespace}},{key:"orgNamespace",get:function(){return this._orgNamespace}},{key:"isSandbox",get:function(){return this._isSandbox}},{key:"isDeveloperOrg",get:function(){return this._isDeveloperOrg}},{key:"isTrialOrg",get:function(){return this._isTrialOrg}},{key:"isAdminOrSystemManager",get:function(){return!n2.isNull(this._userPermission)&&0<=["SFAdmin","Admin","SystemManager"].indexOf(this._userPermission)}},{key:"isDESystemManager",get:function(){return!n2.isNull(this._userPermission)&&"SystemManager"===this._userPermission}},{key:"isDEAdmin",get:function(){return!n2.isNull(this._userPermission)&&"Admin"===this._userPermission}},{key:"isTeamManager",get:function(){return!n2.isNull(this._userPermission)&&"TeamManager"===this._userPermission}},{key:"isUser",get:function(){return!n2.isNull(this._userPermission)&&"User"===this._userPermission}},{key:"hasNoDEPermissionSet",get:function(){return n2.isNull(this._userPermission)||0<=["SFAdmin","None"].indexOf(this._userPermission)}},{key:"currentUserId",get:function(){return this._currentUserId}},{key:"isMobileApp",get:function(){return this._isMobileApp}},{key:"currentRelativePageURL",get:function(){return this._currentRelativePageURL}},{key:"load",value:function(e){var t=e.locale,n=e.timeZone,n=void 0===n?null:n,i=e.userPermission,i=void 0===i?null:i,s=e.namespace,s=void 0===s?"":s,a=e.orgNamespace,a=void 0===a?"":a,o=e.isSandbox,o=void 0!==o&&o,r=e.isDeveloperOrg,r=void 0!==r&&r,l=e.isTrialOrg,l=void 0!==l&&l,c=e.currentUserId,c=void 0===c?null:c,u=e.isMobileApp,u=void 0!==u&&u,e=e.currentRelativePageURL,e=void 0===e?null:e;this._locale=void 0===t?null:t,this._timeZone=n,this._userPermission=i,this._namespace=s,this._orgNamespace=a,this._isSandbox=o,this._isDeveloperOrg=r,this._isTrialOrg=l,this._currentUserId=c,this._isMobileApp="true"===u,this._currentRelativePageURL=e}}]),t}(),n2.de.Error={getMessage:function(e){return this.isInvalidId(e)?"You have accessed this page with an invalid record id, press OK to return to the listing page.":this.isDE2(e)?e.replace("".concat(n2.de.enum.Error.DE2," "),""):e},isInvalidId:function(e){return e.startsWith(n2.de.enum.Error.DE1)},isInvalidTeamId:function(e){return e===n2.de.enum.Error.INVALID_TEAM_ID},isInvalidTeamMemberId:function(e){return e===n2.de.enum.Error.INVALID_TEAM_MEMBER_ID},isInvalidDistributorId:function(e){return e===n2.de.enum.Error.INVALID_DISTRIBUTOR_ID},isInvalidDistributionHours:function(e){return e===n2.de.enum.Error.INVALID_DISTRIBUTION_HOURS},isInvalidTagCollectionId:function(e){return e===n2.de.enum.Error.INVALID_TAG_COLLECTION_ID},isDE2:function(e){return e.startsWith(n2.de.enum.Error.DE2)}},n2.de.File=function(){_inherits(t,_wrapNativeSuper(Blob));var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"download",value:function(e){var t;navigator.msSaveBlob?navigator.msSaveBlob(this,e):(t=URL.createObjectURL(this),(e=this._createTempDownloadLink(t,e)).click(),document.body.removeChild(e),URL.revokeObjectURL(t))}},{key:"_createTempDownloadLink",value:function(e,t){var n=document.createElement("a");return n.setAttribute("href",e),n.setAttribute("download",t),n.setAttribute("rel","noopener"),n.setAttribute("target","_blank"),n.textContent="Download Link",document.body.appendChild(n),n}}]),t}(),n2.de.Icon={getMethodIcon:function(e){return n2.isNull(e)?"":{"ROUND ROBIN":n2.de.icon.RoundRobin,"ROUND ROBIN STICKY ASSIGNMENT":n2.de.icon.RoundRobin,"LOAD BALANCING":n2.de.icon.LoadBalancing,"LOAD BALANCING STICKY ASSIGNMENT":n2.de.icon.LoadBalancing,"ROUND ROBIN LOOKUP OWNER":n2.de.icon.LookupOwner,"LOOKUP OWNER":n2.de.icon.LookupOwner,"RELATED OWNER":n2.de.icon.RelatedOwner,"CURRENT OWNER":n2.de.icon.CurrentOwner,"DYNAMIC OWNER":n2.de.icon.DynamicOwner,"PULL FROM QUEUE":n2.de.icon.PullDistributor,PULL:n2.de.icon.PullDistributor,"MANUAL ASSIGNMENT":n2.de.icon.ManualAssignment}[e.toUpperCase()]}},n2.de.Page=function(){_inherits(i,n2.ui.SalesforcePage);var e,t,n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{main:".n2_main",spinnerContainer:".n2_main > .n2_spinner-container",body:".n2_content"}),this._template='<div id="{{id}}" class="n2-de-page {{cls}}">\n            <section class="n2_main">\n                <article class="n2_content">\n                </article>\n                <div class="n2_spinner-container"></div>\n            </section>\n        </div>',this._heading="[TODO] Set page heading",this._headingIcon=null,this._additionalHeading=null,this._helpLinkURL=null,this._pageContext=null,this._isPageContextLoaded=!1,this._actionMenuOptions=[],this._showRefreshButton=!1}},{key:"pageHeader",get:function(){return this._components["page-header"]}},{key:"actionMenu",get:function(){return this.pageHeader.components["action-menu"]}},{key:"spinnerTemplate",get:function(){return'<div id="'.concat(this.domId,'_spinner" class="slds-spinner_container">\n            <div class="slds-spinner slds-spinner_x-small" role="status">\n                <span class="slds-assistive-text">Loading</span>\n                <div class="slds-spinner__dot-a"></div>\n                <div class="slds-spinner__dot-b"></div>\n            </div>\n        </div>')}},{key:"slideOutPanel",get:function(){return n2.de.page.SlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._prepareScopedRoot()}},{key:"_prepareScopedRoot",value:function(){n2.ui.dom.Scope.getInstance().root=this._getSalesForceContainer()}},{key:"_getSalesForceContainer",value:function(){var e=_get(_getPrototypeOf(i.prototype),"_getSalesForceContainer",this).call(this);return(e=n2.isNull(e)?this._getPageRoot():e).addClass("slds-scope"),this._isMobileApp()&&e.addClass("n2-mobile-app"),e}},{key:"_getPageRoot",value:function(){var e=document.getElementById("n2-page-root");return n2.isNull(e)&&(document.body.insertAdjacentHTML("beforeend",'<div id="n2-page-root"></div>'),e=document.getElementById("n2-page-root")),new n2.ui.DOM(e)}},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=0<n.length&&void 0!==n[0]?n[0]:{}).silent,t=t.force,t=void 0!==t&&t,_get(_getPrototypeOf(i.prototype),"_load",this).apply(this,n),e.t0=this._isPageContextLoaded,e.t0){e.next=6;break}return e.next=6,this._loadPageContext({force:t});case 6:n2.DataProviderManager.getInstance().get("get-license-details").get({silent:!1,force:!1});case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_loadPageContext",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0<n.length&&void 0!==n[0]?n[0]:{}).force,t=void 0!==t&&t,e.t0=n2.isNull(this._pageContext),e.t0){e.next=5;break}return e.next=5,this._pageContext.load({silent:!0,force:t});case 5:this._onPageContextLoaded();case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onPageContextLoaded",value:function(){this._isPageContextLoaded=!0,this._insertPageComponents()}},{key:"_insertPageComponents",value:function(){this._insertPageHeader(),this._insertExpiringLicenseWarning()}},{key:"_insertPageHeader",value:function(){var t=this;return this.insert(new n2.de.component.Header({id:"page-header",heading:this._heading,icon:this._headingIcon,additionalHeading:this._additionalHeading,helpLinkURL:this._helpLinkURL,actionMenuOptions:this._actionMenuOptions,showRefreshButton:this._showRefreshButton,renderTo:{target:this.SELECTORS.main,position:"afterbegin"},listeners:{click:function(e){return t._onPageHeaderClick(e)}}}))}},{key:"_onPageHeaderClick",value:function(e){"action-menu"===e.target.parent.id&&this._onActionMenuClick(e.target),"refresh-button"===e.target.id&&this._onRefreshButtonClick(e)}},{key:"_onActionMenuClick",value:function(e){}},{key:"_onRefreshButtonClick",value:function(e){this._reload()}},{key:"_reload",value:function(){return this.load({force:!0})}},{key:"_insertExpiringLicenseWarning",value:function(){return this._insert(new n2.de.component.ExpiringLicenseWarning({id:"expiring-license",mixins:[n2.mixin.DataDriven],dataProviders:["get-license-details"],renderTo:{target:this.SELECTORS.main,position:"afterend"},daysToExpiry:{bindPath:"get-license-details.daysToExpiry",defaultValue:null},daysToRenewal:{bindPath:"get-license-details.daysToRenewal",defaultValue:null},messageType:{bindPath:"get-license-details",adapter:function(e){return n2.de.ApplicationContext.getInstance().isDeveloperOrg?n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.DEVELOPER:"Trial"===e.licenseStatus?n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.TRIAL:e.isUpcomingRenewal?n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.RENEWAL:e.hasExpired?n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.EXPIRED:n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.LICENSE}}}))}},{key:"render",value:function(e){_get(_getPrototypeOf(i.prototype),"render",this).apply(this,arguments),this._renderSlideOutPanel()}},{key:"_renderSlideOutPanel",value:function(){this.slideOutPanel.render()}},{key:"_onServerError",value:function(e){var t=this;n2.de.Error.isDE2(e)||(n2.de.Error.isInvalidId(e)?n2.de.page.InvalidIdMessageBox.getInstance({renderTo:this._dom}).show({header:e.replace("".concat(n2.de.enum.Error.DE1," "),"")+" not found",message:this._getInvalidIdMessageBoxContent(e),listeners:{submit:function(){return t._onInvalidIdMessageBoxSubmit(e)}}}):_get(_getPrototypeOf(i.prototype),"_onServerError",this).apply(this,arguments))}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return"Your record could not be found, please press OK to return to the listing page."}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){}},{key:"_insertSpinner",value:function(){this.element("spinnerContainer").insert(this.spinnerTemplate)}},{key:"_getUsedLicensesText",value:function(e,t){var n="".concat(e),i=1!==e;return n2.de.ApplicationContext.getInstance().isSandbox||(n="".concat(e," of ").concat(t),i=1!==t),"".concat(n,i?" licenses used":" license used")}},{key:"_isMobileApp",value:function(){return n2.de.ApplicationContext.getInstance().isMobileApp}}]),i}(),n2.de.PollingService=function(){function n(e,t){_classCallCheck(this,n),this._define(e,t)}return _createClass(n,[{key:"_define",value:function(e,t){this._task=e,this._interval=t,this._id=null}},{key:"start",value:function(){var e=this;if(n2.isNull(this._task))throw new Error("You are trying to start a destroyed task.");n2.isNull(this._id)&&(this._id=window.setInterval(function(){e._task()},this._interval))}},{key:"stop",value:function(){n2.isNull(this._id)||(window.clearInterval(this._id),this._id=null)}},{key:"destroy",value:function(){this.stop(),this._task=null,this._interval=null,this._id=null}}]),n}(),n2.de.component.AbstractPopover=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS||{},{change:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_popover-body"}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Singleton,n2.mixin.Observable]),this._lazyRender=!0,this._componentCls="n2-de-abstract-popover",this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{>bodyTemplate}}\n        </div>',this._bodyTemplate='<div class="n2_popover-body"></div>',this._focusable=n2.ui.enum.Focusable.INACTIVE,this.renderTo=n2.ui.dom.Scope.getInstance().root,this._hidden=!0,this._target=null,this._position="bottom",this._windowMouseDownHandler=null,this._windowScrollHandler=null,this._windowResizeHandler=null}},{key:"target",set:function(e){this._target=e,this.refresh({target:!0})}},{key:"_insertCloseButton",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).renderTo;return this._insert(new n2.ui.component.Button({id:"close-button",cls:"n2_close-button",renderTo:void 0===e?{position:"afterbegin"}:e,icon:n2.ui.enum.Icon.CLOSE,listeners:{click:this._onCloseButtonClick,scope:this}}))}},{key:"_onCloseButtonClick",value:function(e){this.hide()}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.target,e.position,e.cls,e.listeners),e=void 0===e?{}:e;this._onBeforeShow.apply(this,arguments),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this._onShow.apply(this,arguments),this._applyListeners(e)}},{key:"_onBeforeShow",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).cls,e=void 0===e?null:e;n2.isNull(e)||(this.cls=e)}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{bodyTemplate:this._bodyTemplate})}},{key:"_onShow",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.target,t=void 0===t?null:t,e=e.position;this._position=void 0===e?"bottom":e,this.target=t,this.focus(),this._addPopoverListeners()}},{key:"_addPopoverListeners",value:function(){var t=this;this._windowMouseDownHandler=function(e){return t._onWindowClick(e)},window.addEventListener("mousedown",this._windowMouseDownHandler,!0),this._windowScrollHandler=function(e){return t._onWindowScroll(e)},window.addEventListener("scroll",this._windowScrollHandler,!0),this._windowResizeHandler=function(e){return t._onWindowResize(e)},window.addEventListener("resize",this._windowResizeHandler),this._dom.listen("keyup",this._onKeyUp,{scope:this})}},{key:"_onWindowClick",value:function(e){this._hideOnWindowMouseDown(e.target)&&this.hide()}},{key:"_hideOnWindowMouseDown",value:function(e){return!this._popoverContains(e)&&!this._popoverTargetContains(e)}},{key:"_popoverTargetContains",value:function(e){return this._target.rawDOM.contains(e)}},{key:"_onWindowScroll",value:function(e){this._hideOnWindowScroll(e.target)&&this.hide()}},{key:"_hideOnWindowScroll",value:function(e){return!this._isScopedRoot(e)&&!this._popoverContains(e)&&e!==document}},{key:"_isScopedRoot",value:function(e){var t=n2.ui.dom.Scope.getInstance().root,t=n2.isUndefined(t.rawDOM)?t:t.rawDOM;return e===(t===document.body?document:t)}},{key:"_popoverContains",value:function(e){return this._dom.rawDOM.contains(e)}},{key:"_onWindowResize",value:function(e){this.hide()}},{key:"_onKeyUp",value:function(e){n2.ui.Key.get(e.key)===n2.ui.enum.Key.ESCAPE&&this.hide()}},{key:"hide",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).reserveSpace;_get(_getPrototypeOf(t.prototype),"hide",this).apply(this,arguments),this._removePopoverListeners(),this.fire("change",this._createEvent(this,{data:{hidden:this._hidden}})),this.purgeListeners()}},{key:"_removePopoverListeners",value:function(){window.removeEventListener("resize",this._windowResizeHandler),window.removeEventListener("scroll",this._windowScrollHandler,!0),window.removeEventListener("mousedown",this._windowMouseDownHandler,!0),this._rendered&&this._dom.removeListeners("keyup",this._onKeyUp,{scope:this})}},{key:"refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.target,t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshTarget()}},{key:"_refreshTarget",value:function(){this._rendered&&!this._hidden&&("top"===this._position?this._positionPopover({bottom:0,left:0}):this._positionPopover({top:0,left:0}),this._positionPopover(this._calculatePopoverPosition()))}},{key:"_calculatePopoverPosition",value:function(){var e=this._target.rawDOM.getBoundingClientRect(),t=this._dom.attribute("offsetParent").getBoundingClientRect();return"top"===this._position?{bottom:t.bottom-e.top,left:e.left-t.left}:{top:e.bottom-t.top,left:e.left-t.left}}},{key:"_positionPopover",value:function(e){var t=e.top,n=e.bottom,e=e.left,e={left:"".concat(e,"px")};n2.isUndefined(t)||(e.top="".concat(t,"px")),n2.isUndefined(n)||(e.bottom="".concat(n,"px")),this._dom.style(e)}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).apply(this,arguments),this._removePopoverListeners()}}]),t}(),n2.de.component.AbstractRecordList=function(){_inherits(s,n2.ui.Component);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},change:function(e){}}),this._mixins=[n2.mixin.Observable],this._componentCls="n2-de-record-list",this._dataTable=null,this._toolbar=null,this._footer=null,this._data=null}},{key:"selectedData",get:function(){return this._dataTable.selection}},{key:"data",get:function(){return this._data},set:function(e){n2.compare(e,this._data)||(this._data=e,this._refresh())}},{key:"_setComponents",value:function(){throw new Error("`_setComponents` must be over-written in extending class.")}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this,arguments),this._setComponents(),this._insertComponents()}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(s.prototype),"_afterRender",this).apply(this,arguments),n2.isNull(this._data)||this._refresh()}},{key:"_insertComponents",value:function(){this._insertToolbar(),this._insertDataTable(),this._insertFooter()}},{key:"_insertToolbar",value:function(){if(n2.isNull(this._toolbar))throw new Error("Toolbar must be set in `_setComponents`");return this._toolbar.listen("click",this._handleClick,this),this._toolbar.listen("change",this._handleChange,this),this.insert(this._toolbar)}},{key:"_insertDataTable",value:function(){if(n2.isNull(this._dataTable))throw new Error("Data table must be set in `_setComponents`");return this.insert(this._dataTable)}},{key:"_insertFooter",value:function(){if(n2.isNull(this._footer))throw new Error("Footer must be set in `_setComponents`");return this._footer.listen("click",this._handleClick,this),this.insert(this._footer)}},{key:"_handleClick",value:function(e){this._footer.clearFiltersButton&&this._footer.clearFiltersButton.id===e.target.id&&(this._toolbar.clear(),this._refresh({footer:!0})),this.fire("click",e)}},{key:"_handleTableClick",value:function(e,t,n,i){e instanceof n2.ui.component.DataTable?this.fire("click",this._createEvent.call(e,n,{relatedTarget:t,event:i})):this.fire("click",e)}},{key:"_handleChange",value:function(e){this.fire("change",e),e.data.actions.includes("filter")&&this._handleFilter(e)}},{key:"_handleFilter",value:function(e){this._refresh({footer:!0})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(n2.isArray(e))return _get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments);var t=e.dataTable,t=void 0!==t&&t,n=e.toolbar,n=void 0!==n&&n,i=e.footer,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshDataTable(),(e||n)&&this._refreshToolbar(),(e||i)&&this._refreshFooter()}},{key:"_refreshDataTable",value:function(){this._dataTable.data=this._data}},{key:"_refreshToolbar",value:function(){this._toolbar.clear(),this._toolbar.hidden=n2.isEmpty(this._data)}},{key:"_refreshFooter",value:function(){var e=this._dataTable.getFilteredRows().length,t=this._dataTable.data.length-e;this._footer.count={filtered:e,displayed:t}}}]),s}(),n2.de.component.Accordion=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._componentCls="n2-accordion",this._template='<ul id="{{id}}" class="slds-accordion {{componentCls}} {{cls}}{{#hidden}} {{hideCls}}{{/hidden}}"></ul>',this._openedSection=null}},{key:"_insert",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=_get(_getPrototypeOf(n.prototype),"_insert",this).call(this,e,t);return e instanceof n2.de.component.accordion.AccordionSection&&(e.opened&&this._setOpenedSection(e),e.listen("change",this._onAccordionSectionChange,this)),e}},{key:"_onAccordionSectionChange",value:function(e){n2.isUndefined(e.data.opened)||!0!==e.data.opened.newValue||this._setOpenedSection(e.target)}},{key:"_setOpenedSection",value:function(e){n2.isNull(this._openedSection)||e===this._openedSection||(this._openedSection.opened=!1),this._openedSection=e}}]),n}(),n2.de.component.AvailabilityCalendar=function(){_inherits(i,n2.ui.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{calendarToolbar:".n2_calendar-toolbar",calendarControls:".n2_calendar-navigation"}),this._template='<div id="{{id}}" class="{{componentCls}}{{#cls}} {{cls}}{{/cls}}{{#hidden}} {{hideCls}}{{/hidden}}">\n            <div class="n2_calendar-toolbar">\n                <div class="n2_calendar-navigation"></div>\n                {{#timezone}}<div class="n2_timezone"><span class="n2_timezone-label">Timezone:</span> {{timezone}}</div>{{/timezone}}\n            </div>\n            <table id="{{id}}" class="slds-table slds-table_header-fixed slds-table_fixed-layout"{{#selectable}} aria-multiselectable="true"{{/selectable}}{{#description}} aria-label="{{description}}"{{/description}}>\n                {{>colgroupTemplate}}\n                <thead></thead>\n                <tbody></tbody>\n                {{#footer.displayFooter}}<tfoot>{{> footerTemplate}}</tfoot>{{/footer.displayFooter}}\n            </table>\n        </div>',this._componentCls="n2-de-availability-calendar",this.columns=[{header:{cellTemplate:'<abbr title="Sunday">Sun</abbr>'},bindPath:"0",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Monday">Mon</abbr>'},bindPath:"1",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Tuesday">Tue</abbr>'},bindPath:"2",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Wednesday">Wed</abbr>'},bindPath:"3",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Thursday">Thu</abbr>'},bindPath:"4",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Friday">Fri</abbr>'},bindPath:"5",cell:{type:n2.de.component.availabilityCalendar.DayCell}},{header:{cellTemplate:'<abbr title="Saturday">Sat</abbr>'},bindPath:"6",cell:{type:n2.de.component.availabilityCalendar.DayCell}}],this._minDate=null,this._maxDate=null,this._currentDate=null,this._month=null,this._year=null,this._data=null,this._filterData=null,this._REFRESH={month:["calendarNavigation","dayCells"],year:["calendarNavigation"]}}},{key:"currentDate",set:function(e){this._setProperties({currentDate:e,month:e.getMonth(),year:e.getFullYear()},{silent:!1}),this.data=this._getCalendarData()}},{key:"dateRangeWeeks",get:function(){return this._getCalendarDateRangeWeeks()}},{key:"previousMonthButton",get:function(){return this._components["previous-month"]}},{key:"monthYearLabel",get:function(){return this._components["month-year-label"]}},{key:"nextMonthButton",get:function(){return this._components["next-month"]}},{key:"_onDefined",value:function(){n2.isNull(this._currentDate)||(this._month=this._currentDate.getMonth(),this._year=this._currentDate.getFullYear(),this._minDate=this._getMinimumStartDate(),this._maxDate=this._getMaximumStartDate(),this._data=this._getCalendarData()),_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._insertCalendarControls()}},{key:"_createRow",value:function(e){var t=this,n=_get(_getPrototypeOf(i.prototype),"_createRow",this).apply(this,arguments);return n.forEachCell(function(e){e.setProperties({currentDate:t._currentDate,month:t._month})}),n}},{key:"_insertCalendarControls",value:function(){return[this._insertPreviousMonthButton(),this._insertMonthYearLabel(),this._insertNextMonthButton()]}},{key:"_insertPreviousMonthButton",value:function(){return this._insert(new n2.ui.component.Button({id:"previous-month",renderTo:this.SELECTORS.calendarControls,icon:n2.de.enum.Icon.CHEVRON_LEFT,hidden:!this._hasMonthAndYear(),listeners:{click:this._onPreviousMonthClick,scope:this}}))}},{key:"_onPreviousMonthClick",value:function(e){if(0===this._month)return this._setProperties({month:11,year:this._year-1},{silent:!1});this._setProperty("month",this._month-1,{silent:!1})}},{key:"_insertMonthYearLabel",value:function(){return this._insert(new n2.ui.component.HTML({id:"month-year-label",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.calendarControls,hidden:!this._hasMonthAndYear(),cls:"n2_month-year-label",template:'<span id="{{id}}" class="{{cls}}{{#hidden}} {{hideCls}}{{/hidden}}">{{model.month}} {{model.year}}</span>',model:this._getMonthYearData()}))}},{key:"_insertNextMonthButton",value:function(){return this._insert(new n2.ui.component.Button({id:"next-month",renderTo:this.SELECTORS.calendarControls,icon:n2.de.enum.Icon.CHEVRON_RIGHT,hidden:!this._hasMonthAndYear(),listeners:{click:this._onNextMonthClick,scope:this}}))}},{key:"_onNextMonthClick",value:function(e){if(11===this._month)return this._setProperties({month:0,year:this._year+1},{silent:!1});this._setProperty("month",this._month+1,{silent:!1})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(i.prototype),"_getTemplateData",this).call(this),{timezone:this._getTimezone()})}},{key:"_getPropertyChangeEventConfig",value:function(){var e=_get(_getPrototypeOf(i.prototype),"_getPropertyChangeEventConfig",this).call(this);return e.data.dateRange=this._getCalendarMonthDateRange(),e.canBubble=!0,e}},{key:"filter",value:function(e){var t=e.userIds,n=void 0===t?null:t,t=e.tagIds,i=void 0===t?null:t;this._setProperty("filterData",{userIds:n,tagIds:i}),this.forEachRow(function(e){return e.forEachCell(function(e){return e.filter({userIds:n,tagIds:i})})})}},{key:"loadAvailabilityData",value:function(n,e){var i=this,e=e.weekNumber;this._components["tr-".concat(e)].componentList.forEach(function(e,t){e.setProperties({availabilityData:n[t],filterData:i._filterData})})}},{key:"_refresh",value:function(e){if(n2.isObject(e))return _get(_getPrototypeOf(i.prototype),"_refresh",this).call(this,e);"all"===e?this._refreshAll():this._refreshParts(e)}},{key:"_refreshCalendarNavigation",value:function(){this._isMinimumDate()?this.previousMonthButton.disable():this.previousMonthButton.enable(),this.monthYearLabel.model=this._getMonthYearData(),this._isMaximumDate()?this.nextMonthButton.disable():this.nextMonthButton.enable()}},{key:"_refreshDayCells",value:function(){this.data=this._getCalendarData()}},{key:"_getTimezone",value:function(){var e=n2.getTimeZone();return e!==this._getBrowserTimezone()?e:null}},{key:"_getBrowserTimezone",value:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone}},{key:"_hasMonthAndYear",value:function(){return!n2.isNull(this._month)&&!n2.isNull(this._year)}},{key:"_getMonthYearData",value:function(){return{month:n2.isNull(this._month)?this._month:n2.de.enum.Date.MONTH[this._month],year:this._year}}},{key:"_getCalendarData",value:function(){var t=this;return this.dateRangeWeeks.map(function(e){return t._getCalendarDaysData(e)})}},{key:"_getCalendarDaysData",value:function(e){for(var t=[],n=e.startDate;!n2.isLaterThan(n,e.endDate);)t.push(this._getCalendarDayData(n)),n.setDate(n.getDate()+1);return t}},{key:"_getCalendarDayData",value:function(e){return{day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear(),teamHolidayNames:null,teamMembersWorking:null,teamMembersOutOfOffice:null}}},{key:"_getCalendarDateRangeWeeks",value:function(){for(var e=this._getCalendarMonthDateRange(),t=[],n=e.startDate;!n2.isLaterThan(n,e.endDate);){var i=new Date(n.getTime());n.setDate(n.getDate()+6),t.push({startDate:i,endDate:new Date(n.getTime())}),n.setDate(n.getDate()+1)}return t}},{key:"_getCalendarMonthDateRange",value:function(){var e=this._getCurrentMonthStartDate(),t=7===e.getDay()?0:e.getDay(),n=this._getCurrentMonthEndDate();0!==t&&e.setDate(-(t-1));t=7<=(t=42-(t+n.getDate()))?t-7:t;return n.setDate(n.getDate()+t),{startDate:e,endDate:n}}},{key:"_isMinimumDate",value:function(){var e=this._getCurrentMonthStartDate();return n2.isDateEqual(this._minDate,e)||n2.isLaterThan(this._minDate,e)}},{key:"_isMaximumDate",value:function(){var e=this._getCurrentMonthStartDate();return n2.isDateEqual(this._maxDate,e)||n2.isEarlierThan(this._maxDate,e)}},{key:"_getMinimumStartDate",value:function(){var e=this._getCurrentMonthStartDate();return e.setMonth(e.getMonth()-1),e}},{key:"_getMaximumStartDate",value:function(){var e=this._getCurrentMonthStartDate();return e.setMonth(this._month+12),e}},{key:"_getCurrentMonthStartDate",value:function(){return new Date(this._year,this._month,1)}},{key:"_getCurrentMonthEndDate",value:function(){return new Date(this._year,this._month+1,0)}}]),i}(),n2.de.component.ButtonToggleGroup=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["buttons"]),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this._template='<div id="{{id}}" class="slds-button-group n2-component {{cls}}" role="group">\n        </div>',this._buttons=null,this._currentSelectedIndex=null}},{key:"buttons",set:function(e){this._forEachButtonComponent(function(e){e.destroy()}),this._addButtons()}},{key:"currentSelectedIndex",set:function(e){this._currentSelectedIndex!==e&&(this._currentSelectedIndex=e,this._refresh({selectedIndex:!0}))}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._addButtons()}},{key:"_addButtons",value:function(){var n=this;n2.isEmpty(this._buttons)||n2.forEach(this._buttons,function(e,t){e.selected&&(n._currentSelectedIndex=t),n.insert(new n2.ui.component.Button(n2.merge(e,{id:"button-".concat(t),cls:"slds-button_icon-border-filled",toggle:!0,listeners:{click:function(e){return n._onButtonClicked(e)}}})))})}},{key:"_onButtonClicked",value:function(n){var i;this._forEachButtonComponent(function(e,t){e===n?(i=t,e.select()):e.deselect()}),this._currentSelectedIndex!==i&&(this._currentSelectedIndex=i,this.fire("click",{target:n,data:{index:i}}))}},{key:"_forEachButtonComponent",value:function(t){var n=0;n2.forEach(this._components,function(e){if(e instanceof n2.ui.component.Button)return t(e,n++)})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.selectedIndex,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshCurrentSelectedIndex()}},{key:"_refreshCurrentSelectedIndex",value:function(){var n=this;this._forEachButtonComponent(function(e,t){t===n._currentSelectedIndex?e.select():e.deselect()})}}]),t}(),n2.de.component.Card=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{heading:".n2_card-heading",icon:".n2_icon",cardContent:".n2_card-content",body:".n2_content"}),this._componentCls="n2-de-card",this._template='<article id="{{id}}" class="n2-component slds-card{{#hidden}} {{hideCls}}{{/hidden}} {{componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{#heading}}{{>headingTemplate}}{{/heading}}\n            <div class="slds-card__body slds-card__body_inner n2_card-content">\n                <div class="n2_content">{{>contentTemplate}}</div>\n            </div>\n        </article>',this._headingTemplate='<div class="slds-card__header slds-grid n2_card-heading">\n            <header class="slds-media slds-media_center slds-has-flexi-truncate">\n                {{#icon}}{{>iconTemplate}}{{/icon}}\n                <div class="slds-media__body">\n                    <h2 class="slds-card__header-title">\n                        {{>headingContentTemplate}}\n                    </h2>\n                </div>\n            </header>\n        </div>',this._headingContentTemplate="<span>{{heading}}</span>",this._iconTemplate='<div class="n2_icon slds-media__figure">\n            <span class="slds-icon_container" title="{{iconTitle}}">\n                {{{icon}}}\n                <span class="slds-assistive-text">{{heading}}</span>\n            </span>\n        </div>',this._contentTemplate="{{#content}}<p>{{content}}</p>{{/content}}",this._heading=null,this._icon={},this._content=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["heading","content"],heading:["heading"],icon:["heading"],content:["content"]})}},{key:"heading",set:function(e){this._setProperty("heading",e,{sync:!1})}},{key:"icon",set:function(e){this._setProperty("icon",e,{sync:!1})}},{key:"content",set:function(e){this._setProperty("content",e,{sync:!1})}},{key:"_getTemplateData",value:function(){var e=n2.isUndefined(this._icon.cls)?"":this._icon.cls;return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{heading:this._heading,iconTitle:n2.isUndefined(this._icon.title)?this._heading:this._icon.title,icon:n2.isEmpty(this._icon)?null:n2.ui.Icon.getSVG(this._icon.icon,{cls:"slds-icon_small ".concat(e)}),content:this._getTemplateContent()})}},{key:"_getTemplateContent",value:function(){return this._content}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{headingTemplate:this._headingTemplate,headingContentTemplate:this._headingContentTemplate,iconTemplate:this._iconTemplate,contentTemplate:this._contentTemplate})}},{key:"_refreshHeading",value:function(){var e;n2.isNull(this.element("heading"))||this.element("heading").destroy(),n2.isEmpty(this._heading)||(e=n2.ui.Template.render(this._headingTemplate,this._getTemplateData(),this._getTemplatePartials()),this._dom.insert(e,"afterbegin"),this.element("heading",!0))}},{key:"_refreshContent",value:function(){var e;this.element("body").hasChildren()&&this.element("body").clear(),n2.isEmpty(this._content)||(e=n2.ui.Template.render(this._contentTemplate,this._getTemplateData(),this._getTemplatePartials()),this.element("body").insert(e,"afterbegin"),this.element("body",!0))}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).apply(this,arguments),this._heading=null,this._icon={},this._content=null}}]),t}(),n2.de.component.ConfirmationMessageBox=function(){_inherits(n,n2.ui.component.MessageBox);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._componentCls="n2-de-modal n2-confirmation-message-box",this._message="You will lose all unsaved changes, do you want to continue?"}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.message,t=void 0===t?this._message:t,e=e.listeners,e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).call(this,{message:t,buttons:n2.ui.enum.Button.OK_CANCEL,listeners:e})}}]),n}(),n2.de.component.DataTable=function(){_inherits(s,n2.ui.component.DataTable);var n,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._sortFunction=null,this._cachedRowSelection=[]}},{key:"emptyFilteredState",get:function(){return this._emptyFilteredState},set:function(e){n2.compare(this._emptyFilteredState,e)||(this._emptyFilteredState=e)}},{key:"currentSortBy",get:function(){return this._sortBy}},{key:"sortFunction",set:function(e){this._sortFunction!==e&&(this._sortFunction=e)}},{key:"_onHeaderRowSelectionChange",value:function(e){var t;_get(_getPrototypeOf(s.prototype),"_onHeaderRowSelectionChange",this).apply(this,arguments),e.target.selected?(t=this._getUnCachedRowSelection(),this._cachedRowSelection=n2.merge(this._cachedRowSelection,t)):this._cachedRowSelection=[],this.fire("selectionChange",e)}},{key:"_getUnCachedRowSelection",value:function(){var e=this;return this._getSelectionData({includeHidden:!1}).filter(function(t){return!!n2.isUndefined(e._cachedRowSelection.find(function(e){return e.id===t.id}))})||[]}},{key:"_onRowSelectionChange",value:function(t){t.target.selected?this._cachedRowSelection.push(t.target.data):this._cachedRowSelection=this._cachedRowSelection.filter(function(e){return e.id!==t.target.data.id}),_get(_getPrototypeOf(s.prototype),"_onRowSelectionChange",this).apply(this,arguments)}},{key:"_insertEmptyState",value:function(e){var t;n2.isUndefined(e.type)?_get(_getPrototypeOf(s.prototype),"_insertEmptyState",this).apply(this,arguments):(t=(e=n2.clone(e)).type,delete e.type,delete e.heading,delete e.content,delete e.button,e.id="empty-state",e.colspan=this._getTotalColumns().length,this._insert(new t(e)))}},{key:"_sort",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.direction,n2.isNull(this._sortFunction)?(_get(_getPrototypeOf(s.prototype),"_sort",this).apply(this,i),e.next=8):e.next=5;break;case 5:return e.next=7,this._sortFunction.apply(this,i);case 7:this._refreshData();case 8:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_refreshData",value:function(){_get(_getPrototypeOf(s.prototype),"_refreshData",this).apply(this,arguments),this._applySelection(),this._refreshHeaderRowSelection()}},{key:"_getSelectionData",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeHidden;return(void 0===e||e)&&!n2.isEmpty(this._cachedRowSelection)?this._cachedRowSelection:_get(_getPrototypeOf(s.prototype),"_getSelectionData",this).apply(this,arguments)}},{key:"_applySelection",value:function(){var n,i=this;n2.isEmpty(this._cachedRowSelection)||(n=_toConsumableArray(this._cachedRowSelection),this._cachedRowSelection=[],this.forEachRow(function(t){var e=n.find(function(e){return e.id===t.data.id});n2.isUndefined(e)?t.select(!1,{silent:!0}):(i._cachedRowSelection.push(t.data),t.select(!0,{silent:!0}))}))}},{key:"clearSelection",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,t=void 0!==e&&e;this.forEachRow(function(e){e.select(!1,{silent:t})},{includeHeaderRow:!0}),t&&(this._cachedRowSelection=[])}}]),s}(),n2.de.component.DeleteMessageBox=function(){_inherits(s,n2.ui.component.MessageBox);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="n2-de-modal n2-de-delete-message-box",this._hideOnSubmit=!1}},{key:"_onSaving",value:function(){this._components["ok-button"].spinner(),this._components["cancel-button"].disable()}},{key:"_onSaved",value:function(){this._components["ok-button"].spinner(!1),this._components["ok-button"].success()}},{key:"_onError",value:function(){_get(_getPrototypeOf(s.prototype),"_onError",this).apply(this,arguments),this._reset()}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.names,t=void 0===t?[]:t,n=e.itemCount,n=void 0===n?null:n,i=e.type,i=void 0===i?"items":i,e=e.listeners,e=void 0===e?null:e;_get(_getPrototypeOf(s.prototype),"show",this).call(this,{message:this._getMessage({names:t,type:i,itemCount:n}),buttons:n2.ui.enum.Button.OK_CANCEL,listeners:e})}},{key:"_getMessage",value:function(e){var t=e.names,n=e.type,e=e.itemCount;return"You are trying to delete ".concat(this._getNamesMessage({names:t,type:n,itemCount:void 0===e?null:e}),".  Are you sure you want to continue?")}},{key:"_getNamesMessage",value:function(e){var t=e.names,n=e.type,e=e.itemCount,e=void 0===e?null:e;return n2.isNull(e)?5<t.length?"".concat(t.length," ").concat(n.toLowerCase()):1<t.length?"".concat(t.slice(0,-1).join(", ")," and ").concat(t.slice(-1)):t[0]:"".concat(e," ").concat(n.toLowerCase())}},{key:"_reset",value:function(){this._components["ok-button"].reset(),this._components["cancel-button"].enable()}},{key:"hide",value:function(){var e=arguments,t=this;return new n2.util.DelayedTask(function(){_get(_getPrototypeOf(s.prototype),"hide",t).apply(t,e)},500).start()}}]),s}(),n2.de.component.ExpiringLicenseWarning=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{> contentTemplate}}\n        </div>',this._componentCls="n2-de-expiring-license-warning",this._trialContentTemplate='<p>\n            {{{icon}}} Your trial expires in <span>{{daysToExpiry}}.</span>\n            <a class="n2-link-knowledge" href="https://help.nc-squared.com/purchasing-licences" target="_blank">Contact Support</a>\n        </p>',this._licenseContentTemplate='<p>\n            {{{icon}}} Your license expires in <span>{{daysToExpiry}}.</span>\n            <a class="n2-link-knowledge" href="https://help.nc-squared.com/contact-us-support" target="_blank">Contact Support</a>\n        </p>',this._renewalContentTemplate='<div>\n            <div class="n2-dismiss-container slds-float_right"></div>\n            <p class=" slds-m-bottom_small">\n            {{{icon}}} Your Distribution Engine license is expiring in <span>{{daysToRenewal}}</span>.</p>\n             <p>Please contact <a class="n2-renewal-mailto" target="_blank" href="mailto:admin@nc-squared.com">admin@nc-squared.com</a> to ensure the continuation of the service.</p>\n        </div>',this._expiredLicenseContentTemplate='<div>\n            <p class="slds-m-bottom_small">\n            {{{icon}}} Your Distribution Engine license has expired.\n             </p>\n             <p>Please contact <a class="n2-renewal-mailto" target="_blank" href="mailto:admin@nc-squared.com">admin@nc-squared.com</a> to ensure the continuation of the service.</p>\n        </div>',this._developerContentTemplate="<p>{{{icon}}} Developer Edition: Not supported</p>",this._EXPIRY_LIMIT=7,this._messageType=null,this._daysToExpiry=null,this._daysToRenewal=null}},{key:"dismissButton",get:function(){return this._components["dismiss-button"]}},{key:"messageType",set:function(e){this._messageType!==e&&(this._messageType=e,this._refresh())}},{key:"daysToExpiry",set:function(e){this._daysToExpiry!==e&&(this._daysToExpiry=e,this._refresh())}},{key:"daysToRenewal",set:function(e){this._daysToRenewal!==e&&(this._daysToRenewal=e,this._refresh())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._hidden=!this._isExpiring()&&!this._isRenewal()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{daysToRenewal:1===this._daysToRenewal?"".concat(this._daysToRenewal," day"):"".concat(this._daysToRenewal," days"),daysToExpiry:1===this._daysToExpiry?"".concat(this._daysToExpiry," day"):"".concat(this._daysToExpiry," days"),icon:n2.ui.Icon.getSVG(n2.de.enum.Icon.IDENTITY,{cls:"slds-icon_x-small"})})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{contentTemplate:this._getContentTemplate()})}},{key:"_refresh",value:function(){this._refreshContent(),this.hidden=!this._isExpiring()&&!this._isRenewal()}},{key:"_refreshContent",value:function(){var e;this._dom.clear(),(this._isExpiring()||this._isRenewal())&&(e=n2.ui.Template.render(this._getContentTemplate(),this._getTemplateData(),this._getTemplatePartials()),this._dom.insert(e,"afterbegin"),this._isRenewal())&&(n2.isUndefined(this.dismissButton)||this.dismissButton.destroy(),this._insertDismissButton())}},{key:"_getContentTemplate",value:function(){switch(this._messageType){case n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.DEVELOPER:return this._developerContentTemplate;case n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.LICENSE:return this._licenseContentTemplate;case n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.RENEWAL:return this._renewalContentTemplate;case n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.EXPIRED:return this._expiredLicenseContentTemplate;case n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.TRIAL:return this._trialContentTemplate;default:return""}}},{key:"_insertDismissButton",value:function(){var e=this;return this._insert(new n2.ui.component.Button({id:"dismiss-button",renderTo:".n2-dismiss-container",icon:n2.ui.enum.Icon.CLOSE,theme:n2.ui.component.button.Theme.INVERSE,listeners:{click:function(){e._dismissRenewalWarning()}}}))}},{key:"_isExpiring",value:function(){return!n2.isNull(this._daysToExpiry)&&this._daysToExpiry<=this._EXPIRY_LIMIT}},{key:"_isRenewal",value:function(){if(this._messageType===n2.de.component.ExpiringLicenseWarning.MESSAGE_TYPE.RENEWAL)return!0}},{key:"_dismissRenewalWarning",value:function(){this.hide()}}],[{key:"MESSAGE_TYPE",get:function(){return{DEVELOPER:"developer",LICENSE:"license",TRIAL:"trial",EXPIRED:"expired",RENEWAL:"renewal"}}}]),t}(),n2.de.component.Form=function(){_inherits(n,n2.ui.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{formBody:".slds-form-element"}),this._componentCls="n2-form n2-de-form",this._includeFooter=!0}},{key:"includeFooter",set:function(e){this._includeFooter!==e&&(this._includeFooter=e,this._refresh({footer:!0}))}},{key:"footer",get:function(){return this._components["save-footer"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._includeFooter&&this._insertSaveFooter()}},{key:"_onSaving",value:function(){this._disable(!0),this._includeFooter&&(this.footer.message="Saving...",this.footer.spinner())}},{key:"_onSaved",value:function(){var e=this;this._includeFooter&&(this.footer.message="Saved",this.footer.showSuccess(),new n2.util.DelayedTask(function(){e._resetFooter()},500).start()),this._disable(!1)}},{key:"_resetFooter",value:function(){var e=this;this._includeFooter&&(this.footer.hidden=!0,new n2.util.DelayedTask(function(){e.footer.reset()},500).start())}},{key:"_onError",value:function(){this._includeFooter&&this.footer.showError(),this._disable(!1)}},{key:"_insert",value:function(e){var t=this;return(e instanceof n2.ui.component.Field||e instanceof n2.de.component.form.FieldGroup)&&(e.renderTo=e.renderTo||this.SELECTORS.formBody,e.listen("change",function(e){return t._onFieldChange(e)},this),e instanceof n2.ui.component.field.TextBox)&&e.listen("type",function(e){return t._onFieldChange(e)},this),_get(_getPrototypeOf(n.prototype),"_insert",this).apply(this,arguments)}},{key:"_onFieldChange",value:function(e){e=this._createChangeEventObject([{property:"value",type:"set"}],{relatedTarget:e,defaultMethod:this._showFooter});this.fire("change",e)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.footer,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshFooter()}},{key:"_refreshFooter",value:function(){n2.isUndefined(this.footer)||this.footer.destroy(),this._includeFooter&&this._insertSaveFooter()}},{key:"_insertSaveFooter",value:function(){var t=this;return this._insert(new n2.de.component.form.Footer({id:"save-footer",hidden:!0,listeners:{cancel:function(e){t.cancel()},submit:function(e){return t.submit()}}}))}},{key:"cancel",value:function(){_get(_getPrototypeOf(n.prototype),"cancel",this).apply(this,arguments),this._onCancel(),this._hideFooter()}},{key:"_onCancel",value:function(){this.reset()}},{key:"submit",value:function(){!this._disabled&&this.validate()&&(_get(_getPrototypeOf(n.prototype),"submit",this).apply(this,arguments),this._onSubmit())}},{key:"_onSubmit",value:function(){}},{key:"_disable",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];_get(_getPrototypeOf(n.prototype),"_disable",this).apply(this,arguments),this._disableFooter(e)}},{key:"_showFooter",value:function(){this._includeFooter&&(this.footer.message="You have unsaved changes.",this.footer.hidden=!1)}},{key:"_hideFooter",value:function(){this._includeFooter&&(this.footer.hidden=!0)}},{key:"_disableFooter",value:function(){this._includeFooter&&(this.footer.disabled=!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}},{key:"validate",value:function(){var t=this,n=(this._isValid=!0,null);return this.forEachField(function(e){e.hidden||e.disabled||e.validate()||(t._isValid=!1,n=n||e)}),n2.isNull(n)||n2.de.component.Form.scrollInvalidComponentIntoView(n),this._isValid}},{key:"forEachField",value:function(t){var n=this;this.forEach(function(e){if(e.instanceOf(n2.ui.component.Field)||e.instanceOf(n2.de.component.form.FieldGroup))return t.call(n,e)})}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).apply(this,arguments),this._removeDataProviderListeners()}},{key:"_removeDataProviderListeners",value:function(){var t=this;this._isDataDriven()&&this._getDataProviders(this.dataProviders).forEach(function(e){e.removeListeners("loading",{caller:t}),e.removeListeners("loaded",{caller:t}),e.removeListeners("posting",{caller:t}),e.removeListeners("posted",{caller:t}),e.removeListeners("error",{caller:t})})}}],[{key:"scrollInvalidComponentIntoView",value:function(e){var t=e instanceof n2.de.component.form.FieldGroup?e.getFirstInvalidField():e;t instanceof n2.ui.component.field.DataTable&&(t=this._findInvalidFieldInDataTableField(t)),n2.isNull(t)||(t.dom.scrollIntoView({behaviour:"smooth"}),new n2.util.DelayedTask(function(){t.focus()},500).start())}},{key:"_findInvalidFieldInDataTableField",value:function(e){var t=e;return e.components["data-table"].forEachRow(function(e){return e.forEachCell(function(e){return e.forEach(function(e){if(e instanceof n2.ui.component.Field&&!e.isValid)return t=e,!1})})}),t}}]),n}(),n2.de.component.Header=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["heading","icon"]),this.SELECTORS=n2.merge(this.SELECTORS,{heading:".slds-page-header__title",icon:".slds-icon",additionalHeading:".slds-page-header__name-meta",actions:".n2_actions",helpLink:".n2_help-link"}),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this._heading="",this._icon="",this._template='<div id="{{id}}" class="n2-de-header slds-page-header">\n            <div class="slds-page-header__row">\n                <div class="slds-page-header__col-title">\n                    <div class="slds-media slds-media_center">\n                        <div class="slds-media__figure">\n                            <span class="slds-icon_container" title="{{heading}}">\n                                <svg class="slds-icon n2_icon slds-icon_small" aria-hidden="true">\n                                    <use xlink:href="{{icon}}"></use>\n                                </svg>\n                                <span class="slds-assistive-text">{{heading}}</span>\n                            </span>\n                        </div>\n                        <div class="slds-media__body">\n                            <div class="slds-page-header__name">\n                                <div class="slds-page-header__name-title">\n                                    <h1>\n                                        <span class="slds-page-header__title slds-truncate" title="{{heading}}">{{heading}}</span>\n                                    </h1>\n                                </div>\n                            </div>\n                            {{#additionalHeading}}{{>additionalHeadingTemplate}}{{/additionalHeading}}\n                        </div>\n                    </div>\n                </div>\n                <div class="slds-page-header__col-actions">\n                    <div class="slds-page-header__controls">\n                        <div class="slds-page-header__control">\n                            <div class="n2_actions">\n                                {{#helpLinkURL}}{{>helpLinkTemplate}}{{/helpLinkURL}}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>',this._additionalHeadingTemplate='<p class="slds-page-header__name-meta">{{{additionalHeading}}}</p>',this._helpLinkTemplate='<a href="{{helpLinkURL}}" target="_blank" class="n2_help-link slds-grid slds-grid_vertical-align-center n2_mobile-app-hide">'+n2.ui.Icon.getSVG(n2.de.enum.Icon.HELP,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<span class="slds-col">Help</span></a>',this._additionalHeading=null,this._helpLinkURL=null,this._actionMenuOptions=[],this._createdBy=null,this._modifiedBy=null,this._showRefreshButton=!1,this._REFRESH=n2.merge(this._REFRESH,{heading:["heading"],icon:["icon"],additionalHeading:["additionalHeading"],helpLinkURL:["helpLink"],actionMenuOptions:["actionMenu"],createdBy:["actionMenu"],modifiedBy:["actionMenu"],showRefreshButton:["refreshButton"]})}},{key:"heading",set:function(e){this._setProperty("heading",e,{sync:!1})}},{key:"icon",set:function(e){this._setProperty("icon",e,{sync:!1})}},{key:"additionalHeading",set:function(e){this._setProperty("additionalHeading",e,{sync:!1})}},{key:"helpLinkURL",set:function(e){this._setProperty("helpLinkURL",e,{sync:!1})}},{key:"actionMenuOptions",set:function(e){this._setProperty("actionMenuOptions",e,{sync:!1})}},{key:"createdBy",set:function(e){this._setProperty("createdBy",e,{sync:!1})}},{key:"modifiedBy",set:function(e){this._setProperty("modifiedBy",e,{sync:!1})}},{key:"showRefreshButton",set:function(e){this._setProperty("showRefreshButton",e,{sync:!1})}},{key:"actionMenu",get:function(){return this._components["action-menu"]}},{key:"refreshButton",get:function(){return this._components["refresh-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertActionMenu(),this._insertRefreshButton()}},{key:"_insertActionMenu",value:function(){var n=this;return this._insert(new n2.de.component.header.ActionMenu({id:"action-menu",renderTo:this.SELECTORS.actions,options:this._actionMenuOptions,createdBy:this._createdBy,modifiedBy:this._modifiedBy,hidden:!this._hasActionMenuContent(),listeners:{select:function(e,t){return n._onActionMenuSelect(e)}}}))}},{key:"_onActionMenuSelect",value:function(e){this.fire("click",this._createEvent(e))}},{key:"_insertRefreshButton",value:function(){return this._insert(new n2.ui.component.Button({id:"refresh-button",renderTo:this.SELECTORS.actions,icon:n2.de.enum.Icon.SYNC,hidden:!this._showRefreshButton,cls:"n2_refresh-button n2_mobile-app-hide",title:"Refresh",listeners:{click:this._handleRefreshButtonClick,scope:this}}))}},{key:"_handleRefreshButtonClick",value:function(e){this.fire("click",this._createEvent(e,{defaultMethod:this._onRefreshButtonClick}))}},{key:"_onRefreshButtonClick",value:function(e){}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{heading:this._heading,icon:n2.ui.Icon.getLink(this._icon),additionalHeading:this._additionalHeading,helpLinkURL:this._helpLinkURL})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{additionalHeadingTemplate:this._additionalHeadingTemplate,helpLinkTemplate:this._helpLinkTemplate})}},{key:"_refreshIcon",value:function(){this._rendered&&this.element("icon").attribute("xlink:href",this._icon)}},{key:"_refreshHeading",value:function(){this._rendered&&this.element("heading").text(this._heading)}},{key:"_refreshAdditionalHeading",value:function(){var e;n2.isNull(this.element("additionalHeading"))?(e=n2.ui.Template.render(this._additionalHeadingTemplate,this._getTemplateData()),this._dom.find(".slds-media__body").insert(e)):n2.isNull(this._additionalHeading)?this.element("additionalHeading").remove():(this.element("additionalHeading").clear(),this.element("additionalHeading").insert(this._additionalHeading))}},{key:"_refreshHelpLink",value:function(){var e;n2.isNull(this.element("helpLink"))&&(e=n2.ui.Template.render(this._helpLinkTemplate,this._getTemplateData()),this._dom.find(".n2_actions").insert(e)),n2.isNull(this._helpLinkURL)?this.element("helpLink").remove():this.element("helpLink").attribute("href",this._helpLinkURL)}},{key:"_refreshActionMenu",value:function(){this.actionMenu.hidden=this._hasActionMenuContent(),this._refreshActionMenuOptions(),this._refreshCreatedBy(),this._refreshModifiedBy()}},{key:"_refreshActionMenuOptions",value:function(){this.actionMenu.options=this._actionMenuOptions}},{key:"_refreshCreatedBy",value:function(){this.actionMenu.createdBy=this._createdBy}},{key:"_refreshModifiedBy",value:function(){this.actionMenu.modifiedBy=this._modifiedBy}},{key:"_refreshRefreshButton",value:function(){this.refreshButton.hidden=!this._showRefreshButton}},{key:"_hasActionMenuContent",value:function(){return!n2.isEmpty(this._actionMenuOptions)||!n2.isNull(this._createdBy)||!n2.isNull(this._modifiedBy)}}]),t}(),n2.de.component.Link=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this._componentCls="n2-de-link",this._template='<a id="{{id}}" href="{{href}}"{{#target}} target="{{target}}"{{/target}} class="n2-component {{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{text}}\n        </a>',this._text=null,this._href="#",this._target=null}},{key:"text",set:function(e){this._text!==e&&(this._text=e,this._refresh({href:!1,target:!1}))}},{key:"href",set:function(e){this._href!==e&&(this._href=e,this._refresh({text:!1,target:!1}))}},{key:"target",set:function(e){this._target!==e&&(this._target=e,this._refresh({href:!1,text:!1}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{text:this._text,href:this._href,target:this._target})}},{key:"_bindEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),this._dom.listen("click",function(e){t._onClick(e),t.fire("click",{target:t,event:e})})}},{key:"_onClick",value:function(e){}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.text,n=e.href,n=void 0===n||n,e=e.target,e=void 0===e||e;this._rendered&&((void 0===t||t)&&this._refreshText(),n&&this._refreshHref(),e)&&this._refreshHref()}},{key:"_refreshText",value:function(){var e=n2.isNull(this._text)?"":this._text;this._dom.text(e)}},{key:"_refreshHref",value:function(){var e=n2.isNull(this._href)?"#":this._href;this._dom.attribute("href",e)}},{key:"_refreshTarget",value:function(){this._dom.attribute("target",this._target)}}]),n}(),n2.de.component.Modal=function(){_inherits(n,n2.ui.component.Modal);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{body:".slds-modal__content",footerButtons:".slds-modal__footer .n2_footer-buttons"}),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Singleton],this._mixins),this._buttons=n2.ui.enum.Button.OK_CANCEL,this._errorMessageTemplate='<div class="n2_validation-message slds-grid slds-text-color_error slds-m-top_x-small">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.ERROR,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-error"}),'\n            <div class="slds-col slds-text-body_small"><p>{{{message}}}</p></div>\n        </div>')}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._submitButton=this.components["submit-button"]}},{key:"_addOkButton",value:function(e){var t=this;this._addButton(n2.merge({id:"submit-button",text:"OK",theme:e,listeners:{click:function(){return t._onSubmit()}}},this._getOKButtonConfig()))}},{key:"_getOKButtonConfig",value:function(){return{}}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{cls:"n2-de-modal ".concat(this._cls)})}},{key:"_onSaving",value:function(){this._components["cancel-button"].disable(),this._components["submit-button"].spinner()}},{key:"_onSaved",value:function(e,t){var n=this._components["submit-button"];n.spinner(!1),n.success()}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onError",this).apply(this,arguments),n2.de.Error.isDE2(e)?(this._showFooterValidation({message:n2.de.Error.getMessage(e)}),this._resetButtons()):(this.hide(),this._reset())}},{key:"_renderChildren",value:function(e){this.element("footer").insert('<div class="n2_footer-buttons"></div>'),_get(_getPrototypeOf(n.prototype),"_renderChildren",this).call(this,e)}},{key:"_addButton",value:function(e){this.insert(new n2.ui.component.Button(n2.merge(e,{renderTo:this.SELECTORS.footerButtons})))}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).call(this),this._reset()}},{key:"_reset",value:function(){this._resetButtons(),this._clearFooterValidation()}},{key:"_resetButtons",value:function(){var e=this._components["submit-button"];e.reset(),e.enable(),e.spinner(!1),this._components["cancel-button"].enable()}},{key:"_showFooterValidation",value:function(e){var t,n,e=e.message,e=void 0===e?"":e;this._rendered&&(t=this._getFooterForMessage().find(".n2_validation-message"),this._dom.addClass("n2_has-validation-message"),n2.isNull(t)?(n=n2.ui.Template.render(this._errorMessageTemplate,{message:e}),this._getFooterForMessage().insert(n,"afterbegin")):t.find("p").text(e))}},{key:"_clearFooterValidation",value:function(){var e;this._rendered&&(e=this._getFooterForMessage().find(".n2_validation-message"),n2.isNull(e)||(this._dom.removeClass("n2_has-validation-message"),e.remove()))}},{key:"_getFooterForMessage",value:function(){return this._rendered?this._dom.find("#".concat(this.domId,"_footer")):null}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).listeners,e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),n2.isNull(e)||this._applyListeners(e)}},{key:"hide",value:function(){_get(_getPrototypeOf(n.prototype),"hide",this).call(this),this.purgeListeners()}}]),n}(),n2.de.component.RecordName=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS||{},{click:function(e){}}),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Observable],this._mixins),this._template='<span id="{{id}}" class="n2-component{{#cls}} {{cls}}{{/cls}}">\n            {{#isLink}}<a href="#" title="{{text}}">{{text}}</a>{{/isLink}}\n            {{^isLink}}<span title="{{text}}"}>{{text}}</span>{{/isLink}}\n        </span>',this.text="",this.isLink=!1}},{key:"_prepareDOM",value:function(){var t=this,e=(_get(_getPrototypeOf(n.prototype),"_prepareDOM",this).apply(this,arguments),this._dom.find("a"));n2.isNull(e)||e.listen("click",function(e){e.stopPropagation(),t.fire("click",t._createEvent(t,{event:e}))})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{text:this.text,isLink:this.isLink})}}]),n}(),n2.de.component.ScopedNotification=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["type"]),this._template='<div id="{{id}}" class="n2-component n2_scoped-notification{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{>notificationTemplate}}\n        </div>',this._notificationTemplate='<div class="n2_scoped-notification-template slds-scoped-notification{{#isLightTheme}} slds-scoped-notification_light{{/isLightTheme}} slds-media slds-media_center {{#theme}}{{theme}}{{/theme}}" role="status">\n            <div class="slds-media__figure">\n            <span class="slds-icon_container {{utility}}" title="{{type}}">\n                {{{svg}}}\n                <span class="slds-assistive-text">{{type}}</span>\n            </span>\n            </div>\n            <div class="slds-media__body">\n            <p>{{{content}}}</p>\n            </div>\n        </div>',this._content=null,this._type=null,this._isLightTheme=!1}},{key:"content",set:function(e){this._content=e,this._refreshNotification()}},{key:"type",set:function(e){this._type!==e&&(this._type=e,this._refreshNotification())}},{key:"isLightTheme",set:function(e){this._isLightTheme!==e&&(this._isLightTheme=e,this._refreshNotification())}},{key:"_refreshNotification",value:function(){var e;this.rendered&&(this._dom.clear(),e=n2.ui.Template.render(this._notificationTemplate,this._getTemplateData()),this._dom.insert(e))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{content:this._content,type:this._type,isLightTheme:this._isLightTheme,theme:this._isLightTheme?null:"slds-theme_".concat(this._type),utility:"slds-icon-utility-".concat(this._type),svg:n2.ui.Icon.getSVG(this._getIconConfig(),{cls:this._isLightTheme?"slds-icon_x-small "+this._getIconClass():"slds-icon_x-small"})})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{notificationTemplate:this._notificationTemplate})}},{key:"_getIconConfig",value:function(){switch(this._type){case"info":return n2.ui.enum.Icon.INFO;case"warning":return n2.de.enum.Icon.WARNING;case"error":return n2.ui.enum.Icon.ERROR;case"success":return n2.de.enum.Icon.SUCCESS}}},{key:"_getIconClass",value:function(){switch(this._type){case"warning":case"error":case"success":return"slds-icon-text-".concat(this._type);default:return"slds-icon-text-default"}}}]),t}(),n2.de.component.UserSelectionModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.id="user-selection-modal",this._mixins=n2.merge(this._mixins,[n2.mixin.Singleton]),this.header="Select User",this._cls="n2-user-selection-modal",this._selectedUser=null,this._teamId=null,this._informationMessageTemplate='<div id="{{id}}" class="n2_user-limit-message slds-grid slds-m-bottom_small slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Displaying '+n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT+" users, use the filters to find others.</p></div></div>"}},{key:"selectedUser",get:function(){return this._selectedUser}},{key:"teamId",set:function(e){this._teamId!==e&&(this._teamId=e)}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this.insert(new n2.ui.component.HTML({id:"user-limit-message",template:this._informationMessageTemplate,hidden:!0})),this._insertUserSearch(),this._insertUserSelection()}},{key:"_insertUserSearch",value:function(){var e=this;this.insert(new n2.ui.component.field.TextBox({id:"user-search",label:{text:"Search by name",hidden:!0},placeholder:"Find users...",cls:"slds-m-bottom_small",icon:n2.ui.enum.Icon.SEARCH,listeners:{type:function(){return e._loadUsers({force:!0})}}}))}},{key:"_insertUserSelection",value:function(){var t=this;this.insert(new n2.ui.component.field.Combo({id:"user-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-available-users"],label:{text:"Select user",hidden:!0},sort:!1,required:!0,options:{bindPath:"get-available-users",adapter:function(e){return e.map(function(t){return{label:1<e.filter(function(e){return e.name===t.name}).length?"".concat(t.name," (").concat(t.username,")"):t.name,value:t.id}})}},listeners:{change:function(e){n2.isEmpty(e.value)?t._components["submit-button"].disable():t._components["submit-button"].enable()}}}))}},{key:"_getOKButtonConfig",value:function(){return{text:"Select User",disabled:!0}}},{key:"show",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._loadUsers({sortAscending:!0,force:!0})}},{key:"_loadUsers",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(t=0<s.length&&void 0!==s[0]?s[0]:{}).force,i=void 0!==i&&i,t=t.silent,t=void 0!==t&&t,n={name:this._components["user-search"].value,teamId:this._teamId,sortAscending:!0,userLimit:n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT},e.next=4,n2.DataProviderManager.getInstance().get("get-available-users").get({force:i,silent:t,params:[n]});case 4:i=e.sent,this._components["user-limit-message"].hidden=i.length<n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT;case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSubmit",value:function(){var t=this;this._selectedUser=n2.DataProviderManager.getInstance().get("get-available-users").model.find(function(e){return e.id===t._components["user-selection"].value}),_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),this.hide(),this._reset()}},{key:"reset",value:function(){this._selectedUser=null,this._reset()}},{key:"_reset",value:function(){_get(_getPrototypeOf(n.prototype),"_reset",this).call(this),this._components["user-search"].clear(),this._components["user-selection"].clear()}},{key:"_resetButtons",value:function(){_get(_getPrototypeOf(n.prototype),"_resetButtons",this).call(this),this._components["submit-button"].disable()}}]),n}(),n2.de.component.VerticalNavigation=function(){_inherits(t,n2.ui.component.VerticalNavigation);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{returnLinkContainer:".n2_return-link-container",returnLink:".n2_return-link-container > .n2_return-link"}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._componentCls="n2-de-vertical-navigation",this._template='<nav id="{{id}}" class="slds-nav-vertical n2-vertical-navigation{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}{{#hidden}} {{hideCls}}{{/hidden}}{{^returnLink}} n2_no-return-link{{/returnLink}}">\n            {{#returnLink}}{{> returnLinkTemplate}}{{/returnLink}}\n        </nav>',this._returnLinkTemplate='<div class="n2_return-link-container">\n            <a href="{{returnLink.href}}" class="n2_return-link">\n                <span class="slds-icon_container slds-line-height_reset" title="returnLink.text">\n                    '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.CHEVRON_LEFT,{cls:"slds-icon-text-default slds-icon_x-small slds-m-right_small"}),"\n                </span>\n                {{returnLink.text}}\n            </a>\n        </div>"),this._returnLink=null}},{key:"returnLink",set:function(e){this._returnLink!==e&&(this._returnLink=e,this._refresh({returnLink:!0}))}},{key:"activeLink",get:function(){return this._activeLink},set:function(e){this._activeLink!==e&&(this._activeLink=e,this._refresh({activeLink:!0}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{returnLink:this._returnLink})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{returnLinkTemplate:this._returnLinkTemplate})}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._bindReturnLinkEvents()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.activeLink,t=void 0!==t&&t,n=e.returnLink,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshActiveLink(),(e||n)&&this._refreshReturnLink()}},{key:"_refreshActiveLink",value:function(){this._activeLink.active=!0}},{key:"_refreshReturnLink",value:function(){var e;this._rendered&&(this.element("returnLinkContainer").remove(),e=n2.ui.Template.render(this._returnLinkTemplate,this._getTemplateData(),this._getTemplatePartials()),this._dom.insert(e,{position:"afterbegin"}),this._bindReturnLinkEvents())}},{key:"_bindReturnLinkEvents",value:function(){var e=this,t=this.element("returnLink",!0);n2.isNull(t)||t.listen("click",function(){e._onReturnLinkClick(),e.fire("click",{target:t,currentTarget:e})},{scope:this})}},{key:"_onReturnLinkClick",value:function(){}}]),t}(),n2.de.component.Wizard=function(){_inherits(i,n2.ui.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},change:function(e){}}),this.id="wizard",this.SELECTORS=n2.merge(this.SELECTORS,{body:".slds-modal__content"}),this._componentCls="n2-de-wizard",this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Singleton],this._mixins),this._buttons=null,this._stages=[]}},{key:"footer",get:function(){return this._components.footer}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),n2.isNull(this._buttons)&&this._insertWizardFooter()}},{key:"_addFooterButtons",value:function(){this._insertWizardFooter()}},{key:"_insertWizardFooter",value:function(){return this._insert(new n2.de.component.wizard.Footer({id:"footer",buttons:this._buttons,renderTo:this.SELECTORS.footer}))}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onError",this).apply(this,arguments),this.hide(),this._reset()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(i.prototype),"_onCancel",this).call(this)}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.currentStageId,t=void 0===t?null:t,e=e.listeners,e=void 0===e?null:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.footer.stages=this._stages,this.footer.listen("click",this._onFooterClick,this),this.footer.listen("change",this._onFooterChange,this),this.footer.currentStageId=n2.isNull(t)?this._stages[0].id:t,this._submitButton=this.footer.submitButton,n2.isNull(e)||this._applyListeners(e)}},{key:"_onFooterClick",value:function(e){switch(e.target.id){case"cancel-button":this._onCancel();break;case"submit-button":this._onSubmit();break;case"back-button":this._onBackButtonClick(e);break;case"next-button":this._onNextButtonClick(e);break;default:this._onStageButtonClick(e)}}},{key:"_onSubmit",value:function(){this._validateStage()?(this.footer.markCurrentStageComplete(),this._onWizardSubmit(),_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this)):this.footer.markCurrentStageInvalid()}},{key:"_onWizardSubmit",value:function(){}},{key:"_onBackButtonClick",value:function(e){this._moveToPreviousStage()}},{key:"_moveToPreviousStage",value:function(){this.footer.moveToPreviousStage()}},{key:"_onNextButtonClick",value:function(e){this._validateStage()?this._moveToNextStage():this.footer.markCurrentStageInvalid()}},{key:"_moveToNextStage",value:function(){this.footer.moveToNextStage()}},{key:"_onStageButtonClick",value:function(e){this._moveToStageId(e.target.id)}},{key:"_moveToStageId",value:function(e){this.footer.currentStageId=e}},{key:"_validateStage",value:function(){return!0}},{key:"_onFooterChange",value:function(e){e.data.changes.includes("currentStageId")&&this._onStageChange(e)}},{key:"_onStageChange",value:function(e){}},{key:"_onSaving",value:function(e){this.footer.submitButton.spinner()}},{key:"_onSaved",value:function(e,t){var n=this;_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),this.footer.submitButton.spinner(!1),this.footer.submitButton.success(),new n2.util.DelayedTask(function(){n.hide(),n.footer.submitButton.reset()},500).start()}},{key:"hide",value:function(){_get(_getPrototypeOf(i.prototype),"hide",this).call(this),this.purgeListeners(),this.footer.purgeListeners()}},{key:"destroy",value:function(){_get(_getPrototypeOf(i.prototype),"destroy",this).apply(this,arguments),this.footer.purgeListeners()}}]),i}(),n2.de.data.Adapters={objectFieldOptions:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.includeFilterable,i=t.includeSortable,s=t.includeFormula,a=t.includeRecordTypeId,o=t.includeFiltersOnly,t=t.validTypes;return(e=n2.de.data.Adapters._filterFieldOptions(e,{includeFilterable:n,includeSortable:i,includeFormula:s,includeRecordTypeId:a,includeFiltersOnly:void 0!==o&&o,validTypes:t})).map(function(e){return{label:e.label,value:e.value}})},objectFieldOptionsWithType:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.includeFilterable,i=t.includeSortable,s=t.includeFormula,a=t.includeRecordTypeId,o=t.includeFiltersOnly,r=t.validTypes,t=t.includeParents;return(e=n2.de.data.Adapters._filterFieldOptions(e,{includeFilterable:n,includeSortable:i,includeFormula:s,includeRecordTypeId:a,includeFiltersOnly:void 0!==o&&o,validTypes:r,includeParents:void 0!==t&&t})).map(function(e){return{label:e.label,value:e.value,type:e.type,isParent:!n2.isUndefined(e.isParent)&&e.isParent}})},formulaFieldOptions:function(e){return this.objectFieldOptions(e,{includeSortable:!0,includeFilterable:!0,includeFormula:!0,validTypes:[n2.de.data.FieldType.STRING]})},classifierFilterFieldOptions:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.includeFiltersOnly,t=t.includeParents,i=[n2.de.data.FieldType.BOOLEAN,n2.de.data.FieldType.COMBOBOX,n2.de.data.FieldType.CURRENCY,n2.de.data.FieldType.DATE,n2.de.data.FieldType.DATETIME,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.EMAIL,n2.de.data.FieldType.INTEGER,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.PHONE,n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.TEXTAREA,n2.de.data.FieldType.URL];return this.objectFieldOptionsWithType(e,{includeFilterable:!0,includeFiltersOnly:void 0!==n&&n,includeRecordTypeId:!0,includeParents:void 0!==t&&t,validTypes:i})},backfillFilterFieldOptions:function(e){var t=[n2.de.data.FieldType.ID,n2.de.data.FieldType.BOOLEAN,n2.de.data.FieldType.COMBOBOX,n2.de.data.FieldType.CURRENCY,n2.de.data.FieldType.DATE,n2.de.data.FieldType.DATETIME,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.EMAIL,n2.de.data.FieldType.INTEGER,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.PHONE,n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.TEXTAREA,n2.de.data.FieldType.URL];return this.objectFieldOptionsWithType(e,{includeFiltersOnly:!0,includeRecordTypeId:!0,includeParents:!1,validTypes:t})},_filterFieldOptions:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=t.includeFilterable,a=t.includeSortable,o=t.includeFormula,r=t.includeRecordTypeId,n=t.includeFiltersOnly,l=void 0!==n&&n,c=t.validTypes,n=t.includeParents,u=void 0!==n&&n;return e.filter(function(e){var t,n,i;return!(!r||"RecordTypeId"!==e.value)||(e.isParent?u:e.filtersOnly?l:(t=n2.isUndefined(s)||e.filterable===s,n=n2.isUndefined(a)||e.sortable===a,i=n2.isUndefined(o)||e.isFormula===o,e=n2.isUndefined(c)||c.includes(e.type.toUpperCase()),t&&n&&i&&e))})}},n2.de.data.FieldType={BOOLEAN:"BOOLEAN",COMBOBOX:"COMBOBOX",CURRENCY:"CURRENCY",DATE:"DATE",DATETIME:"DATETIME",DOUBLE:"DOUBLE",EMAIL:"EMAIL",ENCRYPTEDSTRING:"ENCRYPTEDSTRING",ID:"ID",INTEGER:"INTEGER",LONG:"LONG",MULTIPICKLIST:"MULTIPICKLIST",PHONE:"PHONE",PICKLIST:"PICKLIST",REFERENCE:"REFERENCE",STRING:"STRING",TEXTAREA:"TEXTAREA",URL:"URL"},n2.de.data.PeriodOptions={_PERIOD_OPTIONS:[{label:"Half hourly",value:"Half hourly"},{label:"Hourly",value:"Hourly"},{label:"Daily",value:"Daily"},{label:"Weekly",value:"Weekly"},{label:"Monthly",value:"Monthly"},{label:"Active cap",value:"Load balanced"},{label:"Criteria Based",value:"Criteria based"}],_addOptionIfMissing:function(e,t,n){e.find(function(e){return e.value===t})||e.push({label:this.getPeriodLabel(this.cappingPeriodFromKey(t),{teamHasActiveStatus:!n}),value:t})},get:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.useTotalLabel,i=void 0!==n&&n,n=e.extraPeriods,n=void 0===n?null:n,s=e.includePeriodKey,s=void 0===s?null:s,a=e.isTeamLevelCaps,o=void 0!==a&&a,a=e.distributorType,r=void 0===a?null:a,l=this._PERIOD_OPTIONS.filter(function(e){return(!o||"Criteria based"!==e.value)&&(r!==n2.de.enum.distributor.Type.TRIGGER||"Load balanced"!==e.value&&"Criteria based"!==e.value)}).map(function(e){return"Load balanced"===e.value&&(e.label=i?"Total cap":"Active cap"),e});return n2.isEmpty(s)||this._addOptionIfMissing(l,s,i),n2.isEmpty(n)||n2.forEach(n,function(e){return t._addOptionIfMissing(l,n2.de.data.PeriodOptions.cappingPeriodToKey(e),i)}),l},cappingPeriodToKey:function(e){return n2.isEmpty(e)||n2.isEmpty(e.period)?"":n2.isUndefined(e.rolling)||n2.isUndefined(e.length)||!e.rolling&&1===e.length?e.period:e.length.toString()+" "+e.period},cappingPeriodFromKey:function(e){if(n2.isEmpty(e))return{period:"",length:1,rolling:!1};if(!isNaN(e.substring(0,1))){var t=_toArray(e.split(" ")),n=t[0],t=t.slice(1);if(!isNaN(n)&&!n2.isEmpty(t))return{period:t.join(" "),length:parseInt(n),rolling:!0}}return{period:e,length:1,rolling:!1}},getPeriodLabel:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.teamHasActiveStatus,n=void 0!==n&&n,t=t.useShortNames,t=void 0!==t&&t,i=this.getNormalizedCapPeriodType(e);if(n2.isEmpty(i))return"";if("load balanced"===i)return n=n?"Active":"Total",t?n:n+" cap";if("criteria based"===i)return"Criteria Based";if(e.rolling){if("hourly"===i)return 1===e.length?"Hourly (rolling)":"Every "+e.length+" hours (rolling)";if("half hourly"===i){if(1===e.length)return"Half hourly (rolling)"}else{if("by minute"===i)return"Every "+e.length+" minutes (rolling)";if("daily"===i)return 1===e.length?"Daily":"Every "+e.length+" days"}}return e.period},getNormalizedCapPeriodType:function(e){return n2.isEmpty(e)||n2.isEmpty(e.period)?null:e.period.toLowerCase()}},n2.de.enum.Date={DAYS:{1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"]},n2.de.enum.Error={DE1:"[DE-1]",INVALID_TEAM_ID:"[DE-1] Team",INVALID_TEAM_MEMBER_ID:"[DE-1] Team member",INVALID_DISTRIBUTOR_ID:"[DE-1] Distributor",INVALID_DISTRIBUTION_HOURS:"[DE-1] Distribution hours",INVALID_TAG_COLLECTION_ID:"[DE-1] Tag collection",DE2:"[DE-2]"},n2.de.enum.Icon={HOME:{sprite:"utility",icon:"home"},GROUPS:{sprite:"utility",icon:"groups"},QUOTE:{sprite:"utility",icon:"quote"},PROCESS:{sprite:"utility",icon:"process"},DATE_TIME:{sprite:"utility",icon:"date_time"},RESOURCE_CAPACITY:{sprite:"utility",icon:"resource_capacity"},NOTIFICATION:{sprite:"utility",icon:"notification"},NOTE:{sprite:"utility",icon:"note"},CANCEL_TRANSFER:{sprite:"utility",icon:"cancel_transfer"},TEXT_TEMPLATE:{sprite:"utility",icon:"text_template"},METRICS:{sprite:"utility",icon:"metrics"},ARCHIVE:{sprite:"utility",icon:"archive"},SETTINGS:{sprite:"utility",icon:"settings"},HELP:{sprite:"utility",icon:"question"},WARNING:{sprite:"utility",icon:"warning"},SUCCESS:{sprite:"utility",icon:"success"},IDENTITY:{sprite:"utility",icon:"identity"},CHEVRON_LEFT:{sprite:"utility",icon:"chevronleft"},CHEVRON_RIGHT:{sprite:"utility",icon:"chevronright"},GRAPH:{sprite:"utility",icon:"graph"},USER:{sprite:"utility",icon:"user"},PRODUCT_TRANSFER:{sprite:"utility",icon:"product_transfer"},PEOPLE:{sprite:"utility",icon:"people"},DISTRIBUTION:{sprite:"utility",icon:"rules"},TERRITORIES:{sprite:"utility",icon:"location"},OBJECT_SYNC:{sprite:"utility",icon:"note"},AUTO_CONVERSION:{sprite:"utility",icon:"data_mapping"},LEAD_MATCHING:{sprite:"utility",icon:"merge"},SCHEDULER:{sprite:"utility",icon:"clock"},TALENT_DEVELOPMENT:{sprite:"utility",icon:"talent_development"},SURVEY:{sprite:"utility",icon:"survey"},APPLICATION_MONITORING:{sprite:"utility",icon:"feed"},SOURCES:{sprite:"utility",icon:"download"},MONTHLY_VIEW:{sprite:"utility",icon:"monthlyview"},WAITS:{sprite:"utility",icon:"waits"},CHART:{sprite:"utility",icon:"chart"},DATE_INPUT:{sprite:"utility",icon:"date_input"},SWITCH:{sprite:"utility",icon:"switch"},KEY_DATES:{sprite:"utility",icon:"key_dates"},SYNC:{sprite:"utility",icon:"sync"},LOCK:{sprite:"utility",icon:"lock"},FILTER:{sprite:"standard",icon:"filter"},AVATAR:{sprite:"standard",icon:"avatar"}},n2.de.event.EventType={SHOW:"show"},n2.de.icon.CurrentOwner='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="matrix(.461538 0 0 .461538 0 0)"><path d="M35.6 39.5c-.7-4.1-4.9-6.2-8.3-7.7 -1.5-.7-3.6-1.5-4.2-3.3 -.4-1-.2-2 .3-2.9 .9-.9 1.7-1.7 2.4-2.8 .2-.3.3-.5.5-.8 2-2.9 2.3-6.9 1.1-10.2 -1.2-3.6-4.4-6-8.3-6.1h-.6c-3.9.1-7.1 2.5-8.3 6.1 -1.2 3.4-.9 7.3 1.1 10.2 .1.3.3.5.5.8 .7 1.1 1.6 1.9 2.4 2.8 .4.9.6 1.9.3 2.9 -.6 1.8-2.7 2.6-4.2 3.3 -3.4 1.5-7.6 3.6-8.3 7.7 -.7 3.4 1.6 6.8 5.2 6.8h23.6c3.2 0 5.5-3.4 4.8-6.8Zm5.7-29.6c4.1-.2 7.4 3 7.4 7.1 0 .3-.2.4-.4.4h-1.8c-.3 0-.4-.1-.4-.4v.1c0-2.4-1.8-4.4-4.1-4.6 -2.6-.2-4.7 1.9-4.7 4.4 0 .3-.2.4-.4.4h-1.8c-.2 0-.4-.2-.4-.4 0-3.6 2.9-6.8 6.6-7Zm7.4 9.3h-14.1c-1 0-1.8.8-1.8 1.8v8.4c0 1 .8 1.8 1.8 1.8h14.1c1 0 1.8-.8 1.8-1.8v-8.4c0-1-.8-1.8-1.8-1.8Zm-5 8.7c.1.3-.1.6-.4.6h-3.3c-.3 0-.5-.3-.4-.6l.8-2.6c-.7-.4-1.1-1.2-.9-2.1 .2-.8.8-1.5 1.7-1.7 1.4-.3 2.6.7 2.6 2.1 0 .7-.4 1.4-.9 1.7l.8 2.6Z"></path></g></svg>',n2.de.icon.DynamicOwner='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M27.3 37.6c-3-1.2-3.5-2.3-3.5-3.5 0-1.2.8-2.3 1.8-3.2 1.8-1.5 2.6-3.9 2.6-6.4 0-4.7-2.9-8.5-8.3-8.5 -5.4 0-8.3 3.8-8.3 8.5 0 2.5.8 4.9 2.6 6.4 1 .9 1.8 2 1.8 3.2 0 1.2-.5 2.3-3.5 3.5 -4.4 1.8-8.6 3.8-8.7 7.6 .2 2.6 2.2 4.8 4.7 4.8h23c2.5 0 4.5-2.2 4.5-4.7 -.1-3.8-4.3-5.9-8.7-7.7Zm17.2-18.6c0-7.4-6.1-13.5-13.5-13.5v-3.5l-6.8 5.5c-.3.3-.2.8.1 1.1l6.7 5.4v-3.5c4.7 0 8.5 3.8 8.5 8.5h-3.5l5.5 6.8c.3.3.8.3 1.1 0l5.4-6.8h-3.5Z" transform="matrix(.461538 0 0 .461538 0 0)"></path></svg>',n2.de.icon.LoadBalancing='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M18.576 6.24l-5.856.864v8.256c0 .144-.096.24-.24.24h-.96c-.144 0-.24-.096-.24-.24v-8.04l-5.664.84h-.096c-.36 0-.672-.264-.72-.624 -.048-.384.216-.768.6-.816l4.464-.672c.408-.744 1.2-1.272 2.112-1.272 .672 0 1.248.264 1.68.696l4.728-.672c.384-.048.768.216.816.6 .048.408-.216.768-.624.84Zm-8.664 8.856c.168-.216.216-.48.096-.744l-1.92-4.56c-.096-.264-.36-.432-.648-.432 -.288 0-.552.168-.672.432l-1.92 4.56c-.096.216-.072.456.048.672 .048.072.984 1.512 2.496 1.512 .888 0 1.752-.48 2.52-1.44Zm-2.472-3.168l1.032 2.472h-2.064Zm9.792-3.576c-.12-.263-.383-.432-.672-.432 -.289 0-.552.169-.672.432l-1.92 4.56c-.096.216-.072.456.048.672 .048.072.984 1.512 2.496 1.512 .888 0 1.728-.48 2.52-1.44 .168-.216.216-.48.096-.744Zm-.672 2.136l1.032 2.472h-2.064Zm-4.56 6.552c-1.344 0-2.712.48-3.672 1.296 -.096.096-.168.216-.168.36v.024c0 .264.216.48.48.48h6.72c.264 0 .48-.216.48-.48v-.024c0-.144-.048-.264-.168-.36 -.96-.816-2.328-1.296-3.672-1.296Z"></path></svg>',n2.de.icon.LookupOwner='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M17.2 11.6h17.6c.9 0 1.6-.7 1.6-1.6v-3.2c0-2.6-2.2-4.8-4.8-4.8h-11.2c-2.6 0-4.8 2.2-4.8 4.8v3.2c0 .9.7 1.6 1.6 1.6Zm26.4-5.6h-1.6c-.5 0-.8.3-.8.8v3.2c0 3.5-2.9 6.4-6.4 6.4h-17.6c-3.5 0-6.4-2.9-6.4-6.4v-3.2c0-.5-.3-.8-.8-.8h-1.6c-2.6 0-4.8 2.2-4.8 4.8v34.4c0 2.6 2.2 4.8 4.8 4.8h35.2c2.6 0 4.8-2.2 4.8-4.8v-34.4c0-2.6-2.2-4.8-4.8-4.8Zm-6.1 38.1l-1 1c-.3.3-.7.3-1 0l-6.5-6.5c-1.9 1.3-4.2 2-6.7 1.6 -4.2-.6-7.5-4.1-7.9-8.3 -.6-5.8 4.3-10.7 10.1-10.1 4.3.4 7.7 3.7 8.3 7.9 .4 2.5-.3 4.9-1.6 6.7l6.5 6.5c.1.4.1.8-.2 1.2Zm-14-19.3c-3.5 0-6.3 2.9-6.3 6.3 0 3.5 2.8 6.3 6.3 6.3 3.5 0 6.3-2.8 6.3-6.3 0-3.5-2.8-6.3-6.3-6.3Z" transform="matrix(.461538 0 0 .461538 0 0)"></path></svg>',n2.de.icon.ManualAssignment='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="m27.3 37.6c-3-1.2-3.5-2.3-3.5-3.5 0-1.2 0.8-2.3 1.8-3.2 1.8-1.5 2.6-3.9 2.6-6.4 0-4.7-2.9-8.5-8.3-8.5s-8.3 3.8-8.3 8.5c0 2.5 0.8 4.9 2.6 6.4 1 0.9 1.8 2 1.8 3.2 0 1.2-0.5 2.3-3.5 3.5-4.4 1.8-8.6 3.8-8.7 7.6 0.2 2.6 2.2 4.8 4.7 4.8h23c2.5 0 4.5-2.2 4.5-4.7-0.1-3.8-4.3-5.9-8.7-7.7z m17.2-18.6c0-7.4-6.1-13.5-13.5-13.5v-3.5l-6.8 5.5c-0.3 0.3-0.2 0.8 0.1 1.1l6.7 5.4v-3.5c4.7 0 8.5 3.8 8.5 8.5h-3.5l5.5 6.8c0.3 0.3 0.8 0.3 1.1 0l5.4-6.8h-3.5z" transform="matrix(.461538 0 0 .461538 0 0)"></path></svg>',n2.de.icon.PullDistributor='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M23 27.2h.4c.2-2.7 1.2-5.1 2.7-7 -.8-.8-1.8-1.3-3.1-1.3 -2.4 0-4.2 1.8-4.2 4.2 0 2.3 1.8 4.1 4.2 4.1Zm1.2 8c.5 0 1-.1 1.2-.1 -.8-1.3-1.4-2.7-1.7-4h-.7c-4.5 0-8.4-3.6-8.4-8.4 0-4.5 3.6-8.4 8.4-8.4 2.5 0 4.9 1.1 6.4 2.9 1.2-.7 2.5-1.1 3.9-1.3 -2.3-3.3-6.1-5.4-10.4-5.4 -7.2 0-12.6 5.7-12.6 12.6 0 6.9 5.7 12.6 12.9 12.3 .4-.1.7-.1 1-.2Zm25.7 10.3v1.4c0 1.6-1.4 3-3 3h-24.1c-1.6 0-3-1.4-3-3v-1.4c0-3.6 4.3-5.9 8.3-7.7l.4-.2c.3-.1.6-.1.9.1 1.6 1.1 3.5 1.6 5.4 1.6 1.9 0 3.8-.6 5.4-1.6 .3-.2.6-.2.9-.1l.4.2c4.2 1.8 8.4 4 8.4 7.7Zm-15.1-25.7c4.2 0 7.5 3.7 7.5 8.3 0 4.6-3.3 8.3-7.5 8.3 -4.2 0-7.5-3.7-7.5-8.3 0-4.6 3.4-8.3 7.5-8.3Zm-16.3 19.4c-6.9-2-12.2-8.5-12.2-16.1 0-9.3 7.5-16.8 16.8-16.8 6.9 0 13.1 4.1 15.6 10.2 2 .8 3.8 2.1 5.1 3.8 -1.5-10.5-10.2-18.2-20.8-18.2 -11.7 0-20.9 9.2-20.9 20.9 0 9.2 5.8 17 14.2 19.7 .4-1.4 1.2-2.5 2.2-3.5Z" transform="matrix(.461538 0 0 .461538 0 0)"></path></svg>',n2.de.icon.RelatedOwner='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M72.8 54.7v-.4c0-9-5.3-16.8-12.9-20.6v-.9c0-5.5-4.5-10-10-10 -5.5 0-10 4.5-10 10v.9c-7.6 3.7-12.9 11.6-12.9 20.6v.4c-4.1 1.2-7.2 5-7.2 9.6 0 5.5 4.5 10 10 10 2.2 0 4.3-.7 6-2 3.9 3 8.8 4.9 14 4.9 5.2 0 10.1-1.8 14-4.9 1.7 1.2 3.7 2 6 2 5.5 0 10-4.5 10-10 .2-4.5-2.8-8.4-7-9.6Zm-33.9 14.1c.7-1.4 1.1-2.9 1.1-4.5 0-4.9-3.6-9-8.3-9.8v-.2c0-7 4-13.1 9.8-16.2 1.8 2.8 4.9 4.7 8.5 4.7 3.6 0 6.7-1.9 8.5-4.7 5.8 3.1 9.8 9.2 9.8 16.2v.2c-4.7.8-8.3 4.9-8.3 9.8 0 1.6.4 3.1 1.1 4.5 -3.1 2.4-6.9 3.8-11.1 3.8 -4.2 0-8-1.5-11.1-3.8Z" transform="matrix(.24 0 0 .24 0 0)"></path></svg>',n2.de.icon.RoundRobin='<svg class="slds-icon" version="1.1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M48.5 2h-3c-.8 0-1.5.7-1.5 1.5v7c0 .9-1 1.5-1.6.8 -4.7-5.2-11.4-7.9-18.7-7.2 -2.6.2-5.1 1-7.4 2.2 -1.2.6-2.4 1.3-3.4 2.1 -.7.5-.8 1.6-.2 2.3l2.1 2.1c.5.5 1.3.6 1.9.2 1.2-.8 2.5-1.5 3.9-2.1 .6-.2 1.3-.4 2-.6 6.3-1.2 12.3 1.3 15.7 5.4 1.2 1.4.3 2.3-.7 2.3h-7c-.8 0-1.6.7-1.6 1.5v3c0 .8.8 1.5 1.6 1.5h18.2c.7 0 1.2-.6 1.2-1.3v-19.2c0-.8-.7-1.5-1.5-1.5Zm-9.1 35.4c-.6-.6-1.5-.6-2.1 0 -1.6 1.6-3.6 2.9-5.8 3.7 -.6.2-1.3.4-2 .6 -6.3 1.2-12.3-1.3-15.7-5.4 -1.2-1.4-.3-2.3.7-2.3h7c.8 0 1.5-.7 1.5-1.5v-3c0-.8-.7-1.5-1.5-1.5h-18.2c-.7 0-1.3.6-1.3 1.3v19.2c0 .8.7 1.5 1.5 1.5h3c.8 0 1.5-.7 1.5-1.5v-7c0-.9 1-1.5 1.6-.8 4.6 5.2 11.4 7.9 18.7 7.2 2.6-.2 5.1-1 7.4-2.2 2.2-1.1 4.1-2.5 5.7-4.1 .6-.6.6-1.6 0-2.1l-2-2.1Z" transform="matrix(.461538 0 0 .461538 0 0)"></path></svg>',n2.de.illustration.Desert=n2.stripIndent('<svg class="slds-illustration__svg" viewBox="0 0 468 194" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-67.000000, -112.000000)">\n            <g>\n                <g transform="translate(245.000000, 200.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n                    <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n                    <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>\n                    <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>\n                    <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>\n                </g>\n                <g transform="translate(135.000000, 152.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n                    <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n                    <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>\n                    <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>\n                    <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>\n                </g>\n                <g transform="translate(69.000000, 256.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n                    <path vector-effect="non-scaling-stroke" d="M14,36.5 L464,36.5"></path>\n                    <path vector-effect="non-scaling-stroke" d="M0,36.5 L6,36.5"></path>\n                    <polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="234.5 36 279.5 0 313.5 26"></polyline>\n                    <path vector-effect="non-scaling-stroke" d="M279.5,1 L279.5,35" stroke-linejoin="round"></path>\n                    <path vector-effect="non-scaling-stroke" d="M313.5,11 C313.5,20.7437888 313.5,25.7437888 313.5,26 C313.5,25.7437888 313.5,20.7437888 313.5,11 Z" stroke-linejoin="round"></path>\n                    <polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="303.5 17 313.5 9 347.5 36"></polyline>\n                </g>\n                <g transform="translate(113.000000, 178.000000)">\n                    <g transform="translate(30.000000, 8.000000)" class="slds-illustration__fill-secondary">\n                        <path vector-effect="non-scaling-stroke" d="M29.5,60.5 L29.5,12 C29.5,5.372583 34.872583,0 41.5,0 C48.127417,0 53.5,5.372583 53.5,12 L53.5,40.5 L70.5,40.5 L70.5,27 C70.5,23.1340068 73.6340068,20 77.5,20 C81.3659932,20 84.5,23.1340068 84.5,27 L84.5,48.5 C84.5,51.8137085 81.8137085,54.5 78.5,54.5 L53.5,54.5 L53.5,118.5 L29.5,118.5 L29.5,74.5 L6.5,74.5 C3.1862915,74.5 0.5,71.8137085 0.5,68.5 L0.5,39 C0.5,35.1340068 3.63400675,32 7.5,32 C11.3659932,32 14.5,35.1340068 14.5,39 L14.5,60.5 L29.5,60.5 Z"></path>\n                    </g>\n                    <g transform="translate(59.000000, 7.000000)" fill="#FFFFFF">\n                        <path vector-effect="non-scaling-stroke" d="M2,11 C3.65332031,8.49145508 5.65181478,6.77364095 7.9954834,5.84655762 C11.5109863,4.45593262 15.2684326,4.95605469 17.8156738,6.2824707 C20.362915,7.60888672 22.3626709,9.64978027 23.2602539,11.81604 C23.8586426,13.2602132 23.8586426,11.7547201 23.2602539,7.29956055 L19.612793,3.56494141 L13.7923584,0.564331055 L8.765625,1.42663574 L4.67321777,3.19787598 C2.69893392,5.13902708 1.69559733,6.16722532 1.66320801,6.2824707 C1.61462402,6.45533878 0.856079102,9.49145508 0.813964844,9.66003418 C0.785888672,9.77242025 1.18123372,10.2190755 2,11 Z"></path>\n                    </g>\n                    <g class="slds-illustration__stroke-primary" stroke-width="3">\n                        <path vector-effect="non-scaling-stroke" d="M0,126.5 L356,126.5" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M362.5,126.5 L372.013149,126.5" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M107.5,20 L107.5,28" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M113,30.6568542 L118.656854,25" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M37.5,32 L37.5,40" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M44,42.6568542 L49.6568542,37" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M25,42.6568542 L30.6568542,37" stroke-linecap="round" transform="translate(27.828427, 39.828427) scale(-1, 1) translate(-27.828427, -39.828427) "></path>\n                        <path vector-effect="non-scaling-stroke" d="M71.5,0 L71.5,8" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M79,10.6568542 L84.6568542,5" stroke-linecap="round"></path>\n                        <path vector-effect="non-scaling-stroke" d="M58,10.6568542 L63.6568542,5" stroke-linecap="round" transform="translate(60.828427, 7.828427) scale(-1, 1) translate(-60.828427, -7.828427) "></path>\n                        <path vector-effect="non-scaling-stroke" d="M59.5,68.5 L59.5,20 C59.5,13.372583 64.872583,8 71.5,8 C78.127417,8 83.5,13.372583 83.5,20 L83.5,48.5 L100.5,48.5 L100.5,35 C100.5,31.1340068 103.634007,28 107.5,28 C111.365993,28 114.5,31.1340068 114.5,35 L114.5,56.5 C114.5,59.8137085 111.813708,62.5 108.5,62.5 L83.5,62.5 L83.5,126.5 L59.5,126.5 L59.5,82.5 L36.5,82.5 C33.1862915,82.5 30.5,79.8137085 30.5,76.5 L30.5,47 C30.5,43.1340068 33.6340068,40 37.5,40 C41.3659932,40 44.5,43.1340068 44.5,47 L44.5,68.5 L59.5,68.5 Z"></path>\n                        <path vector-effect="non-scaling-stroke" d="M77,88.5 L92.5,88.5 L92.5,81 C92.5,77.1340068 95.6340068,74 99.5,74 L99.5,74 C103.365993,74 106.5,77.1340068 106.5,81 L106.5,96.5 C106.5,99.8137085 103.813708,102.5 100.5,102.5 L77,102.5"\n                        class="slds-illustration__fill-secondary" stroke-linecap="round" stroke-linejoin="round"></path>\n                    </g>\n                </g>\n                <g transform="translate(429.000000, 242.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n                    <g>\n                        <path vector-effect="non-scaling-stroke" d="M12.5,4 L12.5,50"></path>\n                        <polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="11 18.5 0.5 18.5 0.5 0"></polyline>\n                        <polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="14 25.5 24.5 25.5 24.5 8"></polyline>\n                        <polyline vector-effect="non-scaling-stroke" stroke-linejoin="round" points="2.5 31 2.5 38.5 11 38.5"></polyline>\n                    </g>\n                </g>\n                <g transform="translate(327.000000, 95.000000)">\n                    <g>\n                        <circle vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" cx="64" cy="64" r="23"></circle>\n                        <circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="135,1,1,18" transform="translate(64.000000, 64.000000) rotate(230.000000) translate(-64.000000, -64.000000) "\n                        cx="64" cy="64" r="45"></circle>\n                        <circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="107,10" transform="translate(64.000000, 64.000000) rotate(150.000000) translate(-64.000000, -64.000000) "\n                        cx="64" cy="64" r="33"></circle>\n                    </g>\n                    <g transform="translate(41.000000, 41.000000)" class="slds-illustration__stroke-primary" stroke-width="3">\n                        <circle vector-effect="non-scaling-stroke" cx="23" cy="23" r="23"></circle>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>'),n2.de.illustration.NoTask=n2.stripIndent('<svg class="slds-illustration__svg" viewBox="0 0 454 182" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n      <g transform="translate(-73.000000, -110.000000)">\n        <g>\n          <g transform="translate(75.000000, 240.000000)">\n            <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" transform="translate(375.250000, 18.000000) scale(-1, 1) translate(-375.250000, -18.000000) "\n              points="335.5 36 380 0 415 27"></polyline>\n            <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" transform="translate(324.500000, 22.500000) scale(-1, 1) translate(-324.500000, -22.500000) "\n              points="303 18 313.5 9 346 36"></polyline>\n            <path vector-effect="non-scaling-stroke" d="M0,36.5 L450,36.5" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round"></path>\n            <path vector-effect="non-scaling-stroke" d="M406.04276,9.26543454 L413,32.7461193 L400.495829,23.8448556 L404.113561,9.30802252 C404.246938,8.772085 404.789525,8.44574518 405.325462,8.57912213 C405.669253,8.66468028 405.942114,8.9257539 406.04276,9.26543454 Z"\n              class="slds-illustration__fill-secondary"></path>\n            <path vector-effect="non-scaling-stroke" d="M311.962964,11.4391572 L318,33 L306.770218,23.1063642 L310.037036,11.4391572 C310.185948,10.9073269 310.7378,10.5969106 311.26963,10.7458231 C311.605963,10.8399963 311.868791,11.1028246 311.962964,11.4391572 Z"\n              class="slds-illustration__fill-secondary" transform="translate(312.385109, 21.626882) scale(-1, 1) translate(-312.385109, -21.626882) "></path>\n          </g>\n          <g transform="translate(83.000000, 173.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n            <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n            <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>\n            <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>\n            <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>\n          </g>\n          <g transform="translate(274.000000, 111.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n            <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n            <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>\n            <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>\n            <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>\n          </g>\n          <g transform="translate(115.000000, 191.000000)">\n            <g transform="translate(148.000000, 32.000000) scale(-1, 1) translate(-148.000000, -32.000000) translate(116.000000, 0.000000)" class="slds-illustration__fill-secondary">\n              <path vector-effect="non-scaling-stroke" d="M25,53 C25,55.76 22.76125,58 20,58 C17.24,58 15,55.76 15,53 C15,50.24 17.24,48 20,48 C22.76125,48 25,50.24 25,53 Z"></path>\n              <path vector-effect="non-scaling-stroke" d="M8,58 C6.34130214,58 5,59.344354 5,61 C5,62.655646 6.34130214,64 8,64 C9.65717192,64 11,62.655646 11,61 C11,59.344354 9.65717192,58 8,58"></path>\n              <path vector-effect="non-scaling-stroke" d="M43.2932416,0 C35.2856577,0 28.3128049,4.40586521 24.6382957,10.9184604 C22.0889739,9.11222859 18.9814709,8.03886643 15.6213524,8.03886643 C6.99160591,8.03886643 0,15.0367986 0,23.6690948 C0,32.302472 6.99160591,39.3004042 15.6213524,39.3004042 C15.8077805,39.3004042 15.9920023,39.2777047 16.1806367,39.2712191 C19.0013272,43.3344299 23.6918145,46 29.011083,46 C32.7848734,46 36.2475826,44.6596485 38.9469293,42.4296926 C40.3512074,42.7193815 41.8051261,42.8739543 43.2932416,42.8739543 C55.1275661,42.8739543 64,33.4569038 64,21.6185732 C64,9.77916158 55.1275661,0 43.2932416,0 Z"></path>\n            </g>\n            <g transform="translate(0.000000, 18.000000)">\n              <path vector-effect="non-scaling-stroke" d="M90.5057553,53.0538038 C90.5057553,53.0538038 116.215483,58.0701972 145.433002,58.0701972 C174.650521,58.0701972 204.505755,53.0538038 204.505755,53.0538038 C204.505755,53.0538038 192.222862,60.6378663 185.905056,63.0258453 C179.58725,65.4138243 166.637272,67.3671811 166.637272,67.3671811 C166.637272,67.3671811 153.865271,70.7987363 147.505755,70.9374424 C141.14624,71.0761485 132.54218,68.1108222 132.54218,68.1108222 L106.786672,63.0258453 L90.5057553,53.0538038 Z"\n                class="slds-illustration__fill-primary"></path>\n              <path vector-effect="non-scaling-stroke" d="M84.8198266,43.3368404 C84.8198266,43.3368404 99.4457512,70.425365 147.915957,70.425365 C196.386164,70.425365 214.819827,43.3368404 214.819827,43.3368404" class="slds-illustration__stroke-primary"\n                stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path>\n              <path vector-effect="non-scaling-stroke" d="M73,49.5 L88,49.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round"></path>\n              <path vector-effect="non-scaling-stroke" d="M211,49.5 L226,49.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round"></path>\n              <path vector-effect="non-scaling-stroke" d="M142.74548,0 L153.650377,2.22044605e-16 C154.478804,8.05656105e-16 155.150377,0.671572875 155.150377,1.5 L155.150377,2.98261094 C155.150377,3.11136765 155.100706,3.2351613 155.01171,3.32820944 L146.234757,12.5047677 L155.209827,12.5047677 C156.038254,12.5047677 156.709827,13.1763405 156.709827,14.0047677 L156.709827,14.4270108 C156.709827,15.2554379 156.038254,15.9270108 155.209827,15.9270108 L141.888626,15.9270108 C141.060199,15.9270108 140.388626,15.2554379 140.388626,14.4270108 L140.388626,12.8248256 C140.388626,12.696109 140.438265,12.5723507 140.527212,12.4793109 L149.20663,3.40051458 L142.74548,3.40051458 C141.917053,3.40051458 141.24548,2.7289417 141.24548,1.90051458 L141.24548,1.5 C141.24548,0.671572875 141.917053,1.52179594e-16 142.74548,0 Z"\n                class="slds-illustration__fill-primary"></path>\n              <path vector-effect="non-scaling-stroke" d="M20,81.5 L390,81.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round"></path>\n              <path vector-effect="non-scaling-stroke" d="M0,81.5 L12,81.5" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round"></path>\n            </g>\n          </g>\n          <g transform="translate(175.500000, 153.000000)">\n            <g transform="translate(0.000000, 7.000000)" class="slds-illustration__fill-secondary">\n              <path vector-effect="non-scaling-stroke" d="M19.3444016,2.17529966 L32.8957957,84.445825 C33.0753185,85.5357082 32.3373256,86.5647651 31.2474424,86.7442879 C31.1399954,86.7619863 31.0312825,86.7708798 30.9223876,86.7708798 L2.12566435,86.7708798 C1.02109485,86.7708798 0.125664347,85.8754493 0.125664347,84.7708798 C0.125664347,84.6486417 0.136870913,84.526661 0.159143349,84.4064691 L15.4044726,2.13594377 C15.6057311,1.04986421 16.6493247,0.332574998 17.7354043,0.533833473 C18.5639901,0.687376483 19.2074411,1.34381197 19.3444016,2.17529966 Z"></path>\n            </g>\n            <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3">\n              <polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="17 0.709590879 34 94.5 -1.82254212e-12 94.5"></polygon>\n              <path vector-effect="non-scaling-stroke" d="M17,8.09449405 C17,92.0999502 17,135.036706 17,136.904762 C17,135.036706 17,92.0999502 17,8.09449405 Z"></path>\n              <path vector-effect="non-scaling-stroke" d="M17,64.2334004 C24.3333333,71.7198767 28,75.6881307 28,76.1381623 C28,75.6881307 24.3333333,71.7198767 17,64.2334004 Z" stroke-linejoin="round" transform="translate(22.500000, 70.185781) scale(-1, 1) translate(-22.500000, -70.185781) "></path>\n              <path vector-effect="non-scaling-stroke" d="M8,50.2334004 C14,57.05321 17,60.6881307 17,61.1381623 C17,60.6881307 14,57.05321 8,50.2334004 Z" stroke-linejoin="round"></path>\n            </g>\n          </g>\n          <g transform="translate(307.500000, 135.000000)">\n            <g transform="translate(0.000000, 2.000000)" class="slds-illustration__fill-secondary">\n              <path vector-effect="non-scaling-stroke" d="M29.524032,0.669921875 L55.6419593,108.305728 C55.9024257,109.379148 55.2433964,110.460477 54.1699762,110.720943 C54.0155692,110.75841 53.8572476,110.777344 53.69836,110.777344 L2.40272523,110.777344 C1.29815573,110.777344 0.402725233,109.881913 0.402725233,108.777344 C0.402725233,108.601258 0.42597945,108.425943 0.471884777,108.255946 L29.524032,0.669921875 Z"></path>\n            </g>\n            <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3">\n              <polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="29 0 56.572466 112.5 0 112.5"></polygon>\n              <path vector-effect="non-scaling-stroke" d="M29,6.09449405 C29,103.433283 29,153.036706 29,154.904762 C29,153.036706 29,103.433283 29,6.09449405 Z"></path>\n              <path vector-effect="non-scaling-stroke" d="M29,74.2334004 C41,87.05321 47,93.6881307 47,94.1381623 C47,93.6881307 41,87.05321 29,74.2334004 Z" stroke-linejoin="round" transform="translate(38.000000, 84.185781) scale(-1, 1) translate(-38.000000, -84.185781) "></path>\n              <path vector-effect="non-scaling-stroke" d="M14,61.2334004 C24,72.7198767 29,78.6881307 29,79.1381623 C29,78.6881307 24,72.7198767 14,61.2334004 Z" stroke-linejoin="round"></path>\n              <path vector-effect="non-scaling-stroke" d="M29,48.2334004 C36.3333333,57.05321 40,61.6881307 40,62.1381623 C40,61.6881307 36.3333333,57.05321 29,48.2334004 Z" stroke-linejoin="round" transform="translate(34.500000, 55.185781) scale(-1, 1) translate(-34.500000, -55.185781) "></path>\n            </g>\n          </g>\n          <g transform="translate(347.500000, 166.000000)">\n            <g transform="translate(0.000000, 4.000000)" class="slds-illustration__fill-secondary">\n              <path vector-effect="non-scaling-stroke" d="M19.3444016,2.17529966 L32.8957957,84.445825 C33.0753185,85.5357082 32.3373256,86.5647651 31.2474424,86.7442879 C31.1399954,86.7619863 31.0312825,86.7708798 30.9223876,86.7708798 L2.12566435,86.7708798 C1.02109485,86.7708798 0.125664347,85.8754493 0.125664347,84.7708798 C0.125664347,84.6486417 0.136870913,84.526661 0.159143349,84.4064691 L15.4044726,2.13594377 C15.6057311,1.04986421 16.6493247,0.332574998 17.7354043,0.533833473 C18.5639901,0.687376483 19.2074411,1.34381197 19.3444016,2.17529966 Z"></path>\n            </g>\n            <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3">\n              <polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="17 0.709590879 34 91.5 -1.82254212e-12 91.5"></polygon>\n              <path vector-effect="non-scaling-stroke" d="M17,5.09449405 C17,83.0999502 17,123.036706 17,124.904762 C17,123.036706 17,83.0999502 17,5.09449405 Z"></path>\n              <path vector-effect="non-scaling-stroke" d="M17,61.2334004 C24.3333333,68.7198767 28,72.6881307 28,73.1381623 C28,72.6881307 24.3333333,68.7198767 17,61.2334004 Z" stroke-linejoin="round" transform="translate(22.500000, 67.185781) scale(-1, 1) translate(-22.500000, -67.185781) "></path>\n            </g>\n          </g>\n          <g transform="translate(392.000000, 184.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n            <g transform="translate(31.713442, 25.088326) rotate(-15.000000) translate(-31.713442, -25.088326) translate(4.713442, 6.588326)">\n              <path vector-effect="non-scaling-stroke" d="M31.0360707,3.43528591 C31.0360707,3.43528591 40.5802283,0.671893051 42.6488424,10.6908663" transform="translate(36.842457, 6.888440) rotate(41.000000) translate(-36.842457, -6.888440) "></path>\n              <path vector-effect="non-scaling-stroke" d="M40.4282002,10.1797377 C40.4282002,10.1797377 49.9723578,7.4163448 52.0409719,17.435318" transform="translate(46.234586, 13.632892) scale(-1, 1) rotate(-41.000000) translate(-46.234586, -13.632892) "></path>\n              <path vector-effect="non-scaling-stroke" d="M0.730284783,29.5865514 C0.730284783,29.5865514 10.2744424,26.8231586 12.3430565,36.8421318"></path>\n              <path vector-effect="non-scaling-stroke" d="M12.7302848,29.5865514 C12.7302848,29.5865514 22.2744424,26.8231586 24.3430565,36.8421318" transform="translate(18.536671, 33.039705) scale(-1, 1) translate(-18.536671, -33.039705) "></path>\n            </g>\n          </g>\n        </g>\n      </g>\n    </g>\n  </svg>'),n2.de.illustration.OpenRoad=n2.stripIndent('<svg class="slds-illustration__svg" viewBox="0 0 454 272" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g fill="none" fill-rule="evenodd" transform="translate(-65 -74)">\n    <g transform="translate(77 180)">\n        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" points="21 74 111.5 0 177.5 54"></polyline>\n        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" points="160 37 181.5 19 249 74"></polyline>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M5.83623454,54.8238008 C6.47896445,52.7119739 7.52041887,52.7099477 8.16376546,54.8238008 L14,74 L0,74 L5.83623454,54.8238008 Z"></path>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M14.9699006 61.8628727C15.5388088 59.729467 16.4627585 59.7353443 17.0300994 61.8628727L20 73 12 73 14.9699006 61.8628727zM239.734375 56.5589921C240.43336 54.4620359 241.506942 54.4857215 242.128332 56.5984458L246 69.7621171 237 64.7621171 239.734375 56.5589921z"></path>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M247.921591,53.8514618 C248.51718,51.7243582 249.484912,51.7318303 250.077772,53.8491859 L254.357732,69.1347569 L242,75 L247.921591,53.8514618 Z" transform="matrix(-1 0 0 1 496.358 0)"></path>\n    </g>\n    <g transform="matrix(-1 0 0 1 496 216)">\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M5.9215907,18.8514618 C6.51717971,16.7243582 7.48113835,16.7183512 8.0784093,18.8514618 L14,40 L0,40 L5.9215907,18.8514618 Z" transform="matrix(-1 0 0 1 14 0)"></path>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M123.136984,25.2363093 C123.613615,23.448945 124.38595,23.4473111 124.863437,25.237887 L126.693756,32.1015868 L120,37 L123.136984,25.2363093 Z" transform="matrix(-1 0 0 1 246.694 0)"></path>\n        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" points="13 37 59.5 0 92.5 27"></polyline>\n        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" points="83 17 92.5 9 127 38"></polyline>\n    </g>\n    <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3" transform="translate(67 253)">\n        <path vector-effect="non-scaling-stroke" d="M0 1.5L450 1.5M284 2L419 61M282 2L65 91M443 1.5L449 1.5"></path>\n    </g>\n    <g transform="translate(73 163)">\n        <polygon vector-effect="non-scaling-stroke" fill="#FFF" points="20.906 .73 24.63 2.34 27.093 9.155 11.046 19.877 .131 19.877" transform="translate(80 22)"></polygon>\n        <g class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">\n        <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n        <path vector-effect="non-scaling-stroke" d="M83 20.5C84.0558268 16.8461914 86.2227376 14.4572754 89.5007324 13.333252 94.4177246 11.6472168 99.0800781 13.8925781 100.942383 16.1518555 102.804687 18.4111328 103.39502 20.2260742 103.746582 22.1201172 103.980957 23.3828125 104.06543 24.8427734 104 26.5 108.141764 26.3313802 110.918945 27.1647135 112.331543 29 114.040039 31.1936035 114.215332 33.817627 113.593018 35.75 112.970703 37.682373 110.894531 40.5 107 40.5L28 40.5M18 27.5L83.0004985 27.5M0 27.5L8 27.5"></path>\n        </g>\n    </g>\n    <g class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3" transform="translate(292 139)">\n        <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>\n        <path vector-effect="non-scaling-stroke" d="M83 20.5C84.0558268 16.8461914 86.2227376 14.4572754 89.5007324 13.333252 94.4177246 11.6472168 99.0800781 13.8925781 100.942383 16.1518555 102.804687 18.4111328 103.39502 20.2260742 103.746582 22.1201172 103.980957 23.3828125 104.06543 24.8427734 104 26.5 108.141764 26.3313802 110.918945 27.1647135 112.331543 29 114.040039 31.1936035 114.215332 33.817627 113.593018 35.75 112.970703 37.682373 110.894531 40.5 107 40.5L28 40.5M18 27.5L83.0004985 27.5M0 27.5L8 27.5"></path>\n    </g>\n    <g transform="translate(204.5 228.5)">\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"></path>\n        <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">\n        <polygon points="17 .324 34 54 0 54"></polygon>\n        <path vector-effect="non-scaling-stroke" d="M17,6.32394366 C17,42.1378022 17,60.4711356 17,61.3239437 C17,60.4711356 17,42.1378022 17,6.32394366 Z"></path>\n        <path vector-effect="non-scaling-stroke" d="M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z" transform="matrix(-1 0 0 1 42 0)"></path>\n        </g>\n    </g>\n    <g transform="translate(439.5 227.5)">\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"></path>\n        <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">\n        <polygon vector-effect="non-scaling-stroke" points="17 -4.676 34 54 0 54"></polygon>\n        <path vector-effect="non-scaling-stroke" d="M17,1.32394366 C17,40.3936076 17,60.3936076 17,61.3239437 C17,60.3936076 17,40.3936076 17,1.32394366 Z"></path>\n        <path vector-effect="non-scaling-stroke" d="M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z" transform="matrix(-1 0 0 1 42 0)"></path>\n        </g>\n    </g>\n    <g transform="translate(141.852 213.5)">\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__fill-secondary" d="M25.6478873,0 L50.8997802,86.4391718 C51.2095171,87.4994249 50.6011034,88.6100213 49.5408502,88.9197582 C49.3586621,88.9729817 49.1698252,89 48.980022,89 L2.31575269,89 C1.21118319,89 0.315752686,88.1045695 0.315752686,87 C0.315752686,86.8101968 0.342770948,86.6213599 0.395994453,86.4391718 L25.6478873,0 Z"\n        transform="translate(1)"></path>\n        <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" transform="translate(0 2)">\n        <polygon vector-effect="non-scaling-stroke" points="26.648 0 52.648 87 .648 87"></polygon>\n        <path vector-effect="non-scaling-stroke" d="M26.6478873 6C26.6478873 64.4972948 26.6478873 94.4972948 26.6478873 96 26.6478873 94.4972948 26.6478873 64.4972948 26.6478873 6zM15.6478873 42C22.9812207 49.078692 26.6478873 52.7453587 26.6478873 53 26.6478873 52.7453587 22.9812207 49.078692 15.6478873 42zM27.6478873 68C36.9812207 57.078692 41.6478873 51.7453587 41.6478873 52 41.6478873 51.7453587 36.9812207 57.078692 27.6478873 68z"></path>\n        </g>\n    </g>\n    <g transform="translate(168 57)">\n        <circle vector-effect="non-scaling-stroke" cx="64" cy="64" r="23" class="slds-illustration__fill-secondary"></circle>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-dasharray="135 1 1 18" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M64,109 C88.8528137,109 109,88.8528137 109,64 C109,39.1471863 88.8528137,19 64,19 C39.1471863,19 19,39.1471863 19,64 C19,88.8528137 39.1471863,109 64,109 Z"\n        transform="rotate(-130 64 64)"></path>\n        <path vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-dasharray="107 10" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M64,97 C82.2253967,97 97,82.2253967 97,64 C97,45.7746033 82.2253967,31 64,31 C45.7746033,31 31,45.7746033 31,64 C31,82.2253967 45.7746033,97 64,97 Z"\n        transform="rotate(150 64 64)"></path>\n        <g class="slds-illustration__stroke-primary" stroke-width="3" transform="translate(41 41)">\n        <circle vector-effect="non-scaling-stroke" cx="23" cy="23" r="23"></circle>\n        </g>\n    </g>\n    </g>\n</svg>'),n2.de.mixins.LimitLoads={_limitLoadsReject:null,_limitLoads:function(a,e){var o=this,r=e.params,l=e.requestId,t=e.force,c=void 0===t||t,t=e.silent,u=void 0===t||t;if(this._isDataDriven())return this._limitLoadsReject&&this._limitLoadsReject(),new Promise(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n2.DataProviderManager.getInstance().get(a),o._limitLoadsReject=n,o._onLimitedLoading(i),e.next=4,i.get({params:r,force:c,silent:u,requestId:l});case 4:return s=e.sent,e.abrupt("return",(o._limitLoadsReject=null,t({model:s,dataProvider:i})));case 6:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}()).then(function(e){var t=e.model,e=e.dataProvider;return o._onLoaded(t,e),t}).catch(function(){o._limitLoadsReject=null});throw new Error("This object needs to be data driven to use the limitLoads mixin")},_onLimitedLoading:function(e){}},n2.de.page.Analytics=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t)}(),n2.de.page.Availability=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._activeNavigationId=null,this._pageContext=n2.de.page.availability.Context.getInstance()}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isUser||this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var e=this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:[{id:"availability-section",heading:{text:"Availability",hidden:!0},links:[{id:"out-of-office",label:"Out of office",icon:n2.de.enum.Icon.GRAPH},{id:"regional-holidays",label:"Regional Holidays",icon:n2.de.enum.Icon.DATE_TIME},{id:"shifts",label:"Shifts",icon:n2.de.enum.Icon.IDENTITY}]}],listeners:{click:this._onNavigationClick,scope:this}}));return e.activeLink=e.components["availability-section"].components[this._activeNavigationId],e}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id)}},{key:"_navigateToPage",value:function(e){switch(e){case"regional-holidays":n2.de.page.Navigation.getInstance().open("Availability_Holidays");break;case"out-of-office":n2.de.page.Navigation.getInstance().open("Availability_OutOfOffice");break;case"shifts":n2.de.page.Navigation.getInstance().open("Availability_Shifts")}}}]),t}(),n2.de.page.Classifier=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-classifier",this._cls="n2_full-width",this._navigationGroups=null,this._actionMap=null}},{key:"navigationGroups",set:function(e){this._navigationGroups=e,this._refresh({navigation:!0})}},{key:"verticalNavigation",get:function(){return this._components["vertical-navigation"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){return this._actionMap={},this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",cls:"n2_classifier-navigation-style",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:this._prepareNavigationSections(),listeners:{click:this._onNavigationClick,scope:this}}))}},{key:"_prepareNavigationSections",value:function(){var t=this;return this._navigationGroups.map(function(e){return{heading:e.heading,links:e.items.map(function(e){return t._actionMap[e.itemId]=e.action,{id:e.itemId,label:e.label,active:e.selected}})}})}},{key:"_onNavigationClick",value:function(e){this._actionMap[e.target.id]()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.navigation,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshNavigation()}},{key:"_refreshNavigation",value:function(){n2.isUndefined(this.verticalNavigation)||this.verticalNavigation.destroy(),this._insertVerticalNavigation()}}]),t}(),n2.de.page.Console=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._activeNavigationId=null,this._pageContext=n2.de.page.console.Context.getInstance(),this._cls="n2_full-width"}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var e=this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:[{id:"console-section",heading:{text:"Console",hidden:!0},links:this._getLinks()}],hidden:this._isMobileApp(),listeners:{click:this._onNavigationClick,scope:this}})),t=e.components["console-section"].components[this._activeNavigationId];return n2.isUndefined(t)||(e.activeLink=t),e}},{key:"_getLinks",value:function(){var e=[{id:"todays-distribution-list",label:"Today's Distributions",icon:n2.de.enum.Icon.DISTRIBUTION},{id:"source-list",label:"Sources",icon:n2.de.enum.Icon.SOURCES},{id:"calendar",label:"Calendar",icon:n2.de.enum.Icon.MONTHLY_VIEW}];return n2.de.ApplicationContext.getInstance().isDESystemManager||e.unshift({id:"application-monitoring",label:"Application Monitoring",icon:n2.de.enum.Icon.APPLICATION_MONITORING}),e}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id)}},{key:"_navigateToPage",value:function(e){switch(e){case"application-monitoring":n2.de.page.Navigation.getInstance().open("Console_ApplicationMonitoring");break;case"todays-distribution-list":n2.de.page.Navigation.getInstance().open("Console_TodaysDistributionList");break;case"source-list":n2.de.page.Navigation.getInstance().open("Console_SourceList");break;case"calendar":n2.de.page.Navigation.getInstance().open("Console_Calendar")}}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){this.load({silent:!1,force:!0}),this.slideOutPanel.hide()}}]),t}(),n2.de.page.InvalidIdMessageBox=function(){_inherits(i,n2.ui.component.MessageBox);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.listeners,t=void 0===t?null:t,n=e.header,n=void 0===n?"Record not found":n,e=e.message,e=void 0===e?"":e;_get(_getPrototypeOf(i.prototype),"show",this).call(this,{header:n,message:e,theme:n2.ui.enum.Theme.ERROR,buttons:n2.ui.enum.Button.OK,listeners:t})}}]),i}(),n2.de.page.Logs=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._activeNavigationId=null,this._pageContext=n2.de.page.logs.Context.getInstance(),this._componentCls="n2-de-logs"}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var e=this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:[{id:"logs-section",heading:{text:"Logs",hidden:!0},links:this._getLinks()}],listeners:{click:this._onNavigationClick,scope:this}}));return e.activeLink=e.components["logs-section"].components[this._activeNavigationId],e}},{key:"_getLinks",value:function(){var e=[{id:"distribution-log-list",label:"Distribution logs",icon:n2.de.enum.Icon.DISTRIBUTION}],t={id:"object-sync-log-list",label:"Object sync logs",icon:n2.de.enum.Icon.OBJECT_SYNC},n={id:"archive-log-list",label:"Archive logs",icon:n2.de.enum.Icon.ARCHIVE},i={id:"scheduler-log-list",label:"Scheduler logs",icon:n2.de.enum.Icon.SCHEDULER};return n2.de.ApplicationContext.getInstance().isDEAdmin?(e=[].concat(_toConsumableArray(e),[{id:"territories-log-list",label:"Territories logs",icon:n2.de.enum.Icon.TERRITORIES},{id:"lead-matching-log-list",label:"Lead matching logs",icon:n2.de.enum.Icon.LEAD_MATCHING},{id:"auto-conversion-log-list",label:"Auto-conversion logs",icon:n2.de.enum.Icon.AUTO_CONVERSION},t,i]),this._pageContext.hasArchivingBeenEnabled&&e.push(n)):n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(e.push(t),e.push(i),this._pageContext.hasArchivingBeenEnabled)&&e.push(n),e}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id)}},{key:"_navigateToPage",value:function(e){switch(e){case"distribution-log-list":n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList");break;case"territories-log-list":n2.de.page.Navigation.getInstance().open("Logs_TerritoriesLogList");break;case"lead-matching-log-list":n2.de.page.Navigation.getInstance().open("Logs_LeadMatchingLogList");break;case"object-sync-log-list":n2.de.page.Navigation.getInstance().open("Logs_ObjectSyncLogList");break;case"auto-conversion-log-list":n2.de.page.Navigation.getInstance().open("Logs_AutoConversionLogList");break;case"archive-log-list":n2.de.page.Navigation.getInstance().open("Logs_ArchiveLogList");break;case"scheduler-log-list":n2.de.page.Navigation.getInstance().open("Logs_SchedulerLogList")}}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){this.load({silent:!1,force:!0}),this.slideOutPanel.hide()}}]),t}(),n2.de.page.Navigation=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._mixins=[n2.mixin.Singleton]}},{key:"open",value:function(e,t){e="/apex/"+n2.de.ApplicationContext.getInstance().namespace+e;t&&(e+="?"+t),this.openURL(e)}},{key:"openURL",value:function(e){n2.ui.SalesforcePage.isClassic()?this._setLocation(e):sforce.one.navigateToURL(e)}},{key:"openObject",value:function(e){n2.ui.SalesforcePage.isClassic()?this._setLocation("/"+e):sforce.one.navigateToSObject(e)}},{key:"_setLocation",value:function(e){(window.parent||window).location.assign(e)}}]),t}(),n2.de.page.ObjectSync=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t)}(),n2.de.page.Settings=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._activeNavigationId=null}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isDEAdmin&&this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var e=this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:[{id:"settings-section",heading:{text:"Settings",hidden:!0},links:[{id:"app-settings",label:"Settings",icon:n2.de.enum.Icon.SETTINGS},{id:"advanced-settings",label:"Advanced Settings",icon:n2.de.enum.Icon.SETTINGS},{id:"licensed-users",label:"Licensed Users",icon:n2.de.enum.Icon.PEOPLE},{id:"export-import",label:"Export/Import",icon:n2.de.enum.Icon.PRODUCT_TRANSFER}]}],listeners:{click:this._onNavigationClick,scope:this}}));return e.activeLink=e.components["settings-section"].components[this._activeNavigationId],e}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id)}},{key:"_navigateToPage",value:function(e){switch(e){case"app-settings":n2.de.page.Navigation.getInstance().open("Settings_AppSettings");break;case"advanced-settings":n2.de.page.Navigation.getInstance().open("Settings_AdvancedSettings");break;case"licensed-users":n2.de.page.Navigation.getInstance().open("Settings_LicensedUsers");break;case"export-import":n2.de.page.Navigation.getInstance().open("Settings_ExportImport")}}}]),t}(),n2.de.page.SlideOutPanel=function(){_inherits(s,n2.ui.Component);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{header:"header",heading:"h2",actions:".n2_actions",body:".n2_container"}),this.id="slide-out-panel",this._mixins=[n2.mixin.Singleton,n2.mixin.Observable],this._template='<aside id="{{id}}" class="n2-component n2-de-slide-out-panel{{#hidden}} slds-hidden{{/hidden}}">\n            <div class="n2_container">\n                <header class="slds-grid">\n                    {{>headingTemplate}}\n                    <div class="n2_actions"></div>\n                </header>\n            </div>\n        </aside>',this._headingTemplate="<h2></h2>",this._hidden=!0,this._heading="",this._includeNavButtons=!1,this._resizeHandler=null,this._scrollHandler=null}},{key:"heading",set:function(e){this._heading!==e&&(this._heading=e,this._rendered)&&this._refreshHeading()}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertHeadingButton(),this._insertActionButtons(),this._insertCloseButton()}},{key:"_insertHeadingButton",value:function(){return this._insert(new n2.ui.component.Button({id:"heading-button",cls:"slds-truncate",text:this._heading,theme:n2.ui.component.button.Theme.LINK,renderTo:this.SELECTORS.heading,listeners:{click:this._onOpenButtonClick,scope:this}}))}},{key:"_insertActionButtons",value:function(){return[this._insertOpenButton()]}},{key:"_insertOpenButton",value:function(){return this._insert(new n2.ui.component.Button({id:"open-button",text:"Open",theme:n2.ui.component.button.Theme.LINK,cls:"slds-m-right_xx-small",renderTo:this.SELECTORS.actions,listeners:{click:this._onOpenButtonClick,scope:this}}))}},{key:"_insertCloseButton",value:function(){return this._insert(new n2.ui.component.Button({id:"close-button",icon:n2.ui.enum.Icon.CLOSE,renderTo:this.SELECTORS.actions,cls:"n2_close-button",listeners:{click:this._onCloseButtonClick,scope:this}}))}},{key:"_onOpenButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this,relatedTarget:null,data:null})}},{key:"_onCloseButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this,relatedTarget:null,data:null}),this._animateVisibilty(!1)}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.heading,t=void 0===t?"":t,n=e.includeNavButtons,i=e.components,i=void 0===i?[]:i,e=e.listeners,e=void 0===e?{}:e;this._includeNavButtons=void 0!==n&&n,this.heading=t,n2.isEmpty(i)||(this._destroyContentComponents(),this._insertContentComponents(i)),n2.isEmpty(e)||(this._purgeListeners(),this._applyListeners(e)),_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this._animateVisibilty()}},{key:"_applyListeners",value:function(e){var t=this;_get(_getPrototypeOf(s.prototype),"_applyListeners",this).apply(this,arguments),this._resizeHandler=function(){return t._setPosition()},window.addEventListener("resize",this._resizeHandler),n2.ui.SalesforcePage.isClassic()&&(this._scrollHandler=function(){return t._setPosition()},window.addEventListener("scroll",this._scrollHandler))}},{key:"_animateVisibilty",value:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?this._dom.addClass("n2-de-slide-out-panel-animation-toggle"):this._dom.removeClass("n2-de-slide-out-panel-animation-toggle")}},{key:"_destroyContentComponents",value:function(){this.forEach(function(e){"open-button"!==e.id&&"close-button"!==e.id&&"heading-button"!==e.id&&e.destroy()})}},{key:"_insertContentComponents",value:function(e){var t=this;return e.map(function(e){return t._insert(e)})}},{key:"_refreshHeading",value:function(){this._refreshHeadingButtons(),this._refreshHeadingText()}},{key:"_refreshHeadingButtons",value:function(){var e=this._components["heading-button"],t=this._components["open-button"];this._includeNavButtons?(this.element("heading").clearText(),e.hidden=!1,e.text=this._heading,e.title=this._heading,t.hidden=!1):(e.hidden=!0,t.hide({reserveSpace:!0}))}},{key:"_refreshHeadingText",value:function(){var e;this._includeNavButtons||((e=this.element("heading")).clearText(),e._rawDOM.appendChild(document.createTextNode(this._heading)),e.attribute("title",this._heading))}},{key:"_showElement",value:function(){this._rendered||this.render(),this._setPosition(),_get(_getPrototypeOf(s.prototype),"_showElement",this).apply(this,arguments)}},{key:"_setPosition",value:function(){var e=this._dom.parent.rawDOM.getBoundingClientRect(),t=document.body.offsetWidth-e.right;this._dom.style({top:"".concat(e.top,"px"),right:"".concat(t,"px"),height:"".concat(e.height,"px")})}},{key:"hide",value:function(){this._hideSpinners(),_get(_getPrototypeOf(s.prototype),"hide",this).call(this,{reserveSpace:!0}),this._purgeListeners()}},{key:"_hideSpinners",value:function(){this.spinner(!1),this.componentList.forEach(function(e){return e.spinner(!1)})}},{key:"_purgeListeners",value:function(){this.purgeListeners(),window.removeEventListener("resize",this._resizeHandler),n2.isNull(this._scrollHandler)||window.removeEventListener("scroll",this._scrollHandler)}},{key:"_bindEvents",value:function(){var e=this;_get(_getPrototypeOf(s.prototype),"_bindEvents",this).apply(this,arguments),this.element("body").listen("transitionend",function(){return e._onSlideTransitionEnd()})}},{key:"_onSlideTransitionEnd",value:function(){this._dom.hasClass("n2-de-slide-out-panel-animation-toggle")||(this.hidden=!0)}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(s.prototype),"_getTemplateData",this).call(this),{heading:this._heading})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(s.prototype),"_getTemplatePartials",this).call(this),{headingTemplate:this._headingTemplate})}}]),s}(),n2.de.page.Tags=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._activeNavigationId=null,this._pageContext=n2.de.page.tags.Context.getInstance()}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var e=this.insert(new n2.de.component.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},sections:[{id:"tags-section",heading:{text:"Tags",hidden:!0},links:this._getLinks()}],listeners:{click:this._onNavigationClick,scope:this}}));return e.activeLink=e.components["tags-section"].components[this._activeNavigationId],e}},{key:"_getLinks",value:function(){var e=[];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.push({id:"tag-collection-list",label:"Tag Collections",icon:n2.de.enum.Icon.QUOTE}),(n2.de.ApplicationContext.getInstance().isAdminOrSystemManager||n2.de.ApplicationContext.getInstance().isTeamManager)&&e.push({id:"tag-assignment-list",label:"Tag Assignment",icon:n2.de.enum.Icon.QUOTE}),e}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id)}},{key:"_navigateToPage",value:function(e){switch(e){case"tag-collection-list":n2.de.page.Navigation.getInstance().open("Tags_TagCollectionList");break;case"tag-assignment-list":n2.de.page.Navigation.getInstance().open("Tags_TagAssignmentList")}}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){this.load({silent:!1,force:!0}),this.slideOutPanel.hide()}}]),t}(),n2.de.page.Team=function(){_inherits(n,n2.de.Page);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._LINKS={HOME:{id:"home",label:"Home",icon:n2.de.enum.Icon.HOME},TEAM_MEMBERS:{id:"team-members",label:"Team members",icon:n2.de.enum.Icon.GROUPS},AVAILABILITY:{id:"availability",label:"Availability",icon:n2.de.enum.Icon.GROUPS},PERFORMANCE:{id:"performance",label:"Performance",cls:"n2_vertical-nav-divider-bottom",icon:n2.de.enum.Icon.TALENT_DEVELOPMENT},DISTRIBUTORS:{id:"distributors",label:"Distributors",icon:n2.de.enum.Icon.PROCESS},WEIGHTING_CAPS:{id:"weighting-and-caps",label:"Weighting and caps",icon:n2.de.enum.Icon.RESOURCE_CAPACITY},DISTRIBUTION_HOURS:{id:"distribution-hours",label:"Distribution hours",icon:n2.de.enum.Icon.DATE_TIME},TRACKING_SLAS:{id:"tracking-and-slas",label:"Tracking and SLAs",icon:n2.de.enum.Icon.NOTIFICATION},ASSIGNMENT_REJECTION:{id:"assignment-rejection",label:"Assignment rejection",icon:n2.de.enum.Icon.CANCEL_TRANSFER},POST_ASSIGNMENT:{id:"post-assignment",label:"Post assignment",icon:n2.de.enum.Icon.TEXT_TEMPLATE},SETTINGS:{id:"settings",label:"Settings",icon:n2.de.enum.Icon.SETTINGS}},this._activeNavigationId=null,this._pageContext=n2.de.page.team.Context.getInstance()}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(n.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertVerticalNavigation()}},{key:"_insertVerticalNavigation",value:function(){var t=this,e=this.insert(new n2.de.page.team.VerticalNavigation({id:"vertical-navigation",renderTo:{target:this.SELECTORS.main,position:"beforebegin"},cls:"n2_navigation",teamId:this._pageContext.teamId,sections:[{id:"team-section",heading:{text:"Team",hidden:!0},links:this._getLinks()}],listeners:{click:function(e){return t._onNavigationClick(e)},teamChange:function(e){return t._onTeamNavigationChange(e)}}}));return e.activeLink=e.components["team-section"].components[this._activeNavigationId],e}},{key:"_getLinks",value:function(){var t=this,e=Object.entries(this._LINKS).map(function(e){e=_slicedToArray(e,2);e[0];return e[1]});return this._pageContext.isQ2QTeam&&(e=e.filter(function(e){return e.id!==t._LINKS.AVAILABILITY.id})),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?e:e.filter(function(e){return[t._LINKS.HOME.id,t._LINKS.TEAM_MEMBERS.id,t._LINKS.AVAILABILITY.id,t._LINKS.PERFORMANCE.id,t._LINKS.WEIGHTING_CAPS.id,t._LINKS.DISTRIBUTION_HOURS.id].includes(e.id)})}},{key:"_onNavigationClick",value:function(e){this._navigateToPage(e.target.id,this._pageContext.teamId)}},{key:"_onTeamNavigationChange",value:function(e){var t=this._components["vertical-navigation"].activeLink.id;this._navigateToPage(t,e.target.value)}},{key:"_navigateToPage",value:function(e,t){switch(e){case"home":n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(t));break;case"assignment-rejection":n2.de.page.Navigation.getInstance().open("Team_AssignmentRejection","teamId=".concat(t));break;case"team-members":n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t));break;case"availability":n2.de.page.Navigation.getInstance().open("Team_Availability","teamId=".concat(t));break;case"performance":n2.de.page.Navigation.getInstance().open("Team_TeamPerformance","teamId=".concat(t));break;case"settings":n2.de.page.Navigation.getInstance().open("Team_TeamSettings","teamId=".concat(t));break;case"distributors":n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t));break;case"distribution-hours":n2.de.page.Navigation.getInstance().open("Team_DistributionHours","teamId=".concat(t));break;case"weighting-and-caps":n2.de.page.Navigation.getInstance().open("Team_WeightingAndCaps","teamId=".concat(t));break;case"post-assignment":n2.de.page.Navigation.getInstance().open("Team_PostAssignment","teamId=".concat(t));break;case"tracking-and-slas":n2.de.page.Navigation.getInstance().open("Team_TrackingAndSlas","teamId=".concat(t))}}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTeamId(e)?"Your team could not be found, please press OK to return to the Teams page.":n2.de.Error.isInvalidTeamMemberId(e)?"Your team member could not be found, please press OK to return to the Team members page.":n2.de.Error.isInvalidDistributorId(e)?"Your distributor could not be found, please press OK to return to the Distributors page.":n2.de.Error.isInvalidDistributionHours(e)?"You have selected a shift that no longer exists, press OK to refresh the distribution hours.":_get(_getPrototypeOf(n.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){this.spinner();var t=this._pageContext.teamId;n2.de.Error.isInvalidTeamId(e)?n2.de.page.Navigation.getInstance().open("Team_TeamList"):n2.de.Error.isInvalidTeamMemberId(e)?n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t)):n2.de.Error.isInvalidDistributorId(e)?n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t)):_get(_getPrototypeOf(n.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments)}}]),n}(),n2.de.util.Date={formatTimestamp:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).dateOnly,t=void 0!==t&&t;return this.formatDate(new Date(e),{dateOnly:t})},formatDate:function(e,t){var n=t.timeZone,n=void 0===n?n2.getTimeZone():n,t=t.dateOnly,t=void 0!==t&&t,e=this.getDateTimeParts(e,n),n=e.day,i=e.month,s=e.year,a=e.hour,o=e.minute,e=e.meridiem,n="".concat(n,"-").concat(i.substring(0,3),"-").concat(s);return t||(n+=" ".concat(a,":").concat(o).concat(e)),n},convertDateToTimeZone:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).timeZone,t=void 0===t?n2.getTimeZone():t,t=n2.extractDateTimeParts(new Intl.DateTimeFormat(n2.getLocale(),{timeZone:t}),e),e=t.day,n=t.month,t=t.year;return new Date(t,n-1,e)},getIsoDateString:function(e){return e.toISOString().split("T")[0]},getDateTimeParts:function(e){var t,n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"UTC",s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{intlFormat:!1},i=this._getDateTimeFormat({hour12:!0,timeZone:i});return n2.isUndefined(i.formatToParts)||s.intlFormat?(t=(s=e.getUTCHours())<12?"am":"pm",s=12<s?s-12:s,n=e.getUTCMinutes(),{day:this.getDay(e),month:n2.getMonth(e,{short:!0}),year:this.getYear(e),hour:"".concat(s),minute:(n<10?"0":"").concat(n),meridiem:t}):(s=n2.extractDateTimeParts(i,e),n2.merge(s,{meridiem:s.dayPeriod.toLowerCase()}))},formatDateRange:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=n.startIsAllDay,i=void 0!==i&&i,n=n.endIsAllDay,n=void 0!==n&&n,s=this.getYear(new Date),e=this.getDateTimeParts(e),t=this.getDateTimeParts(t),a=e.day===t.day&&e.month===t.month&&e.year===t.year,o="".concat(e.day,"-").concat(e.month);return e.year!==s&&(o="".concat(o,"-").concat(e.year)),i||(o="".concat(o," ").concat(this._getTime(e))),a&&n?o:a&&!n?"".concat(o," to ").concat(this._getTime(t)):(o="".concat(o," to ").concat(t.day,"-").concat(t.month),t.year!==s&&(o="".concat(o,"-").concat(t.year)),o=n?o:"".concat(o," ").concat(this._getTime(t)))},getDay:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).day,t=void 0===t?"2-digit":t;return e.toLocaleDateString(n2.getLocale(),{day:t})},getYear:function(e){return e.toLocaleDateString(n2.getLocale(),{year:"numeric"})},getDateAsUTC:function(e){return new Date(e.getTime()+60*e.getTimezoneOffset()*1e3)},_getDateTimeFormat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hour12,t=void 0!==t&&t,e=e.timeZone,e={day:"2-digit",month:"short",year:"numeric",hour:"numeric",minute:"numeric",timeZone:void 0===e?n2.getTimeZone():e,hourCycle:t?"h12":"h24"};return new Intl.DateTimeFormat(n2.getLocale(),e)},_getTime:function(e){return"".concat(e.hour,":").concat(e.minute).concat(e.meridiem)},getUserLocaleTimeStamp:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n2.de.ApplicationContext.getInstance().timeZone,n=new Date(e.toLocaleString("en-US",{timeZone:"UTC"})),t=new Date(e.toLocaleString("en-US",{timeZone:t})).getTime()-n.getTime();return e.getTime()-t},getLuxonDateTimeMillis:function(e,t){return luxon.DateTime.fromObject(this._getLuxonDateTimeParts(e),{zone:t}).toMillis()},_getLuxonDateTimeParts:function(e){return{year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hour:e.getUTCHours(),minute:e.getUTCMinutes(),second:0,millisecond:0}},getJsDateFromDateTimeMillis:function(e,t){return n2.isEmpty(e)||n2.isEmpty(t)?null:(e=luxon.DateTime.fromMillis(e,{zone:t}).toFormat("yyyy-MM-dd HH:mm:ss"),new Date(luxon.DateTime.fromFormat(e,"yyyy-MM-dd HH:mm:ss",{zone:"UTC"})))}},n2.de.component.accordion.AccordionSection=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK,n2.event.EventType.CHANGE]),this.SELECTORS=n2.merge(this.SELECTORS,{container:".n2_container",heading:".n2_heading",body:".n2_content"}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this._componentCls="n2-accordion-section",this._template='<li id="{{id}}" class="slds-accordion__list-item {{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <section class="n2_container slds-accordion__section{{#opened}} slds-is-open{{/opened}}">\n                <div class="slds-accordion__summary">\n                    <h2 class="slds-accordion__summary-heading n2_heading"></h2>\n                </div>\n                <div class="slds-accordion__content n2_content" id="{{id}}_content"></div>\n            </section>\n        </li>',this._opened=!1,this._heading=null,this._REFRESH=n2.merge(this._REFRESH,{opened:["opened"],heading:["heading"]})}},{key:"opened",get:function(){return this._opened},set:function(e){this._setProperty("opened",e,{silent:!1,sync:!1})}},{key:"heading",set:function(e){this._setProperty("heading",e,{sync:!1})}},{key:"openButton",get:function(){return this._components["open-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._insertOpenButton()}},{key:"_insertOpenButton",value:function(){return this._insert(new n2.ui.component.Button({id:"open-button",renderTo:{target:this.SELECTORS.heading,position:"afterbegin"},icon:n2.de.enum.Icon.SWITCH,text:this._heading,theme:"reset",cls:"slds-accordion__summary-action n2_open-button",iconCls:"slds-accordion__summary-action-icon",listeners:{click:this._handleOpenButtonClick,scope:this}}))}},{key:"_handleOpenButtonClick",value:function(e){var t=this,n=this._createEventObject({canBubble:!0,defaultMethod:function(e){t.opened=!t._opened,t._onOpenButtonClick(e)}});this.fire("click",n)}},{key:"_onOpenButtonClick",value:function(e){}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{opened:this._opened})}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).call(this),this.openButton.dom.attribute("aria-controls","".concat(this.domId,"-content"))}},{key:"_refreshOpened",value:function(){this._rendered&&(this._opened?this.element("container").addClass("slds-is-open"):this.element("container").removeClass("slds-is-open"))}},{key:"_refreshHeading",value:function(){this.openButton.text=this._heading}}]),t}(),n2.de.component.availabilityCalendar.DayCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{dayCellContent:".n2_day-cell-content",dayLabel:".n2_day-label",teamHoliday:".n2_team-holiday",teamMembersWorking:".n2_team-members-working",teamMembersOutOfOffice:".n2_team-members-out-of-office"}),this._data=null,this._cellTemplate='<div class="n2_day-cell-content {{#isToday}}n2_is-today {{/isToday}}{{^isCurrentMonth}}n2_is-not-current-month {{/isCurrentMonth}}{{#isCurrentMonth}}n2test_day-{{day}} {{/isCurrentMonth}}">\n            <strong class="n2_day-label{{#month}} n2_is-month-start{{/month}} slds-truncate">{{day}}{{#month}} {{month}}{{/month}}</strong>\n            {{> teamHolidayTemplate }}\n            {{> workingTeamMembersTemplate}}\n            {{> outOfOfficeTeamMembersTemplate}}\n        </div>',this._teamHolidayTemplate='{{#teamHoliday}}\n            <p class="n2_day-cell-item n2_team-holiday slds-truncate" title="{{teamHoliday.names}}">\n                {{teamHoliday.output}}\n            </p>\n        {{/teamHoliday}}',this._workingTeamMembersTemplate='{{#workingTeamMembers}}\n            <p class="n2_day-cell-item n2_team-members-working slds-truncate" title="{{workingTeamMembers.names}}">\n                {{workingTeamMembers.count}} working {{workingTeamMembers.suffix}}\n            </p>\n        {{/workingTeamMembers}}',this._outOfOfficeTeamMembersTemplate='{{#outOfOfficeTeamMembers}}\n            <p class="n2_day-cell-item n2_team-members-out-of-office slds-truncate" title="{{outOfOfficeTeamMembers.names}}">\n                {{outOfOfficeTeamMembers.count}} out of office {{outOfOfficeTeamMembers.suffix}}\n            </p>\n        {{/outOfOfficeTeamMembers}}',this.currentDate=null,this.month=null,this.availabilityData=null,this.filterData=null,this._REFRESH=n2.merge(this._REFRESH,{filterData:["teamMembers"],availabilityData:["teamHoliday","teamMembers"],currentDate:["isToday"]})}},{key:"filteredAvailabilityData",get:function(){return this._getFilteredAvailabilityData()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),this._getDateData())}},{key:"filter",value:function(e){var t=e.userIds,e=e.tagIds;this._setProperty("filterData",{userIds:void 0===t?null:t,tagIds:void 0===e?null:e})}},{key:"_refreshIsToday",value:function(){this._rendered&&(this._getDateData().isToday?this.element("dayCellContent").addClass("n2_is-today"):this.element("dayCellContent").removeClass("n2_is-today"))}},{key:"_refreshTeamHoliday",value:function(){var e;this._rendered&&(n2.isNull(this.element("teamHoliday",!0))||this.element("teamHoliday").remove(),e=this._bindTemplateToData(this._teamHolidayTemplate,{teamHoliday:this._getTeamHolidayNamesTemplateData(this.availabilityData.teamHolidayNames)}),this.element("dayLabel").insert(e,"afterend"))}},{key:"_refreshTeamMembers",value:function(){var e;this._rendered&&(n2.isNull(this.element("teamMembersWorking",!0))||this.element("teamMembersWorking").remove(),n2.isNull(this.element("teamMembersOutOfOffice",!0))||this.element("teamMembersOutOfOffice").remove(),e=this._getFilteredAvailabilityData(),this.element("dayCellContent").insert(this._templateTeamMembersOutput(e)))}},{key:"_getFilteredAvailabilityData",value:function(){return n2.isNull(this.filterData)?this.availabilityData:{teamMembersWorking:this._filterTeamMemberData(this.availabilityData.teamMembersWorking,this.filterData),teamMembersOutOfOffice:this._filterTeamMemberData(this.availabilityData.teamMembersOutOfOffice,this.filterData)}}},{key:"_templateTeamMembersOutput",value:function(e){var t="".concat(this._workingTeamMembersTemplate).concat(this._outOfOfficeTeamMembersTemplate);return this._bindTemplateToData(t,{workingTeamMembers:this._getTeamMembersTemplateData(e.teamMembersWorking),outOfOfficeTeamMembers:this._getTeamMembersTemplateData(e.teamMembersOutOfOffice)})}},{key:"_bindTemplateToData",value:function(e,t){return n2.ui.Template.render(e,t)}},{key:"_filterTeamMemberData",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length?arguments[1]:void 0,i=n.userIds,s=void 0===i?null:i,i=n.tagIds,a=void 0===i?null:i;return n2.isEmpty(s)&&n2.isEmpty(a)||n2.isEmpty(e)?e:e.filter(function(e){return t._isUserIdMatch(s,e.userId)&&t._isTagMatch(a,e.tagIds)})}},{key:"_isUserIdMatch",value:function(e,t){return n2.isEmpty(e)||e.includes(t)}},{key:"_isTagMatch",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return n2.isEmpty(e)||e.every(function(e){return t.includes(e)})}},{key:"_getTeamMembersTemplateData",value:function(e){var t;return n2.isEmpty(e)?null:{count:t=e.length,suffix:1===t?"team member":"team members",names:e.map(function(e){return e.userName})}}},{key:"_getTeamHolidayNamesTemplateData",value:function(e){return n2.isEmpty(e)?null:{names:e.join(", "),output:1<e.length?"Holiday":e[0]}}},{key:"_getDateData",value:function(){var e=new Date(Date.UTC(this._data.year,this._data.month-1,this._data.day));return{day:this._data.day,month:1===this._data.day?n2.de.enum.Date.MONTH[this._data.month-1]:null,isToday:"".concat(this.currentDate.toDateString())==="".concat(e.toDateString()),isCurrentMonth:this.month===e.getMonth()}}}]),t}(),n2.de.component.availabilityCalendar.SlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.de.event.EventType.SHOW]),this.SELECTORS=n2.merge(this.SELECTORS,{availabilityContent:".n2_availability-content",emptyState:".n2_empty-state",teamHolidayContainer:".n2_holiday",teamHoliday:".n2_holiday h3",filterMessage:".n2_filter-message",filteredTeamMemberCount:".n2_filtered-team-member-count",clearFiltersLink:".n2_filter-message a"}),this._componentCls="n2-de-availability-calendar-slide-out-panel",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._lazyLoad=!0,this._bodyTemplate='<div class="n2_availability-content">\n            <div class="n2_empty-state"><p>Your team has no scheduled hours for this day</p></div>\n            <div class="n2_holiday slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.KEY_DATES,{cls:"slds-icon_small slds-m-right_x-small slds-col slds-no-flex slds-icon-text-default"}),'\n                <h3 title=""></h3>\n            </div>\n            <div class="n2_filter-message slds-hide">\n                ').concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n                <p><span class="n2_filtered-team-member-count"></span> hidden by filters. <a href="javascript:void(0)">Clear filters</a> to see these team members.</p>\n            </div>\n        </div>'),this.date=null,this.availabilityData=null,this.filteredAvailabilityData=null,this.shiftsData=null,this.outOfOfficeData=null,this._REFRESH=n2.merge(this._REFRESH,{date:["date"],availabilityData:["emptyState","teamHoliday"],filteredAvailabilityData:["emptyState","filterMessage","availabilityAccordion"]})}},{key:"availabilityAccordion",get:function(){return this._components["availability-accordion"]}},{key:"workingAccordionSection",get:function(){return this.availabilityAccordion.components["working-team-members"]}},{key:"outOfOfficeAccordionSection",get:function(){return this.availabilityAccordion.components["out-of-office-team-members"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this),this._insertAvailabilityAccordion()}},{key:"_insertAvailabilityAccordion",value:function(){return this._insert(new n2.de.component.Accordion({id:"availability-accordion",renderTo:this.SELECTORS.availabilityContent,hidden:!0,components:[new n2.de.component.accordion.AccordionSection({id:"working-team-members"}),new n2.de.component.accordion.AccordionSection({id:"out-of-office-team-members",components:[new n2.ui.component.HTML({id:"team-members",mixins:[n2.mixin.DataDriven],template:'<div class="n2_availability-item">\n                        <div class="n2_availability-details">\n                            <ul>\n                                {{#model}}<li title="{{outOfOffice}}">{{userName}}</li>{{/model}}\n                            </ul>\n                        </div>\n                    </div>'})]})]}))}},{key:"_renderChildren",value:function(){this._insertBodyElement(),_get(_getPrototypeOf(n.prototype),"_renderChildren",this).call(this)}},{key:"_insertBodyElement",value:function(){this.element("body").insert(this._getBodyContent())}},{key:"_getBodyContent",value:function(){return n2.ui.Template.render(this._bodyTemplate,this._getTemplateData(),this._getTemplatePartials())}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(n.prototype),"_prepareDOM",this).call(this),this.element("clearFiltersLink").listen("click",this._onClearFilterLinkClick,{scope:this})}},{key:"_onClearFilterLinkClick",value:function(e){this.fire("click",this._createEventObject({data:{actions:["clear-filters"]}})),e.preventDefault()}},{key:"_hasPropertyChanged",value:function(e,t){return"filteredAvailabilityData"===e||_get(_getPrototypeOf(n.prototype),"_hasPropertyChanged",this).call(this,e,t)}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.fire("show",this._createEventObject())}},{key:"hide",value:function(){_get(_getPrototypeOf(n.prototype),"hide",this).apply(this,arguments),this._refresh(["availabilityAccordion"])}},{key:"_refreshEmptyState",value:function(){if(!this._hasAvailabilityData())return this.element("emptyState").show();this.element("emptyState").hide()}},{key:"_refreshDate",value:function(){this.heading=n2.de.util.Date.formatDate(this.date,{timeZone:"UTC",dateOnly:!0})}},{key:"_refreshHeading",value:function(){n2.isEmpty(this._heading)||_get(_getPrototypeOf(n.prototype),"_refreshHeading",this).call(this)}},{key:"_refreshTeamHoliday",value:function(){var e=this.availabilityData.teamHolidayNames;if(n2.isEmpty(e))return this.element("teamHolidayContainer").hide();var t=1<e.length?"Holiday":e[0];this.element("teamHoliday").text(t),this.element("teamHoliday").attribute("title",e.join(", ")),this.element("teamHolidayContainer").show()}},{key:"_refreshFilterMessage",value:function(){var e=this._getFilteredOutTeamMemberCount();if(0===e)return this.element("filterMessage").hide();var t=1===e?"other team member":"other team members";this.element("filteredTeamMemberCount").text("".concat(e," ").concat(t)),this.element("filterMessage").show()}},{key:"_refreshAvailabilityAccordion",value:function(){this.availabilityAccordion.hidden=!this._hasAvailabilityData(),this._refreshWorkingTeamMembersSection(),this._refreshOutOfOfficeTeamMembersSection()}},{key:"_refreshWorkingTeamMembersSection",value:function(){var e,t,n;this._hidden?this.workingAccordionSection.opened=!1:(this.workingAccordionSection.heading="Working team members (".concat(this.filteredAvailabilityData.teamMembersWorking.length,")"),this._destroyShiftDetailsComponents(),e=this._insertShifts(),t=this._insertIndividualShifts(),n=this._insertTeamShifts(),this.workingAccordionSection.hidden=n2.isEmpty(e)&&n2.isEmpty(t)&&n2.isEmpty(n))}},{key:"_destroyShiftDetailsComponents",value:function(){this.workingAccordionSection.componentList.forEach(function(e){(e instanceof n2.de.component.availabilityCalendar.slideOutPanel.IndividualShiftDetails||e instanceof n2.de.component.availabilityCalendar.slideOutPanel.ShiftDetails)&&e.destroy()})}},{key:"_insertShifts",value:function(){var i=this,s=[];return this._getShiftsDataByShiftType("Shift").forEach(function(e,t){var n=i._getWorkingTeamMembersForShifts([e]);n2.isEmpty(n)||s.push(i.workingAccordionSection.insert(new n2.de.component.availabilityCalendar.slideOutPanel.ShiftDetails({id:"shift-details-".concat(t),slideOutPanelDate:i.date,shiftsData:[e],teamMembersData:n})))}),s}},{key:"_insertIndividualShifts",value:function(){var e=this._getShiftsDataByShiftType("Individual"),t=this._getWorkingTeamMembersForShifts(e);return n2.isEmpty(e)||n2.isEmpty(t)?null:this.workingAccordionSection.insert(new n2.de.component.availabilityCalendar.slideOutPanel.IndividualShiftDetails({id:"individual-shift-details",slideOutPanelDate:this.date,shiftsData:e,teamMembersData:this._getWorkingTeamMembersForShifts(e)}))}},{key:"_insertTeamShifts",value:function(){var e=this._getShiftsDataByShiftType("Team"),t=this._getWorkingTeamMembersForShifts(e);return n2.isEmpty(e)||n2.isEmpty(t)?null:this.workingAccordionSection.insert(new n2.de.component.availabilityCalendar.slideOutPanel.ShiftDetails({id:"team-shift-details",slideOutPanelDate:this.date,shiftsData:e,teamMembersData:t}))}},{key:"_refreshOutOfOfficeTeamMembersSection",value:function(){var e;this._hidden?this.outOfOfficeAccordionSection.opened=!1:(e=this._getTeamMembersWithOutOfOfficeData(),this.outOfOfficeAccordionSection.hidden=n2.isEmpty(e),this.outOfOfficeAccordionSection.heading="Out of office team members (".concat(this.filteredAvailabilityData.teamMembersOutOfOffice.length,")"),this.outOfOfficeAccordionSection.components["team-members"].model=e)}},{key:"_getFilteredOutTeamMemberCount",value:function(){return n2.isNull(this.filteredAvailabilityData)?0:this.availabilityData.teamMembersWorking.length-this.filteredAvailabilityData.teamMembersWorking.length+(this.availabilityData.teamMembersOutOfOffice.length-this.filteredAvailabilityData.teamMembersOutOfOffice.length)}},{key:"_getShiftsDataByShiftType",value:function(t){return this.shiftsData.filter(function(e){return e.shiftType===t})}},{key:"_getWorkingTeamMembersForShifts",value:function(e){var t=e.map(function(e){return e.shiftHoursId});return this.filteredAvailabilityData.teamMembersWorking.filter(function(e){return t.includes(e.shiftHoursId)})}},{key:"_getTeamMembersWithOutOfOfficeData",value:function(){var t=this;return this.filteredAvailabilityData.teamMembersOutOfOffice.map(function(e){return n2.merge(e,{outOfOffice:t._getOutOfOfficeOutput(t.outOfOfficeData[e.userId])})})}},{key:"_getOutOfOfficeOutput",value:function(i){var s="";return i.forEach(function(e,t){var t=t===i.length-1,n=n2.de.util.Date.formatDateRange(new Date(e.startDate),new Date(e.endDate));s+="".concat(e.oooReason," (").concat(n," (").concat(e.timezone,"))"),s=t?s:"".concat(s," | ")}),s}},{key:"_hasAvailabilityData",value:function(){return!(n2.isEmpty(this.availabilityData)||n2.isEmpty(this.availabilityData.teamMembersWorking)&&n2.isEmpty(this.availabilityData.teamMembersOutOfOffice)&&n2.isEmpty(this.availabilityData.teamHolidayNames))}}]),n}(),n2.de.component.DistributorCapsLabel=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Observable],this._mixins),this._template='<div id="{{id}}" class="slds-truncate n2-distributor-caps-label n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}></div>'}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._insertCapComponents()}},{key:"_getCapTypeDescription",value:function(e){return n2.de.data.PeriodOptions.getPeriodLabel(e.cappingPeriod,{teamHasActiveStatus:e.teamHasActiveStatus,useShortNames:!0}).toLowerCase()}},{key:"_insertCapComponents",value:function(){n2.isUndefined(this._components["cap-text"])||this._components["cap-text"].destroy(),n2.isUndefined(this._components["cap-filter"])||this._components["cap-filter"].destroy();var e,t=this._getCapDisplayInfo();t?(e="".concat(t.value," ").concat(t.label),this.insert(new n2.ui.component.HTML({id:"cap-text",template:"<span>".concat(e,"</span>")})),t.customFilter&&(t=new n2.de.component.summary.InlineFilterSummary({id:"cap-filter",filter:t.customFilter,noTitles:!0}),this.insert(t),e+=t.getSummaryAsText()),this.title=e):(this.insert(new n2.ui.component.HTML({id:"cap-text",template:'<span class="n2_text-weak">&mdash;</span>'})),this.title=null)}},{key:"_getCapDisplayInfo",value:function(){var e,t;return n2.isUndefined(this._model)||!(e=n2.dataProvider.Model.isModeled(this._model)?this._model.json:this._model).hasCap||n2.isUndefined(e.capValue)?null:(t={value:e.capValue,label:this._getCapTypeDescription(e)},"criteria based"===n2.de.data.PeriodOptions.getNormalizedCapPeriodType(e.cappingPeriod)&&this._populateCriteriaCapsDetails(e.criteriaCapsConfig,t),t)}},{key:"_populateCriteriaCapsDetails",value:function(e,t){e&&(e.useDistributorFilters?t.label="Distributor Filters":e.customFilter&&n2.isArray(e.customFilter.filters)&&(e=e.customFilter.filters[0],n2.isUndefined(e)||(t.label="",t.customFilter=e)))}}]),n}(),n2.de.component.MultiFieldUpdateLabel=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Observable],this._mixins),this._componentCls="n2-de-multi-field-update-label"}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._insertUpdateLabels()}},{key:"_insertUpdateLabels",value:function(){var i=this,e=(n2.isUndefined(this._components["update-labels"])||this._components["update-labels"].destroy(),n2.dataProvider.Model.isModeled(this._model)?this._model.json:this._model);e.fieldUpdateEnabled&&e.fieldUpdateConfig&&n2.isArray(e.fieldUpdateConfig.fields)?(e=new n2.de.component.summary.InlineFiltersSummary({id:"update-labels",cls:"slds-truncate",noTitles:!0,filters:e.fieldUpdateConfig.fields.map(function(e){var t=i._prepareValue(e.value),n=t.val,t=t.op;return{name:e.label,val:n,op:t,type:e.type}})}),this.insert(e),this.title=e.getSummaryAsText()):(this.insert(new n2.ui.component.HTML({id:"update-labels",template:'<span class="n2_text-weak">&mdash;</span>'})),this.title=null)}},{key:"_prepareValue",value:function(e){return n2.isUndefined(e)||n2.isNull(e)?{val:null,op:""}:n2.isString(e)?""===e?{val:null,op:""}:{val:e.replace(/\s/g,""),op:null}:{val:e,op:null}}}]),n}(),n2.de.component.distributors.PreviewToolModal=function(){_inherits(i,n2.de.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="preview-tool-modal",this._cls="n2-de-preview-tool-modal",this.header="Preview Tool",this._RECORD_DISPLAY_LIMIT=50,this._recordLimitMessageTemplate='<div id="{{id}}" class="slds-grid slds-m-bottom_small slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Displaying '+this._RECORD_DISPLAY_LIMIT+" of {{model.totalAvailableRecords}} available {{model.objectLabelPlural}}.</p></div></div>",this._highVolumeMessageTemplate='<div id="{{id}}" class="slds-grid slds-m-bottom_small slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.ERROR,{cls:"slds-icon_x-small slds-m-right_xx-small slds-m-top_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>There is a high volume of {{model}} waiting in the queue. This may affect Distribution Engine performance. Please see help topic <a href="https://help.nc-squared.com/optimising-distribution-engine-performance" target="_blank">Tuning Distribution Engine</a> for more details.</p></div></div>'}},{key:"_insertRecordLimitMessage",value:function(){return n2.isUndefined(this._components["record-limit-message"])||this._components["record-limit-message"].destroy(),this._insert(new n2.ui.component.HTML({id:"record-limit-message",mixins:[n2.mixin.DataDriven],template:this._recordLimitMessageTemplate,model:{totalAvailableRecords:this._model.get("totalAvailableRecords"),objectLabelPlural:this._model.get("objectLabelPlural")},hidden:!0}))}},{key:"_insertSourceMessage",value:function(){return n2.isUndefined(this._components["source-message"])||this._components["source-message"].destroy(),this._insert(new n2.ui.component.HTML({id:"source-message",mixins:[n2.mixin.DataDriven],template:'<span id="{{id}}" class="slds-hide">Assigning {{model.preposition}} {{model.assignFromType}}: {{model.assignFrom}} </span>',model:this._getSourceMessageData(),hidden:!0}))}},{key:"_onLoading",value:function(){var e=this._components["records-data-table"];n2.isUndefined(e)||e.spinner()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),this.spinner(!1);var n=(this._model=e).get("totalAvailableRecords");this._insertRecordLimitMessage(),this._insertHighVolumeMessage(),this._insertSourceMessage(),this._components["high-volume-message"].hidden=!e.get("isHighVolume"),this._components["record-limit-message"].hidden=n<=this._RECORD_DISPLAY_LIMIT,this._components["source-message"].hidden=n<1,this._insertRecordsDataTable(),this._components["records-data-table"].data=e.get("availableRecords")}},{key:"_insertHighVolumeMessage",value:function(){return n2.isUndefined(this._components["high-volume-message"])||this._components["high-volume-message"].destroy(),this._insert(new n2.ui.component.HTML({id:"high-volume-message",mixins:[n2.mixin.DataDriven],model:this._model.get("objectLabelPlural"),template:this._highVolumeMessageTemplate,hidden:!0}),this.getComponentIndex("record-limit-message"))}},{key:"_getSourceMessageData",value:function(){var e=this._model.get("assignFromType").toLowerCase(),t=this._model.get("assignFrom"),n="from";return"status"===e&&(n="by",t=t.split(",")[0].replace("(","- ")),{preposition:n,assignFromType:e,assignFrom:t}}},{key:"_insertRecordsDataTable",value:function(){return n2.isUndefined(this._components["records-data-table"])||this._components["records-data-table"].destroy(),this._insert(new n2.de.component.DataTable({id:"records-data-table",columns:this._getColumns(),emptyState:{heading:"No records waiting",content:"There are no eligible records awaiting assignment at the moment"}}))}},{key:"_getColumns",value:function(){return[{header:this._model.get("objectLabel"),cell:{cellTemplate:"",components:[{id:"record-name",type:n2.ui.component.Button,mixins:[n2.mixin.DataDriven],theme:n2.ui.component.button.Theme.LINK,cls:"n2_record-link",text:{bindPath:".recordName"},listeners:{click:function(e){return n2.de.page.Navigation.getInstance().openObject(e.model.recordId)}}}]}},{header:"Last modified",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.lastModifiedDate)}}},{header:"Created",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.createdDate)}}}]}},{key:"_addOkCancelButtons",value:function(){var e=this;this._addButton({id:"cancel-button",text:"Close",listeners:{click:function(){return e._onCancel()}}})}},{key:"_resetButtons",value:function(){this._components["cancel-button"].enable()}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).distributorName,e=void 0===e?null:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header={text:"Preview Tool",description:e},n2.isNull(this._model)&&this.spinner(!0)}},{key:"_insertSpinner",value:function(){this._dom.find(".slds-modal__container .slds-modal__content").insert(this.spinnerTemplate)}}]),i}(),n2.de.component.distributors.RecentDistributionsModal=function(){_inherits(n,n2.de.component.Modal);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CHANGE]),this.id="recent-distributor-modal",this._cls="n2-de-recent-distributions-modal",this.header="Recent distributions",this._DISTRIBUTION_DISPLAY_LIMIT=50,this._informationMessageTemplate='<div id="{{id}}" class="n2_distribution-limit-message slds-grid slds-m-bottom_small slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Displaying '+this._DISTRIBUTION_DISPLAY_LIMIT+" distributions, use the filters to find others.</p></div></div>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertLimitMessage(),this._insertFilters()}},{key:"_insertLimitMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:"distribution-limit-message",template:this._informationMessageTemplate,hidden:!0}))}},{key:"_insertFilters",value:function(){var e=this,t=this._insert(new n2.ui.component.Form({id:"filter-form",cls:"n2_filters slds-grid slds-wrap slds-grid_align-spread slds-p-bottom_small"}));return t.insert(new n2.ui.component.field.Combo({id:"log-duration",label:{text:"Time period",hidden:!0},placeholder:"All",cls:"slds-col slds-size_1-of-2 slds-p-right_x-small",options:[{label:"Last run",value:"LAST_RUN"},{label:"Today",value:"TODAY"},{label:"Yesterday",value:"YESTERDAY"},{label:"Last 7 days",value:"LAST_N_DAYS:7"}],sort:!1,listeners:{change:function(){return e._handleFilter()}}})),t.insert(new n2.ui.component.field.TextBox({id:"search",label:{text:"Filter names",hidden:!0},cls:"slds-col slds-size_1-of-2",placeholder:"Filter names...",icon:n2.ui.enum.Icon.SEARCH,listeners:{type:function(){return e._handleFilter()}}})),t}},{key:"_handleFilter",value:function(){var e=this._components["filter-form"],t=e.components["log-duration"].value,e=e.components.search.value,t=this._createChangeEventObject([{property:"value",type:"set"}],{data:{logDuration:t,recordName:e}});this.fire("change",t)}},{key:"_insertSpinner",value:function(){this._dom.find(".slds-modal__container .slds-modal__content").insert(this.spinnerTemplate)}},{key:"_onLoading",value:function(){this._components["filter-form"].disabled=!0,this._showDataTableSpinner()}},{key:"_onLimitedLoading",value:function(){this._showDataTableSpinner()}},{key:"_showDataTableSpinner",value:function(){var e=this._components["distributions-data-table"];n2.isUndefined(e)||e.spinner()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),this.spinner(!1),this._model=e,this._insertDistributionsDataTable(),this._components["distributions-data-table"].data=e.get("logs"),this._components["filter-form"].disabled=!1,this._components["distribution-limit-message"].hidden=e.get("logs").length<this._DISTRIBUTION_DISPLAY_LIMIT}},{key:"_insertDistributionsDataTable",value:function(){return n2.isUndefined(this._components["distributions-data-table"])||this._components["distributions-data-table"].destroy(),this._insert(new n2.de.component.DataTable({id:"distributions-data-table",columns:this._getColumns(),emptyState:{heading:"No assignments in time period",content:"Try a different time period or filter"}}))}},{key:"_getColumns",value:function(){var t=this,e=[{header:"Date",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.assignmentDate)}}},{header:this._model.get("objectName"),cell:{cellTemplate:"",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isAssignedObjectDeleted",adapter:function(e){return!1===e}},text:{bindPath:".assignedObjectRecordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Status",cls:"n2_status-column",cell:{dataAdapter:function(e){return t._getStatus(e)}}},{header:"Assigned to",bindPath:"assignedOwnerName"}];return this._model.get("isStickyDistributor")&&e.splice(2,0,{header:"Sticky",cls:"n2_sticky-column",cell:{dataAdapter:function(e){return e.isSticky?"Yes":{html:'<span class="n2_text-weak">&mdash;</span>'}}}}),e}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.assignedObjectId)}},{key:"_getStatus",value:function(e){return e.inAlert?"SLA Alert":e.isReassignedToQueue?"Reassigned":n2.isUndefined(e.rejectLogId)?e.isOnHold?"On Hold":e.inError?{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_xx-small slds-m-right_xx-small slds-icon-text-error"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}:{html:"<span>&mdash;</span>"}:"Rejected"}},{key:"_addOkCancelButtons",value:function(){var e=this;this._addButton({id:"cancel-button",text:"Close",listeners:{click:function(){return e._onCancel()}}})}},{key:"_resetButtons",value:function(){this._components["cancel-button"].enable()}},{key:"_reset",value:function(){_get(_getPrototypeOf(n.prototype),"_reset",this).call(this),this._components["filter-form"].clear()}},{key:"show",value:function(e){e=e.distributorName;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.header={text:"Recent distributions",description:e},n2.isNull(this._model)&&this.spinner(!0)}}]),n}(),n2.de.component.field.ChangeOnCloseCombo=function(){_inherits(t,n2.ui.component.field.Combo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_onBlur",value:function(){this._performBlur&&(this.validate(),this._updateDataBinding("value",this.value),this.close({maintainFocus:!1})),this._performBlur=!0}},{key:"_refreshOpened",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).focusSelectedOption;_get(_getPrototypeOf(t.prototype),"_refreshOpened",this).apply(this,arguments),this.rendered&&!this.opened&&this._multiple&&this._onChange()}}]),t}(),n2.de.component.field.DataTable=function(){_inherits(t,n2.ui.component.field.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).apply(this,arguments),this._removeDataProviderListeners()}},{key:"_removeDataProviderListeners",value:function(){var t=this;this._isDataDriven()&&this._getDataProviders(this.dataProviders).forEach(function(e){e.removeListeners("loading",{caller:t}),e.removeListeners("loaded",{caller:t}),e.removeListeners("posting",{caller:t}),e.removeListeners("posted",{caller:t}),e.removeListeners("error",{caller:t})})}}]),t}(),n2.de.component.field.DateRangePicker=function(){_inherits(t,n2.ui.component.Field);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{datePicker:".n2_date-picker",timePicker:".n2_time-picker"}),this._fieldTemplate='<div class="n2-date-range-picker">\n            <div class="n2_start-date">\n                <div class="n2_start-date-picker"></div>\n                <div class="n2_start-date-all-day"></div>\n            </div>\n            <div class="n2_end-date">\n                <div class="n2_end-date-picker"></div>\n                <div class="n2_end-date-all-day"></div>\n            </div>\n        </div>',this._labelTemplate='<label class="slds-form-element__label{{#label.hidden}} {{assistiveTextCls}}{{/label.hidden}} {{label.cls}}" for="{{id}}_field">\n            {{label.text}}\n        </label>',this._previousStartDate=null,this._currentYear=(new Date).getFullYear(),this._showTime=!1,this._hideAllDay=!1,this._startDateLabel="Starts",this._endDateLabel="Ends",this._maintainDuration=!0}},{key:"showTime",set:function(e){this._showTime!==e&&(this._showTime=e,this.startDateField.timeHidden=!this._showTime,this.endDateField.timeHidden=!this._showTime,this._setAllDayDefaultValue())}},{key:"hideAllDay",set:function(e){this._hideAllDay!==e&&(this._hideAllDay=e,this.startDateAllDayField.hidden=this._hideAllDay,this.endDateAllDayField.hidden=this._hideAllDay,this._setAllDayDefaultValue())}},{key:"startDateLabel",set:function(e){this._startDateLabel!==e&&(this._startDateLabel=e,this.startDateField.label=this._startDateLabel)}},{key:"endDateLabel",set:function(e){this._endDateLabel!==e&&(this._endDateLabel=e,this.endDateField.label=this._endDateLabel)}},{key:"maintainDuration",set:function(e){this._maintainDuration!==e&&(this._maintainDuration=e)}},{key:"startDateField",get:function(){return this.components["start-date"]}},{key:"endDateField",get:function(){return this.components["end-date"]}},{key:"startDateAllDayField",get:function(){return this.components["start-date-all-day"]}},{key:"endDateAllDayField",get:function(){return this.components["end-date-all-day"]}},{key:"_onDefined",value:function(){if(_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this,arguments),this._showTime&&!this._hideAllDay)throw new Error("Misconfiguration issue. If we are showing the all day checkboxes, then they default to true, so we hide the time fields.");this._insertComponents(),this._showTime&&(this._setDefaultStartTime(!0),this._setDefaultEndTime(!0))}},{key:"_insertComponents",value:function(){this._insertStartDate(),this._insertStartDateAllDay(),this._insertEndDate(),this._insertEndDateAllDay()}},{key:"_insertStartDate",value:function(){return this.insert(new n2.ui.component.field.DateTimePicker({id:"start-date",cls:"slds-m-bottom_medium",renderTo:".n2_start-date-picker",label:this._startDateLabel,minDate:this._getMinDate(),maxDate:this._getMaxDate(),yearRange:6,required:this.required,timeHidden:!this._showTime,hideComponentLabels:!0,listeners:{change:this._onStartDateChange,scope:this}}))}},{key:"_insertStartDateAllDay",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"start-date-all-day",cls:"slds-m-bottom_medium",renderTo:".n2_start-date-all-day",label:"All-day",value:this._getAllDayDefaultValue(),hidden:this._hideAllDay,listeners:{change:this._onStartDateAllDayChange,scope:this}}))}},{key:"_insertEndDate",value:function(){return this.insert(new n2.ui.component.field.DateTimePicker({id:"end-date",cls:"slds-m-bottom_medium",renderTo:".n2_end-date-picker",label:this._endDateLabel,minDate:this._getMinDate(),maxDate:this._getMaxDate(),yearRange:6,required:this.required,timeHidden:!this._showTime,hideComponentLabels:!0,listeners:{change:this._onEndDateChange,scope:this}}))}},{key:"_insertEndDateAllDay",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"end-date-all-day",cls:"slds-m-bottom_medium",renderTo:".n2_end-date-all-day",label:"All-day",value:this._getAllDayDefaultValue(),hidden:this._hideAllDay,listeners:{change:this._onEndDateAllDayChange,scope:this}}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).call(this),n2.isNull(this._value)||this._setFieldValue(this._value)}},{key:"_getAllDayDefaultValue",value:function(){return!this._hideAllDay||!this._showTime}},{key:"_setAllDayDefaultValue",value:function(){var e=this._getAllDayDefaultValue();this.startDateAllDayField.value=e,this.endDateAllDayField.value=e}},{key:"_onStartDateAllDayChange",value:function(e){this.startDateField.timeHidden=e.value,e.value||this._setDefaultStartTime(!1),this._onChange()}},{key:"_onEndDateAllDayChange",value:function(e){this.endDateField.timeHidden=e.value,e.value||this._setDefaultEndTime(!1),this._onChange()}},{key:"_onStartDateChange",value:function(e){var t,e=e.value;n2.isNull(e)||(t=this._calculateEndDateFromStartDate(e),this.endDateField.minTime=this._getEndDateMinTime(e,t),this.endDateField.minDate=n2.de.util.Date.getDateAsUTC(e),this._previousStartDate=this.startDateField.value,this.endDateField.value={value:t,silent:!0,validate:!1}),this._onChange()}},{key:"_calculateEndDateFromStartDate",value:function(e){var t,n=this.endDateField.value;return n2.isNull(n)?null:(n=new Date(n.getTime()),(n=this._maintainDuration&&this._isMoveEndDateRequired()?this._getUpdatedEndDate():n)<e&&(n=new Date(e.getTime()),t=(e=_slicedToArray(this.endDateField.timePickerField.value,2))[0],e=e[1],n.setUTCHours(t,e)),n)}},{key:"_onEndDateChange",value:function(){this.endDateField.minTime=this._getEndDateMinTime(this.startDateField.value,this.endDateField.value),this._onChange()}},{key:"_setDefaultStartTime",value:function(e){this.startDateField.components["time-picker"].value={value:[9,0],silent:e,validate:!1}}},{key:"_setDefaultEndTime",value:function(e){this.endDateField.components["time-picker"].value={value:[17,0],silent:e,validate:!1}}},{key:"_getMinDate",value:function(){return new Date(this._currentYear-1,0,1)}},{key:"_getMaxDate",value:function(){return new Date(this._currentYear+5,11,31)}},{key:"_isMoveEndDateRequired",value:function(){return!n2.isNull(this._previousStartDate)&&!n2.isNull(this.endDateField.value)}},{key:"_getUpdatedEndDate",value:function(){var e=this.endDateField.value;return n2.modifyDate(e,this._getStartDateChange())}},{key:"_getStartDateChange",value:function(){return(new Date(this.startDateField.value.getTime()).setUTCHours(0,0,0,0)-new Date(this._previousStartDate.getTime()).setUTCHours(0,0,0,0))/864e5}},{key:"_isSameDate",value:function(e,t){return!n2.isNull(e)&&!n2.isNull(t)&&0==new Date(e.getTime()).setUTCHours(0,0,0,0)-new Date(t.getTime()).setUTCHours(0,0,0,0)}},{key:"_getEndDateMinTime",value:function(e,t){return this._isSameDate(e,t)?this.startDateField.timePickerField.value:[0,0]}},{key:"_removeTimeFromDate",value:function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}},{key:"_setFieldValue",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.silent,t.sync,t.validate;n2.isNull(e)||(t=e[0],n2.isDateObject(t.date)&&(this.startDateAllDayField.value=n2.isUndefined(t.isAllDay)?this._getAllDayDefaultValue():t.isAllDay,this.startDateField.value=t.date),t=e[1],n2.isDateObject(t.date)&&(this.endDateAllDayField.value=n2.isUndefined(t.isAllDay)?this._getAllDayDefaultValue():t.isAllDay,this.endDateField.value=t.date))}},{key:"_getValue",value:function(){return{startDate:this.startDateField.value,startIsAllDay:this.startDateAllDayField.value,endDate:this.endDateField.value,endIsAllDay:this.endDateAllDayField.value}}},{key:"validate",value:function(){var e=this.startDateField.validate(),t=this.endDateField.validate();return this._isValid=e&&t,this._isValid}},{key:"clear",value:function(){_get(_getPrototypeOf(t.prototype),"clear",this).call(this),this.startDateField.clear(),this.endDateField.clear()}}]),t}(),n2.de.component.field.MaxSelectMultipleCombo=function(){_inherits(t,n2.ui.component.field.Combo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._multiple=!0,this._maxItems=null}},{key:"maxItems",set:function(e){this._maxItems!==e&&(n2.isNull(this._maxItems)||n2.isFiniteNumber(this._maxItems))&&(this._maxItems=e,this._refreshMaxItems())}},{key:"_setFieldValue",value:function(e){_get(_getPrototypeOf(t.prototype),"_setFieldValue",this).apply(this,arguments),this._refreshMaxItems()}},{key:"_onListBoxChange",value:function(e){this._multiple&&!n2.isNull(this._maxItems)&&this._getValue().length>this._maxItems?e.target.select(!1):_get(_getPrototypeOf(t.prototype),"_onListBoxChange",this).apply(this,arguments)}},{key:"_getInputFieldValue",value:function(){var e,t=this._getValue();return this._multiple&&1<t.length?(e="".concat(t.length," Options Selected"),n2.isNull(this._maxItems)||t.length!==this._maxItems?e:e+" (max)"):(t=this._getSelectedOption(),n2.isNull(t)?"":t.label)}},{key:"_refreshMaxItems",value:function(){var e,n=this;this._multiple&&(n2.isNull(this._maxItems)?this._refreshInputFieldValue():(e=this._getValue(),this._maxItems>=e.length||this.listBox.forEachOption(function(e,t){t>=n._maxItems&&e.select(!1)})))}}]),t}(),n2.de.component.field.Picker=function(){_inherits(t,n2.ui.component.Field);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{field:".n2_target",focusTarget:".n2_target",pickerValue:".n2_target .n2_value"}),this._componentCls="n2-de-picker",this._focusable=n2.ui.enum.Focusable.ACTIVE,this._defaultValue=[],this._fieldTemplate='<div class="n2_target slds-input-has-icon slds-input-has-icon_right">{{> targetTemplate }}</div>',this._targetTemplate='<span class="n2_value"></span><span class="slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right">{{{icon}}}</span>',this._placeholder="Choose...",this._opened=!1,this._showClear=!1,this._REFRESH=n2.merge(this._REFRESH,{placeholder:["pickerValue"],showClear:["showClear"]})}},{key:"placeholder",set:function(e){this._setProperty("placeholder",e,{sync:!1})}},{key:"showClear",set:function(e){this._setProperty("showClear",e,{sync:!1})}},{key:"popover",get:function(){throw new Error("Please define a popover that provides the field with it's selection")}},{key:"clearButton",get:function(){return this._components["clear-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertClearButton()}},{key:"_insertClearButton",value:function(){var e=this;return this._showClear?this._insert(new n2.ui.component.Button({id:"clear-button",icon:n2.ui.enum.Icon.CLEAR,renderTo:{target:this.SELECTORS.pickerValue,position:"afterend"},title:"Clear",cls:"slds-input__icon slds-input__icon_right slds-button slds-button_icon n2_clear-picker",listeners:{click:function(){return e.clear()}}})):null}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{icon:n2.ui.Icon.getSVG(n2.ui.enum.Icon.DOWN,{cls:"slds-icon slds-icon slds-icon_x-small slds-icon-text-default"})})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{targetTemplate:this._targetTemplate})}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).apply(this,arguments),this._bindTargetEvents(),this._disabled&&this._disableField()}},{key:"_bindTargetEvents",value:function(){this.element("field").listen("keyup",this._onPickerTargetKeyUp,{scope:this}),this.element("field").listen("click",this._onPickerTargetClick,{scope:this})}},{key:"_onPickerTargetKeyUp",value:function(e){n2.ui.Key.get(e.key)===n2.ui.enum.Key.ENTER&&this._onPickerTargetClick(e)}},{key:"_onPickerTargetClick",value:function(e){this._disabled||e.target.id.endsWith("clear-button")||(this._opened?this.close():this.open())}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).call(this),this._refresh(["pickerValue"])}},{key:"open",value:function(){this.popover.show(this._getPopoverConfig()),this._opened=!0}},{key:"_getPopoverConfig",value:function(){return{target:this.element("field"),cls:"n2-de-picker-popover",listeners:{change:this._onPopoverChange,scope:this}}}},{key:"_onPopoverChange",value:function(e){n2.isUndefined(e.data.hidden)||e.data.hidden&&(this._opened=!1,this.focus(),this._onChange()),e.stopPropagation()}},{key:"close",value:function(){this.popover.hide(),this._opened=!1,this._onChange()}},{key:"_onChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,e=e.sync;void 0!==e&&!e||this._updateDataBinding("value",this.value),t||(e=this._createChangeEventObject([{property:"value",type:"set"}],{data:{value:{newValue:this._value}},canBubble:!0}),this.fire("change",e))}},{key:"_getValue",value:function(){return this._value}},{key:"_setRawValue",value:function(e){this._refresh(["pickerValue"])}},{key:"_refreshPickerValue",value:function(){if(this.element("pickerValue").clear(),n2.isEmpty(this._value))return this._setPickerPlaceHolderValue(this._placeholder);this._setPickerValue(this._value)}},{key:"_refreshShowClear",value:function(){var e=this.clearButton;this._showClear||n2.isNull(e)||e.destroy(),this._showClear&&n2.isNull(e)&&this._insertClearButton()}},{key:"_setPickerPlaceHolderValue",value:function(e){this.element("pickerValue").text(e),this.element("pickerValue").addClass("n2_placeholder")}},{key:"_setPickerValue",value:function(e){this.element("pickerValue").text(this._getPickerDisplayValue(e)),this.element("pickerValue").removeClass("n2_placeholder")}},{key:"_getPickerDisplayValue",value:function(e){return e}},{key:"_disableField",value:function(){this.element("field").addClass("n2_disabled")}},{key:"_enableField",value:function(){this.element("field").removeClass("n2_disabled")}},{key:"_validateRequired",value:function(){return!n2.isEmpty(this._value)}},{key:"validate",value:function(){var e=_get(_getPrototypeOf(t.prototype),"validate",this).apply(this,arguments);return this.required&&this.popover.refresh({target:!0}),e}},{key:"destroy",value:function(){this._rendered&&(this.element("field").purgeListeners(),this.popover.destroy()),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_bindHelpText",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._bindTooltip({text:this._helpText.text,target:this.element("tooltipTarget"),trigger:this.element("tooltipTarget"),position:this._helpText.position||n2.ui.enum.Position.ABOVE,template:this._helpText.template||"<p>{{text}}</p>",refreshConfig:e})}}]),t}(),n2.de.component.field.RadioButtonGroup=function(){_inherits(t,n2.ui.component.field.RadioButtonGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_onChange",value:function(){_get(_getPrototypeOf(t.prototype),"_onChange",this).apply(this,arguments),this._value=this.value}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this.refreshOptionNames()}},{key:"_setFieldValue",value:function(t){this._forEachOptionComponent(function(e){e.value={value:t===e.fieldValue,silent:!0}})}},{key:"refreshOptionNames",value:function(){var t=this;this._rendered&&this._forEachOptionComponent(function(e){e.element("field").attribute("name","".concat(t.domId,"_radio"))})}}]),t}(),n2.de.component.field.ReadOnly=function(){_inherits(t,n2.ui.component.Field);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._insertReadOnlyOutput()}},{key:"_insertReadOnlyOutput",value:function(){return this._insert(new n2.ui.component.HTML({id:"read-only-output",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.fieldContainer,model:this._value,template:'<p id="{{id}}">{{model}}</p>'}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-read-only-field")}},{key:"_getValue",value:function(){return this._components["read-only-output"].model}},{key:"_setFieldValue",value:function(e){this._components["read-only-output"].model=e}}]),t}(),n2.de.component.field.UserOrQueueField=function(){_inherits(i,n2.ui.component.Field);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._template='<div class="slds-form-element n2-component n2-de-user-or-queue-field{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}" id="{{id}}"{{#title}} title="{{title}}"{{/title}}>{{> labelTemplate}}{{> helpIconTemplate}}<div class="slds-form-element__control {{iconContainerCls}}">{{> fieldTemplate}}</div>{{> errorTemplate}}</div>',this._allowNoneOption=!0,this._teamId=null,this._modalParent=null}},{key:"allowNoneOption",set:function(e){this._allowNoneOption!==e&&(this._allowNoneOption=e)}},{key:"teamId",set:function(e){this._teamId!==e&&(this._teamId=e)}},{key:"modalParent",set:function(e){this._modalParent!==e&&(this._modalParent=e)}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._insertSelectionTypeField(),this._insertQueueSelection(),this._insertUserSelection()}},{key:"_insertSelectionTypeField",value:function(){var t=this;this.insert(new n2.de.component.field.RadioButtonGroup({id:"type-selection",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.fieldContainer,cls:"slds-m-right_medium",label:{text:"Selection type",hidden:!0},options:{bindPath:".",adapter:function(e){return t._getSelectionOptions(e)}},value:{bindPath:".selectionType"},listeners:{change:function(e){return t._onSelectionTypeFieldChange(e)}},hidden:{bindPath:".",adapter:function(e){return t._shouldHideSelectionType(e)}},sort:!1}))}},{key:"_shouldHideSelectionType",value:function(e){return!this._allowNoneOption&&!e.supportsQueues}},{key:"_getSelectionOptions",value:function(e){var t=[];return this._allowNoneOption&&t.push("None"),e.supportsQueues&&t.push("Queue"),t.push("User"),t}},{key:"_onSelectionTypeFieldChange",value:function(e){var t=this._components["queue-selection"],n=this._components["user-selection"];switch(t.hidden="Queue"!==e.value,n.hidden="User"!==e.value,e.value){case"Queue":this._model.getProperty("selectedId").value=t.value;break;case"User":var i=this._getUserSelectionModal({renderTo:this._dom.parent}).selectedUser;this._model.getProperty("selectedId").value=n2.isNull(i)?"":i.id;break;default:this._model.getProperty("selectedId").value="None"}}},{key:"_insertQueueSelection",value:function(){var t=this;this.insert(new n2.ui.component.field.Combo({id:"queue-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-available-source-queues"],renderTo:this.SELECTORS.fieldContainer,cls:"n2_queue-selection slds-m-top_x-small slds-m-left_large slds-p-right_small",label:{text:"Select Queue",hidden:!0},hidden:{bindPath:".selectionType",adapter:function(e){return"Queue"!==e}},required:this.required,options:{bindPath:"get-available-source-queues",adapter:function(e){return e.map(function(e){return{label:e.name,value:e.id}})}},value:{bindPath:".selectedId"},listeners:{change:function(e){t.validate()}}}))}},{key:"_insertUserSelection",value:function(){var t=this;return this.insert(new n2.de.component.field.userOrQueueField.TextBoxButton({id:"user-selection",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.fieldContainer,label:{text:"Select User",hidden:!0},required:!0,placeholder:"Choose a user...",cls:"n2_user-selection slds-m-top_x-small slds-m-left_large slds-p-right_small",hidden:{bindPath:".selectionType",adapter:function(e){return"User"!==e}},value:{bindPath:".selectedName"},listeners:{click:function(e){t._getUserSelectionModal().show({listeners:{submit:function(e){e=e.selectedUser;t._model.getProperty("selectedId").value=e.id,t.validate()}}})}}}))}},{key:"_getUserSelectionModal",value:function(){var e;return this.rendered?(e=this._modalParent?document.querySelector(this._modalParent):this._dom.parent,n2.de.component.UserSelectionModal.getInstance({teamId:this._teamId,renderTo:e})):null}},{key:"_onLoaded",value:function(e,t){var n=this;_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this.clearInvalid(),this._components["type-selection"].model=e,this._components["queue-selection"].model=e,(this._components["user-selection"].model=e).getProperty("selectionType").listen("change",function(){return n._onSelectionTypeChange()},this),e.getProperty("selectedId").listen("change",function(){return n._onSelectedIdChange()},this),t=this._getUserSelectionModal(),n2.isNull(t)||n2.isNull(t.selectedUser)||t.reset(),this._loadQueues())}},{key:"_onSelectionTypeChange",value:function(e){this.clearInvalid(),this._onChange()}},{key:"_onSelectedIdChange",value:function(e){"User"===this._model.get("selectionType")&&this._refreshUserSelectedName(),this._onChange()}},{key:"_refreshUserSelectedName",value:function(){var e=this._getUserSelectionModal().selectedUser;this._components["user-selection"].value={value:n2.isNull(e)?"":e.name,validate:!1}}},{key:"_validateRequired",value:function(){return!(!this._allowNoneOption||"None"!==this._model.get("selectionType"))||!n2.isEmpty(this._model.get("selectedId"))&&!n2.isEmpty(this._model.get("selectionType"))}},{key:"clearInvalid",value:function(){_get(_getPrototypeOf(i.prototype),"clearInvalid",this).call(this),this._components["type-selection"].clearInvalid(),this._components["queue-selection"].clearInvalid(),this._components["user-selection"].clearInvalid()}},{key:"_loadQueues",value:function(){n2.DataProviderManager.getInstance().get("get-available-source-queues").get({params:[this._teamId,this._model.get("objectName"),!0],force:!0})}}]),i}(),n2.de.component.field.SourceSelection=function(){_inherits(s,n2.de.component.field.UserOrQueueField);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._defaultStatusField=null,this._allowNoneOption=!1}},{key:"_insertStatusSelection",value:function(){var i=this,e=this._components["status-selection"];return n2.isUndefined(e)||e.destroy(),(e=this._insert(new n2.de.component.form.FieldGroup({id:"status-selection",mixins:[n2.mixin.DataDriven],hidden:{bindPath:".selectionType",adapter:function(e){return"Status"!==e}}}))).insert(new n2.ui.component.field.Combo({id:"status-field-selection",cls:"slds-m-top_x-small",mixins:[n2.mixin.DataDriven],dataProviders:["get-available-status-fields"],label:{text:"Select Status Field",hidden:!1},required:!0,options:{bindPath:"get-available-status-fields",adapter:function(e){return e.options}},value:{bindPath:".selectedStatusField"},listeners:{loaded:function(e,t,n){return i._onAvailableStatusFieldsLoaded(e,t,n)}}})),e.insert(new n2.ui.component.field.Combo({id:"ready-status-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-status-field-values"],label:{text:'Value for "Ready for Distribution"',hidden:!1},required:!0,disabled:{bindPath:"get-status-field-values",defaultValue:!0,adapter:function(e){return n2.isEmpty(e)}},options:{bindPath:"get-status-field-values"},value:{bindPath:".selectedReadyStatus"},listeners:{change:function(e){return i.validate()}}})),e.insert(new n2.ui.component.field.Combo({id:"assigned-status-selection",cls:"slds-m-top_small",mixins:[n2.mixin.DataDriven],dataProviders:["get-status-field-values"],label:{text:'Value for "Assigned"',hidden:!1},required:!0,disabled:{bindPath:"get-status-field-values",defaultValue:!0,adapter:function(e){return n2.isEmpty(e)}},options:{bindPath:"get-status-field-values"},value:{bindPath:".selectedAssignedStatus"},validator:function(e){return i._validateStatusSelections()},listeners:{change:function(e){return i.validate()}}})),e}},{key:"_onAvailableStatusFieldsLoaded",value:function(e,t,n){n2.isNull(n)||"get-available-status-fields"!==n.id||(this._defaultStatusField=t.defaultValue,n2.isEmpty(this._defaultStatusField))||!n2.isEmpty(e.value)||(n="Status"===this._model.get("selectionType"),e.value={value:this._defaultStatusField,silent:!0,validate:!1,sync:n},n)||this._refreshStatusValues(this._defaultStatusField)}},{key:"_getSelectionOptions",value:function(e){e=_get(_getPrototypeOf(s.prototype),"_getSelectionOptions",this).call(this,e);return e.push("Status"),e}},{key:"_shouldHideSelectionType",value:function(){return!1}},{key:"_onSelectionTypeFieldChange",value:function(e){var t=this._components["status-selection"],n=(t.hidden="Status"!==e.value,t.components["status-field-selection"]),i=t.components["ready-status-selection"],t=t.components["assigned-status-selection"];"Status"===e.value?(this._model.getProperty("selectedStatusField").value=n2.isEmpty(n.value)&&!n2.isEmpty(this._defaultStatusField)?this._defaultStatusField:n.value,this._model.getProperty("selectedReadyStatus").value=i.value,this._model.getProperty("selectedAssignedStatus").value=t.value):(this._model.getProperty("selectedStatusField").value="",this._model.getProperty("selectedReadyStatus").value="",this._model.getProperty("selectedAssignedStatus").value=""),_get(_getPrototypeOf(s.prototype),"_onSelectionTypeFieldChange",this).call(this,e)}},{key:"_onLoaded",value:function(e,t){var n=this;_get(_getPrototypeOf(s.prototype),"_onLoaded",this).call(this,e,t),n2.isNull(t)&&((t=this._insertStatusSelection()).model=e,t.components["status-field-selection"].model=e,t.components["ready-status-selection"].model=e,(t.components["assigned-status-selection"].model=e).getProperty("selectedStatusField").listen("change",function(){return n._onSelectedStatusFieldChange()},this),e.getProperty("selectedReadyStatus").listen("change",function(){return n._onSelectedReadyStatusChange()},this),e.getProperty("selectedAssignedStatus").listen("change",function(){return n._onSelectedAssignedStatusChange()},this),this._loadStatusFields(),this._refreshStatusValues())}},{key:"_onSelectedStatusFieldChange",value:function(e){this.clearInvalid(),this._refreshStatusValues(),this._onChange()}},{key:"_refreshStatusValues",value:function(){var e=this._model,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||e.get("selectedStatusField");n2.isEmpty(t)||n2.DataProviderManager.getInstance().get("get-status-field-values").get({force:!0,params:[e.get("objectName"),t]})}},{key:"_validateRequired",value:function(){return"Status"===this._model.get("selectionType")||_get(_getPrototypeOf(s.prototype),"_validateRequired",this).call(this)}},{key:"validate",value:function(){var e=!0;return(e="Status"===this._model.get("selectionType")?this._components["status-selection"].validate():e)&&_get(_getPrototypeOf(s.prototype),"validate",this).call(this)}},{key:"_onSelectedReadyStatusChange",value:function(){this.clearInvalid(),this._onChange()}},{key:"_onSelectedAssignedStatusChange",value:function(){this.clearInvalid(),this._onChange()}},{key:"_validateStatusSelections",value:function(){return"Status"!==this._model.get("selectionType")||""===this._model.get("selectedStatusField")||""===this._model.get("selectedReadyStatus")||this._model.get("selectedReadyStatus")!==this._model.get("selectedAssignedStatus")||"Ready and Assigned values must be different"}},{key:"clearInvalid",value:function(){_get(_getPrototypeOf(s.prototype),"clearInvalid",this).call(this);var e=this._components["status-selection"];n2.isUndefined(e)||(e.components["status-field-selection"].clearInvalid(),e.components["ready-status-selection"].clearInvalid(),e.components["assigned-status-selection"].clearInvalid())}},{key:"_loadStatusFields",value:function(){n2.DataProviderManager.getInstance().get("get-available-status-fields").get({params:[this._model.get("objectName")]})}}]),s}(),n2.de.component.field.TagPicker=function(){_inherits(t,n2.de.component.field.Picker);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-tag-picker"),this.tagCollections=null,this.tagMap=null,this._placeholder="All tags"}},{key:"popover",get:function(){return n2.de.component.field.tagPicker.TagPickerPopover.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_getPopoverConfig",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getPopoverConfig",this).call(this),{tagCollections:this.tagCollections,tagMap:this.tagMap,selection:this._value})}},{key:"_onPopoverChange",value:function(e){_get(_getPrototypeOf(t.prototype),"_onPopoverChange",this).call(this,e),e.target.id.startsWith("tag-selection-")&&(this.value={value:this.popover.selection,silent:!0})}},{key:"_getPickerDisplayValue",value:function(e){var t;return 1===e.length?(t=e[0],Object.entries(this.tagMap).map(function(e){e=_slicedToArray(e,2);e[0];return e[1]}).flat().find(function(e){return e.value===t}).label):"".concat(e.length," tags selected")}}]),t}(),n2.de.component.field.UserPicker=function(){_inherits(n,n2.de.component.field.Picker);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{pickerAvatars:".n2_target .n2_avatars"}),this._componentCls="".concat(this._componentCls," n2-de-user-picker"),this._targetTemplate='<span class="n2_avatars"></span><span class="n2_value"></span>\n                <span class="slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right">{{{icon}}}</span>',this._placeholder="Pick users...",this._users=null,this._max=null,this._REFRESH=n2.merge(this._REFRESH,{users:["pickerValue"],max:["max"]})}},{key:"users",set:function(e){this._setProperty("users",e,{sync:!1})}},{key:"max",set:function(e){this._setProperty("max",e,{sync:!1})}},{key:"popover",get:function(){return n2.de.component.field.userPicker.UserPickerPopover.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_getPopoverConfig",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getPopoverConfig",this).call(this),{users:this._users,selection:this._value,max:this._max})}},{key:"_onPopoverChange",value:function(e){_get(_getPrototypeOf(n.prototype),"_onPopoverChange",this).apply(this,arguments),n2.isUndefined(e.data.selection)||(this.value={value:e.data.selection.map(function(e){return e.id}),silent:!0})}},{key:"_setPickerPlaceHolderValue",value:function(e){this._destroyAvatars(),this._insertDefaultAvatar(),_get(_getPrototypeOf(n.prototype),"_setPickerPlaceHolderValue",this).apply(this,arguments)}},{key:"_setPickerValue",value:function(e){var t=this._getSelectedUsers();this._destroyAvatars(),this._insertAvatars(t.slice(0,5)),_get(_getPrototypeOf(n.prototype),"_setPickerValue",this).apply(this,arguments)}},{key:"_refreshMax",value:function(){this.popover.max=this._max}},{key:"_destroyAvatars",value:function(){this.forEach({type:n2.ui.component.Avatar,fcn:function(e){return e.destroy()}}),this.element("pickerAvatars").clear()}},{key:"_insertDefaultAvatar",value:function(){this.element("pickerAvatars").insert('<span class="slds-avatar n2-avatar slds-avatar--circle n2_default-avatar">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.USER),"</span>"))}},{key:"_insertAvatars",value:function(e){var n=this;return e.map(function(e,t){return n._insertAvatar({id:"user-".concat(t),avatar:e.avatarUrl,displayName:e.name})})}},{key:"_insertAvatar",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.avatar,e=e.displayName;return this._insert(new n2.ui.component.Avatar({id:t,renderTo:this.SELECTORS.pickerAvatars,avatar:n,displayName:e}))}},{key:"_getPickerDisplayValue",value:function(e){var t=this._getSelectedUsers();return 1===t.length?t[0].name:"".concat(t.length," users")}},{key:"_getSelectedUsers",value:function(){var t=this;return n2.isNull(this._users)?[]:this._users.filter(function(e){return t._value.includes(e.id)})}}]),n}(),n2.de.component.field.TeamMemberPicker=function(){_inherits(t,n2.de.component.field.UserPicker);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="".concat(this._componentCls," n2-de-team-member-picker"),this._placeholder="Pick team members..."}},{key:"popover",get:function(){return n2.de.component.field.teamMemberPicker.TeamMemberPickerPopover.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,max:this._max})}},{key:"_getPickerDisplayValue",value:function(e){var t=this._getSelectedUsers();return 1===t.length?t[0].name:"".concat(t.length," team members")}}]),t}(),n2.de.component.field.TextArea=function(){_inherits(t,n2.ui.component.field.TextBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{field:"textarea",focusTarget:"textarea"}),this._fieldTemplate='<textarea class="slds-input" id="{{id}}_field"{{#disabled}} disabled="disabled"{{/disabled}}{{#hasValidation}} aria-describedby="{{id}}_error"{{#required}} required="required"{{/required}}{{/hasValidation}}{{#placeholder}} placeholder="{{placeholder}}"{{/placeholder}}{{#maxLength}} maxlength="{{maxLength}}"{{/maxLength}} value="{{value}}" ></textarea>'}}]),t}(),n2.de.component.field.UniqueNameField=function(){_inherits(t,n2.ui.component.field.TextBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._names=[],this._maxLength=45,this._nameValidationMessage="Names must be unique",this._caseSensitive=!0}},{key:"names",set:function(e){var t=this;this._names=e.map(function(e){return t._getCaseSensitiveValue(e)})}},{key:"nameValidationMessage",set:function(e){this._nameValidationMessage!==e&&(this._nameValidationMessage=e)}},{key:"caseSensitive",set:function(e){n2.compare(this._caseSensitive,e)||(this._caseSensitive=e)}},{key:"_validateCustom",value:function(){var e=this.value.trim();return this.value=e,!this._names.includes(this._getCaseSensitiveValue(e))||this._nameValidationMessage}},{key:"_getCaseSensitiveValue",value:function(e){return this._caseSensitive?e.toLowerCase():e}},{key:"_hasValidation",value:function(){return!0}}]),t}(),n2.de.component.form.FieldGroup=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{error:"#{{id}}_error",body:".n2_fields",heading:"h2"}),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this._mixins=[n2.mixin.Observable],this._template='<fieldset id="{{id}}" class="n2-de-field-group{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">{{>headingTemplate}}<div class="n2_fields"></div>{{>errorTemplate}}</fieldset>',this._headingTemplate='{{#heading}}<h2 class="slds-text-heading_small"><span>{{heading}}</span></h2>{{/heading}}',this._errorTemplate='<div class="slds-form-element__help n2_field-group-error {{hideCls}}" id="{{id}}_error"></div>',this._heading=null,this._toggleActive=!1,this._disabled=!1,this._helpText=null,this._isValid=!0}},{key:"heading",get:function(){return this._heading},set:function(e){this._heading!==e&&(this._heading=e,this._refreshHeading())}},{key:"toggleActive",get:function(){return this._toggleActive},set:function(e){this._toggleActive!==e&&(this._toggleActive=e,this._refreshToggleActive())}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this._refreshDisabled()}},{key:"helpText",get:function(){return this._helpText()},set:function(e){this._helpText!==e&&(n2.isString(e)&&(e={text:e}),this._helpText=n2.merge(this._helpText,e),this.rendered)&&this._refreshHelpText()}},{key:"isValid",get:function(){return this._isValid}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),n2.isString(this._helpText)&&(this._helpText={text:this._helpText}),n2.isNull(this._helpText)||this._insertHelpTextButton(),this._insertFields(),this._toggleActive&&this._insertToggleActiveField()}},{key:"_insertFields",value:function(){}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{heading:this._heading})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplatePartials",this).call(this),{headingTemplate:this._headingTemplate,errorTemplate:this._errorTemplate})}},{key:"_insert",value:function(e){var t=this;return(e instanceof n2.ui.component.Field||e instanceof n2.de.component.form.FieldGroup)&&(e.listen("change",function(e){return t._onFieldChange(e)},this),e instanceof n2.ui.component.field.TextBox)&&e.listen("type",function(e){return t._onFieldChange(e)},this),_get(_getPrototypeOf(n.prototype),"_insert",this).apply(this,arguments)}},{key:"_onFieldChange",value:function(e){this.fire("change",this,e)}},{key:"_refreshHeading",value:function(){var e=this.element("heading");n2.isNull(e)&&e.remove(),this._dom.insert(n2.ui.Template.render(this._headingTemplate,this._getTemplateData(),this._getTemplatePartials()),"afterbegin")}},{key:"_refreshToggleActive",value:function(){var e=this._components["toggle-active"];n2.isUndefined(e)||e.destroy(),this._toggleActive&&this._insertToggleActiveField()}},{key:"_refreshDisabled",value:function(){var t=this;this._forEachField(function(e){e.disabled=t._disabled})}},{key:"_refreshHelpText",value:function(){n2.isUndefined(this._components["help-text-button"])||this._components["help-text-button"].destroy(),n2.isNull(this._helpText)||this._insertHelpTextButton()}},{key:"_insertToggleActiveField",value:function(){var t=this;return this.insert(new n2.ui.component.field.CheckboxToggle({id:"toggle-active",cls:"n2_toggle-active n2_small",label:{text:"Activate",hidden:!0},renderTo:this.SELECTORS.heading,listeners:{change:function(e){return t._onToggleActiveChange(e)}}}))}},{key:"_onToggleActiveChange",value:function(e){}},{key:"_insertHelpTextButton",value:function(){return this.insert(new n2.ui.component.Button({id:"help-text-button",cls:"slds-m-left_xx-small n2_help-icon",icon:n2.ui.enum.Icon.INFO,iconCls:"slds-icon_x-small slds-icon-text-default",renderTo:this.SELECTORS.heading,tooltip:{text:this._helpText.text,position:this._helpText.position}}))}},{key:"validate",value:function(){var t=this;return this._isValid=!0,this._forEachField(function(e){e.hidden||e.disabled||e.destroyed||e.validate()||(t._isValid=!1)}),this._isValid}},{key:"markInvalid",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.errorMessage;this._showError(e)}},{key:"_showError",value:function(e){var t;this._rendered&&(t=this.element("error"),this._applyContainerErrorClass(),t.text(e),t.show())}},{key:"_applyContainerErrorClass",value:function(){this._dom.addClass(n2.ui.enum.CSS.HAS_ERROR)}},{key:"clearInvalid",value:function(){this._hideError()}},{key:"_hideError",value:function(){var e;this._rendered&&(e=this.element("error"),this._removeContainerErrorClass(),e.text(""),e.hide())}},{key:"_removeContainerErrorClass",value:function(){this._dom.removeClass(n2.ui.enum.CSS.HAS_ERROR)}},{key:"reset",value:function(){this._forEachField(function(e){e.reset()})}},{key:"clear",value:function(){this._forEachField(function(e){e.destroyed||e.clear()})}},{key:"_forEachField",value:function(t){var n=this;this.forEach(function(e){if(e.instanceOf(n2.ui.component.Field)||e.instanceOf(n2.de.component.form.FieldGroup))return t.call(n,e)})}},{key:"getFirstInvalidField",value:function(){var e=this._getFirstInvalidComponent();return e instanceof n2.de.component.form.FieldGroup?e.getFirstInvalidField():e}},{key:"_getFirstInvalidComponent",value:function(){var t=null;return this._forEachField(function(e){if(!e.isValid&&!e.hidden)return t=e,!1}),t}}]),n}(),n2.de.component.form.FieldFilter=function(){_inherits(o,n2.de.component.form.FieldGroup);var e,n,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-field-filter",this._heading="Field-based filter",this._toggleActive=!0,this._helpText="If defined, only records matching the filter criteria will be distributed.",this._maxRows=20,this._minRows=null,this._showLogicToggle=!0,this._referenceTypes=null,this._includeParents=!0}},{key:"maxRows",set:function(e){this._maxRows=e}},{key:"minRows",set:function(e){this._minRows=e}},{key:"showLogicToggle",set:function(e){this._showLogicToggle=e}},{key:"includeParents",set:function(e){this._includeParents=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertFilterSelection(),this._insertStandardFilter(),this._insertAdvancedFilter()}},{key:"_insertFilterSelection",value:function(){var t=this;this._insert(new n2.de.component.field.RadioButtonGroup({id:"filter-type",cls:"slds-m-bottom_medium",hidden:!0,sort:!1,label:{text:"Choose filter type",hidden:!0},options:["Standard","Advanced"],listeners:{change:function(e){return t._onFilterTypeChange(e)}}}))}},{key:"_onFilterTypeChange",value:function(e){e="Advanced"===e.value;this._model.getProperty("isAdvancedFilter").value=e,this._showFields()}},{key:"_insertStandardFilter",value:function(){var t,n,s=this,a=[n2.de.data.FieldType.BOOLEAN,n2.de.data.FieldType.COMBOBOX,n2.de.data.FieldType.CURRENCY,n2.de.data.FieldType.DATE,n2.de.data.FieldType.DATETIME,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.EMAIL,n2.de.data.FieldType.INTEGER,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.PHONE,n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.TEXTAREA],e=this._insert(new n2.ui.component.field.LogicFilter({id:"standard-filter",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-object-field-options"],required:!0,max:this._maxRows,min:this._minRows,label:{hidden:!0},hidden:!0,showLogicToggle:this._showLogicToggle,logicHidden:{bindPath:".hideLogic"},fieldOptions:{bindPath:"get-team-object-field-options",adapter:function(e){return n2.de.data.Adapters.objectFieldOptionsWithType(e,{includeFilterable:!0,includeRecordTypeId:!0,includeFiltersOnly:!0,validTypes:a,includeParents:s._includeParents})}},loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),i="".concat(s._model.get("objectName"),".").concat(n.get("name")),e.next=4,s._fetchDataProvider("get-pick-list-field-select-options",{params:[s._model.get("objectName"),n.get("name")],silent:!0,force:!1,requestId:i});case 4:i=e.sent,t.options=i.response,t.spinner(!1);case 6:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),loadRelatedObjectFieldOptions:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s._referenceTypes[t.fieldSelection.value],n2.isUndefined(n))return e.abrupt("return",[]);e.next=3;break;case 3:return e.next=5,s._fetchDataProvider("get-team-object-field-options",{params:[n],silent:!0,force:!1,requestId:n});case 5:return i=e.sent,e.abrupt("return",n2.de.data.Adapters.objectFieldOptionsWithType(i.response,{includeFilterable:!0,includeRecordTypeId:!0,validTypes:a}));case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),value:{bindPath:".logicAndFilters"}})),i=e.components["data-table"];return i.headerRow.hidden=!1,i.headerRow.components["th-1"].hidden=!0,e}},{key:"_insertAdvancedFilter",value:function(){this._insert(new n2.de.component.field.TextArea({id:"advanced-filter",mixins:[n2.mixin.DataDriven],required:!0,cls:"slds-m-bottom_x-small n2_field-x-large",label:{text:"Advanced filter",hidden:!0},hidden:!0,value:{bindPath:".advancedSoql"}})).insert(new n2.ui.component.HTML({id:"advanced-template-warning",renderTo:".slds-form-element__control",template:'<div id="{{id}}" class="slds-grid slds-m-bottom_small"> \n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n                <div class="slds-col">\n                    <p>Only suitable for Salesforce admins with experience of SOQL. Complex queries on large data sets can introduce performance and reliability issues. Please also note that advanced filters cannot be tested using the DE test tool.</p>\n                </div>\n            </div>')}))}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i,s=this,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,a),n2.isNull(n))return this._model.get("advancedFiltersEnabled")||(this._model.getProperty("isAdvancedFilter").value=!1),(i=this._components["toggle-active"])&&(i.value={value:t.get("hasFieldFilters"),silent:!0}),this._components["filter-type"].value={value:t.get("isAdvancedFilter")?"Advanced":"Standard",silent:!0},e.next=7,this._populateReferenceTypes();e.next=9;break;case 7:i=t.getProperty("logicAndFilters",{defaultValue:{filters:[]}}),this._components["standard-filter"].model=t,this._components["advanced-filter"].model=t,this._showFields(),i.listen("change",function(e){return s._onFieldChange(s._components["standard-filter"])},this);case 9:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("hasFieldFilters").value=e.value,this._showFields()}},{key:"_showFields",value:function(){if(!this._model.get("advancedFiltersEnabled"))return n2.isEmpty(this._model.getProperty("logicAndFilters").get("filters"))&&this._components["standard-filter"].components["data-table"].addRow({silent:!0}),this._showStandardFilterFieldsOnly();var e=this._model.get("hasFieldFilters"),t=this._model.get("isAdvancedFilter");this._components["filter-type"].hidden=!e,this._components["standard-filter"].hidden=!e||t,this._components["advanced-filter"].hidden=!e||!t}},{key:"_showStandardFilterFieldsOnly",value:function(){var e=this._model.get("hasFieldFilters");this._components["filter-type"].hidden=!0,this._components["standard-filter"].hidden=!e,this._components["advanced-filter"].hidden=!0}},{key:"_populateReferenceTypes",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._referenceTypes={},e.next=3,n2.DataProviderManager.getInstance().get("get-team-object-field-options").get({params:[this._model.get("objectName")]});case 3:t=e.sent,n2.forEach(t,function(e){e.isParent&&(n._referenceTypes[e.value]=e.referenceType)});case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),o}(),n2.de.component.form.Footer=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{cancel:function(e){},submit:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{message:".n2_message"}),this._mixins=[n2.mixin.Observable],this._template='<footer id="{{id}}" class="n2-de-form-footer slds-text-align_right{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}"><div class="n2_message">{{#message}}{{>messageTemplate}}{{/message}}</div></footer>',this._messageTemplate='<p class="slds-text-color_weak">{{message}}</p>',this._message="You have unsaved changes.",this._disabled=!1}},{key:"disabled",set:function(e){this._disabled!==e&&(this._disabled=e,this._makeDisabled(e))}},{key:"message",set:function(e){this._message!==e&&(this._message=e,this._showMessage(e))}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._addButtons()}},{key:"_addButtons",value:function(){var n=this;this._addButton({id:"cancel-button",text:"Cancel",disabled:this._disabled,focusable:n2.ui.enum.Focusable.INACTIVE,listeners:{click:function(e,t){n.fire("cancel",{target:e,relatedTarget:n,event:t}),n._onCancel(e,t)}}}),this._addButton({id:"save-button",text:"Save",theme:n2.ui.component.button.Theme.BRAND,disabled:this._disabled,focusable:n2.ui.enum.Focusable.INACTIVE,listeners:{click:function(e,t){n.fire("submit",{target:e,relatedTarget:n,event:t})}}})}},{key:"_onCancel",value:function(){this.message=null,this.hide()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{message:this._message})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{messageTemplate:this._messageTemplate})}},{key:"_showSpinner",value:function(){this._components["save-button"].spinner(),this._components["cancel-button"].disable()}},{key:"_hideSpinner",value:function(){this._components["save-button"].spinner(!1),this._components["cancel-button"].enable()}},{key:"_addButton",value:function(e){this.insert(new n2.ui.component.Button(e))}},{key:"_makeDisabled",value:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?(this._components["save-button"].disable(),this._components["cancel-button"].disable()):(this._components["save-button"].enable(),this._components["cancel-button"].enable())}},{key:"show",value:function(){_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this._makeFocusable(n2.ui.enum.Focusable.ACTIVE)}},{key:"_showMessage",value:function(e){var t=this.element("message");t.clear(),n2.isEmpty(this._message)||(e=n2.ui.Template.render(this._messageTemplate,{message:e}),t.insert(e))}},{key:"showSuccess",value:function(){var e=this._components["save-button"];return e.spinner(!1),e.success(),new n2.util.DelayedTask(function(){},500).start()}},{key:"showError",value:function(){this._components["cancel-button"].enable(),this._components["save-button"].spinner(!1)}},{key:"hide",value:function(){var e=this;return _get(_getPrototypeOf(t.prototype),"hide",this).apply(this,arguments),new n2.util.DelayedTask(function(){e.reset(),e._makeFocusable(n2.ui.enum.Focusable.INACTIVE)},500).start()}},{key:"reset",value:function(){this._components["cancel-button"].enable();var e=this._components["save-button"];e.spinner(!1),e.reset(),e.enable()}},{key:"_makeFocusable",value:function(e){this._components["save-button"].focusable=e,this._components["cancel-button"].focusable=e}}]),t}(),n2.de.component.form.UpdateField=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t,n,i=_createSuper(s);function s(){return _classCallCheck(this,s),i.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{keydown:function(e,t){}}),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._fieldOptions=[],this._fieldType=null,this.objectName=null,this.isPersonAccounts=null,this._fieldIndex=null,this._fieldsToHide=[]}},{key:"fieldIndex",set:function(e){var t;e!==this._fieldIndex&&(this._fieldIndex=e,e=this.components["field-to-update"],t=this._getFieldLabelWithIndex(this._fieldIndex),e.label={text:t},e.rendered)&&((e=e.element("label")).clearText(),e._rawDOM.appendChild(document.createTextNode(" "+t)))}},{key:"fieldsToHide",set:function(e){!n2.compare(e,this._fieldsToHide)&&(this._fieldsToHide=e,e=this.components["field-to-update"])&&(e.optionValuesToHide=this._fieldsToHide)}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertFieldToUpdate()}},{key:"_insertFieldToUpdate",value:function(){var t=this;return this._insert(new n2.de.component.form.updateFields.Combo({id:"field-to-update",mixins:[n2.mixin.DataDriven],dataProviders:["get-fields"],cls:"slds-m-bottom_medium n2_field-medium",label:this._getFieldLabelWithIndex(this._fieldIndex),required:!0,hidden:!0,options:{bindPath:"get-fields",adapter:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}},optionValuesToHide:this._fieldsToHide,value:{bindPath:".name"},listeners:{change:function(e){t._updateFieldType(e.value),t._clearUpdatedValue(),t._refreshFieldVisibility()}}}))}},{key:"_updateFieldType",value:function(e){this._fieldType=this._getFieldType(e),this._model.getProperty("type")?this._model.getProperty("type").value=this._fieldType:this._model.insert(this._fieldType,{key:"type"})}},{key:"_getFieldType",value:function(t){var e=this._fieldOptions.find(function(e){return e.value===t});return n2.isUndefined(e)?null:e.type}},{key:"_clearUpdatedValue",value:function(){this._model.getProperty("value")&&(this._model.getProperty("value").value=null)}},{key:"_refreshFieldVisibility",value:function(){this._components["field-to-update"].hidden=!1,this._hideUpdatedValueField(),this._showUpdatedValueField()}},{key:"_hideUpdatedValueField",value:function(){this.forEach(function(e){e.id.startsWith("updated-value-")&&(e.hidden=!0)})}},{key:"_showUpdatedValueField",value:function(){switch(this._fieldType){case n2.de.data.FieldType.STRING:this._showUpdatedValueStringField();break;case n2.de.data.FieldType.BOOLEAN:this._showUpdatedValueBooleanField();break;case n2.de.data.FieldType.PICKLIST:this._showUpdatedValuePicklistField();break;case n2.de.data.FieldType.MULTIPICKLIST:this._showUpdatedValueMultiPicklistField()}}},{key:"_showUpdatedValueStringField",value:function(){n2.isUndefined(this._components["updated-value-string"])&&this._insertUpdatedValueStringField(),this._components["updated-value-string"].model=this._model,this._components["updated-value-string"].hidden=!1,this._components["updated-value-string"].clearInvalid()}},{key:"_showUpdatedValueBooleanField",value:function(){n2.isUndefined(this._components["updated-value-boolean"])&&this._insertUpdatedValueBooleanField(),this._components["updated-value-boolean"].model=this._model,this._components["updated-value-boolean"].hidden=!1,this._components["updated-value-boolean"].clearInvalid()}},{key:"_showUpdatedValuePicklistField",value:function(){n2.isUndefined(this._components["updated-value-picklist"])&&this._insertUpdatedValuePicklistField(),this._components["updated-value-picklist"].model=this._model,this._components["updated-value-picklist"].hidden=!1,this._loadPicklistOptions(),this._components["updated-value-picklist"].clearInvalid()}},{key:"_showUpdatedValueMultiPicklistField",value:function(){n2.isUndefined(this._components["updated-value-multipicklist"])&&this._insertUpdatedValueMultiPicklistField(),this._components["updated-value-multipicklist"].model=this._model,this._components["updated-value-multipicklist"].hidden=!1,this._loadPicklistOptions(),this._components["updated-value-multipicklist"].clearInvalid()}},{key:"_insertUpdatedValueStringField",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"updated-value-string",label:"Updated value",cls:"slds-m-bottom_medium n2_field-medium",mixins:[n2.mixin.DataDriven],value:{bindPath:".value"}}))}},{key:"_insertUpdatedValueBooleanField",value:function(){return this.insert(new n2.ui.component.field.Combo({id:"updated-value-boolean",label:"Updated value",cls:"slds-m-bottom_medium n2_field-medium",required:!0,options:["true","false"],sort:!1,mixins:[n2.mixin.DataDriven],value:{bindPath:".value"}}))}},{key:"_insertUpdatedValuePicklistField",value:function(){var a=this;return this._insert(new n2.ui.component.field.Combo({id:"updated-value-picklist",mixins:[n2.mixin.DataDriven],dataProviders:["get-picklist-field-select-options"],cls:"slds-m-bottom_medium n2_field-medium",label:"Updated value",placeholder:"None",options:[],value:{bindPath:".value"},listeners:{loaded:function(e,t,n,i){var s=a._model.get("name");n2.isNull(n)||"get-picklist-field-select-options"!==n.id||n2.isNull(s)||i!==s||(e.options=t)}}}))}},{key:"_insertUpdatedValueMultiPicklistField",value:function(){var a=this;return this._insert(new n2.ui.component.field.Combo({id:"updated-value-multipicklist",mixins:[n2.mixin.DataDriven],dataProviders:["get-picklist-field-select-options"],cls:"slds-m-bottom_medium n2_field-medium",multiple:!0,label:"Updated value",placeholder:"None",options:[],listeners:{loaded:function(e,t,n,i){var s;n2.isNull(n)?(s=a._model.get("value"),e.value={value:s?s.split(";"):"",silent:!0},e.clearInvalid()):"get-picklist-field-select-options"===n.id&&(s=a._model.get("name"),n2.isNull(s)||i!==s||(e.options=t))},change:function(e){e=e.value.join(";");a._model.getProperty("value")?a._model.getProperty("value").value=e:a._model.insert(e,{key:"value"})}}}))}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),e.t0=n2.isNull(n),e.t0)return this._model=this._createUpdateFieldModel(t),this._components["field-to-update"].model=this._model,e.next=7,this._loadFieldOptions();e.next=9;break;case 7:this._setDefaultFieldType(),this._refreshFieldVisibility();case 9:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_createUpdateFieldModel",value:function(e){var t=new n2.dataProvider.Model({value:{}});return t.insert(this._model.getProperty("name",{defaultValue:""}),{key:"name"}),t.insert(this._model.getProperty("type",{defaultValue:""}),{key:"type"}),t.insert(this._model.getProperty("value",{defaultValue:""}),{key:"value"}),t}},{key:"value",get:function(){return this._model.json}},{key:"_loadFieldOptions",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("get-fields").get({params:[this.objectName,this.isPersonAccounts]});case 2:this._fieldOptions=e.sent;case 3:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_setDefaultFieldType",value:function(){this._model.get("name")&&(this._fieldType=this._getFieldType(this._model.get("name")),n2.isNull(this._fieldType))&&(this._components["field-to-update"].value=null)}},{key:"_loadPicklistOptions",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._model.get("name"),e.next=3,n2.DataProviderManager.getInstance().get("get-picklist-field-select-options").get({params:[this.objectName,t],force:!1,requestId:t});case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_prepareDOM",value:function(){var t=this;_get(_getPrototypeOf(s.prototype),"_prepareDOM",this).call(this),this.element("body").listen("keydown",function(e){t._onKeyDown(e),t.fire("keydown",t,e)})}},{key:"_onKeyDown",value:function(e){}},{key:"_getFieldLabelWithIndex",value:function(e){return n2.isNull(e)?"Field to update":"Field to update ".concat(e)}}]),s}(),n2.de.component.header.ActionMenu=function(){_inherits(t,n2.ui.component.Menu);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{pageChangeInfo:".n2_page-change-info"}),this._template='<div id="{{id}}" class="n2-component n2-menu n2-action-menu slds-dropdown-trigger slds-dropdown-trigger_click{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}{{#openedCls}} {{openedCls}}{{/openedCls}}"{{#title}} title="{{title}}"{{/title}}>\n            <div class="slds-dropdown {{positionCls}}">\n                <h3>Actions</h3>\n                <ul class="slds-dropdown__list" role="menu" aria-label="Show More">\n                </ul>\n                <div class="n2_page-change-info">\n                    {{> pageChangeInfoTemplate }}\n                </div>\n            </div>\n        </div>',this._pageChangeInfoTemplate='{{#showRecordChangeInfo}}<dl>\n            {{#createdBy}}<dt class="n2_created-by-label">Created by</dt><dd class="n2_created-by-values">{{createdBy.name}} <span class="n2_bullet"></span> {{createdBy.formattedDate}}</dd>{{/createdBy}}\n            {{#modifiedBy}}<dt class="n2_modified-by-label">Modified by</dt><dd class="n2_modified-by-values">{{modifiedBy.name}} <span class="n2_bullet"></span> {{modifiedBy.formattedDate}}</dd>{{/modifiedBy}}\n        </dl>{{/showRecordChangeInfo}}',this._createdBy=null,this._modifiedBy=null}},{key:"createdBy",set:function(e){n2.compare(this._createdBy,e)||(this._createdBy=e,this._refreshPageChangeInfo())}},{key:"modifiedBy",set:function(e){n2.compare(this._modifiedBy,e)||(this._modifiedBy=e,this._refreshPageChangeInfo())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).apply(this,arguments),{showRecordChangeInfo:!n2.isNull(this._createdBy)||!n2.isNull(this._modifiedBy),createdBy:this._formatDateInfo(this._createdBy),modifiedBy:this._formatDateInfo(this._modifiedBy)})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).apply(this,arguments),{pageChangeInfoTemplate:this._pageChangeInfoTemplate})}},{key:"_refreshPageChangeInfo",value:function(){var e;this._rendered&&((e=this.element("pageChangeInfo")).clear(),e.insert(n2.ui.Template.render(this._pageChangeInfoTemplate,this._getTemplateData())))}},{key:"_formatDateInfo",value:function(e){return n2.isNull(e)?null:{name:e.name,formattedDate:n2.de.util.Date.formatTimestamp(e.timestamp)}}}]),t}(),n2.de.component.hours.ShiftDay=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["day","dayKey"]),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){},click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{blocksContainer:".n2_shift-blocks"}),this._mixins=[n2.mixin.Observable],this._template='<div id="{{id}}" class="n2-component n2-de-shift-day slds-grid {{cls}}">\n            <div class="n2_shift-blocks slds-grid"></div>\n        </div>',this.day=null,this.dayKey=null,this._minTime=[0,0],this._data=[]}},{key:"minTime",set:function(e){this._minTime!==e&&(this._minTime=e,this._refreshMinTime())}},{key:"data",get:function(){return this._updateRawData(),this._data},set:function(e){this._data=e||[],this._refreshData(),this._onChange()}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._insertComponents()}},{key:"validate",value:function(){var t=!0;return this._forEachTimeRangePicker(function(e){e.validate()||(t=!1)}),t}},{key:"_insertComponents",value:function(){var t=this,e=0<this._data.length;this.insert(new n2.ui.component.field.CheckboxToggle({id:"toggle-available",cls:"n2_small",renderTo:{position:"afterBegin"},label:{text:"Available",hidden:!0},value:e,listeners:{change:function(e){return t._onToggleActiveChange(e)}}})),this.insert(new n2.ui.component.HTML({id:"day-label",renderTo:{position:"afterBegin"},template:'<span class="n2-de-day-label">'.concat(this.day.substring(0,3),"</span>")})),this.insert(new n2.ui.component.Button({id:"add-block-button",text:"Add block",cls:"slds-m-right_xx-small",hidden:!e,listeners:{click:function(e){return t._onAddBlockClick(e)}}})),this.insert(new n2.ui.component.Button({id:"copy-all-button",text:"Copy to all",hidden:!e,listeners:{click:function(e){return t._onCopyToAllButtonClick(e)}}})),this._insertTimeRangePickers()}},{key:"_onToggleActiveChange",value:function(e){e.value?(this.element("blocksContainer").removeClass(n2.ui.enum.CSS.HIDE),this._components["add-block-button"].hidden=!1,this._components["copy-all-button"].hidden=!1,0===this._data.length&&(this._insertTimeRangePicker({minTime:this._minTime}),this._enableDisableAddBlock())):(this.element("blocksContainer").addClass(n2.ui.enum.CSS.HIDE),this._components["add-block-button"].hidden=!0,this._components["copy-all-button"].hidden=!0,this.forEach({type:n2.de.component.hours.TimeRangePicker,fcn:function(e){e.destroy()}})),this._onChange(e)}},{key:"_onAddBlockClick",value:function(e){var t=[],n=(this._forEachTimeRangePicker(function(e){e.showRemove=!0,t.push(e)}),t[t.length-1].value);this._insertTimeRangePicker({index:t.length,showRemove:!0,minTime:[n.endHour,n.endMinute]}),this._enableDisableAddBlock(),this._onChange(e)}},{key:"_onCopyToAllButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}},{key:"_insertTimeRangePickers",value:function(){var n,i=this,s=1<this._data.length,a=this._minTime;n2.forEach(this._data,function(e,t){n=i._insertTimeRangePicker({block:e,index:t,showRemove:s,minTime:a}),n=n.value,a=[n.endHour,n.endMinute]}),this._enableDisableAddBlock()}},{key:"_insertTimeRangePicker",value:function(e){var t=this,n=e.block,n=void 0===n?null:n,i=e.index,s=e.showRemove,s=void 0!==s&&s,e=e.minTime,e=void 0===e?[0,0]:e;return this.insert(new n2.de.component.hours.TimeRangePicker({id:"time-picker-".concat(void 0===i?0:i),renderTo:this.SELECTORS.blocksContainer,label:{text:"Shift block",hidden:!0},cls:"slds-p-right_x-small",required:!0,showRemove:s,minTime:e,value:n,listeners:{change:function(e){return t._onBlockChange(e)},click:function(e){return t._onTimeRangePickerClick(e)}}}))}},{key:"_onBlockChange",value:function(t){var n,i=!1,s=t.value;this._forEachTimeRangePicker(function(e){t===e?i=!0:i&&(24<=(n=[s.endHour,s.endMinute])[0]?e.destroy():(e.minTime=n,s=e.value))}),this._enableDisableRemove(),this._enableDisableAddBlock(),this._onChange(t)}},{key:"_enableDisableRemove",value:function(){var e=this._getTimeRangePickers();1===e.length&&(e[0].showRemove=!1)}},{key:"_onTimeRangePickerClick",value:function(e){"remove-button"===e.target.id&&this._onRemoveBlockClick(e.currentTarget)}},{key:"_onRemoveBlockClick",value:function(e){e.destroy(),this._updateRawData(),this._forEachTimeRangePicker(function(e){e.destroy()}),this._insertTimeRangePickers(),this._onChange(e)}},{key:"_refreshData",value:function(){this.forEach(function(e){e.destroy()}),this._insertComponents()}},{key:"_refreshMinTime",value:function(){var e;this.rendered&&0<(e=this._getTimeRangePickers()).length&&(e[0].minTime=this._minTime)}},{key:"_getTimeRangePickers",value:function(){var t=[];return this._forEachTimeRangePicker(function(e){t.push(e)}),t}},{key:"_forEachTimeRangePicker",value:function(t){var n=this;this.forEach({includeDestroyed:!1,type:n2.de.component.hours.TimeRangePicker,fcn:function(e){return t.call(n,e)}})}},{key:"_enableDisableAddBlock",value:function(){var e=this._getTimeRangePickers();if(0===e.length||2<e.length)return this._components["add-block-button"].disable();24<=e[e.length-1].value.endHour?this._components["add-block-button"].disable():this._components["add-block-button"].enable()}},{key:"_updateRawData",value:function(){var t=this;this._data=[],this._components["toggle-available"].value&&this._forEachTimeRangePicker(function(e){t._data.push(e.value)})}},{key:"_onChange",value:function(){this.fire("change",{target:0<arguments.length&&void 0!==arguments[0]?arguments[0]:this,currentTarget:this})}}]),t}(),n2.de.component.hours.ShiftDays=function(){_inherits(t,n2.ui.component.Field);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._fieldTemplate='<div class="n2-de-shift-days slds-grid slds-grid_vertical"></div>',this._defaultValue={}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._insertShiftDays()}},{key:"_insertShiftDays",value:function(){var n=this,i=this._getMinTime(this._value[7]);n2.forEach(n2.de.enum.Date.DAYS,function(e,t){n.insert(new n2.de.component.hours.ShiftDay({id:"shift-day-".concat(t),cls:"slds-m-bottom_x-small",day:e,dayKey:t,data:n._value[t],minTime:i,listeners:{change:function(e){return n._onShiftDayChange(e)},click:function(e){return n._onShiftDayClick(e)}}})),i=n._getMinTime(n._value[t])}),this._refreshCopyAllButtons()}},{key:"_onShiftDayChange",value:function(e){var e=e.currentTarget,t=parseInt(e.dayKey)+1;this._components["shift-day-".concat(t=7<t?1:t)].minTime=this._getMinTime(e.data),this._refreshCopyAllButtons(),this._onChange()}},{key:"_onShiftDayClick",value:function(e){"copy-all-button"===e.target.id&&this._onCopyToAll(e.currentTarget)}},{key:"_onCopyToAll",value:function(t){var n=t.data;this.forEach({includeDestroyed:!1,type:n2.de.component.hours.ShiftDay,fcn:function(e){t!==e&&0<e.data.length&&(e.data=n)}}),this._onChange()}},{key:"_setFieldValue",value:function(){this._value=n2.de.component.hours.Util.joinAcrossDays(this._value),this._refreshShiftDays()}},{key:"_getValue",value:function(){var t,n={};return this._forEachShiftDay(function(e){0<(t=e.data).length&&(n[e.dayKey]=t)}),n2.de.component.hours.Util.splitAcrossDays(n)}},{key:"_validateRequired",value:function(){var t=!0;return this._forEachShiftDay(function(e){e.validate()||(t=!1)}),t}},{key:"_showError",value:function(e){}},{key:"_forEachShiftDay",value:function(t){var n=this;this.forEach({includeDestroyed:!1,type:n2.de.component.hours.ShiftDay,fcn:function(e){return t.call(n,e)}})}},{key:"_refreshShiftDays",value:function(){var t=this;this._forEachShiftDay(function(e){t.remove(e,{destroy:!0})}),this._insertShiftDays()}},{key:"_refreshCopyAllButtons",value:function(){var t=0;this._forEachShiftDay(function(e){0<e.data.length&&t++}),this.forEach({type:n2.de.component.hours.ShiftDay,fcn:function(e){e=e.components["copy-all-button"];t<=1?e.disable():e.enable()}})}},{key:"_getMinTime",value:function(e){return n2.isUndefined(e)||0===e.length||(e=e[e.length-1]).endHour<24?[0,0]:24===e.endHour?[0,e.endMinute]:[e.endHour-24,e.endMinute]}}]),t}(),n2.de.component.hours.ShiftHours=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{shiftDays:".n2_shift-days"}),this._componentCls="n2-de-shift-hours",this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <div class="n2_shift-days">\n                {{>dayTemplate}}\n            </div>\n        </div>',this._dayTemplate='{{#days}}\n            <div id="{{id}}" class="n2_shift-day slds-grid {{cls}}">\n                <span class="slds-col n2_day">{{day}}</span>\n                <span class="slds-col n2_shift-block-container">\n                    {{#hourBlocks}}\n                        <span class="n2_shift-block">{{startTime.hour}}:{{startTime.minute}}{{startTime.meridiem}} to {{endTime.hour}}:{{endTime.minute}}{{endTime.meridiem}}</span>\n                    {{/hourBlocks}}\n                    {{^hourBlocks}}\n                        <span class="n2_shift-block n2_off">Off</span>\n                    {{/hourBlocks}}\n                </span>\n            </div>\n        {{/days}}',this._shiftDays=null}},{key:"shiftDays",set:function(e){this._shiftDays=e,this._refresh()}},{key:"_formatShiftDays",value:function(e){return n2.de.component.hours.Util.formatShiftDays(e,{idPrefix:"".concat(this.domId,"_shift-day")})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{days:this._formatShiftDays(this._shiftDays)})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{dayTemplate:this._dayTemplate})}},{key:"_refresh",value:function(){this._refreshDays()}},{key:"_refreshDays",value:function(){var e,t=this.element("shiftDays");n2.isNull(t)||t.clear(),n2.isNull(this._shiftDays)||(e=this._formatShiftDays(this._shiftDays),e=n2.ui.Template.render(this._dayTemplate,{days:e},this._getTemplatePartials()),t.insert(e),this.element("shiftDays",!0))}}]),t}(),n2.de.component.hours.ShiftHoursModal=function(){_inherits(r,n2.de.component.Modal);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{change:function(){}}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this.id="shift-hours-modal",this._cls="n2-de-shift-hours-modal",this._size="large",this._SHIFT_DAYS_HELP_TEXT={text:"Each day may have up to three blocks of working hours during which records are distributed.",position:n2.ui.enum.Position.BELOW}}},{key:"shiftHoursForm",get:function(){return this._components["shift-hours-form"]}},{key:"shiftNameField",get:function(){return this.shiftHoursForm.components["shift-name"]}},{key:"shiftDaysField",get:function(){return this.shiftHoursForm.components["shift-days"]}},{key:"timezoneField",get:function(){return this.shiftHoursForm.components["shift-timezone"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e={};return e.isShiftHours=!this.shiftNameField.hidden,e.isShiftHours&&(e.name=this.shiftNameField.value),e.days=this.shiftDaysField.value,e.timezone=this.timezoneField.value,e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(r.prototype),"_onDefined",this).call(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){var e=this;this.insert(new n2.ui.component.Form({id:"shift-hours-form",components:[{type:n2.de.component.field.UniqueNameField,id:"shift-name",cls:"n2_field-width slds-m-bottom_medium",label:"Name",required:!0,listeners:{change:function(){return e._onFieldChange()}}},{type:n2.de.component.hours.ShiftDays,id:"shift-days",label:"Hours",helpText:this._SHIFT_DAYS_HELP_TEXT,required:!0,listeners:{change:function(){return e._onFieldChange()}}},{type:n2.ui.component.field.Combo,id:"shift-timezone",cls:"n2_wide-field",label:"Timezone",required:!0,sort:!1,options:["Europe/London"],listeners:{change:function(){return e._onFieldChange()}}}]}))}},{key:"_onFieldChange",value:function(){this.fire("change")}},{key:"_onSubmit",value:function(){this.shiftHoursForm.validate()&&_get(_getPrototypeOf(r.prototype),"_onSubmit",this).call(this)}},{key:"show",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(a=0<o.length&&void 0!==o[0]?o[0]:{}).header,t=void 0===t?"New Shift":t,n=a.model,n=void 0===n?null:n,i=a.timezoneOptions,i=void 0===i?[]:i,s=a.shiftNames,s=void 0===s?[]:s,a=a.submitButtonText,a=void 0===a?"OK":a,_get(_getPrototypeOf(r.prototype),"show",this).apply(this,o),this.header=t,this.shiftHoursForm.clear(),this.timezoneField.options=i,this.shiftNameField.names=s,n2.isNull(n)?(this._showNameField(),this.timezoneField.value=n2.de.ApplicationContext.getInstance().timeZone):this.model=n,"OK"!==a&&(this.submitButton.text=a),this.submitButton.reset(),this.cancelButton.enable();case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(r.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(e.isShiftHours?this._showNameField({name:e.name}):this.shiftNameField.hidden=!0,this.shiftDaysField.value={value:e.days,silent:!0},this.timezoneField.value={value:e.timezone,silent:!0})}},{key:"_showNameField",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).name,e=void 0===e?"":e;this.shiftNameField.hidden=!1,this.shiftNameField.value={value:e,silent:!0,validate:!1}}}]),r}(),n2.de.component.hours.TimeRangePicker=function(){_inherits(t,n2.ui.component.Field);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._fieldTemplate='<span class="n2-de-time-range-between">to</span>',this._defaultValue={startHour:0,startMinute:0,endHour:24,endMinute:0},this._minTime=[0,0],this._showRemove=!0}},{key:"minTime",set:function(e){this._minTime!==e&&(this._minTime=e),this._refreshTimeOptions()}},{key:"showRemove",set:function(e){this._showRemove!==e&&(this._showRemove=e,this._refreshRemoveButton())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._insertComponents()}},{key:"_insertComponents",value:function(){var t=this;this.insert(new n2.ui.component.field.TimePicker({id:"from-time",cls:"n2-de-time-range-from",renderTo:{target:this.SELECTORS.fieldContainer,position:"afterBegin"},label:{text:"From time",hidden:!0},required:!0,value:this._getValueForFromTime(),minTime:this._minTime,includesNextMorning:!1,listeners:{change:function(e){return t._onFromTimeChange(e)}}})),this.insert(new n2.ui.component.field.TimePicker({id:"to-time",cls:"n2-de-time-range-to",renderTo:{target:this.SELECTORS.fieldContainer,position:"beforeEnd"},label:{text:"To time",hidden:!0},required:!0,value:this._getValueForToTime(),minTime:this._components["from-time"].value,includesNextMorning:!0,listeners:{change:function(){return t._onChange()}}})),this._insert(new n2.ui.component.Button({id:"remove-button",icon:n2.ui.enum.Icon.CLOSE,cls:"slds-button_icon-border-filled n2-de-time-range-remove",renderTo:{target:this.SELECTORS.fieldContainer,position:"beforeEnd"},disabled:!this._showRemove,listeners:{click:function(e){return t._onRemoveButtonClick(e)}}}))}},{key:"_onFromTimeChange",value:function(e){this._components["to-time"].minTime=e.value,this._onChange()}},{key:"_onRemoveButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{cls:"".concat(this.cls," n2-de-time-range-picker")})}},{key:"_setFieldValue",value:function(){this._components["from-time"].value=this._getValueForFromTime(),this._components["to-time"].value=this._getValueForToTime()}},{key:"_getValue",value:function(){var e=this._components["from-time"].value,t=this._components["to-time"].value;return{startHour:e[0],startMinute:e[1],endHour:t[0],endMinute:t[1]}}},{key:"_validateRequired",value:function(){var e=this._components["from-time"].validate(),t=this._components["to-time"].validate();return e&&t}},{key:"_showError",value:function(e){}},{key:"_refreshRemoveButton",value:function(){this._showRemove?this._components["remove-button"].enable():this._components["remove-button"].disable()}},{key:"_refreshTimeOptions",value:function(){this._components["from-time"].minTime=this._minTime,this._components["to-time"].minTime=this._components["from-time"].value}},{key:"_getValueForFromTime",value:function(){return[this._value.startHour,this._value.startMinute]}},{key:"_getValueForToTime",value:function(){return[this._value.endHour,this._value.endMinute]}}]),t}(),n2.de.component.hours.Util={joinAcrossDays:function(n){var s,e,a={};return n2.isEmpty(n)||(s=null,n2.forEach(Object.keys(n2.de.enum.Date.DAYS).reverse(),function(e){var i=[],t=n[e];n2.isUndefined(t)||(t=JSON.parse(JSON.stringify(t))).reverse().forEach(function(e){var t=0===e.startHour&&0===e.startMinute,n=24===e.endHour&&0===e.endMinute;e.acrossDayHours&&t&&!n?s={endHour:24+e.endHour,endMinute:e.endMinute}:(e.acrossDayHours&&n&&!n2.isNull(s)&&(e.endHour=s.endHour,e.endMinute=s.endMinute,s=null),i.unshift(e))}),0<i.length&&(a[e]=i)}),n2.isNull(s))||(e=a[7],n2.isUndefined(e))||((e=e[e.length-1]).endHour=s.endHour,e.endMinute=s.endMinute),a},splitAcrossDays:function(s){var e,a={},o=null;return n2.forEach(n2.de.enum.Date.DAYS,function(e,t){var n=n2.isNull(o)?[]:[o],i=(o=null,s[t]);n2.isUndefined(i)||n2.forEach(i,function(e){e.acrossDayHours=24<e.endHour||24===e.endHour&&0<e.endMinute,e.acrossDayHours&&(o={acrossDayHours:!0,startHour:0,startMinute:0,endHour:e.endHour-24,endMinute:e.endMinute},e.endHour=24,e.endMinute=0),n.push(e)}),0<n.length&&(a[t]=n)}),n2.isNull(o)||(e=a[1],n2.isUndefined(e)?a[1]=[o]:e.unshift(o)),a},formatShiftDays:function(e){var i,s,a=this,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).idPrefix,o=void 0===t?"n2_hours":t;return n2.isNull(e)||n2.isUndefined(e)?null:(i=n2.de.component.hours.Util.joinAcrossDays(e),s=[],n2.forEach(n2.de.enum.Date.DAYS,function(e,t){var n=i[t];s.push({id:"".concat(o,"-").concat(t),day:e.substring(0,3),hourBlocks:n2.isUndefined(n)?null:a._getHourBlocks(n)})}),s)},_getHourBlocks:function(e){var t=this;return e.map(function(e){return t._formatHourBlock(e)})},_formatHourBlock:function(e){var t=e.startHour,n=e.startMinute,i=e.endHour,e=e.endMinute;return{startTime:{hour:this._formatHour(t),minute:this._formatMinute(n),meridiem:this._getMeridiem(t)},endTime:{hour:this._formatHour(i),minute:this._formatMinute(e),meridiem:this._getMeridiem(i)}}},_formatHour:function(e){return 24<e?"".concat(e-24):12<e?"".concat(e-12):0===e?"12":"".concat(e)},_formatMinute:function(e){e=e.toString();return 1===e.length?"0".concat(e):e},_getMeridiem:function(e){return 24<=e?"am (+1)":12<=e?"pm":"am"}},n2.de.component.recordList.AbstractEmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._componentCls="n2-de-data-table-empty-state",this._mixins=[n2.mixin.Observable],this._illustration=n2.de.illustration.Desert,this._buttonText="New"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._canInsertAddButton()&&this._insertAddButton()}},{key:"_canInsertAddButton",value:function(){return!0}},{key:"_insertAddButton",value:function(){return this._insert(new n2.ui.component.Button({id:"empty-state-add-new",text:"Add ".concat(this._buttonText),theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._handleAddButtonClick,scope:this}}))}},{key:"_insertAddSplitButton",value:function(e){var t=e.text,e=e.menuOptions;return this.insert(new n2.ui.component.SplitButton({id:"empty-state-add-new-split-button",cls:"n2_empty-state-split-button",buttonText:"Add ".concat(t),menuOptions:e,listeners:{click:this._handleAddButtonClick,select:this._handleSelection,scope:this}}))}},{key:"_handleAddButtonClick",value:function(e){this.fire("click",this._createEvent(e,{data:{actions:["add-new"]}}))}},{key:"_handleSelection",value:function(e){e=e.target;this.fire("click",this._createEvent(e))}}]),t}(),n2.de.component.recordList.AbstractFooter=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this.SELECTORS=n2.merge(this.SELECTORS,{details:".n2_filter-details",button:".n2_clear-filters"}),this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <span class="n2_filter-details"></span>\n            <span class="n2_clear-filters"></span>\n        </div>',this._componentCls="n2-de-record-list-footer",this.hidden=!0,this._count={filtered:0,displayed:0}}},{key:"count",set:function(e){n2.compare(this._count,e)||(this._count=e,this.refresh())}},{key:"clearFiltersButton",get:function(){return this.components["clear-filters-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){}},{key:"_insertClearFiltersButton",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).text;return this.insert(new n2.ui.component.Button({id:"clear-filters-button",cls:"n2_clear-filters-button",renderTo:this.SELECTORS.button,text:void 0===e?"Clear Filters":e,theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._handleClick,scope:this}}))}},{key:"_handleClick",value:function(e){this.fire("click",this._createEvent(e))}},{key:"refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.component,t=void 0!==t&&t,n=e.details,n=void 0!==n&&n,i=e.button,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshComponent(),(e||n)&&this._refreshDetails(),(e||i)&&this._refreshButton()}},{key:"_refreshComponent",value:function(){this.hidden=0===this._count.filtered}},{key:"_refreshDetails",value:function(){this.element("details").clear(),this.element("details").text("Showing ".concat(this._count.displayed," ").concat(this._getRowName()," (").concat(this._count.filtered," hidden by filters)"))}},{key:"_refreshButton",value:function(){this.clearFiltersButton.hidden=0===this._count.filtered}},{key:"_getRowName",value:function(){return 1===this._count.displayed?"row":"rows"}}]),t}(),n2.de.component.recordList.AbstractToolbar=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},change:function(e){}}),this._mixins=[n2.mixin.Observable],this.SELECTORS=n2.merge(this.SELECTORS,{left:".n2_left",right:".n2_right",body:".n2_right"}),this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2_left"></div>\n            <div class="n2_right"></div>\n        </div>',this._componentCls="n2-de-record-list-toolbar",this._hidden=!0}},{key:"quickFilter",get:function(){return this.components["quick-filter"]}},{key:"addNewButton",get:function(){return this.components["add-new-button"]}},{key:"addNewSplitButton",get:function(){return this.components["add-new-split-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){throw new Error("Abstract class method `_insertComponents` must be over-written")}},{key:"_insertAddButton",value:function(e){e=e.text;return this.insert(new n2.ui.component.Button({id:"add-new-button",cls:"n2_add-new-button",text:"Add ".concat(e),theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._handleClick,scope:this}}))}},{key:"_insertAddSplitButton",value:function(e){var t=e.text,e=e.menuOptions;return this.insert(new n2.ui.component.SplitButton({id:"add-new-split-button",buttonText:"Add ".concat(t),cls:"n2_add-new-button",menuOptions:e,listeners:{click:this._handleSplitButtonClick,select:this._handleSelection,scope:this}}))}},{key:"_insertQuickFilter",value:function(e){e=e.text;return this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",cls:"n2_quick-filter",label:{text:e,hidden:!0},placeholder:"".concat(e,"..."),allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{type:this._handleFilter,change:this._handleFilter,scope:this}}))}},{key:"_handleClick",value:function(e){var t={};"add-new-button"===e.id&&(t.data={actions:["add-new"]}),this.fire("click",this._createEvent(e,t))}},{key:"_handleSplitButtonClick",value:function(e){var t=e.target;e.event;this.fire("click",this._createEvent(t,{data:{actions:["add-new"]}}))}},{key:"_handleSelection",value:function(e){e=e.target;this.fire("click",this._createEvent(e))}},{key:"_handleFilter",value:function(e){e=this._createEvent(e,{data:{changes:[{property:"value",type:"set"}],actions:["filter"]}});return this.fire("change",e),e}},{key:"clear",value:function(){throw new Error("Abstract class method `clear` must be over-written")}}]),t}(),n2.de.component.summary.FilterSummary=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._template='<p id="{{id}}" class="n2-component n2-de-filter-summary{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">{{#filter}}{{>filterTemplate}}{{/filter}}</p>',this._filterTemplate='{{#filter.label}}<span id="{{id}}_filter-label" class="n2_filter-label slds-p-right_xx-small">{{filter.label}}</span>{{/filter.label}}{{#filter.name}}<span id="{{id}}_field-label" class="slds-truncate slds-p-right_xx-small"{{^noTitles}} title="{{filter.name}}"{{/noTitles}}>{{filter.name}}</span>{{/filter.name}}{{#filter.op}}<span id="{{id}}_filter-operator" class="n2_filter-label slds-p-right_xx-small">{{filter.op}}</span>{{/filter.op}}{{#filter.val}}<span id="{{id}}_filter-value" class="{{filter.valueCls}}"{{^noTitles}} title="{{filter.valueTitle}}"{{/noTitles}}>{{filter.val}}</span>{{/filter.val}}',this._summaryAsTextTemplate="{{#filter.label}}{{filter.label}} {{/filter.label}}{{#filter.name}}{{filter.name}}{{/filter.name}}{{#filter.op}} {{filter.op}}{{/filter.op}}{{#filter.valueTitle}} {{filter.valueTitle}}{{/filter.valueTitle}}",this._filter=null,this._noTitles=!1}},{key:"filter",set:function(e){n2.compare(this._filter,e)||(this._filter=e,this._refreshFilter())}},{key:"noTitles",set:function(e){n2.compare(this._noTitles,e)||(this._noTitles=e,this._refreshFilter())}},{key:"_getTemplateData",value:function(){var e=this._getFilterData();return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{filter:e,noTitles:this._noTitles})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{filterTemplate:this._filterTemplate})}},{key:"_refreshFilter",value:function(){var e;this._rendered&&(this._dom.clear(),!n2.isNull(this._filter))&&(e=n2.ui.Template.render(this._filterTemplate,this._getTemplateData()),this._dom.insert(e))}},{key:"_getFilterData",value:function(){var e,t,n,i;return n2.isNull(this._filter)?null:(e={value:t=n2.isUndefined(this._filter.val)||n2.isNull(this._filter.val)?"":this._filter.val,label:this._filter.val},n2.isUndefined(this._filter.type)||(e=n2.ui.component.field.logicFilter.Util.format({value:t,type:this._filter.type,operator:this._filter.op})),n=(t=n2.isArray(e.value))?e.value.length:0,i=n2.isUndefined(e.label)||n2.isNull(e.label)?null:e.label.toString(),n2.merge(this._filter,{valueCls:t?"n2_filter-values":"n2_filter-value slds-truncate",valueTitle:i,val:1<n?"".concat(e.value.length," items"):i}))}},{key:"getSummaryAsText",value:function(){return n2.ui.Template.render(this._summaryAsTextTemplate,this._getTemplateData())}}]),t}(),n2.de.component.summary.Summary=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{label:"h3"}),this._template='<div id="{{id}}" class="n2-component {{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><h3>{{label}}</h3>{{>contentTemplate}}</div>',this._contentTemplate="",this._componentCls="",this._label=null}},{key:"label",set:function(e){this._label!==e&&(this._label=e,this._refreshLabel())}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this.dom.addClass("n2-de-summary")}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{label:this._label,componentCls:this._componentCls})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{contentTemplate:this._contentTemplate})}},{key:"_refreshLabel",value:function(){this._rendered&&(this.element("label").clear(),this.element("label").text(this._label))}}]),t}(),n2.de.component.summary.FiltersSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters"}),this._componentCls="n2-de-filters-summary",this._contentTemplate='<div class="n2_filters slds-m-top_xx-small"></div>',this._filters=[]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshFilters()}},{key:"filters",set:function(e){n2.compare(this._filters,e)||(this._filters=e,this._refreshFilters())}},{key:"_refreshFilters",value:function(){var n=this;this._rendered&&this.destroyComponents(),n2.forEach(this._filters,function(e,t){n._insert(new n2.de.component.summary.FilterSummary({id:"".concat(t),renderTo:n.SELECTORS.filters,cls:e.cls||"slds-m-top_xx-small",filter:e}))})}}]),t}(),n2.de.component.summary.InlineFilterSummary=function(){_inherits(t,n2.de.component.summary.FilterSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._template='<span id="{{id}}" class="n2-component n2-de-filter-summary{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">{{#filter}}{{>filterTemplate}}{{/filter}}</span>'}}]),t}(),n2.de.component.summary.InlineFiltersSummary=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2-de-filters-summary"}),this._componentCls="n2-de-filters-summary",this._filters=[],this._noTitles=!1}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshFilters()}},{key:"filters",set:function(e){n2.compare(this._filters,e)||(this._filters=e,this._refreshFilters())}},{key:"_refreshFilters",value:function(){var n=this;this._rendered&&this.destroyComponents(),n2.forEach(this._filters,function(e,t){n._insert(new n2.de.component.summary.InlineFilterSummary({id:"".concat(t),cls:e.cls||"slds-m-top_xx-small",filter:e,noTitles:n._noTitles}))})}},{key:"noTitles",set:function(e){n2.compare(this._noTitles,e)||(this._noTitles=e,this._refreshFilters())}},{key:"getSummaryAsText",value:function(){var t="";return this.forEach(function(e){""!==t&&(t+=", "),t+=e.getSummaryAsText()}),t}}]),t}(),n2.de.component.summary.ListSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{items:".n2_items"}),this._componentCls="n2-de-list-summary",this._contentTemplate='<p class="n2_items slds-m-top_xx-small">{{>itemsTemplate}}</p>',this._itemsTemplate='{{#items}}<span class="n2_filter-value slds-m-right_xx-small slds-m-bottom_xx-small">{{.}}</span> {{/items}}',this._items=[]}},{key:"items",set:function(e){this._items!==e&&(this._items=e,this._refreshItems())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{items:this._items})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{itemsTemplate:this._itemsTemplate})}},{key:"_refreshItems",value:function(){var e;this._rendered&&(this.element("items").clear(),e=n2.ui.Template.render(this._itemsTemplate,{items:this._items}),this.element("items").insert(e))}}]),t}(),n2.de.component.summary.LogicFilterSummary=function(){_inherits(t,n2.de.component.summary.FilterSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._template='<li id="{{id}}" class="n2-component n2-de-logic-filter-summary{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">{{#filter}}{{>filterTemplate}}{{/filter}}</li>'}}]),t}(),n2.de.component.summary.LogicFiltersSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{container:".n2_container",logicContainer:".n2_logic-container",logic:".n2_logic",filters:".n2_filters"}),this._componentCls="n2-de-logic-filters-summary",this._contentTemplate='<div class="n2_container">{{^isAdvanced}}{{>filtersTemplate}}{{/isAdvanced}}{{#isAdvanced}}{{>advancedFiltersTemplate}}{{/isAdvanced}}</div>',this._filtersTemplate='<div class="n2_filters-container"><ol class="n2_filters"></ol><p class="slds-m-top_x-small n2_logic-container{{^logic}} slds-hide{{/logic}}"><span class="n2_filter-label slds-p-right-xx_small">Logic</span> <span class="n2_logic">{{logic}}</span></p></div>',this._advancedFiltersTemplate='<div class="n2_advanced-filters-container"><p class="slds-m-top_x-small" title="{{filtersTitle}}">{{filters}}</p></div>',this._isAdvanced=!1,this._logic=null,this._filters=[]}},{key:"isAdvanced",set:function(e){this._isAdvanced!==e&&(this._isAdvanced=e,this._refreshFilters())}},{key:"logic",set:function(e){this._logic!==e&&(this._logic=e,this._checkLogic(),this._refreshLogic())}},{key:"filters",set:function(e){n2.compare(this._filters,e||[])||(this._filters=e,this._refreshFilters())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._checkLogic(),this._refreshFilters()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{logic:this._logic,isAdvanced:this._isAdvanced,filtersTitle:this._isAdvanced?this._filters:"",filters:this._isAdvanced?this._truncate(this._filters):""})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{filtersTemplate:this._filtersTemplate,advancedFiltersTemplate:this._advancedFiltersTemplate})}},{key:"_checkLogic",value:function(){n2.isEmpty(this._logic)||!this._logic.match(/or/i)?this._logic=null:this._logic=this._logic.toUpperCase()}},{key:"_refreshLogic",value:function(){this._rendered&&(this.element("logic").clear(),this.element("logic").text(this._logic),n2.isNull(this._logic)?this.element("logicContainer").hide():this.element("logicContainer").show())}},{key:"_refreshFilters",value:function(){var e;n2.isEmpty(this._components)||this.destroyComponents(),this._isAdvanced?this._refreshAdvancedFilters():(this._rendered&&(this.element("container").clear(),e=n2.ui.Template.render(this._filtersTemplate,{logic:this._logic}),this.element("container").insert(e)),n2.isEmpty(this._filters)||this._insertLogicFilters())}},{key:"_refreshAdvancedFilters",value:function(){var e;this._rendered&&(this.element("container").clear(),e=n2.ui.Template.render(this._advancedFiltersTemplate,{isAdvanced:this._isAdvanced,filtersTitle:this._filters,filters:this._truncate(this._filters)}),this.element("container").insert(e))}},{key:"_truncate",value:function(e){return e.length<=150?e:"".concat(e.slice(0,150).trim(),"...")}},{key:"_insertLogicFilters",value:function(){var n=this;this._filters.forEach(function(e,t){n._insert(new n2.de.component.summary.LogicFilterSummary({id:"logic-filter-".concat(t),renderTo:n.SELECTORS.filters,filter:e}))})}}]),t}(),n2.de.component.tags.AbstractModifyTagAssignments=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{cancel:function(e){}}),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Observable],this._mixins),this._componentCls="n2-modify-assignments",this._lazyLoad=!0,this._userIds=null,this._collectionTagAssignments=null,this.includeFormFooter=!0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar(),this._insertForm(),this._insertEmptyState()}},{key:"assignmentsToolbar",get:function(){return this._components["modify-assignments-toolbar"]}},{key:"assignmentsForm",get:function(){return this._components["modify-assignments-form"]}},{key:"emptyState",get:function(){return this._components["modify-assignments-empty-state"]}},{key:"context",get:function(){throw new Error("No context has been set in the extending class")}},{key:"saveDataProviderId",get:function(){throw new Error("No save data provider id has been set in the extending class")}},{key:"ToolbarClass",get:function(){throw new Error("No toolbar class has been set in the extending class")}},{key:"_insertToolbar",value:function(){return this._insert(new this.ToolbarClass({id:"modify-assignments-toolbar",hidden:!1,listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertForm",value:function(){return this._insert(new n2.de.component.tags.modifyTagAssignments.Form({context:this.context,saveDataProviderId:this.saveDataProviderId,id:"modify-assignments-form",includeFooter:this.includeFormFooter,listeners:{saved:this._handleSaved,cancel:this._handleCancel,scope:this}}))}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.de.component.tags.modifyTagAssignments.EmptyState({id:"modify-assignments-empty-state",listeners:{click:this._handleClearFilters,scope:this}}))}},{key:"_handleSaved",value:function(){this.fire.apply(this,["saved"].concat(Array.prototype.slice.call(arguments)))}},{key:"_handleCancel",value:function(e){e=this._createEvent(e);this.fire("cancel",e)}},{key:"_handleClearFilters",value:function(){this.assignmentsToolbar.clear()}},{key:"_handleFilter",value:function(e){this._filterCollections(),this.assignmentsForm.isFiltering=!0,this._refresh({form:!0}),this.assignmentsForm.isFiltering=!1}},{key:"_filterCollections",value:function(){var i=this,s=this.assignmentsToolbar.collectionsFilter.value,a=0===s.length;this._collectionTagAssignments.forEach(function(e){var t=a||s.includes(e.id),n=i._filterTags(e,t);e.hidden=n||!t})}},{key:"_filterTags",value:function(e,n){var i=this.assignmentsToolbar.quickFilter.value,s=!0;return e.tagAssignments.forEach(function(e){var t;n?(t=""===i||e.tagName.toLowerCase().includes(i.toLowerCase()),e.hidden=!t,t&&(s=!1)):e.hidden=!0}),s}},{key:"show",value:function(e){var t=e.userIds;e.model;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._userIds=t,this.assignmentsForm.userIds=t,this.assignmentsToolbar.show()}},{key:"reset",value:function(){this._refresh({toolbar:!0}),this.assignmentsForm.reset()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.form,t=void 0!==t&&t,n=e.toolbar,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshForm(),(e||n)&&this._refreshToolbar()}},{key:"_refreshForm",value:function(){var e=-1===this._collectionTagAssignments.findIndex(function(e){return!e.hidden});e||(this.assignmentsForm.collectionData=this._collectionTagAssignments),this._showEmptyState(e),this.assignmentsForm.reset()}},{key:"_refreshToolbar",value:function(){this.assignmentsToolbar.reset()}},{key:"_showEmptyState",value:function(e){this.assignmentsForm.hidden=e,this.emptyState.hidden=!e}}]),n}(),n2.de.component.tags.AssignedTagsPillList=function(){_inherits(t,n2.ui.component.PillList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-de-assigned-tags-pill-list",this._pills=[],this._context=null}},{key:"context",set:function(e){this._context=e}},{key:"_onDefined",value:function(){}},{key:"pills",get:function(){return this._pills},set:function(e){n2.compare(this._pills,e)||(this._pills=e,this._refresh())}},{key:"_createPill",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new n2.de.component.tags.TagsPill({id:this._getUniquePillId(),text:e,value:n2.isNull(n)?e:n,renderTo:".slds-listbox",focusable:n2.isEmpty(this._components)&&!this._disabled?n2.ui.enum.Focusable.ACTIVE:n2.ui.enum.Focusable.INACTIVE,disabled:this._disabled,listeners:{click:function(e){return t._onTagsPillClick(e)}}})}},{key:"_onTagsPillClick",value:function(e){this._context.getInstance().selectedTagData=e.target.value}},{key:"_refresh",value:function(){this.removePills({silent:!0}),this.insertPills(this._pills,{silent:!0})}}]),t}(),n2.de.component.tags.TagsPill=function(){_inherits(n,n2.ui.component.pillList.Pill);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}})}},{key:"_bindEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),this.element("pill").listen("click",function(e){return t._onPillClick()})}},{key:"_onPillClick",value:function(){this.fire("click",this._createEvent(this))}}]),n}(),n2.de.component.wizard.Footer=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},change:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{stagesList:"ol.slds-progress__list",progressBar:".slds-progress-bar"}),this._mixins=n2.merge([n2.mixin.Observable],this._mixins),this._componentCls="n2-de-wizard-footer",this._template='<div id="{{id}}" class="n2-component slds-grid{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <div class="slds-progress slds-progress_shade">\n                <ol class="slds-progress__list"></ol>\n                {{> progressBarTemplate }}\n            </div>\n        </div>',this._progressBarTemplate='<div class="slds-progress-bar slds-progress-bar_x-small" aria-valuemin="0" aria-valuemax="100" aria-valuenow="{{progressPercentage}}" role="progressbar">\n            <span class="slds-progress-bar__value" style="width:{{progressPercentage}}%">\n                <span class="slds-assistive-text">Progress: {{progressPercentage}}%</span>\n            </span>\n        </div>',this._buttons=null,this._stages=null,this._currentStageId=null,this._stageButtons=null}},{key:"buttons",set:function(e){n2.compare(this._buttons,e)||(this._buttons=e,this._refresh({buttons:!0}))}},{key:"stages",set:function(e){n2.compare(this._stages,e)||(this._stages=e,this._refresh())}},{key:"currentStageId",get:function(){return this._currentStageId},set:function(e){this.setCurrentStageId(e)}},{key:"backButton",get:function(){return this._components["back-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"nextButton",get:function(){return this._components["next-button"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"currentStageButton",get:function(){return this._components[this._currentStageId]}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{progressPercentage:this._getProgressPercentage()})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{progressBarTemplate:this._progressBarTemplate})}},{key:"_renderChildren",value:function(e){this._insertBackButton(),this._insertCancelButton(),this._stageButtons=this._insertStages(),this._insertNextButton(),this._insertSubmitButton(),_get(_getPrototypeOf(t.prototype),"_renderChildren",this).apply(this,arguments)}},{key:"_getProgressPercentage",value:function(){return n2.isNull(this._stages)?0:Math.floor(this._getCurrentStageIndex()/(this._stages.length-1)*100)}},{key:"_insertBackButton",value:function(){var e=this._isBackButtonActive();return this._insert(new n2.ui.component.Button(n2.merge({id:"back-button",text:"Back",theme:n2.ui.component.button.Theme.NEUTRAL,renderTo:{position:"afterbegin"},hidden:!e,disabled:!e,listeners:{click:this._handleActionButtonClick,scope:this}},this._getButtonConfig("back"))))}},{key:"_insertCancelButton",value:function(){var e=this._isCancelButtonActive();return this._insert(new n2.ui.component.Button(n2.merge({id:"cancel-button",text:"Cancel",renderTo:{position:"afterbegin"},hidden:!e,disabled:!e,listeners:{click:this._handleActionButtonClick,scope:this}},this._getButtonConfig("cancel"))))}},{key:"_insertNextButton",value:function(){var e=this._isNextButtonActive();return this._insert(new n2.ui.component.Button(n2.merge({id:"next-button",text:"Next",theme:n2.ui.component.button.Theme.BRAND,renderTo:{position:"beforeend"},hidden:!e,disabled:!e,listeners:{click:this._handleActionButtonClick,scope:this}},this._getButtonConfig("next"))))}},{key:"_insertSubmitButton",value:function(){var e=this._isSubmitButtonActive();return this._insert(new n2.ui.component.Button(n2.merge({id:"submit-button",theme:n2.ui.component.button.Theme.BRAND,text:"Submit",renderTo:{position:"beforeend"},hidden:!e,disabled:!e,listeners:{click:this._handleActionButtonClick,scope:this}},this._getButtonConfig("submit"))))}},{key:"_handleActionButtonClick",value:function(e){this.fire("click",this._createEvent(e))}},{key:"_getButtonConfig",value:function(e){return n2.isNull(this._buttons)||(e=this._buttons[e],n2.isUndefined(e))?{}:e}},{key:"setCurrentStageId",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).silent,t=void 0!==t&&t;this._currentStageId!==e&&(this._currentStageId=e,this._refresh({currentStage:!0}),t||this.fire("change",this._createEvent(this,{data:{changes:["currentStageId"]}})))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.stages,t=void 0!==t&&t,n=e.currentStage,n=void 0!==n&&n,i=e.buttons,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshStages(),(e||n)&&this._refreshCurrentStage(),(e||i)&&this._refreshButtons(),this._refreshButtonStates(),this._refreshProgressBar()}},{key:"_refreshStages",value:function(){this._destroyStages(),this._stageButtons=this._insertStages()}},{key:"_destroyStages",value:function(){this._stageButtons.forEach(function(e){return e.destroy()}),this.element("stagesList").clear()}},{key:"_insertStages",value:function(){var n,i=this;return n2.isNull(this._stages)?[]:(n=this._getCurrentStageIndex(),this._stages.map(function(e,t){return i._insertStage(e,{index:t,isComplete:t<n,isCurrent:n===t})}))}},{key:"_insertStage",value:function(e,t){var n=t.index,i=t.isComplete,i=void 0!==i&&i,t=t.isCurrent,t=void 0!==t&&t,n=new n2.ui.DOM('<li id="stage-'.concat(n,'" class="').concat(this._getStageListItemCls({isComplete:i,isCurrent:t}),'"></li>')),t=new n2.ui.component.Button({id:e.id,renderTo:n,title:e.label,theme:null,cls:this._getStageButtonCls({hasIcon:i}),listeners:{click:this._handleStageButtonClick,scope:this}});return this._rendered||t.render(n),this._insert(t),this.element("stagesList").insert(n),t}},{key:"_handleStageButtonClick",value:function(e){this._getStageIndexByStageId(e.id)<=this._getCurrentStageIndex()&&this.fire("click",this._createEvent(e))}},{key:"_refreshCurrentStage",value:function(){var s=this,a=this._getCurrentStageIndex();this._stageButtons.forEach(function(e,t){var n=e.dom.parent,i=t<a;n.attribute("class",s._getStageListItemCls({isComplete:i,isCurrent:t===a})),e.cls=s._getStageButtonCls({hasIcon:i}),e.icon=s._getStageButtonIcon({isComplete:i})})}},{key:"_refreshButtons",value:function(){this.backButton.destroy(),this._insertBackButton(),this.cancelButton.destroy(),this._insertCancelButton(),this.nextButton.destroy(),this._insertNextButton(),this.submitButton.destroy(),this._insertSubmitButton()}},{key:"_refreshButtonStates",value:function(){this._refreshButton(this.backButton,{isButtonActive:this._isBackButtonActive()}),this._refreshButton(this.cancelButton,{isButtonActive:this._isCancelButtonActive()}),this._refreshButton(this.nextButton,{isButtonActive:this._isNextButtonActive()}),this._refreshButton(this.submitButton,{isButtonActive:this._isSubmitButtonActive()})}},{key:"_refreshButton",value:function(e,t){t=t.isButtonActive;e.hidden=!t,t?e.enable():e.disable()}},{key:"_refreshProgressBar",value:function(){this.element("progressBar").remove();var e=n2.ui.Template.render(this._progressBarTemplate,this._getTemplateData(),this._getTemplatePartials());this.element("stagesList").insert(e,"afterend"),this.element("progressBar",!0)}},{key:"moveToPreviousStage",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,e=void 0!==e&&e,t=this._getCurrentStageIndex();0<t&&(t=this._stages[t-1],this.setCurrentStageId(t.id,{silent:e}))}},{key:"moveToNextStage",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,e=void 0!==e&&e,t=this._getCurrentStageIndex();t<this._stages.length&&(t=this._stages[t+1],this.setCurrentStageId(t.id,{silent:e}))}},{key:"markCurrentStageInvalid",value:function(){this.currentStageButton.dom.parent.attribute("class",this._getStageListItemCls({isError:!0})),this.currentStageButton.icon=n2.ui.enum.Icon.ERROR,this.currentStageButton.cls=this._getStageButtonCls({hasIcon:!0})}},{key:"markCurrentStageValid",value:function(){this.currentStageButton.dom.parent.attribute("class",this._getStageListItemCls({isError:!1,isComplete:!1,isCurrent:!0})),this.currentStageButton.icon=null,this.currentStageButton.cls=this._getStageButtonCls({hasIcon:!1})}},{key:"markCurrentStageComplete",value:function(){this.currentStageButton.dom.parent.attribute("class",this._getStageListItemCls({isComplete:!0})),this.currentStageButton.icon=n2.de.enum.Icon.SUCCESS,this.currentStageButton.cls=this._getStageButtonCls({hasIcon:!0})}},{key:"_getStageListItemCls",value:function(e){var t=e.isComplete,t=void 0!==t&&t,n=e.isCurrent,n=void 0!==n&&n,e=e.isError,e=void 0!==e&&e;return"slds-progress__item".concat(t?" slds-is-completed":"").concat(!t&&n?" slds-is-active":"").concat(e?" slds-has-error":"")}},{key:"_getStageButtonCls",value:function(e){e=e.hasIcon;return void 0!==e&&e?"slds-progress__marker slds-progress__marker_icon":"slds-progress__marker"}},{key:"_getStageButtonIcon",value:function(e){return e.isComplete?n2.de.enum.Icon.SUCCESS:null}},{key:"_isBackButtonActive",value:function(){return!n2.isNull(this._currentStageId)&&!this._isFirstStage(this._currentStageId)}},{key:"_isCancelButtonActive",value:function(){return!!n2.isNull(this._currentStageId)||this._isFirstStage(this._currentStageId)}},{key:"_isNextButtonActive",value:function(){return!n2.isNull(this._currentStageId)&&!this._isLastStage(this._currentStageId)}},{key:"_isSubmitButtonActive",value:function(){return!!n2.isNull(this._currentStageId)||this._isLastStage(this._currentStageId)}},{key:"_isFirstStage",value:function(e){return 0===this._getStageIndexByStageId(e)}},{key:"_isLastStage",value:function(e){return this._getStageIndexByStageId(e)===this._stages.length-1}},{key:"_getCurrentStageIndex",value:function(){return this._getStageIndexByStageId(this._currentStageId)}},{key:"_getStageIndexByStageId",value:function(t){return this._stages.findIndex(function(e){return e.id===t})}}]),t}(),n2.de.enum.distributionHours.DefaultHours={TEAM_HOURS:{1:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],2:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],3:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],4:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],5:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],6:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}],7:[{acrossDayHours:!1,endHour:24,endMinute:0,startHour:0,startMinute:0}]}},n2.de.enum.distributionHours.HoursType={TEAM:"Team",SHIFT:"Shift",INDIVIDUAL:"Individual"},n2.de.enum.distributor.Method={ROUND_ROBIN:"Round robin",LOAD_BALANCING:"Load balancing",LOOKUP_OWNER:"Lookup owner",RELATED_OWNER:"Related owner",DYNAMIC_OWNER:"Dynamic owner",CURRENT_OWNER:"Current owner"},n2.de.enum.distributor.Type={STANDARD:"Distributor",PULL:"Pull",TRIGGER:"Trigger",MANUAL:"Manual"},n2.de.enum.team.AlertType={TIME_PERIOD_ALERT:"Time Period",CUSTOM_DT_ALERT:"Custom Date/Time",CONTINUOUS_ALERT:"Continuous"},n2.de.page.analytics.Distribution=function(){_inherits(o,n2.de.page.Analytics);var e,t,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-options","get-distributions-over-time","get-distributions-hourly-trend","get-time-to-action","get-user-activity"],this._componentCls="n2-de-analytics-distribution",this._heading="Distribution",this._headingIcon=n2.de.enum.Icon.CHART,this._helpLinkURL="https://help.nc-squared.com/distribution-analytics",this._filterOptions=null,this._distributionData=null,this._distributionDays=null,this._activityData=null,this._xAxisType=null,this._chartType=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["toolbar"],filterOptions:["toolbar"],distributionData:["distributionData","emptyState"],distributionDays:["distributionDays"],activityData:["activityData","emptyState"],xAxisType:["xAxisType"],chartType:["chartType"]})}},{key:"selectionToolbar",get:function(){return this._components["selection-toolbar"]}},{key:"chart",get:function(){return this._components["distribution-chart"]}},{key:"emptyState",get:function(){return this._components["empty-state"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).call(this),this._insertSelectionToolbar(),this._insertChart(),this._insertEmptyState()}},{key:"_insertSelectionToolbar",value:function(){var t=this;return this._insert(new n2.de.page.analytics.distribution.SelectionToolbar({id:"selection-toolbar",listeners:{click:function(e){return t._loadChartData(e.data)}}}))}},{key:"_insertChart",value:function(){return this._insert(new n2.de.page.analytics.distribution.Chart({id:"distribution-chart",listeners:{click:this._handleChartAction,scope:this}}))}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",illustration:n2.de.illustration.Desert,sizeCls:"slds-illustration_large",heading:"No data to display.",hidden:!0}))}},{key:"_loadChartData",value:function(e){if(n2.isNull(e))return null;switch(e.chartConfig.chartType){case"distributions-over-time":return this._setProperties({xAxisType:this._calculateXAxisType(e.chartConfig),chartType:"distribution"}),this._loadDistributionsOverTime(e);case"distributions-hourly-trend":return this._setProperties({xAxisType:"Time of day",chartType:"distribution"}),this._loadDistributionsHourlyTrend(e);case"time-to-action":return this._setProperties({xAxisType:this._calculateXAxisType(e.chartConfig),chartType:"distribution"}),this._loadTimeToAction(e);case"user-activity":return this._setProperty("chartType","activity"),this._loadUserActivity(e)}}},{key:"_loadDistributionsOverTime",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(i=1<s.length&&void 0!==s[1]?s[1]:{}).silent,n=void 0!==n&&n,i=i.force,i=void 0===i||i,e.abrupt("return",this._loadDataProvider("get-distributions-over-time",{params:[t],silent:n,force:i}));case 2:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_loadDistributionsHourlyTrend",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(i=1<s.length&&void 0!==s[1]?s[1]:{}).silent,n=void 0!==n&&n,i=i.force,i=void 0===i||i,e.abrupt("return",this._loadDataProvider("get-distributions-hourly-trend",{params:[t],silent:n,force:i}));case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_loadTimeToAction",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(i=1<s.length&&void 0!==s[1]?s[1]:{}).silent,n=void 0!==n&&n,i=i.force,i=void 0===i||i,e.abrupt("return",this._loadDataProvider("get-time-to-action",{params:[t],silent:n,force:i}));case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_loadUserActivity",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(i=1<s.length&&void 0!==s[1]?s[1]:{}).silent,n=void 0!==n&&n,i=i.force,i=void 0===i||i,e.abrupt("return",this._loadDataProvider("get-user-activity",{params:[t],silent:n,force:i}));case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-filter-options",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptions:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){return _get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-options"===t.id?this._setProperty("filterOptions",e):"get-user-activity"===t.id?this._setProperty("activityData",this._formatActivityData(e)):(e=this._formatDistributionData(e),"get-distributions-over-time"===t.id||"get-time-to-action"===t.id?this._setProperties({distributionData:e.distributionData,distributionDays:e.distributionDays}):"get-distributions-hourly-trend"===t.id?this._setProperties({distributionData:e.distributionData,distributionDays:null}):void 0)}},{key:"_onLoadComplete",value:function(e){e=e.filterOptions;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("filterOptions",e.response),0===this._filterOptions.teams.length||n2.isEmpty(this._filterOptions.distributorsMap)?this._refresh(["emptyState"]):this._loadChartData(this.selectionToolbar.chartOptions)}},{key:"_handleChartAction",value:function(e){var t;return"back-button"===e.target.id?this._loadChartData(this.selectionToolbar.chartOptions):((t=this.selectionToolbar.chartOptions).chartConfig=n2.merge(t.chartConfig,e.data),this._loadChartData(t))}},{key:"_calculateXAxisType",value:function(e){return""===e.dateLiteral?this._isSingleDay(e.startDate,e.endDate)?"Time of day":"Days":"TODAY"===e.dateLiteral?"Time of day":"Days"}},{key:"_isSingleDay",value:function(e,t){return t-e<864e5}},{key:"_formatDistributionData",value:function(e){var i,s,a;return 0===e.length?{distributionData:[],distributionDays:[]}:(s=[],a=(i=[["xLabels"]])[0],e.forEach(function(e,t){var n=[e.splitByName];e.distributionAnalyticsEntries.forEach(function(e){0===t&&(a.push(e.timestamp),s.push(e.dateTimestamp)),n.push(e.dataPointValue)}),i.push(n)}),{distributionData:i,distributionDays:s})}},{key:"_formatActivityData",value:function(e){var o=this,t={"Log out":{class:"n2_activity-log-out"},"Log in":{class:"n2_activity-log-in"}},n=[];return e.forEach(function(e){var i=[],s=[],a=n2.de.ApplicationContext.getInstance().timeZone;e.activityList.forEach(function(e){var t=new Date(e.startDatetime),n=new Date(e.endDatetime),t=new Date(t.toLocaleString("en-US",{timeZone:a})),n=new Date(n.toLocaleString("en-US",{timeZone:a}));i.push([t,e.actionName,n]),s.push(o._getDuration(t,n))}),n.push({categories:t,measure:e.userName,data:i,description:s})}),n}},{key:"_getDuration",value:function(e,t){e=moment(e),t=moment(t);return"<hr> Duration: ".concat(moment.duration(t.diff(e)).humanize())}},{key:"_refreshToolbar",value:function(){this.selectionToolbar.filterOptions=this._filterOptions}},{key:"_refreshDistributionData",value:function(){var e=0!==this._distributionData.length;this.chart.hidden=!e,this._activityData=null,e&&(this.chart.distributionData=this._distributionData)}},{key:"_refreshDistributionDays",value:function(){this.chart.distributionDays=this._distributionDays}},{key:"_refreshActivityData",value:function(){var e=0!==this._activityData.length;this.chart.hidden=!e,this._distributionData=null,e&&(this.chart.activityData=this._activityData)}},{key:"_refreshXAxisType",value:function(){this.chart.xAxisType=this._xAxisType}},{key:"_refreshChartType",value:function(){this.chart.chartType=this._chartType}},{key:"_refreshEmptyState",value:function(){var e=this.selectionToolbar.chartTypeCombo.value;if(0===this._filterOptions.teams.length)this.emptyState.content="This org has no teams or distributors to show activity for.",this.emptyState.hidden=!1;else{var t="user-activity"===e?n2.isNull(this._activityData)||0===this._activityData.length:n2.isNull(this._distributionData)||0===this._distributionData.length,n=(this.emptyState.hidden=!t,"This chart would show the distributions from your team, but there are no distributions recorded over the time period specified.");switch(e){case"time-to-action":n="This chart would show the times your team take to perform an action on a record, but there are no actions to show right now.";break;case"user-activity":n="This chart would show the availability toggle activity of your team members, but there is none recorded over the time period specified."}t&&(this.emptyState.content=n)}}}]),o}(),n2.de.page.assignmentSimulation.AssignmentSimulationModal=function(){_inherits(c,n2.de.component.Modal);var t,e,n,i,s,a,o,r,l=_createSuper(c);function c(){return _classCallCheck(this,c),l.apply(this,arguments)}return _createClass(c,[{key:"_define",value:function(){_get(_getPrototypeOf(c.prototype),"_define",this).call(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{team:".n2-team",distributor:".n2-distributor",detailedresult:".n2-link-detailed-results"}),this.id="assignment-simulation-modal",this.dataProviders=["run-assignment-simulation","get-basic-sobject-ui-vo-by-record-id","get-sobject-type-from-id","get-assignment-simulation","get-assignment-simulation-quick-result"],this._cls="n2-de-assignment-simulation-modal",this._simulationModel=null,this._header="Assignment Simulation",this._simulationType="Full Simulation",this._sourceSelection=null,this._sObjectSupportsQueues=!1,this._simulationPollingService=null,this._resultType=null,this._quickResult=null,this._noMatchTemplate='<div class="n2-simulation-quick-result-message" id="simulation-quick-result-message">\n            <div id="general-message">Distribution Engine was unable to assign this record. {{noMatchMessage}}. Click\n             <a href="javascript:void(0)" class="n2-link-detailed-results" data-id="{{simulatedDistributionId}}">here</a> for more information.</div>\n        </div>',this._matchTemplate='<div class="n2-simulation-quick-result-message" id="simulation-quick-result-message">\n            <div id="general-message">Assignment Simulator was able to assign your record. Click <a href="javascript:void(0)" class="n2-link-detailed-results" data-id="{{simulatedDistributionId}}">here</a> for more information.</div>\n            <div id="team-distributor-detail" class="n2-team-distributor-detail"><table><tr><th id="team-id">Team</th><td><a href="javascript:void(0)" class="n2-team" data-id="{{teamId}}">{{teamName}}</a></td></tr><tr><th id="distributor-id">Distributor</th><td><a href="javascript:void(0)" class="n2-distributor" data-teamid="{{teamId}}" data-id="{{distributorId}}">{{distributorName}}</a></td></tr></table></div>\n        </div>',this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["sourceSettings","simulatedDateTimeSettings","generalModalSettings"]}),this._refererURL=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(c.prototype),"_onDefined",this).call(this,arguments),this._simulationModel=this._initializeSimulationModel(),this._insertNewSimulationForm(),this._insertBackButton()}},{key:"_initializeSimulationModel",value:function(){return new n2.dataProvider.Model({value:{ignoreCaps:!1,ignoreClassifierStatus:!1,continueAfterAssignment:!1,includeInactiveTeamsAndDistributors:!1,simulatedDateTimeMillis:null,assignableObjectId:null,assignableObjectType:null,simulatedDistribution:null,status:null,isSourceOverridden:!1,sourceQueueOverride:null,sourceUserOverride:null,sourceUserOverrideName:null,sourceStatusOverrideFieldName:null,sourceStatusOverrideFieldLabel:null,sourceStatusOverride:null,errorMessage:null}})}},{key:"_insertNewSimulationForm",value:function(){var t=this,e=new n2.de.component.Form({id:"new-simulation-form",includeFooter:!1}),e=(this.SELECTORS.formBody=e.SELECTORS.formBody,e.insert(new n2.ui.component.field.TextBox({id:"record-id",mixins:[n2.mixin.DataDriven],model:this._simulationModel,label:"Record Id",placeholder:"Record Id",required:!0,allowClear:!0,value:{bindPath:".assignableObjectId"},listeners:{change:function(e){return t._onRecordIdChange(e)}},validator:function(e){e=e.value;return!(0<e.length&&15!==e.length&&18!==e.length)||"Invalid record id"},maxLength:18})),e.insert(new n2.de.component.field.ReadOnly({id:"record-type",mixins:[n2.mixin.DataDriven],model:this._simulationModel,label:"Record Type",value:{bindPath:".assignableObjectType"},disabled:!0})),e.insert(new n2.de.component.field.RadioButtonGroup({id:"simulation-type",cls:"slds-m-right_medium",label:{text:"Simulation Type"},options:["Full Simulation","Quick Simulation"],value:this._simulationType,sort:!1,listeners:{change:function(e){return t._simulationType=e.value,t._simulationType},scope:this}})),e.insert(new n2.de.page.assignmentSimulation.newSimulationModal.SimulationDateTimeSettings({id:"simulated-date-time-settings",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",heading:"Simulate Date/Time",helpText:"Simulate distribution at a certain date and time",model:this._simulationModel,listeners:{change:this._onDateTimeChange,scope:this},disabled:!0})),e.insert(new n2.de.page.assignmentSimulation.newSimulationModal.OverwriteSourceSettings({id:"overwrite-source-selection",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",heading:"Overwrite Source",helpText:"Overwrite the source value on the record under test",model:this._simulationModel,hidden:!1,disabled:!0})),e.insert(new n2.ui.component.field.Checkbox({id:"ignore-classifier-status",mixins:[n2.mixin.DataDriven],model:this._simulationModel,label:"Ignore Classifier Status",cls:"slds-m-bottom_medium",helpText:"If checked, the classifier status of the record will be ignored",value:{bindPath:".ignoreClassifierStatus"},hidden:!0})),e.insert(new n2.ui.component.field.Checkbox({id:"ignore-caps",mixins:[n2.mixin.DataDriven],model:this._simulationModel,label:"Ignore Caps",cls:"slds-m-bottom_medium",helpText:"If checked, any existing caps are ignored",value:{bindPath:".ignoreCaps"},disabled:{bindPath:".simulatedDateTimeMillis",defaultValue:!1,adapter:function(e){return!n2.isEmpty(e)}}})),e.insert(new n2.ui.component.field.Checkbox({id:"include-inactive",mixins:[n2.mixin.DataDriven],model:this._simulationModel,label:"Include inactive teams and distributors",cls:"slds-m-bottom_medium",helpText:"If checked, the simulation will include active and inactive teams and distributors",value:{bindPath:".includeInactiveTeamsAndDistributors"}})),e.insert(new n2.ui.component.field.Checkbox({id:"stop-simulation-after-assignment",label:"Stop simulation on successful assignment ",cls:"slds-m-bottom_medium",helpText:"If checked, the simulation will end with the first distributor that successfully assigns the record",value:!0,listeners:{change:function(e){return t._simulationModel.set(!e.value,{key:"continueAfterAssignment"})}}})),this.insert(e),new n2.ui.component.Form({id:"quick-result-form",hidden:!0}));this.insert(e)}},{key:"_insertBackButton",value:function(){this._addButton({id:"back-button",text:"Back",listeners:{click:this._onBackButtonClick,scope:this},hidden:!0})}},{key:"newSimulationForm",get:function(){return this.components["new-simulation-form"]}},{key:"recordIdTextBox",get:function(){return this.newSimulationForm.components["record-id"]}},{key:"ignoreClassifierStatusCheckbox",get:function(){return this.newSimulationForm.components["ignore-classifier-status"]}},{key:"ignoreCapsCheckbox",get:function(){return this.newSimulationForm.components["ignore-caps"]}},{key:"_setIgnoreCaps",value:function(e,t){var n=this.ignoreCapsCheckbox;n.value=e,n.disabled=t}},{key:"includeInactiveCheckbox",get:function(){return this.newSimulationForm.components["include-inactive"]}},{key:"stopAfterAssignmentCheckBox",get:function(){return this.newSimulationForm.components["stop-simulation-after-assignment"]}},{key:"recordTypeReadOnlyField",get:function(){return this.newSimulationForm.components["record-type"]}},{key:"simulatedDateTimeFieldGroup",get:function(){return this.newSimulationForm.components["simulated-date-time-settings"]}},{key:"overwriteSourceSelectionFieldGroup",get:function(){return this.newSimulationForm.components["overwrite-source-selection"]}},{key:"_updateSubmitButton",value:function(e,t){return this._updateButton(this._components["submit-button"],e,t)}},{key:"_updateCancelButton",value:function(e,t){return this._updateButton(this._components["cancel-button"],e,t)}},{key:"_updateBackButton",value:function(e,t){return this._updateButton(this._components["back-button"],e,t)}},{key:"_updateButton",value:function(e,t,n){return n?e.enable():e.disable(),e.hidden=t,e}},{key:"_getOKButtonConfig",value:function(){return{text:"Run simulation"}}},{key:"_onDateTimeChange",value:function(e){"simulated-date-time-settings"===e.id&&(e.isSimulatedDateTimeSet?this._setIgnoreCaps(!0,!0):this._setIgnoreCaps(!1,!1))}},{key:"_onBackButtonClick",value:function(){var e=this.components["new-simulation-form"];e.hidden=!1,e.disabled=!1,this._handleIgnoreCapsEnablement(),this._resetQuickResultForm(),this._updateBackButton(!0,!1),this._updateSubmitButton(!1,!0),this._updateCancelButton(!1,!0)}},{key:"_handleIgnoreCapsEnablement",value:function(){this.simulatedDateTimeFieldGroup.isSimulatedDateTimeSet&&!this.ignoreCapsCheckbox.disabled&&(this.ignoreCapsCheckbox.disabled=!0)}},{key:"_resetQuickResultForm",value:function(){var e=this.components["quick-result-form"],e=(e.hidden=!0,e.components["simulation-result"]);n2.isNull(e)||e.destroy()}},{key:"_onRecordIdChange",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.value,t.validate()&&!n2.isEmpty(n))return e.next=4,this._findBasicSObjectUIVO(n);e.next=8;break;case 4:n=e.sent,n2.isNull(n.response.sObjectType)?this._resetAssignableObjectFields():(this._sObjectSupportsQueues=n.response.supportsQueues,this.recordTypeReadOnlyField.value=n.response.sObjectType,this._resetAssignableObjectDependentFields()),e.next=9;break;case 8:this._resetAssignableObjectFields();case 9:this._refresh();case 10:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"_findBasicSObjectUIVO",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._fetchDataProvider("get-basic-sobject-ui-vo-by-record-id",{params:[t],force:!1,requestId:t}));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"_showClassifierStatus",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ignoreClassifierStatusCheckbox,e.next=3,this._fetchDataProvider("is-classifier-enabled",{params:[],force:!0});case 3:n=e.sent,t.hidden=!n.response;case 5:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_resetAssignableObjectFields",value:function(){this.recordTypeReadOnlyField.value="",this._sObjectSupportsQueues=!1,this._resetAssignableObjectDependentFields()}},{key:"_resetAssignableObjectDependentFields",value:function(){this.simulatedDateTimeFieldGroup.clear(),this._showSourceSelection(this.overwriteSourceSelectionFieldGroup.basicSourceSettings),this.ignoreClassifierStatusCheckbox.value=!1,this.ignoreCapsCheckbox.value=!1,this.includeInactiveCheckbox.value=!1,this.stopAfterAssignmentCheckBox.value=!0}},{key:"_onSaved",value:function(e,t){this._startAssignmentSimulationPolling()}},{key:"_startAssignmentSimulationPolling",value:function(){var e=this;this._simulationPollingService=new n2.de.PollingService(function(){e._loadSimulatedDistribution({silent:!0,force:!0,requestId:e._simulationModel.get("simulatedDistribution")})},5e3),this._simulationPollingService.start(),this._handleScrollBar(!0),this.newSimulationForm.disabled=!0,this.components["submit-button"].spinner()}},{key:"_loadSimulatedDistribution",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).force,t=void 0===t||t,i=n.silent,i=void 0!==i&&i,n=n.requestId,n=void 0===n?null:n,e.next=3,n2.DataProviderManager.getInstance().get("get-assignment-simulation").get({params:[n],silent:i,force:t,requestId:n});case 3:i=e.sent,!n2.isEmpty(i)&&"DONE"!==i.status&&"ERROR"!==i.status||this._endAssignmentSimulationPolling(i);case 5:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"_endAssignmentSimulationPolling",value:function(e){this._simulationPollingService.stop(),this._simulationModel.set(e.status,{key:"status"}),this.components["submit-button"].spinner(!1),this.newSimulationForm.disabled=!1,this._handleScrollBar(!1),"Quick Simulation"===this._simulationType?(this._loadQuickSimulationResult(e.simulatedDistribution),this._updateSubmitButton(!0,!1),this._updateBackButton(!1,!0)):this._openResultsPage(e.simulatedDistribution)}},{key:"_loadQuickSimulationResult",value:function(e){this._fetchDataProvider("get-assignment-simulation-quick-result",{params:[e],silent:!1,force:!0})}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(c.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-assignment-simulation-quick-result"!==t.id||(this._quickResult=e,this._quickResult.matchFound?this._resultType=n2.de.page.assignmentSimulation.AssignmentSimulationModal.MESSAGE_TYPE.MATCH:this._resultType=n2.de.page.assignmentSimulation.AssignmentSimulationModal.MESSAGE_TYPE.NO_MATCH,this._displayQuickResultContent())}},{key:"show",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=this,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).recordId,t=void 0===t?null:t,i=n.data,i=void 0===i?null:i,n=n.refererURL,n=void 0===n?null:n,(_get(_getPrototypeOf(c.prototype),"show",this).apply(this,a),i)?(i=n2.merge({},this._simulationModel.json,i.response),this._simulationModel=new n2.dataProvider.Model({value:i}),e.next=12):e.next=6;break;case 6:if(n2.isNull(t)){e.next=12;break}return this._simulationModel.getProperty("assignableObjectId").set(t),e.next=10,this._findBasicSObjectUIVO(t);case 10:i=e.sent,n2.isNull(i.response.sObjectType)?this._resetAssignableObjectFields():(this._sObjectSupportsQueues=i.response.supportsQueues,this.recordTypeReadOnlyField.value=i.response.sObjectType,this._resetAssignableObjectDependentFields());case 12:n&&this._setProperty("refererURL",n,{sync:!1}),this.components["new-simulation-form"].spinner(!1),this._showClassifierStatus(),this.recordIdTextBox.model=this._simulationModel,this.recordTypeReadOnlyField.model=this._simulationModel,n2.isEmpty(this._simulationModel.get("assignableObjectId"))?this._refresh():this._getSObjectDataFromRecordId(this._simulationModel.get("assignableObjectId")).then(function(e){n2.isEmpty(e.response.sObjectType)||(s._sObjectSupportsQueues=e.response.supportsQueues),s.simulatedDateTimeFieldGroup.dateTimeValue=s._simulationModel.get("simulatedDateTimeMillis"),s._showSourceSelection(s._getSourceFromModel()),s.ignoreClassifierStatusCheckbox.model=s._simulationModel,s.ignoreCapsCheckbox.model=s._simulationModel,s.includeInactiveCheckbox.model=s._simulationModel,s.stopAfterAssignmentCheckBox.value=!s._simulationModel.get("continueAfterAssignment"),s._refresh()});case 13:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_showSourceSelection",value:function(e){var t="User"===e.sourceType?e.sourceUserId:"Queue"===e.sourceType?e.sourceQueueId:null,t=(this._sourceSelection=new n2.dataProvider.Model({value:{objectName:this.recordTypeReadOnlyField.value,supportsQueues:this._sObjectSupportsQueues,sourceType:e.sourceType,sourceId:t,sourceName:null,sourceStatusField:e.sourceStatusField,sourceReadyStatus:e.sourceStatusFieldValue,sourceAssignedStatus:null,selectionType:e.sourceType,selectedId:t,selectedName:e.sourceUserName,selectedStatusField:e.sourceStatusField,selectedReadyStatus:e.sourceStatusFieldValue,selectedAssignedStatus:null}}),this.overwriteSourceSelectionFieldGroup);t.model=this._sourceSelection,t.disabled=!this._hasRecordSet(),t.toggleFieldGroup(e.isSourceOverridden),t.disabled&&!t.sourceSelection.hidden&&(t.toggleFieldGroup(!1),t.reset())}},{key:"_onSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(c.prototype),"_onSubmit",this).call(this),e.t0=this.newSimulationForm.validate(),e.t0)return this._populateModelFromSimulatedDateTimeSettings(),this._populateModelFromSourceSettings(),this._updateSubmitButton(!1,!1),this._updateCancelButton(!1,!0),"Quick Simulation"===this._simulationType&&this._updateBackButton(!0,!1),e.next=10,this._runSimulation();e.next=10;break;case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_handleScrollBar",value:function(e){e?(this.element("formBody").style({"overflow-y":"hidden"}),this._scrollToTop()):this.element("formBody").style({"overflow-y":"auto"})}},{key:"_scrollToTop",value:function(){this.element("formBody").rawDOM.scrollTo({top:0})}},{key:"_populateModelFromSimulatedDateTimeSettings",value:function(){var e=this.simulatedDateTimeFieldGroup.dateTimeValue;this._simulationModel.set(e,{key:"simulatedDateTimeMillis"})}},{key:"_populateModelFromSourceSettings",value:function(){var e=this.overwriteSourceSelectionFieldGroup.sourceSettings;this._simulationModel.set(e.isSourceOverridden,{key:"isSourceOverridden"}),this._simulationModel.set(e.sourceUserId,{key:"sourceUserOverride"}),this._simulationModel.set(e.sourceQueueId,{key:"sourceQueueOverride"}),this._simulationModel.set(e.sourceStatusField,{key:"sourceStatusOverrideFieldName"}),this._simulationModel.set(e.sourceStatusFieldValue,{key:"sourceStatusOverride"})}},{key:"_runSimulation",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._prepareModel(),e.next=3,n2.DataProviderManager.getInstance().get("run-assignment-simulation").post({params:[this._simulationModel.json]});case 3:t=e.sent,this._simulationModel.set(t.data.simulatedDistribution,{key:"simulatedDistribution"}),this._simulationModel.set(t.data.status,{key:"status"});case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_prepareModel",value:function(){this._simulationModel.hasProperty("recordName")&&this._simulationModel.remove("recordName"),this._simulationModel.hasProperty("recordOwnerName")&&this._simulationModel.remove("recordOwnerName"),this._simulationModel.hasProperty("simulatedDateTime")&&this._simulationModel.remove("simulatedDateTime"),this._simulationModel.hasProperty("sourceOverride")&&this._simulationModel.remove("sourceOverride"),this._simulationModel.hasProperty("stopSimulationOnSuccessfulAssignment")&&this._simulationModel.remove("stopSimulationOnSuccessfulAssignment")}},{key:"_reset",value:function(){_get(_getPrototypeOf(c.prototype),"_reset",this).call(this),n2.isNull(this._simulationPollingService)||(this._simulationPollingService.stop(),this.element("body").removeAttribute("style")),this._resetAssignableObjectFields();var e=this._components["new-simulation-form"],e=(e.disabled=!1,e.hidden=!1,e.reset(),this.recordIdTextBox.value={value:"",silent:!0},this.recordTypeReadOnlyField.value={value:"",silent:!0},this.simulatedDateTimeFieldGroup.reset(),this.overwriteSourceSelectionFieldGroup.reset(),this.recordIdTextBox.clearInvalid(),this._components["quick-result-form"]),e=(e.hidden=!0,e.components["simulation-result"]);n2.isEmpty(e)||e.destroy(),this._updateSubmitButton(!1,!0),this._updateBackButton(!0,!1)}},{key:"_refreshSimulatedDateTimeSettings",value:function(){var e=this.simulatedDateTimeFieldGroup;e.disabled=!this._hasRecordSet(),n2.isEmpty(e.dateTimeValue)?e.disabled&&!e.simulatedDateTimePicker.hidden&&e.toggleFieldGroup(!1):e.toggleFieldGroup(!0),this._handleIgnoreCapsEnablement()}},{key:"_refreshSourceSettings",value:function(){var e=this.overwriteSourceSelectionFieldGroup;e.disabled=!this._hasRecordSet(),e.toggleFieldGroup(e.sourceSelection.isSourceSelected),e.disabled&&!e.sourceSelection.hidden&&(e.toggleFieldGroup(!1),e.reset())}},{key:"_refreshGeneralModalSettings",value:function(){this._hasRecordSet()||(this.ignoreClassifierStatusCheckbox.value=!1,this.ignoreCapsCheckbox.value=!1,this.includeInactiveCheckbox.value=!1,this.stopAfterAssignmentCheckBox.value=!0),this._updateSubmitButton(!1,this._hasRecordSet())}},{key:"_getSObjectDataFromRecordId",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._fetchDataProvider("get-basic-sobject-ui-vo-by-record-id",{params:[t],force:!1,requestId:t}));case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_getSourceFromModel",value:function(){var e=this.overwriteSourceSelectionFieldGroup.basicSourceSettings;return n2.isEmpty(this._simulationModel.get("sourceUserOverride"))?n2.isEmpty(this._simulationModel.get("sourceQueueOverride"))?n2.isEmpty(this._simulationModel.get("sourceStatusOverride"))||n2.isEmpty(this._simulationModel.get("sourceStatusOverrideFieldName"))||(e.sourceType="Status",e.sourceStatusField=this._simulationModel.get("sourceStatusOverrideFieldName"),e.sourceStatusFieldValue=this._simulationModel.get("sourceStatusOverride"),e.isSourceOverridden=!0):(e.sourceType="Queue",e.sourceQueueId=this._simulationModel.get("sourceQueueOverride"),e.isSourceOverridden=!0):(e.sourceType="User",e.sourceUserId=this._simulationModel.get("sourceUserOverride"),e.sourceUserName=this._simulationModel.get("sourceUserOverrideName"),e.isSourceOverridden=!0),e}},{key:"_hasRecordSet",value:function(){return!n2.isEmpty(this.recordIdTextBox.value)&&!n2.isEmpty(this.recordTypeReadOnlyField.value)}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(c.prototype),"_getTemplatePartials",this).call(this),{contentTemplate:this._getContentTemplate()})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(c.prototype),"_getTemplateData",this).call(this),{simulatedDistributionId:"".concat(this._simulationModel.get("simulatedDistribution")),noMatchMessage:n2.isEmpty(this._quickResult)||this._quickResult.matchFound||!n2.isEmpty(this._simulationModel.get("simulatedDateTimeMillis"))?"No Distributors are able to assign the record at the date and time simulated":"No Distributors can currently assign the record",teamId:!n2.isEmpty(this._quickResult)&&this._quickResult.teamId?"".concat(this._quickResult.teamId):"",teamName:!n2.isEmpty(this._quickResult)&&this._quickResult.teamName?"".concat(this._quickResult.teamName):"",distributorId:!n2.isEmpty(this._quickResult)&&this._quickResult.distributorId?"".concat(this._quickResult.distributorId):"",distributorName:!n2.isEmpty(this._quickResult)&&this._quickResult.distributorName?"".concat(this._quickResult.distributorName):"",icon:n2.ui.Icon.getSVG(n2.de.enum.Icon.IDENTITY,{cls:"slds-icon_x-small"})})}},{key:"_getContentTemplate",value:function(){switch(this._resultType){case n2.de.page.assignmentSimulation.AssignmentSimulationModal.MESSAGE_TYPE.NO_MATCH:return this._noMatchTemplate;case n2.de.page.assignmentSimulation.AssignmentSimulationModal.MESSAGE_TYPE.MATCH:return this._matchTemplate;default:return""}}},{key:"_displayQuickResultContent",value:function(){this.components["new-simulation-form"].hidden=!0;var e=this.components["quick-result-form"],e=(e.hidden=!1,e.insert(new n2.de.component.field.ReadOnly({id:"simulation-result",label:"Simulation result",disabled:!0}))),t=(e._dom.clear(),n2.ui.Template.render(this._getContentTemplate(),this._getTemplateData(),this._getTemplatePartials()));e._dom.insert(t,"afterbegin"),e._dom.purgeListeners(),this._quickResult.matchFound&&(this._bindTeamClick(),this._bindDistributorClick()),this._bindResultsPageClick(),this._updateCancelButton(!1,!0)}},{key:"_bindTeamClick",value:function(){var e=this.element("team",!0);n2.isNull(e)||(e.removeListeners("click",{scope:this}),e.listen("click",this._onTeamClick))}},{key:"_onTeamClick",value:function(e){var t;e.target.classList.contains("n2-team")&&(t=e.target.dataset.id,n2.de.page.Navigation.getInstance().open("Team_TeamSettings","teamId=".concat(t)),e.preventDefault())}},{key:"_bindDistributorClick",value:function(){var e=this.element("distributor",!0);n2.isNull(e)||(e.removeListeners("click",{scope:this}),e.listen("click",this._onDistributorClick))}},{key:"_onDistributorClick",value:function(e){var t,n;e.target.classList.contains("n2-distributor")&&(t=e.target.dataset.teamid,n=e.target.dataset.id,n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(n,"&teamId=").concat(t)),e.preventDefault())}},{key:"_bindResultsPageClick",value:function(){var e=this.element("detailedresult",!0);n2.isNull(e)||(e.removeListeners("click",{scope:this}),e.listen("click",this._onResultsPageClick,{scope:this}))}},{key:"_onResultsPageClick",value:function(e){e.target.classList.contains("n2-link-detailed-results")&&(this._openResultsPage(e.target.dataset.id),e.preventDefault())}},{key:"_openResultsPage",value:function(e){var t=n2.isEmpty(this._refererURL)?n2.de.ApplicationContext.getInstance().currentRelativePageURL:encodeURIComponent(this._refererURL),n=n2.de.page.assignmentSimulation.Context.getInstance().recordId,e="simulatedDistributionId=".concat(e,"&refererURL=").concat(t),e=n2.isNull(n)?e:"".concat(e,"&recordId=").concat(n);n2.de.page.Navigation.getInstance().open("AssignmentSimulation_Results",e)}}],[{key:"MESSAGE_TYPE",get:function(){return{MATCH:"match",NO_MATCH:"no_match"}}}]),c}(),n2.de.page.assignmentSimulation.AssignmentSimulationResults=function(){_inherits(r,n2.de.Page);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-assignment-simulation-result-by-distributor"],this._heading="Assignment Simulation Results",this._headingIcon=n2.de.enum.Icon.SETTINGS,this._helpLinkURL="https://help.nc-squared.com/assignment-simulation-results",this._componentCls="n2-de-assignment-simulation-results",this._pageContext=n2.de.page.assignmentSimulation.Context.getInstance(),this._simulationConfigurationData=null,this._simulationResultData=null,this._teamResultComponents=null,this._distributorCount=0,this._REFRESH=n2.merge(this._REFRESH,{simulationConfigurationData:["simulationConfiguration","emptyState"],simulationResultData:["simulationConfiguration","simulationResults","emptyState"]})}},{key:"emptyState",get:function(){return this._components["empty-state"]}},{key:"simulationConfiguration",get:function(){return this._components["simulation-configuration"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(r.prototype),"_onDefined",this).call(this),this._pageContext.listen("change",this._handleRecordIdChange,this)}},{key:"_handleRecordIdChange",value:function(e){e=e.data.recordId.newValue;n2.isEmpty(e)||n2.isNull(this._pageContext.simulatedDistributionId)&&this._openModalWithRecordId({recordId:e})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(r.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertBackLink(),this._insertEmptyState(),this._insertSimulationConfiguration()}},{key:"_insertBackLink",value:function(){return this._insert(new n2.de.component.Link({id:"back-link",cls:"n2_back-link",text:"< Back to previous page",href:this._pageContext.recordId?"/".concat(this._pageContext.recordId):decodeURIComponent(this._pageContext.refererURL)}))}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"slds-m-top_xx-large",heading:"No simulation results to display",content:"There are no simulation results to display, run a full simulation to see the results.",illustration:n2.de.illustration.Desert,components:[new n2.ui.component.Button({id:"new-simulation-button",text:"New Simulation",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._handleNewSimulationClick,scope:this}})]}))}},{key:"_handleNewSimulationClick",value:function(e){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show({refererURL:this._pageContext.refererURL})}},{key:"_insertSimulationConfiguration",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.Configuration({id:"simulation-configuration",hidden:!0}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:if(i=this._pageContext.simulatedDistributionId,n2.isNull(i))return e.abrupt("return");e.next=6;break;case 6:return e.next=8,Promise.all([this._loadDataProvider("get-assignment-simulation",{params:[i],silent:t,force:n,requestId:i}),this._loadDataProvider("get-assignment-simulation-team-and-record",{params:[i],force:!1,silent:!1,requestId:i})]);case 8:return a=e.sent,a=_slicedToArray(a,2),s=a[0],a=a[1],e.abrupt("return",{simulationConfigurationData:s,simulationResultData:a});case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.simulationConfigurationData,n=e.simulationResultData;e.refererURL;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperties({simulationConfigurationData:t.response,simulationResultData:n.response})}},{key:"_refreshEmptyState",value:function(){this.emptyState.hidden=!n2.isNull(this._simulationConfigurationData)&&!n2.isEmpty(this._simulationResultData.teamResults)}},{key:"_refreshSimulationConfiguration",value:function(){if(!n2.isNull(this._simulationConfigurationData))return this._isSimulationError()?(window.console.error("Assignment Simulation Error:",this._simulationConfigurationData.errorMessage),this._onServerError("An error has occurred during the assignment simulation, please contact support to help with this issue.",null)):(this.simulationConfiguration.hidden=!1,this.simulationConfiguration.simulationConfigurationData=this._simulationConfigurationData,this.simulationConfiguration.content=this._getSimulationConfigurationContent(),void(this.simulationConfiguration.refererURL=this._pageContext.refererURL));this.simulationConfiguration.hidden=!0}},{key:"_refreshSimulationResults",value:function(){this._destroyTeamResultComponents(),n2.isEmpty(this._simulationResultData.teamResults)||(this._distributorCount=0,this._teamResultComponents=this._insertTeamResults())}},{key:"_destroyTeamResultComponents",value:function(){n2.isNull(this._teamResultComponents)||this._teamResultComponents.forEach(function(e){e.destroy()})}},{key:"_insertTeamResults",value:function(){var n=this;return this._simulationResultData.teamResults.map(function(e,t){return n._insertTeamResult(e,{index:t})})}},{key:"_insertTeamResult",value:function(e,t){t=t.index;return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.TeamResult({id:"team-result-".concat(t),teamResult:e,listeners:{loadComplete:this._onTeamResultLoadComplete,scope:this}}))}},{key:"_onTeamResultLoadComplete",value:function(){var n;this._teamResultComponents.every(function(e){return e.isLoading()})||(n=0,this._teamResultComponents.forEach(function(e,t){e.distributorOrderStartNumber=n+1,n+=e.distributorResults.length}))}},{key:"_getSimulationConfigurationContent",value:function(){var e=n2.clone(this._simulationConfigurationData);return e.isClassifierEnabled=this._simulationResultData.isClassifierEnabled,e.recordName=this._simulationResultData.record.recordName,e.recordOwnerName=this._simulationResultData.record.ownerName,n2.isUndefined(e.simulatedDateTimeMillis)||(e.simulatedDateTime=n2.de.util.Date.formatTimestamp(e.simulatedDateTimeMillis)),e.sourceOverride=this._getSourceOverrideContent(),e.stopSimulationOnSuccessfulAssignment=!e.continueAfterAssignment,e}},{key:"_getSourceOverrideContent",value:function(){return!!this._simulationConfigurationData.isSourceOverridden&&(this._simulationConfigurationData.sourceQueueOverride?{type:"Queue",value:"".concat(this._simulationConfigurationData.sourceQueueOverrideName)}:this._simulationConfigurationData.sourceUserOverride?{type:"User",value:"".concat(this._simulationConfigurationData.sourceUserOverrideName)}:n2.isEmpty(this._simulationConfigurationData.sourceStatusOverride)?void 0:{type:"Status",value:"".concat(this._simulationConfigurationData.sourceStatusOverrideFieldLabel," (").concat(this._simulationConfigurationData.sourceStatusOverride,")")})}},{key:"_openModalWithRecordId",value:function(e){e=e.recordId;n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show({recordId:e})}},{key:"_isSimulationError",value:function(){return"ERROR"===this._simulationConfigurationData.status}}]),r}(),n2.de.page.assignmentSimulation.Context=function(){_inherits(r,n2.Object);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this),this._mixins=[n2.mixin.DataDriven,n2.mixin.Singleton,n2.mixin.Observable],this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CHANGE]),this.dataProviders=["get-assignment-simulation","simulated-distribution-id","is-classifier-enabled"],this._lazyLoad=!0,this._simulatedDistributionId=null,this._refererURL=null,this._recordId=null}},{key:"simulatedDistributionId",get:function(){return this._simulatedDistributionId}},{key:"refererURL",get:function(){return this._refererURL}},{key:"recordId",get:function(){return this._recordId}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return e.next=5,Promise.all([this._loadDataProvider("simulated-distribution-id",{silent:t,force:n}),this._loadDataProvider("referer-url",{silent:t,force:n}),this._loadDataProvider("get-record-data",{silent:t,force:n})]);case 5:return a=e.sent,a=_slicedToArray(a,3),i=a[0],s=a[1],a=a[2],e.abrupt("return",{simulatedDistributionData:i,refererURLData:s,recordId:a?a.response.recordId:null});case 11:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.simulatedDistributionData,n=e.refererURLData,e=e.recordId,t=(_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),t.response.simulatedDistributionId);this._setProperties({simulatedDistributionId:n2.isEmpty(t)?null:t,refererURL:n.response.refererURL,recordId:e},{silent:!1})}}]),r}(),n2.de.page.availability.Context=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._mixins=[n2.mixin.Singleton],this._lazyLoad=!0}}]),t}(),n2.de.page.availability.OutOfOffice=function(){_inherits(l,n2.de.page.Availability);var t,n,e,i,s,a,o,r=_createSuper(l);function l(){return _classCallCheck(this,l),r.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-out-of-offices"],this._heading="Out of Office",this._headingIcon=n2.de.enum.Icon.GRAPH,this._helpLinkURL="https://help.nc-squared.com/distribution-ooo",this._componentCls="n2-de-availability-out-of-office",this._activeNavigationId="out-of-office",this._timezoneOptions=[],this._teams=null,this.TEAM_TYPES=n2.de.page.availability.outOfOffice.Enum.TEAM_TYPES,this._teamsType=this.TEAM_TYPES.MIXED,this._hasAnyData=null,this._switchedToPast=!1,this._eventLimitMessageTemplate='<div id="{{id}}" class="n2_out-of-office-limit-message slds-grid slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Displaying '+n2.de.ApplicationContext.getInstance().OOO_DISPLAY_LIMIT+" events, use the filters to find others.</p></div></div>"}},{key:"emptyState",get:function(){return this._components["empty-state"]}},{key:"outOfOfficeTable",get:function(){return this._components["out-of-office-table"]}},{key:"eventLimitMessage",get:function(){return this._components["event-limit-message"]}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"timeFilter",get:function(){return this.toolbar.components["time-filter"]}},{key:"teamFilter",get:function(){return this.toolbar.components["team-filter"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"createNewButton",get:function(){return this.toolbar.components["create-new-button"]}},{key:"menu",get:function(){return this.toolbar.components["out-of-office-actions-menu"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(l.prototype),"_insertPageComponents",this).call(this),this._insertComponents()}},{key:"_insertComponents",value:function(){this._insertToolbar(),this._insertEmptyState(),this._insertLimitMessage(),this._insertDataTable()}},{key:"_insertEmptyState",value:function(){var n=this;return this._insert(new n2.de.page.availability.outOfOffice.EmptyState({id:"empty-state",listeners:{click:function(e){var t=!0;"create-new-button"===e.target.id&&(t=n._teamsType===n.TEAM_TYPES.QUEUE&&!n2.de.ApplicationContext.getInstance().isUser),n._onOpenModal(t)}},hidden:!0}))}},{key:"_insertLimitMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:"event-limit-message",template:this._eventLimitMessageTemplate,hidden:!0}))}},{key:"_insertToolbar",value:function(){var e=[this._getTimeFilter()],t=[this._getCreateNewButton(),this._getMenu()];return n2.de.ApplicationContext.getInstance().isUser||(e.push(this._getTeamFilter()),t.unshift(this._getQuickFilter())),this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',components:[].concat(e,t)}))}},{key:"_getTeamFilter",value:function(){return new n2.ui.component.field.Combo({id:"team-filter",label:{text:"filter by team",hidden:!0},renderTo:".n2_left",cls:"n2_team-filter slds-col slds-size_4-of-12",options:[],placeholder:"All Teams",listeners:{change:this._onTeamFilterChange,scope:this}})}},{key:"_onTeamFilterChange",value:function(e){var t=e.value;this.outOfOfficeTable.addFilter("teamFilter",function(e){return""===t||e.teams.some(function(e){return e.id===t})}),this._refreshLimitMessage()}},{key:"_getTimeFilter",value:function(){return new n2.ui.component.field.Combo({id:"time-filter",label:{text:"filter by time",hidden:!0},renderTo:".n2_left",cls:"slds-col slds-size_4-of-12 n2_time-filter",required:!0,sort:!1,options:[{label:"Past",value:"Past"},{label:"Upcoming",value:"Upcoming"},{label:"Active",value:"Active"},{label:"This Week",value:"ThisWeek"},{label:"Next Week",value:"NextWeek"}],value:"Upcoming",listeners:{change:this._onTimeFilterChange,scope:this}})}},{key:"_onTimeFilterChange",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadOutOfOffices();case 2:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"_getQuickFilter",value:function(){var t=this;return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Find member",hidden:!0},placeholder:"Find member...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}})}},{key:"_onQuickFilterType",value:function(e){var t=e.value.toLowerCase();this.outOfOfficeTable.addFilter("quickFilter",function(e){return e.name.toLowerCase().includes(t)}),this._refreshLimitMessage()}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&(this.outOfOfficeTable.removeFilters("quickFilter"),this._refreshLimitMessage())}},{key:"_getCreateNewButton",value:function(){var e=this;return new n2.ui.component.SplitButton({id:"create-new-button",buttonText:"Add Out of Office",cls:"n2_create-new",renderTo:".n2_right",listeners:{click:function(){return e._onAddOutOfOfficeClicked()},select:function(){return e._onOpenModal(!0)}}})}},{key:"_setCreateButtonOptions",value:function(){var e=[];this._teamsType!==this.TEAM_TYPES.MIXED||n2.de.ApplicationContext.getInstance().isUser||e.push({id:this.TEAM_TYPES.QUEUE,label:"Add Queue Out of Office"}),this.createNewButton.menuOptions=e}},{key:"_onAddOutOfOfficeClicked",value:function(){var e=this._teamType===this.TEAM_TYPES.QUEUE&&!n2.de.ApplicationContext.getInstance().isUser;this._onOpenModal(e)}},{key:"_getMenu",value:function(){var t=this,e=[{id:"delete",label:"Delete",hidden:!0}];return n2.de.ApplicationContext.getInstance().isUser||e.push({id:"outOfOfficeHistory",label:"Out of Office History"}),new n2.ui.component.Menu({id:"out-of-office-actions-menu",renderTo:".n2_right",cls:"n2_menu",options:e,listeners:{select:function(e){return t._onMenuOptionSelect(e,t.outOfOfficeTable.selection)}}})}},{key:"_onMenuOptionSelect",value:function(e,t){switch(e.id){case"delete":this._deleteEvents(t);break;case"edit":this._editEvent(t);break;case"outOfOfficeHistory":this._showOutOfOfficeHistory()}}},{key:"_deleteEvents",value:function(t){var n=this;n2.de.page.availability.outOfOffice.DeleteEventsMessageBox.getInstance({renderTo:this._dom,dataProviders:["delete-out-of-offices"]}).show({names:t,type:"team members",listeners:{submit:function(e){return n._onDeleteEventsSubmit(e,t)}}})}},{key:"_editEvent",value:function(e){var e=e[0],t=n2.isUndefined(e.user);this._onOpenModal(t,e)}},{key:"_showOutOfOfficeHistory",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-out-of-office-change-history",{params:[null],force:!0,silent:!0});case 2:return t=e.sent,e.abrupt("return",(n2.de.page.availability.outOfOffice.OutOfOfficeChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Out of office history",model:t.response}),t));case 4:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_onDeleteEventsSubmit",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-out-of-offices",{params:[n],silent:!1,force:!0});case 2:return e.next=4,t.hide();case 4:return e.abrupt("return",this._loadOutOfOffices());case 5:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"_insertDataTable",value:function(){var t=this;return this._insert(new n2.de.page.availability.outOfOffice.OutOfOfficeDataTable({id:"out-of-office-table",data:[],hidden:!0,listeners:{selectionChange:function(e){return t._onRowSelectionChange(e)},menuOptionSelect:function(e){return t._onMenuOptionSelect(e.target,[e.relatedTarget.data])},click:function(e){return t._onDataTableClick(e)}}}))}},{key:"_onRowSelectionChange",value:function(e){this._updateMenu()}},{key:"_onDataTableClick",value:function(e){n2.isObject(e)&&"clear-filters"===e.target.id&&(this.teamFilter.clear(),this.quickFilter.clear())}},{key:"_updateMenu",value:function(){var e=this.outOfOfficeTable.selection,e=(this.menu.components.delete.label="Delete (".concat(e.length,")"),this.menu.components.delete.hidden=0===e.length,this.menu.componentList.filter(function(e){return e instanceof n2.ui.component.menu.Option&&!e.hidden}));this.menu.disabled=0===e.length}},{key:"_load",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,o);case 3:return e.next=5,Promise.all([this._loadOutOfOffices({silent:t,force:n}),this._loadDataProvider("get-teams",{silent:t,force:n}),this._loadDataProvider("get-timezone-options",{silent:t,force:n})]);case 5:return a=e.sent,a=_slicedToArray(a,3),i=a[0],s=a[1],a=a[2],e.abrupt("return",{outOfOffices:i,teams:s,timezones:a});case 11:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_loadOutOfOffices",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0!==t&&t,n=n.force,n=void 0===n||n,i=this.timeFilter.value,e.abrupt("return",this._loadDataProvider("get-out-of-offices",{params:[i],silent:t,force:n,requestId:i}));case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.outOfOffices,n=e.teams,e=e.timezones;_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).apply(this,arguments),this._model=t.response.outOfOffices,this._hasAnyData=t.response.hasAnyOutOfOffices,this._teams=n.response,this._timezoneOptions=e.response,this._teamsType=this._getTeamsType(),this._setTeamFilterOptions(),this._setCreateButtonOptions(),this._hasAnyData&&n2.isEmpty(this._model)?(this._switchedToPast=!0,this.timeFilter.value="Past"):(this._refresh(),this._updateMenu())}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(l.prototype),"_onLoaded",this).apply(this,arguments),"get-out-of-offices"===t.id&&(this._model=e.outOfOffices,this._hasAnyData=e.hasAnyOutOfOffices,this._switchedToPast&&(this._switchedToPast=!1,n2.ui.component.Toast.getInstance().show({theme:n2.ui.enum.Theme.INFO,message:"We couldn't find any upcoming events so we've switched to looking at past ones."})),this._hasAnyData)&&n2.isEmpty(this._model)?this._showEmptyFilteredState():(this._refresh(),this._updateMenu())}},{key:"_onServerError",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.de.component.DeleteMessageBox.getInstance().hide();case 2:return e.next=4,n2.de.page.availability.outOfOffice.OutOfOfficeModal.getInstance().hide();case 4:_get(_getPrototypeOf(l.prototype),"_onServerError",this).call(this,t);case 5:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_showEmptyFilteredState",value:function(){this._refresh(),this.outOfOfficeTable.hidden=!1,this.outOfOfficeTable.showEmptyFilteredState()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0===t||t,n=e.outOfOffice,n=void 0===n||n,i=e.emptyState,i=void 0===i||i,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&(this._refreshOutOfOffice(),this._refreshLimitMessage()),(e||i)&&this._refreshEmptyState()}},{key:"_setTeamFilterOptions",value:function(){n2.isEmpty(this._teams)||n2.de.ApplicationContext.getInstance().isUser||(this.teamFilter.options=this._teams.map(function(e){return{label:e.name,value:e.id}}))}},{key:"_getTeamsType",value:function(){for(var e=!1,t=!1,n=0,i=this._teams[n];!n2.isUndefined(i)&&(i.type===this.TEAM_TYPES.STANDARD&&(e=!0),i.type===this.TEAM_TYPES.QUEUE&&(t=!0),!e||!t);)i=this._teams[n+=1];return e&&t?this.TEAM_TYPES.MIXED:t?this.TEAM_TYPES.QUEUE:this.TEAM_TYPES.STANDARD}},{key:"_onOpenModal",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=this._getHeader(e,n2.isNull(t));n2.de.page.availability.outOfOffice.OutOfOfficeModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["save-out-of-office"],listeners:{submit:this._submitOutOfOffice,scope:this}}).show({model:t,timezoneOptions:this._timezoneOptions,options:{header:n,isQueue:e}})}},{key:"_submitOutOfOffice",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,e.next=3,this._postDataProvider("save-out-of-office",{params:[n]});case 3:return n2.de.ApplicationContext.getInstance().isUser||(this.teamFilter.clear({silent:!0}),this.quickFilter.clear({silent:!0})),this._updateTimeFilter(n),e.abrupt("return",this._loadOutOfOffices());case 6:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_updateTimeFilter",value:function(e){var t=n2.merge({},e);switch(t.endIsAllDay&&(t.endDate=this._setTimeToEndOfDay(t.endDate)),this.timeFilter.value){case"Past":return this._updateTimeFilterPast(t);case"Upcoming":return this._updateTimeFilterUpcoming(t);case"Active":return this._updateTimeFilterActive(t);case"ThisWeek":return this._updateTimeFilterWeek(t,0);case"NextWeek":return this._updateTimeFilterWeek(t,7)}}},{key:"_updateTimeFilterPast",value:function(e){this._isDatePast(e.endDate,e.timezone)||(this.timeFilter.value={value:"Upcoming",silent:!0})}},{key:"_updateTimeFilterUpcoming",value:function(e){this._isDatePast(e.endDate,e.timezone)&&(this.timeFilter.value={value:"Past",silent:!0})}},{key:"_updateTimeFilterActive",value:function(e){this._isActiveToday(e)||(this._updateTimeFilterPast(e),this._updateTimeFilterUpcoming(e))}},{key:"_isActiveToday",value:function(e){return this._isDatePast(e.startDate,e.timezone)&&!this._isDatePast(e.endDate,e.timezone)}},{key:"_setTimeToEndOfDay",value:function(e){e=new Date(e);return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)}},{key:"_updateTimeFilterWeek",value:function(e,t){t=this._getWeek(t);(this._getLocaleTimestamp(e.endDate,e.timezone)<t.start||this._getLocaleTimestamp(e.startDate,e.timezone)>t.end)&&(this._updateTimeFilterPast(e),this._updateTimeFilterUpcoming(e))}},{key:"_isDatePast",value:function(e,t){return this._getLocaleTimestamp(e,t)<Date.now()}},{key:"_getLocaleTimestamp",value:function(e,t){return n2.de.util.Date.getUserLocaleTimeStamp(new Date(e),t)}},{key:"_getWeek",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=new Date,n=t.getDay(),i=-6,n=(n&&(i=-1*(n-1)),n2.modifyDate(t,i+e)),t=n2.modifyDate(n,6);return{start:Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),end:Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)}}},{key:"_getHeader",value:function(e,t){return"".concat(t?"New":"Edit").concat(e?" Queue":""," Out of Office")}},{key:"_refreshToolbar",value:function(){var e=n2.isEmpty(this._model)&&!this._hasAnyData;this.timeFilter.hidden=e,this.createNewButton.hidden=e,n2.de.ApplicationContext.getInstance().isUser||(this.teamFilter.hidden=e,this.quickFilter.hidden=e)}},{key:"_refreshOutOfOffice",value:function(){this.outOfOfficeTable.hidden=n2.isEmpty(this._model);var e="Past"===this.timeFilter.value,t=e?"dsc":"asc",n=this.outOfOfficeTable.sortBy;(n2.isNull(n)||0===n.column&&n.direction!==t)&&(this.outOfOfficeTable.sortBy={column:0,direction:t}),this.menu.hidden=e&&n2.de.ApplicationContext.getInstance().isUser,this.outOfOfficeTable.data=this._model}},{key:"_refreshLimitMessage",value:function(){this.eventLimitMessage.hidden=!this.outOfOfficeTable.hasMaxRows}},{key:"_refreshEmptyState",value:function(){this.emptyState.hidden=!n2.isEmpty(this._model)||this._hasAnyData,this.emptyState.teamType=this._teamsType}}]),l}(),n2.de.page.availability.RegionalHolidays=function(){_inherits(s,n2.de.page.Availability);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-holiday-regions"],this._heading="Regional Holidays",this._headingIcon=n2.de.enum.Icon.DATE_TIME,this._helpLinkURL="https://help.nc-squared.com/distribution-holidays",this._componentCls="n2-de-availability-regional-holidays",this._activeNavigationId="regional-holidays",this._regionsResponse=null}},{key:"regions",get:function(){return this._components.regions}},{key:"holidays",get:function(){return this._components.holidays}},{key:"tabs",get:function(){return this._components["holidays-tabs"]}},{key:"holidaysTab",get:function(){return this.tabs.components.holidays}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertTabs(),this._insertRegions(),this._insertHolidays()}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"holidays-tabs",tabs:[{id:"regions",label:"Regions"},{id:"holidays",label:"Regional Holidays"}],listeners:{change:function(e){return t._onTabChange(e)}},selectedTabId:"regions"}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"regions":this._showTabContent({showRegions:!0});break;case"holidays":this._showTabContent({showHolidays:!0})}}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showRegions,e=e.showHolidays,e=void 0!==e&&e;this.regions.hidden=!(void 0!==t&&t),this.holidays.hidden=!e}},{key:"_insertRegions",value:function(){return this._insert(new n2.de.page.availability.regionalHolidays.Regions({id:"regions"}))}},{key:"_insertHolidays",value:function(){return this._insert(new n2.de.page.availability.regionalHolidays.Holidays({id:"holidays",hidden:!0}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-holiday-regions",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{regionsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._regionsResponse=e.regionsData.response,this._refresh()}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-holiday-regions"!==t.id||(this._regionsResponse=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.regions,t=void 0!==t&&t,n=e.holidays,n=void 0!==n&&n,i=e.tabs,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshRegions(),(e||n)&&this._refreshHolidays(),(e||i)&&this._refreshTabs()}},{key:"_refreshRegions",value:function(){this.regions.model=this._regionsResponse}},{key:"_refreshHolidays",value:function(){var e=[];n2.isEmpty(this._regionsResponse)||(e=this._regionsResponse.map(function(e){return{value:e.id,label:e.name}})),this.holidays.regionOptions=e}},{key:"_refreshTabs",value:function(){this.holidaysTab.disabled=n2.isEmpty(this._regionsResponse)}}]),s}(),n2.de.page.availability.Shifts=function(){_inherits(u,n2.de.page.Availability);var t,n,i,s,a,o,e,r,l,c=_createSuper(u);function u(){return _classCallCheck(this,u),c.apply(this,arguments)}return _createClass(u,[{key:"_define",value:function(){_get(_getPrototypeOf(u.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-shifts-data"],this._pageContext=n2.de.page.availability.shifts.Context.getInstance(),this._heading="Shifts",this._headingIcon=n2.de.enum.Icon.IDENTITY,this._helpLinkURL="https://help.nc-squared.com/shift-hours",this._componentCls="n2-de-availability-shifts",this._activeNavigationId="shifts",this._timezoneOptions=[]}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"toolbarActionMenu",get:function(){return this.toolbar.components["action-menu"]}},{key:"timezoneFilter",get:function(){return this.toolbar.components["timezone-filter"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"shiftList",get:function(){return this._components["shifts-data-table"]}},{key:"shiftHoursModal",get:function(){return n2.de.component.hours.ShiftHoursModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["save-shift"]})}},{key:"addShiftButton",get:function(){return this.toolbar.components["add-shift-button"]}},{key:"slideOutPanel",get:function(){return n2.de.page.availability.shifts.SlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(u.prototype),"_insertPageComponents",this).call(this),this._insertToolbar()}},{key:"_onServerError",value:(l=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.de.component.DeleteMessageBox.getInstance().hide();case 2:return e.next=4,n2.de.component.hours.ShiftHoursModal.getInstance().hide();case 4:_get(_getPrototypeOf(u.prototype),"_onServerError",this).call(this,t);case 5:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"_getServerErrorConfig",value:function(e){return{listeners:{submit:this._onServerErrorSubmit,scope:this}}}},{key:"_onServerErrorSubmit",value:function(){this.load({silent:!0,force:!0})}},{key:"_insertToolbar",value:function(){var e=[this._createTimezoneFilter(),this._createQuickFilter(),this._createToolbarActionMenuButton()];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(2,0,this._createAddShiftButton()),this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar{{#hidden}} {{hideCls}}{{/hidden}}">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',components:e}))}},{key:"_createTimezoneFilter",value:function(){return new n2.ui.component.field.Combo({id:"timezone-filter",renderTo:".n2_left",label:{text:"Filter by timezone",hidden:!0},placeholder:"All timezones",options:[],listeners:{change:this._onTimezoneFilterChange,scope:this}})}},{key:"_onTimezoneFilterChange",value:function(e){""!==e.value?this.shiftList.addFilter("timezoneFilter",{dataBindings:["timezone"],value:e.value}):this.shiftList.removeFilters(["timezoneFilter"])}},{key:"_createAddShiftButton",value:function(){return new n2.ui.component.Button({id:"add-shift-button",renderTo:".n2_right",cls:"n2_add-shift-button",text:"Add Shift",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddShiftClick,scope:this}})}},{key:"_createQuickFilter",value:function(){return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find shift...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}})}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this.shiftList.addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.shiftList.removeFilters(["quickFilter"])}},{key:"_createToolbarActionMenuButton",value:function(){return new n2.ui.component.Menu({id:"action-menu",renderTo:".n2_right",cls:"n2_action-menu",options:this._getToolbarActionOptions(),listeners:{select:this._onToolbarActionMenuSelect,scope:this}})}},{key:"_getToolbarActionOptions",value:function(){var e=[{id:"shiftsHistory",label:"Shifts History"}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(0,0,{id:"delete",label:"Delete",hidden:!0}),e}},{key:"_onToolbarActionMenuSelect",value:function(e,t){switch(e.id){case"delete":this._onDeleteShiftClick(this.shiftList.selection);break;case"shiftsHistory":this._onShiftsHistoryClick()}}},{key:"_load",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(u.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-shifts-data",{silent:t,force:n}),this._loadDataProvider("get-timezone-options",{silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{shiftsData:i,timezones:s});case 10:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(u.prototype),"_onLoadComplete",this).apply(this,arguments),this._timezoneOptions=e.timezones.response,this._model=e.shiftsData.response,this._refresh()}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(u.prototype),"_onLoaded",this).apply(this,arguments),"get-shifts-data"===t.id&&(this._model=e,this._refresh())}},{key:"_onShiftsHistoryClick",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-shifts-history",{force:!0,silent:!0});case 2:return t=e.sent,e.abrupt("return",(n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Shifts history",model:t.response,showName:!0}),t));case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0!==t&&t,n=e.shiftList,n=void 0!==n&&n,i=e.slideOutPanel,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshShiftList(),(e||i)&&this._refreshSlideOutPanel()}},{key:"_refreshToolbar",value:function(){var e=n2.isEmpty(this._model);this.quickFilter.clear({silent:!0}),this.timezoneFilter.clear({silent:!0}),this.timezoneFilter.options=this._extractTimezoneOptions(this._model),this.quickFilter.hidden=e,this.timezoneFilter.hidden=e,n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this.addShiftButton.hidden=e),this._updateMenu()}},{key:"_extractTimezoneOptions",value:function(e){return e.map(function(e){return e.timezone}).sort().filter(function(e,t,n){return 0===t||e!==n[t-1]})}},{key:"_refreshShiftList",value:function(){n2.isUndefined(this.shiftList)||this.shiftList.destroy(),this._insertShiftList()}},{key:"_insertShiftList",value:function(){return this._insert(new n2.de.page.availability.shifts.ShiftList({id:"shifts-data-table",data:this._model,listeners:{selectionChange:this._onShiftListTableSelectionChange,click:this._onShiftListClick,scope:this}}))}},{key:"_onShiftListTableSelectionChange",value:function(e){this._updateMenu(e.target.parent.selection)}},{key:"_refreshSlideOutPanel",value:function(){var e,t=this;n2.isEmpty(this._pageContext.shiftHoursId)||(e=this._model.find(function(e){return e.id===t._pageContext.shiftHoursId}),this._showShiftDetailsSidePanel(e))}},{key:"_updateMenu",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=this.toolbarActionMenu.components.delete;n2.isUndefined(t)||(t.hidden=n2.isEmpty(e),t.label="Delete (".concat(e.length,")"))}},{key:"_onShiftListClick",value:function(e,t,n){if(n2.isObject(e)){var i=e;switch(i.target.id){case"delete":this._onDeleteShiftClick([i.data.shiftData]);break;case"add-shift":this._onAddShiftClick();break;case"clear-filters":this._onClearFiltersClick();break;case"clone":this._onCloneShiftClick(i.data.shiftData);break;case"edit":this._onEditShiftClick(i.data.shiftData.id)}}else["td-selectable","td-menu"].includes(n.id)||this._showShiftDetailsSidePanel(t.data)}},{key:"_showShiftDetailsSidePanel",value:function(e){this.slideOutPanel.show({heading:e.name,shiftHoursId:e.id,includeNavButtons:!1,listeners:{click:this._onShiftDetailsSidePanelClick,scope:this}})}},{key:"_onShiftDetailsSidePanelClick",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"edit-shift-button"===t.target.id&&this._onEditShiftClick(t.currentTarget.shiftHoursId,t.data.shiftHoursData);case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"_onEditShiftClick",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i=this,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<s.length&&void 0!==s[1]?s[1]:null,e.t0=n2.isNull(n),e.t0)return e.next=5,n2.DataProviderManager.getInstance().get("get-shift-hours").get({params:[t],requestId:t,silent:!0,force:!1});e.next=6;break;case 5:n=e.sent;case 6:this.shiftHoursModal.show({header:"Edit ".concat(n.name),timezoneOptions:this._timezoneOptions,shiftNames:this._getCurrentShiftNames({excludeName:n.name}),model:n,submitButtonText:"Save",listeners:{submit:function(e){return i._onEditShiftSubmit(e,t)}}});case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"_onEditShiftSubmit",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("save-shift",{params:[n,t.data]});case 2:this._loadDataProvider("get-shifts-data",{silent:!1,force:!0}),this._loadDataProvider("get-shift-hours",{params:[n],requestId:n,silent:!1,force:!0});case 4:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"_onDeleteShiftClick",value:function(t){var n=this;n2.de.component.DeleteMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["delete-shifts"]}).show({names:t.map(function(e){return e.name}),type:"shifts",listeners:{submit:function(e){return n._onDeleteShiftSubmit(e,t)},scope:this}})}},{key:"_onDeleteShiftSubmit",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("delete-shifts").post({params:[n]});case 2:return e.next=4,t.hide();case 4:return e.abrupt("return",this._loadDataProvider("get-shifts-data",{silent:!1,force:!0}));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"_onAddShiftClick",value:function(){this.shiftHoursModal.show({timezoneOptions:this._timezoneOptions,shiftNames:this._getCurrentShiftNames(),submitButtonText:"Create Shift",listeners:{submit:this._onAddShiftSubmit,scope:this}})}},{key:"_onAddShiftSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("save-shift",{params:[null,t.data]});case 2:return e.abrupt("return",this._loadDataProvider("get-shifts-data",{silent:!1,force:!0}));case 3:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_onClearFiltersClick",value:function(){this.timezoneFilter.clear(),this.quickFilter.clear()}},{key:"_onCloneShiftClick",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.shiftHoursModal.show({header:"Clone ".concat(t.name),timezoneOptions:this._timezoneOptions,shiftNames:this._getCurrentShiftNames(),submitButtonText:"Create Shift",listeners:{submit:this._onAddShiftSubmit,scope:this}}),this.shiftHoursModal.spinner(),e.next=3,this._loadDataProvider("get-shift-hours",{params:[t.id],requestId:t.id,silent:!1,force:!1});case 3:n=e.sent,(n=n2.clone(n.response)).name="",this.shiftHoursModal.model=n,this.shiftHoursModal.spinner(!1);case 6:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){this.slideOutPanel.hide(),this.load({silent:!0,force:!0})}},{key:"_getCurrentShiftNames",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).excludeName,t=void 0===e?null:e,e=this._model.map(function(e){return e.name});return e=n2.isNull(t)?e:e.filter(function(e){return e!==t})}}]),u}(),n2.de.page.classifier.AutoConversionSettings=function(){_inherits(o,n2.de.page.Classifier);var e,t,n=_createSuper(o);function o(){return _classCallCheck(this,o),n.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="".concat(this._componentCls," n2-de-auto-conversion-settings"),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-auto-conversion-settings","toggle-auto-conversion-enabled"],this._cls="".concat(this._cls," n2_form-page"),this._heading="Auto-Conversion > Settings",this._headingIcon=n2.de.enum.Icon.AUTO_CONVERSION,this._helpLinkURL="https://help.nc-squared.com/configuring-auto-conversion",this._actionMenuOptions=[{id:"changeHistory",label:"Auto-Conversion History"}],this._autoConversionSettings=null,this._objectFieldOptions=null,this._erroredDataProviderId=null}},{key:"autoConversionSettingsForm",get:function(){return this._components["auto-conversion-settings-form"]}},{key:"classifierFailedMessage",get:function(){return this.autoConversionSettingsForm.components["classifier-failed-message"]}},{key:"maintenanceModeOnMessage",get:function(){return this.autoConversionSettingsForm.components["maintenance-mode-on-message"]}},{key:"enableAutoConversionToggle",get:function(){return this.autoConversionSettingsForm.components["enable-auto-conversion-toggle"]}},{key:"delayFilter",get:function(){return this.autoConversionSettingsForm.components["delay-filter"]}},{key:"autoConversionRules",get:function(){return this.autoConversionSettingsForm.components["auto-conversion-rules"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertAutoConversionSettingsForm()}},{key:"_insertAutoConversionSettingsForm",value:function(){return this._insert(new n2.de.component.Form({id:"auto-conversion-settings-form",mixins:[n2.mixin.DataDriven],dataProviders:["save-auto-conversion-settings"],components:[this._createClassifierFailedMessage(),this._createMaintenanceModeOnMessage(),this._createEnableAutoConversionToggle(),this._createDelayFilter(),this._createDelayFilterMessage(),this._createAutoConversionRules()],listeners:{change:this._onAutoConversionSettingsFormChange,submit:this._onAutoConversionSettingsFormSubmit,cancel:this._onAutoConversionSettingsFormCancel,saved:this._onAutoConversionSettingsFormSaved,scope:this}}))}},{key:"_onAutoConversionSettingsFormChange",value:function(e){"enable-auto-conversion-toggle"===e.relatedTarget.id?this._onEnableAutoConversionToggleChange(e):this.enableAutoConversionToggle.disabled=!0}},{key:"_onEnableAutoConversionToggleChange",value:function(e){e.preventDefault(),this._postDataProvider("toggle-auto-conversion-enabled",{params:[this.enableAutoConversionToggle.value]})}},{key:"_onAutoConversionSettingsFormSubmit",value:function(){this._postDataProvider("save-auto-conversion-settings",{params:[this._autoConversionSettings.json]})}},{key:"_onAutoConversionSettingsFormCancel",value:function(){this.load()}},{key:"_onAutoConversionSettingsFormSaved",value:function(e,t){this._handleAutoConversionSettingsResponse(t)}},{key:"_createClassifierFailedMessage",value:function(){return new n2.de.component.ScopedNotification({id:"classifier-failed-message",renderTo:{position:"afterbegin"},type:"warning",isLightTheme:!0,content:"The classifier has aborted. Please restart.",hidden:!0})}},{key:"_createMaintenanceModeOnMessage",value:function(){return new n2.de.component.ScopedNotification({id:"maintenance-mode-on-message",renderTo:{position:"afterbegin"},type:"info",hidden:!0})}},{key:"_createEnableAutoConversionToggle",value:function(){return new n2.ui.component.field.CheckboxToggle({id:"enable-auto-conversion-toggle",label:"Enable Auto-Conversion",mixins:[n2.mixin.DataDriven],helpText:"Starts and stops auto-conversion from running.",onLabel:"Enabled",offLabel:"Disabled",disabled:!0,value:{bindPath:".autoConversionEnabled"}})}},{key:"_createDelayFilter",value:function(){var n,s=this;return new n2.ui.component.field.LogicFilter({id:"delay-filter",cls:"slds-m-top_medium",label:"Delay filter",helpText:"You can delay auto-conversion of records until they meet the defined condition.",max:1,mixins:[n2.mixin.DataDriven],loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),i=n.get("name"),e.next=4,s._fetchDataProvider("get-picklist-field-options",{params:["Lead",i],requestId:"Lead.".concat(i),force:!1,silent:!0});case 4:i=e.sent,t.options=i.response,t.spinner(!1);case 6:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),value:{bindPath:".processingFilter.filters",defaultValue:{filters:[]}}})}},{key:"_createDelayFilterMessage",value:function(){return new n2.de.component.ScopedNotification({id:"delay-filter-message",renderTo:".slds-form-element",cls:"slds-m-top_medium",type:"info",isLightTheme:!0,content:"This delay processing filter impacts all classification of leads across territory, lead matching and auto-conversion processing for Leads."})}},{key:"_createAutoConversionRules",value:function(){return new n2.de.page.classifier.autoConversionSettings.AutoConversionRules({id:"auto-conversion-rules",renderTo:".slds-form-element",cls:"slds-m-top_medium",listeners:{loaded:this._onAutoConversionRulesLoaded,scope:this}})}},{key:"_onAutoConversionRulesLoaded",value:function(e,t,n){n2.isNull(n)&&(this._autoConversionSettings.set(t,{key:"rules"}),this._refresh({enableAutoConversionToggle:!0}))}},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.t0=Promise,e.next=6,this._loadDataProvider("get-auto-conversion-settings",{force:n,silent:t});case 6:return e.t1=e.sent,e.next=9,this._loadDataProvider("get-all-field-options",{params:["Lead"],force:n,silent:t,requestId:"Lead"});case 9:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=13,e.t0.all.call(e.t0,e.t3);case 13:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{autoConversionSettings:i,objectFieldOptions:s});case 18:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.autoConversionSettings,e=e.objectFieldOptions;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._objectFieldOptions=e.response,this._handleAutoConversionSettingsResponse(t.response)}},{key:"_onActionMenuClick",value:function(e){"changeHistory"===(_get(_getPrototypeOf(o.prototype),"_onActionMenuClick",this).apply(this,arguments),e.id)&&this._onChangeHistoryClick()}},{key:"_onChangeHistoryClick",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-auto-conversion-rule-change-history",{force:!0,silent:!0});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Auto-Conversion history",model:t.response,showName:!0});case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){_get(_getPrototypeOf(o.prototype),"_onSaving",this).apply(this,arguments),this.autoConversionSettingsForm.disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onSaved",this).apply(this,arguments),"toggle-auto-conversion-enabled"===t.id&&(this.autoConversionSettingsForm.disabled=!1,this._handleAutoConversionSettingsResponse(e))}},{key:"_handleAutoConversionSettingsResponse",value:function(e){this._autoConversionSettings=new n2.dataProvider.Model({value:e}),this._refresh()}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onError",this).call(this,e),this._erroredDataProviderId=t.id,this.autoConversionSettingsForm.disabled=!1}},{key:"_getServerErrorConfig",value:function(){return{listeners:{submit:this._onErrorMessageBoxClose,cancel:this._onErrorMessageBoxClose,scope:this}}}},{key:"_onErrorMessageBoxClose",value:function(){"toggle-auto-conversion-enabled"===this._erroredDataProviderId&&this.load()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.classifierFailedMessage,i=e.maintenanceModeOnMessage,i=void 0!==i&&i,s=e.enableAutoConversionToggle,s=void 0!==s&&s,a=e.delayFilter,a=void 0!==a&&a,e=e.autoConversionRules,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshClassifierFailedMessage(),(t||i)&&this._refreshMaintenanceModeOnMessage(),(t||s)&&this._refreshEnableAutoConversionToggle(),(t||a)&&this._refreshDelayFilter(),(t||e)&&this._refreshAutoConversionRules()}},{key:"_refreshClassifierFailedMessage",value:function(){this.classifierFailedMessage.hidden=!this._autoConversionSettings.get("hasClassifierFailed")}},{key:"_refreshMaintenanceModeOnMessage",value:function(){this.maintenanceModeOnMessage.content=this._autoConversionSettings.get("maintenanceModeMessage"),this.maintenanceModeOnMessage.hidden=!this._autoConversionSettings.get("maintenanceModeOn")}},{key:"_refreshEnableAutoConversionToggle",value:function(){this.enableAutoConversionToggle.model=this._autoConversionSettings,this.enableAutoConversionToggle.disabled=n2.isEmpty(this._autoConversionSettings.get("rules"))}},{key:"_refreshDelayFilter",value:function(){this.delayFilter.fieldOptions=n2.de.data.Adapters.classifierFilterFieldOptions(this._objectFieldOptions),this.delayFilter.model=this._autoConversionSettings}},{key:"_refreshAutoConversionRules",value:function(){this.autoConversionRules.model=this._autoConversionSettings.get("rules")}}]),o}(),n2.de.page.classifier.Backfill=function(){_inherits(o,n2.de.page.Classifier);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="".concat(this._componentCls," n2-de-backfill"),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["is-backfill-in-progress"],this._heading="Advanced > Backfill",this._headingIcon=n2.de.enum.Icon.SURVEY,this._helpLinkURL="https://help.nc-squared.com/backfill",this._backfillObjectOptions=null,this._isBackfillInProgress=!1}},{key:"backfillInProgressMessage",get:function(){return this._components["backfill-in-progress-message"]}},{key:"backfillRecordsButton",get:function(){return this._components["backfill-records"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertBackfillInProgressMessage(),this._insertBackfillInformationMessage(),this._insertBackfillWizardButton()}},{key:"_insertBackfillInProgressMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"backfill-in-progress-message",type:"info",cls:"n2_backfill-in-progress-message slds-m-bottom_medium",isLightTheme:!0,hidden:!0,content:"Your backfill is still in progress. This should complete quickly but processing times will vary depending on the number of records and how busy your org is.",components:[new n2.ui.component.Button({id:"check-backfill-progress",text:"Check again",renderTo:".slds-media__body",listeners:{click:this._onCheckBackfillProgressClick,scope:this}})]}))}},{key:"_onCheckBackfillProgressClick",value:function(e){this._loadIsBackfillInProgress()}},{key:"_insertBackfillInformationMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"backfill-information-message",type:"info",cls:"slds-m-bottom_medium",isLightTheme:!0,content:"The Classifier will automatically run on newly created records. Backfill allows you to run the Territories, Lead Matching and Auto-Conversion rules on records that already exist on your org."}))}},{key:"_insertBackfillWizardButton",value:function(){return this._insert(new n2.ui.component.Button({id:"backfill-records",text:"Backfill Records",theme:n2.ui.component.button.Theme.PRIMARY,listeners:{click:this._onBackfillButtonClick,scope:this}}))}},{key:"_onBackfillButtonClick",value:function(e){n2.de.page.classifier.backfill.BackfillWizard.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({backfillObjectOptions:this._backfillObjectOptions,listeners:{saved:this._onBackfillPerformed,scope:this}})}},{key:"_onBackfillPerformed",value:function(e,t,n){this._isBackfillInProgress=!0,this._refresh({backfillInProgressMessage:!0,backfillRecordsButton:!0}),n2.ui.component.MessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({theme:n2.ui.enum.Theme.SUCCESS,header:"Backfill Records",message:"Batch ".concat(t," has been successfully submitted to backfill the selected records"),buttons:n2.ui.enum.Button.OK})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadIsBackfillInProgress({silent:t,force:n}),this._loadDataProvider("get-backfill-object-options",{force:!1,silent:t})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{isBackFillInProgress:i,backfillObjects:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.isBackFillInProgress,e=e.backfillObjects;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._isBackfillInProgress=t.response,this._backfillObjectOptions=e.response.map(function(e){return e.Name}),this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"is-backfill-in-progress"===t.id&&(this._isBackfillInProgress=e,this._refresh())}},{key:"_loadIsBackfillInProgress",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,e=e.force;return this._loadDataProvider("is-backfill-in-progress",{silent:void 0!==t&&t,force:void 0===e||e})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(o.prototype),"_refresh",this).apply(this,arguments),n2.isEmpty(e)),n=e.backfillInProgressMessage,e=e.backfillRecordsButton,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshBackfillInProgressMessage(),(t||e)&&this._refreshBackfillRecordsButton()}},{key:"_refreshBackfillInProgressMessage",value:function(){this.backfillInProgressMessage.hidden=!this._isBackfillInProgress}},{key:"_refreshBackfillRecordsButton",value:function(){if(this._isBackfillInProgress||n2.isEmpty(this._backfillObjectOptions))return this.backfillRecordsButton.disable();this.backfillRecordsButton.enable()}}]),o}(),n2.de.page.console.ApplicationMonitoring=function(){_inherits(t,n2.de.page.Console);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._heading="Application Monitoring",this._headingIcon=n2.de.enum.Icon.APPLICATION_MONITORING,this._helpLinkURL="https://help.nc-squared.com/consoles/application-monitoring",this._componentCls="n2-de-application-monitoring",this._activeNavigationId="application-monitoring",this._showRefreshButton=!0}},{key:"distributionEngineCard",get:function(){return this._components["distribution-engine-card"]}},{key:"healthCheckerCard",get:function(){return this._components["health-checker-card"]}},{key:"classifierCard",get:function(){return this._components["classifier-card"]}},{key:"objectSyncCard",get:function(){return this._components["object-sync-card"]}},{key:"additionalInfoCard",get:function(){return this._components["additional-info-card"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).call(this),n2.de.ApplicationContext.getInstance().isDESystemManager?this._insertAccessDeniedCard():(this._insertDistributionEngineCard(),this._insertHealthCheckerCard(),this._insertClassifierCard(),this._insertObjectSyncCard(),this._insertAdditionalInfoCard())}},{key:"_insertDistributionEngineCard",value:function(){return this._insert(new n2.de.page.console.applicationMonitoring.DistributionEngineCard({id:"distribution-engine-card",cls:"n2_col2"}))}},{key:"_insertHealthCheckerCard",value:function(){return this._insert(new n2.de.page.console.applicationMonitoring.HealthCheckerCard({id:"health-checker-card",cls:"n2_col2"}))}},{key:"_insertClassifierCard",value:function(){return this._insert(new n2.de.page.console.applicationMonitoring.ClassifierCard({id:"classifier-card",cls:"n2_col2"}))}},{key:"_insertObjectSyncCard",value:function(){return this._insert(new n2.de.page.console.applicationMonitoring.ObjectSyncCard({id:"object-sync-card",cls:"n2_col2"}))}},{key:"_insertAdditionalInfoCard",value:function(){return this._insert(new n2.de.page.console.applicationMonitoring.AdditionalInfoCard({id:"additional-info-card",cls:"n2-de-console-card n2_col1"}))}},{key:"_insertAccessDeniedCard",value:function(){return this._insert(new n2.de.component.Card({id:"access-denied-card",cls:"n2_col1",icon:{icon:n2.de.enum.Icon.LOCK,cls:"n2_neutral"},heading:"Access to this page is restricted",content:"Only Distribution Engine Admins can view this page, please contact your Salesforce Admin to add you to the appropriate permission set."}))}},{key:"_reload",value:function(){this.distributionEngineCard.load({force:!0}),this.healthCheckerCard.load({force:!0}),this.classifierCard.load({force:!0}),this.objectSyncCard.load({force:!0}),this.additionalInfoCard.load({force:!0})}}]),t}(),n2.de.page.console.Calendar=function(){_inherits(o,n2.de.page.Console);var t,e,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this.dataProviders=["get-filter-options-data","get-calendar-data"],this._heading="Calendar",this._headingIcon=n2.de.enum.Icon.MONTHLY_VIEW,this._helpLinkURL="https://help.nc-squared.com/consoles/availability-calendar",this._componentCls="n2-de-calendar-page",this._mixins=[n2.mixin.DataDriven],this._activeNavigationId="calendar",this._showRefreshButton=!0,this._filterOptionsData=null,this._openedDayCell=null,this._reloaded=!1,this._REFRESH={filterOptionsData:["calendarRecordList","emptyState"]}}},{key:"calendarRecordList",get:function(){return this._components["calendar-record-list"]}},{key:"emptyState",get:function(){return this._components["empty-state"]}},{key:"slideOutPanel",get:function(){return n2.de.component.availabilityCalendar.SlideOutPanel.getInstance({mixins:[n2.mixin.DataDriven],dataProviders:["get-calendar-day-data"],renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).call(this),this._insertEmptyState(),this._insertCalendarRecordList()}},{key:"_insertCalendarRecordList",value:function(){return this._insert(new n2.de.page.console.calendar.CalendarRecordList({id:"calendar-record-list",hidden:!0,listeners:{change:this._onRecordListChange,click:this._onRecordListClick,scope:this}}))}},{key:"_onRecordListChange",value:function(e){switch(e.target.id){case this.calendarRecordList.toolbar.teamFilter.id:return this.calendarRecordList.toolbar.teamMemberFilter.clear(),this._loadCalendarDataForCurrentMonth(this.calendarRecordList.toolbar.teamFilter.value);case this.calendarRecordList.availabilityCalendar.id:return this._loadCalendarDataForCurrentMonth(this.calendarRecordList.toolbar.teamFilter.value);case this.calendarRecordList.toolbar.teamMemberFilter.id:case this.calendarRecordList.toolbar.tagFilter.id:return this._refresh(["slideOutPanel"])}}},{key:"_onRecordListClick",value:function(e){this._openedDayCell=e.target,this.slideOutPanel.show({listeners:{show:this._onSlideOutPanelShow,click:this._onSlideOutPanelClick,scope:this}})}},{key:"_onSlideOutPanelShow",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._getOpenedDayCellDate(),e.next=3,this._loadSlideOutPanelData(n);case 3:i=e.sent.response,this.slideOutPanel.setProperties({date:n,shiftsData:i.shiftsOnDay,outOfOfficeData:i.ooosForUser,availabilityData:this._openedDayCell.availabilityData,filteredAvailabilityData:this._openedDayCell.filteredAvailabilityData});case 5:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_loadSlideOutPanelData",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.calendarRecordList.toolbar.teamFilter.value,i=this._getDateAsStringParameter(t),s=this._openedDayCell.availabilityData.teamMembersWorking.map(function(e){return[e.userId,e.shiftHoursId]}),e.abrupt("return",this._fetchDataProvider("get-calendar-day-data",{params:[n,i,Object.fromEntries(s)],silent:!1,force:this._reloaded,requestId:"".concat(n,"-").concat(i)}));case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_onSlideOutPanelClick",value:function(e){!n2.isNull(e.data)&&e.data.actions.includes("clear-filters")&&this.calendarRecordList.toolbar.clear()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",heading:"Your org doesn't have any teams yet",content:"The calendar page shows shifts, out of office and holidays for a whole team. ",illustration:n2.de.illustration.Desert,components:[new n2.de.component.Link({id:"team-link",text:"Create your first team to get started.",renderTo:".slds-text-longform p",listeners:{click:this._onTeamLinkClick,scope:this}})]}))}},{key:"_onTeamLinkClick",value:function(e){n2.de.page.Navigation.getInstance().open("Team_TeamList")}},{key:"_load",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).call(this,{silent:t,force:n});case 3:return e.next=5,this._loadDataProvider("get-filter-options-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e.calendarData;var t,e=e.filterOptionsData;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),n2.isEmpty(e.response.teams)||(n2.sort(e.response.teams,{property:"label"}),t=e.response.teams[0].value,this._loadCalendarDataForCurrentMonth(t)),this._setProperties({filterOptionsData:e.response})}},{key:"_reload",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchDataProvider("get-filter-options-data",{silent:!1,force:!0});case 2:this._loadCalendarDataForCurrentMonth(this.calendarRecordList.toolbar.teamFilter.value,{force:!0}),this._reloaded=!0;case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadCalendarDataForCurrentMonth",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(n){var t,i,s,a,o=this,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(t=1<r.length&&void 0!==r[1]?r[1]:{}).silent,i=void 0!==s&&s,s=t.force,a=void 0!==s&&s,e.abrupt("return",(this.slideOutPanel.hide(),this.calendarRecordList.availabilityCalendar.dateRangeWeeks.map(function(e,t){return o._loadCalendarDataForDateRange(n,e,t,{silent:i,force:a})})));case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_loadCalendarDataForDateRange",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},s=i.silent,i=i.force,a=this._getDateAsStringParameter(t.startDate),t=this._getDateAsStringParameter(t.endDate);return this._fetchDataProvider("get-calendar-data",{params:[e,a,t],silent:s,force:i,requestId:"".concat(e,"-").concat(a,"-").concat(t,"-week-").concat(n)})}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-options-data"===t.id&&(n2.sort(e.teams,{property:"label"}),this._setProperties({filterOptionsData:e})),"get-calendar-data"===t.id&&(t=Number(n.substring(n.length-1)),n=this._combineAvailabilityDayDataWithUserData(e),this.calendarRecordList.loadAvailabilityData(n,{weekNumber:t}))}},{key:"_combineAvailabilityDayDataWithUserData",value:function(e){var t=e.calendarDays,i=e.usersWithTags;return t.map(function(e){var t=Object.entries(e.teamMembersWorking).map(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return n2.merge(i[t],{shiftHoursId:e})}),n=e.teamMembersOutOfOffice.map(function(e){return i[e]});return n2.sort(t,{property:"userName"}),n2.sort(n,{property:"userName"}),{teamMembersWorking:t,teamMembersOutOfOffice:n,teamHolidayNames:e.teamHolidayNames||[]}})}},{key:"_refreshCalendarRecordList",value:function(){this.calendarRecordList.filterOptionsData=this._filterOptionsData,this.calendarRecordList.hidden=n2.isEmpty(this._filterOptionsData.teams)}},{key:"_refreshEmptyState",value:function(){this.emptyState.hidden=!n2.isEmpty(this._filterOptionsData.teams)}},{key:"_refreshSlideOutPanel",value:function(){this.slideOutPanel.hidden||this.slideOutPanel.setProperty("filteredAvailabilityData",this._openedDayCell.filteredAvailabilityData)}},{key:"_getOpenedDayCellDate",value:function(){var e=this._openedDayCell.data;return new Date(Date.UTC(e.year,e.month-1,e.day))}},{key:"_getDateAsStringParameter",value:function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}}]),o}(),n2.de.page.console.Context=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.Singleton]}}]),t}(),n2.de.page.console.SourceList=function(){_inherits(s,n2.de.page.Console);var e,t,n=_createSuper(s);function s(){return _classCallCheck(this,s),n.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Sources",this._headingIcon=n2.de.enum.Icon.SOURCES,this._helpLinkURL="https://help.nc-squared.com/consoles/sources-console",this._componentCls="n2-de-source-list",this._activeNavigationId="source-list",this._showRefreshButton=!0,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["dataTable"],distributorList:["dataTable"],teamCountsList:["cells"]}),this._distributorList=null,this._teamCountsList=null,this._cellMap={},this._isLoadingMainData=!0,this._currentCountRequests=0,this._isReloading=!1}},{key:"sourceListDataTable",get:function(){return this._components["source-list-data-table"]}},{key:"_insertPageComponents",value:function(){this._actionMenuOptions=[{id:"assignment-simulation",label:"Assignment Simulation"}],_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertSourceList()}},{key:"_onActionMenuClick",value:function(e){this._openAssignmentSimulationModal()}},{key:"_showLoadingSpinner",value:function(){this._isLoadingMainData&&_get(_getPrototypeOf(s.prototype),"_showLoadingSpinner",this).apply(this,arguments)}},{key:"_insertSourceList",value:function(){return this.insert(new n2.de.page.console.sourceList.DataTable({id:"source-list-data-table"}))}},{key:"_loadDistributorCounts",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,n=void 0===n||n,t=t.force,t=void 0!==t&&t;return this._isLoadingMainData=!1,this._currentCountRequests+=1,this._loadDataProvider("get-distributor-counts-for-team",{params:[e],requestId:"team-request-".concat(e),silent:n,force:t})}},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return this._isLoadingMainData=!0,e.next=6,this._loadDataProvider("get-distributors",{silent:t,force:n});case 6:return e.t0=e.sent,e.abrupt("return",{distributorList:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-distributors"===t.id&&(this._setProperty("distributorList",e),this._updateTableData()),"get-distributor-counts-for-team"===t.id&&(--this._currentCountRequests,this._setProperty("teamCountsList",e),this.sourceListDataTable.syncCellData())}},{key:"_onLoadComplete",value:function(e){var t=e.distributorList;e.distributorCounts;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("distributorList",t.response),this._updateTableData({force:this._isReloading})}},{key:"_initialiseCountCells",value:function(e,t){e.components["available-cell"].spinner(),e.components["on-hold-cell"].spinner(),this._cellMap[t]=e}},{key:"_updateCountCells",value:function(e){var t=this._cellMap[e.distributorId];n2.isUndefined(t)||(t.data=n2.merge({},t.data,{onHoldCount:e.onHoldCount,availableCount:e.availableCount,totalCount:e.totalCount,warning:e.warning||!1}))}},{key:"_updateTableData",value:function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0===e||e,s=(this._cellMap={},new Set);this.sourceListDataTable.forEachRow(function(e){var t=e.data,n=t.distributorId,t=t.teamId;i._initialiseCountCells(e,n),s.add(t)}),this._loadCountsData(_toConsumableArray(s),{force:t,silent:e})}},{key:"_loadCountsData",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=n.force,s=void 0!==i&&i,i=n.silent,a=void 0===i||i,o=setInterval(function(){if(!e.length)return clearInterval(o);2<t._currentCountRequests||t._loadDistributorCounts(e.shift(),{force:s,silent:a})},15)}},{key:"_reload",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._isReloading=!0,e.next=3,_get(_getPrototypeOf(s.prototype),"_reload",this).apply(this,t);case 3:this._isReloading=!1;case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_refreshDataTable",value:function(){this.sourceListDataTable.data=this._distributorList,this._updateActionMenuVisibility()}},{key:"_refreshCells",value:function(){var t=this;this._teamCountsList.forEach(function(e){t._updateCountCells(e)}),this._teamCountsList=null}},{key:"_updateActionMenuVisibility",value:function(){this.pageHeader.actionMenu.hidden=0===this._distributorList.length}},{key:"_openAssignmentSimulationModal",value:function(){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show()}}]),s}(),n2.de.page.console.TodaysDistributionList=function(){_inherits(s,n2.de.page.Console);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Today's Distributions",this._headingIcon=n2.de.enum.Icon.DISTRIBUTION,this._helpLinkURL="https://help.nc-squared.com/consoles/todays-distributions",this._componentCls="n2-de-todays-distribution-list",this._activeNavigationId="todays-distribution-list",this._showRefreshButton=!0,this._distributionCounts=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["dataTable"],distributionCounts:["dataTable"]})}},{key:"distributionList",get:function(){return this._components["todays-distribution-list-data-table"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertDistributionList()}},{key:"_insertDistributionList",value:function(){return this.insert(new n2.de.page.console.todaysDistributionList.DataTable({id:"todays-distribution-list-data-table"}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-todays-distribution-counts-by-team",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{distributionCounts:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-todays-distribution-counts-by-team"===t.id&&this._setProperty("distributionCounts",e)}},{key:"_onLoadComplete",value:function(e){e=e.distributionCounts;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("distributionCounts",e.response)}},{key:"_refreshDataTable",value:function(){this.distributionList.data=this._distributionCounts}}]),s}(),n2.de.page.logs.ArchiveLogList=function(){_inherits(s,n2.de.page.Logs);var e,n,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-archive-logs"],this._heading="Archive Logs",this._headingIcon=n2.de.enum.Icon.ARCHIVE,this._helpLinkURL="https://help.nc-squared.com/logs/archive-logs",this._componentCls="".concat(this._componentCls," n2-de-archive-log-list"),this._activeNavigationId="archive-log-list",this._archiveLogs=null,this._isArchivingEnabled=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"lastArchivedDate",direction:"dsc"}},this._REFRESH={totalLogCount:["recordList"],isArchivingEnabled:["recordList","archivingNotification"],archiveLogs:["recordList"]}}},{key:"archivingNotification",get:function(){return this.components["archiving-notification"]}},{key:"recordList",get:function(){return this.components["archive-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertArchivingNotification(),this._insertRecordList()}},{key:"_insertArchivingNotification",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"archiving-notification",hidden:!0,renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'Archiving is currently disabled, enable it <span class="n2__settings-link"></span>.',components:[new n2.de.component.Link({id:"settings-link",text:"here",renderTo:".n2__settings-link",listeners:{click:this._navigateToSettings,scope:this}})]}))}},{key:"_navigateToSettings",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.archiveLogList.ArchiveLogsRecordList({id:"archive-logs-record-list",cls:"n2-archive-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&this._loadArchiveLogs({data:e.data.filterOptions})}},{key:"_loadArchiveLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data,e=void 0===e?this._defaultOptions:e;return this._loadDataProvider("get-archive-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_handleRecordListAction",value:function(e){switch(e.target.id){case"clear-filters-button":this._loadArchiveLogs({data:this.recordList.getFilterOptions()});break;case"restore-log":this._onRestoreLog(e.data);break;case"restore-logs":this._onRestoreLogs()}}},{key:"_onRestoreLog",value:function(t){var n=this;this._showConfirmation(["restore-archived-logs"],"You are trying to restore ".concat(t.recordName,", this will make it available for distribution again. Are you sure you want to continue?"),function(e){return n._restoreArchivedLogs(e,[t.recordId])})}},{key:"_onRestoreLogs",value:function(){var t=this,n=this.recordList.selectedData.map(function(e){return e.recordId});if(1===n.length)return this._onRestoreLog(this.recordList.selectedData[0]);this._showConfirmation(["restore-archived-logs"],"You are trying to restore ".concat(this.recordList.selectedData.length," logs, this will make them available for distribution again. Are you sure you want to continue?"),function(e){return t._restoreArchivedLogs(e,n)})}},{key:"_restoreArchivedLogs",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("restore-archived-logs",{params:[n]});case 2:return e.next=4,t.hide();case 4:return e.abrupt("return",this._loadArchiveLogs({force:!0,data:this.recordList.getFilterOptions()}));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_showConfirmation",value:function(e,t,n){n2.de.page.logs.component.ConfirmationMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:e}).show({message:t,listeners:{submit:n,scope:this}})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadArchiveLogs({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{archiveLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-archive-logs"===t.id&&this._setProperties({totalLogCount:e.totalCount,isArchivingEnabled:e.archivingEnabled,archiveLogs:e.logVOs})}},{key:"_onLoadComplete",value:function(e){e=e.archiveLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperties({totalLogCount:e.response.totalCount,isArchivingEnabled:e.response.archivingEnabled,archiveLogs:e.response.logVOs})}},{key:"_hasPropertyChanged",value:function(e,t){return"archiveLogs"===e||_get(_getPrototypeOf(s.prototype),"_hasPropertyChanged",this).apply(this,arguments)}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.dataTable.isArchivingEnabled=this._isArchivingEnabled,this.recordList.data=this._archiveLogs}},{key:"_refreshArchivingNotification",value:function(){this.archivingNotification.hidden=this._isArchivingEnabled}}]),s}(),n2.de.page.logs.AutoConversionLogList=function(){_inherits(s,n2.de.page.Logs);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-auto-conversion-logs"],this._heading="Auto-Conversion Logs",this._headingIcon=n2.de.enum.Icon.AUTO_CONVERSION,this._helpLinkURL="https://help.nc-squared.com/auto-conversion-logs-list",this._componentCls="".concat(this._componentCls," n2-de-auto-conversion-log-list"),this._activeNavigationId="auto-conversion-log-list",this._autoConversionLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"assignmentDate",direction:"dsc"}}}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.autoConversionLogList.AutoConversionSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"classifierNotification",get:function(){return this.components["classifier-notification"]}},{key:"recordList",get:function(){return this.components["auto-conversion-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertClassifierNotification(),this._insertRecordList()}},{key:"_insertClassifierNotification",value:function(){var e=this;return this._insert(new n2.de.component.ScopedNotification({id:"classifier-notification",hidden:n2.de.page.logs.Context.getInstance().isClassifierLoggingEnabled,renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'Auto-Conversion logging is currently disabled, enable it <span class="n2__settings-link"></span>.',components:[new n2.de.component.Link({id:"settings-link",text:"here",renderTo:".n2__settings-link",listeners:{click:function(){return e._navigateToSettings()}}})]}))}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.autoConversionLogList.AutoConversionLogsRecordList({id:"auto-conversion-logs-record-list",cls:"n2-auto-conversion-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("clear-filters-button"===e.target.id)return this._loadAutoConversionLogs({data:this.recordList.getFilterOptions()});e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&this._loadAutoConversionLogs({data:e.data.filterOptions})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.recordName,includeNavButtons:!e.isRecordDeleted,log:e})}},{key:"_navigateToSettings",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}},{key:"_loadAutoConversionLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data,e=void 0===e?this._defaultOptions:e;return this._loadDataProvider("get-auto-conversion-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadAutoConversionLogs({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{autoConversionLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-auto-conversion-logs"===t.id&&(this._totalLogCount=e.totalCount,this._autoConversionLogs=e.logVOs,this.slideOutPanel.hide(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.autoConversionLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._totalLogCount=e.response.totalCount,this._autoConversionLogs=e.response.logVOs,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshRecordList()}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._autoConversionLogs}}]),s}(),n2.de.page.logs.Context=function(){_inherits(s,n2.Object);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this._mixins=[n2.mixin.DataDriven,n2.mixin.Singleton,n2.mixin.Observable],this._lazyLoad=!0,this._hasArchivingBeenEnabled=!1,this._isClassifierLoggingEnabled=!1,this._isFiltering=!1}},{key:"hasArchivingBeenEnabled",get:function(){return this._hasArchivingBeenEnabled},set:function(e){this._setProperty("hasArchivingBeenEnabled",e)}},{key:"isFiltering",get:function(){return this._isFiltering},set:function(e){this._isFiltering!==e&&(this._isFiltering=e,this.fire("change",this._createChangeEvent(this,[{property:"value",type:"set"}],{data:{isFiltering:this._isFiltering}})))}},{key:"isClassifierLoggingEnabled",get:function(){return this._isClassifierLoggingEnabled},set:function(e){this._setProperty("isClassifierLoggingEnabled",e)}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-logs-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{loggingData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.loggingData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.hasArchivingBeenEnabled=e.response.hasArchivingBeenEnabled,this.isClassifierLoggingEnabled=e.response.isClassifierLoggingEnabled}}]),s}(),n2.de.page.logs.DistributionLogList=function(){_inherits(r,n2.de.page.Logs);var e,t,n,i,s,a,o=_createSuper(r);function r(){return _classCallCheck(this,r),o.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-distribution-logs"],this._heading="Distribution Logs",this._headingIcon=n2.de.enum.Icon.DISTRIBUTION,this._helpLinkURL="https://help.nc-squared.com/distribution-logs-list",this._componentCls="".concat(this._componentCls," n2-de-distribution-log-list"),this._activeNavigationId="distribution-log-list",this._pageContext=n2.de.page.logs.distributionLogList.Context.getInstance(),this._distributionLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"assignmentDate",direction:"dsc"}},this._onHoldLogCount=null,this._slideOutPanelLogId=null}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.distributionLogList.DistributionSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"recordList",get:function(){return this.components["distribution-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(r.prototype),"_insertPageComponents",this).call(this),n2.de.ApplicationContext.getInstance().hasNoDEPermissionSet&&this._insertPermissionSetMessage(),this._insertRecordList()}},{key:"_insertPermissionSetMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"permission-set-message",renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'You do not have any Distribution Engine permission sets assigned. <a href="https://help.nc-squared.com/permissions">Add a packaged permission set</a> to ensure you have access to any newly released features.'}))}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.distributionLogList.DistributionLogsRecordList({id:"distribution-logs-record-list",cls:"n2-distribution-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){var t=!1;switch(e.target.id){case"clear-filters-button":this._loadDistributionLogs({data:this.recordList.getFilterOptions()}),t=!0;break;case"delete-log":this._onDeleteLog(e.data),t=!0;break;case"delete-logs":this._onDeleteLogs(),t=!0;break;case"retry-log":this._onRetryLog(e.data),t=!0;break;case"retry-all":this._onRetryAll(),t=!0;break;case"reject-log":this._onRejectLog(e.data),t=!0;break;case"menu-cell":t=!0}var n=e.relatedTarget instanceof n2.ui.component.dataTable.Row;!t&&n&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_onDeleteLog",value:function(t){var n=this;this._showConfirmation(["delete-distribution-logs"],"You are trying to delete the log of ".concat(t.stampedRecordName," on ").concat(n2.de.util.Date.formatTimestamp(t.assignmentDate),". Are you sure you want to continue?"),function(e){return n._deleteDistributionLogs(e,[t.logId])})}},{key:"_onDeleteLogs",value:function(){var t=this,n=this.recordList.selectedData.map(function(e){return e.logId});if(1===n.length)return this._onDeleteLog(this.recordList.selectedData[0]);this._showConfirmation(["delete-distribution-logs"],"You are trying to delete ".concat(this.recordList.selectedData.length," logs. Are you sure you want to continue?"),function(e){return t._deleteDistributionLogs(e,n)})}},{key:"_deleteDistributionLogs",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-distribution-logs",{params:[n]});case 2:return e.next=4,t.hide();case 4:return e.abrupt("return",this._loadDistributionLogs({force:!0,data:this.recordList.getFilterOptions()}));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"_onRetryLog",value:function(t){var n=this;this._showConfirmation(["retry-on-hold-assignments"],"Do you want to retry processing ".concat(t.stampedRecordName,"?"),function(e){return n._onRetryConfirmed(e,[t.logId])})}},{key:"_onRetryConfirmed",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("retry-on-hold-assignments",{params:[n]});case 2:return e.next=4,t.hide();case 4:return e.next=6,this._loadDistributionLogs({force:!0,data:this.recordList.getFilterOptions()});case 6:this.slideOutPanel.hidden||this._updateSlideOutPanel();case 7:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"_onRetryAll",value:function(){var e=1===this._onHoldLogCount?"record":"records";this._showConfirmation(["retry-all-on-hold-assignments"],"This will retry ".concat(this._onHoldLogCount," held ").concat(e,". Do you want to continue?"),this._onRetryAllConfirmed)}},{key:"_onRetryAllConfirmed",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("retry-all-on-hold-assignments");case 2:return e.next=4,t.hide();case 4:return e.abrupt("return",this._loadDistributionLogs({force:!0,data:this.recordList.getFilterOptions()}));case 5:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_onRejectLog",value:function(t){this.spinner();var n=this,i=0===(i=n2.de.ApplicationContext.getInstance().namespace).length?"c":i.replace("__","");$Lightning.use(i+":rejectlogapp",function(){var e={showRejectModal:!0,recordId:t.assignedObjectId};$Lightning.createComponent(i+":deRejectComponent",e,n.domId,function(e){return n._onRejectComponentCreated(e.elements[0])})})}},{key:"_onRejectComponentCreated",value:function(e){var t=this;this.spinner(!1),e.addEventListener("lightning__showtoast",function(e){return t._onShowRejectToast(e)}),e.addEventListener("close",function(e){return t._onRejectModalClose(e)})}},{key:"_onShowRejectToast",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n2.ui.component.Toast.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({theme:t.toastAttributes.type,message:t.toastAttributes.message});case 1:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"_onRejectModalClose",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.detail,e.t0)return e.next=4,this._loadDistributionLogs({data:this.recordList.getFilterOptions()});e.next=5;break;case 4:this.slideOutPanel.hidden||this._updateSlideOutPanel();case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_showConfirmation",value:function(e,t,n){n2.de.page.logs.component.ConfirmationMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:e}).show({message:t,listeners:{submit:n,scope:this}})}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&(this._loadDistributionLogs({data:e.data.filterOptions}),this.slideOutPanel.hide())}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.removeListeners("click",{caller:this}),this.slideOutPanel.show({heading:this._getSlideOutPanelHeading(e),includeNavButtons:!e.isAssignedObjectDeleted,log:e,listeners:{click:this._handleSlideOutPanelAction,scope:this}}),this._slideOutPanelLogId=e.logId}},{key:"_getSlideOutPanelHeading",value:function(e){return e.assignedObjectRecordName===e.stampedRecordName?e.assignedObjectRecordName:"".concat(e.assignedObjectRecordName," [").concat(e.stampedRecordName,"]")}},{key:"_handleSlideOutPanelAction",value:function(e){switch(e.target.id){case"retry-button":this._onRetryLog(e.data);break;case"reject-button":this._onRejectLog(e.data)}}},{key:"_updateSlideOutPanel",value:function(){var t=this,e=this._distributionLogs.find(function(e){return e.logId===t._slideOutPanelLogId});this._showSlideOutPanel(e)}},{key:"_loadDistributionLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data;return this._loadDataProvider("get-distribution-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDistributionLogs({silent:t,force:n,data:this._getDefaultOptions()});case 5:return e.t0=e.sent,e.abrupt("return",{distributionLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getDefaultOptions",value:function(){return n2.isEmpty(this._pageContext.logFilterData)?this._defaultOptions:n2.merge(this._defaultOptions,this._pageContext.logFilterData)}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(r.prototype),"_onLoaded",this).apply(this,arguments),"get-distribution-logs"===t.id&&(this._totalLogCount=e.totalLogCount,this._distributionLogs=e.logVOs,this._onHoldLogCount=e.onHoldCount,this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.distributionLogData;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._totalLogCount=e.response.totalLogCount,this._distributionLogs=e.response.logVOs,this._onHoldLogCount=e.response.onHoldCount,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshRecordList()}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._distributionLogs,this.recordList.toolbar.onHoldLogCount=this._onHoldLogCount,n2.isEmpty(this._pageContext.logFilterData)||(this.recordList.toolbar.filterData=this._pageContext.logFilterData,this.recordList.toolbar.isFiltering=!0,this._pageContext.clearLogFilterData())}}]),r}(),n2.de.page.logs.LeadMatchingLogList=function(){_inherits(s,n2.de.page.Logs);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-match-logs"],this._heading="Lead Matching Logs",this._headingIcon=n2.de.enum.Icon.LEAD_MATCHING,this._helpLinkURL="https://help.nc-squared.com/lead-matching-logs-list",this._componentCls="".concat(this._componentCls," n2-de-lead-matching-log-list"),this._activeNavigationId="lead-matching-log-list",this._leadMatchingLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"date",direction:"dsc"}}}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.leadMatchingLogList.LeadMatchingSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"classifierNotification",get:function(){return this.components["classifier-notification"]}},{key:"recordList",get:function(){return this.components["lead-matching-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertClassifierNotification(),this._insertRecordList()}},{key:"_insertClassifierNotification",value:function(){var e=this;return this._insert(new n2.de.component.ScopedNotification({id:"classifier-notification",hidden:n2.de.page.logs.Context.getInstance().isClassifierLoggingEnabled,renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'Classifier logging is currently disabled, enable it <span class="n2__settings-link"></span>.',components:[new n2.de.component.Link({id:"settings-link",text:"here",renderTo:".n2__settings-link",listeners:{click:function(){return e._navigateToSettings()}}})]}))}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.leadMatchingLogList.LeadMatchingLogsRecordList({id:"lead-matching-logs-record-list",cls:"n2-lead-matching-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("clear-filters-button"===e.target.id)return this._loadLeadMatchingLogs({data:this.recordList.getFilterOptions()});e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&this._loadLeadMatchingLogs({data:e.data.filterOptions})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.recordName,includeNavButtons:!e.isRecordDeleted,log:e})}},{key:"_navigateToSettings",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}},{key:"_loadLeadMatchingLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data,e=void 0===e?this._defaultOptions:e;return this._loadDataProvider("get-match-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadLeadMatchingLogs({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{leadMatchingLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-match-logs"===t.id&&(this._totalLogCount=e.totalLogCount,this._leadMatchingLogs=e.matchLogs,this.slideOutPanel.hide(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.leadMatchingLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._totalLogCount=e.response.totalLogCount,this._leadMatchingLogs=e.response.matchLogs,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshRecordList()}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._leadMatchingLogs}}]),s}(),n2.de.page.logs.ObjectSyncLogList=function(){_inherits(s,n2.de.page.Logs);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-object-sync-logs"],this._heading="Object Sync Logs",this._headingIcon=n2.de.enum.Icon.OBJECT_SYNC,this._helpLinkURL="https://help.nc-squared.com/object-sync-logs-list",this._componentCls="".concat(this._componentCls," n2-de-object-sync-log-list"),this._activeNavigationId="object-sync-log-list",this._objectSyncLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"date",direction:"dsc"}}}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.objectSyncLogList.ObjectSyncSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"recordList",get:function(){return this.components["object-sync-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.objectSyncLogList.ObjectSyncLogsRecordList({id:"object-sync-logs-record-list",cls:"n2-object-sync-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("clear-filters-button"===e.target.id)return this._loadObjectSyncLogs({data:this.recordList.getFilterOptions()});e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&this._loadObjectSyncLogs({data:e.data.filterOptions})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.recordName,includeNavButtons:!e.isRecordDeleted,log:e})}},{key:"_loadObjectSyncLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data,e=void 0===e?this._defaultOptions:e;return this._loadDataProvider("get-object-sync-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadObjectSyncLogs({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{objectSyncLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-object-sync-logs"===t.id&&(this._totalLogCount=e.totalCount,this._objectSyncLogs=e.logVOs,this.slideOutPanel.hide(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.objectSyncLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._totalLogCount=e.response.totalCount,this._objectSyncLogs=e.response.logVOs,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshRecordList()}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._objectSyncLogs}}]),s}(),n2.de.page.logs.SchedulerLogList=function(){_inherits(s,n2.de.page.Logs);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-scheduler-logs"],this._heading="Scheduler Logs",this._headingIcon=n2.de.enum.Icon.SCHEDULER,this._helpLinkURL="https://help.nc-squared.com/logs/scheduler-logs",this._componentCls="".concat(this._componentCls," n2-de-scheduler-log-list"),this._activeNavigationId="scheduler-log-list",this._pageContext=n2.de.page.logs.schedulerLogList.Context.getInstance(),this._schedulerLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"startTime",direction:"dsc"}},this._REFRESH={totalLogCount:["recordList"],schedulerLogs:["recordList"]}}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.schedulerLogList.SchedulerSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"recordList",get:function(){return this.components["scheduler-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.schedulerLogList.SchedulerLogsRecordList({id:"scheduler-logs-record-list",cls:"n2-scheduler-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("clear-filters-button"===e.target.id)return this._loadSchedulerLogs({data:this.recordList.getFilterOptions()});e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&(this._loadSchedulerLogs({data:e.data.filterOptions}),this.slideOutPanel.hide())}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:this._formatDate(e.startTime),includeNavButtons:!1,log:e})}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_loadSchedulerLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data;return this._loadDataProvider("get-scheduler-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadSchedulerLogs({silent:t,force:n,data:this._getDefaultOptions()});case 5:return e.t0=e.sent,e.abrupt("return",{schedulerLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getDefaultOptions",value:function(){return n2.isEmpty(this._pageContext.logFilterData)?this._defaultOptions:n2.merge(this._defaultOptions,this._pageContext.logFilterData)}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-scheduler-logs"===t.id&&this._setProperties({totalLogCount:e.totalCount,schedulerLogs:e.logVOs})}},{key:"_onLoadComplete",value:function(e){e=e.schedulerLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperties({totalLogCount:e.response.totalCount,schedulerLogs:e.response.logVOs})}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._schedulerLogs,n2.isEmpty(this._pageContext.logFilterData)||(this.recordList.toolbar.filterData=this._pageContext.logFilterData,this.recordList.toolbar.isFiltering=!0,this._pageContext.clearLogFilterData())}}]),s}(),n2.de.page.logs.TerritoriesLogList=function(){_inherits(s,n2.de.page.Logs);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-territories-logs"],this._heading="Territories Logs",this._headingIcon=n2.de.enum.Icon.TERRITORIES,this._helpLinkURL="https://help.nc-squared.com/territories-logs-list",this._componentCls="".concat(this._componentCls," n2-de-territories-log-list"),this._activeNavigationId="territories-log-list",this._territoriesLogs=null,this._totalLogCount=0,this._defaultOptions={sortOrderField:{columnName:"date",direction:"dsc"}}}},{key:"slideOutPanel",get:function(){return n2.de.page.logs.territoriesLogList.TerritoriesSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"classifierNotification",get:function(){return this.components["classifier-notification"]}},{key:"recordList",get:function(){return this.components["territories-logs-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertClassifierNotification(),this._insertRecordList()}},{key:"_insertClassifierNotification",value:function(){var e=this;return this._insert(new n2.de.component.ScopedNotification({id:"classifier-notification",hidden:n2.de.page.logs.Context.getInstance().isClassifierLoggingEnabled,renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'Classifier logging is currently disabled, enable it <span class="n2__settings-link"></span>.',components:[new n2.de.component.Link({id:"settings-link",text:"here",renderTo:".n2__settings-link",listeners:{click:function(){return e._navigateToSettings()}}})]}))}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.logs.territoriesLogList.TerritoriesLogsRecordList({id:"territories-logs-record-list",cls:"n2-territories-logs-record-list",listeners:{change:this._handleRecordListChange,click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("clear-filters-button"===e.target.id)return this._loadTerritoriesLogs({data:this.recordList.getFilterOptions()});e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_handleRecordListChange",value:function(e){e.data.actions.includes("ordered-filter")&&this._loadTerritoriesLogs({data:e.data.filterOptions})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.recordName,includeNavButtons:!e.isRecordDeleted,log:e})}},{key:"_navigateToSettings",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}},{key:"_loadTerritoriesLogs",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.data,e=void 0===e?this._defaultOptions:e;return this._loadDataProvider("get-territories-logs",{params:[e],silent:void 0!==t&&t,force:void 0===n||n})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadTerritoriesLogs({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{territoriesLogData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-territories-logs"===t.id&&(this._totalLogCount=e.totalLogCount,this._territoriesLogs=e.territoryLogs,this.slideOutPanel.hide(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.territoriesLogData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._totalLogCount=e.response.totalLogCount,this._territoriesLogs=e.response.territoryLogs,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshRecordList()}},{key:"_refreshRecordList",value:function(){this.recordList.totalLogCount=this._totalLogCount,this.recordList.data=this._territoriesLogs}}]),s}(),n2.de.page.objectSync.ObjectSyncActions=function(){_inherits(c,n2.de.page.ObjectSync);var e,t,n,i,s,a,o,r,l=_createSuper(c);function c(){return _classCallCheck(this,c),l.apply(this,arguments)}return _createClass(c,[{key:"_define",value:function(){_get(_getPrototypeOf(c.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-object-sync-actions"],this._componentCls="n2-de-object-sync-actions",this._heading="Object Sync Actions",this._headingIcon=n2.de.enum.Icon.NOTE,this._helpLinkURL="https://help.nc-squared.com/object-sync"}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"toolbarActionsMenu",get:function(){return this.toolbar.components["object-sync-toolbar-actions-menu"]}},{key:"activeFilter",get:function(){return this.toolbar.components["active-filter"]}},{key:"distributionObjectFilter",get:function(){return this.toolbar.components["distribution-object-filter"]}},{key:"relatedObjectFilter",get:function(){return this.toolbar.components["related-object-filter"]}},{key:"actionsList",get:function(){return this._components["actions-data-table"]}},{key:"slideOutPanel",get:function(){return n2.de.page.objectSync.objectSyncActions.SlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"objectSyncActionModal",get:function(){return n2.de.page.objectSync.objectSyncActions.ActionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"reorderActionsModal",get:function(){return n2.de.page.objectSync.objectSyncActions.ReorderActionsModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(c.prototype),"_insertPageComponents",this).call(this),this._insertToolbar()}},{key:"_insertToolbar",value:function(){var e=[this._createActiveFilter(),this._createDistributionObjectFilter(),this._createRelatedObjectFilter(),this._createAddActionButton(),this._createToolbarActionMenu()];return this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar{{#hidden}} {{hideCls}}{{/hidden}}">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',hidden:!0,components:e}))}},{key:"_createActiveFilter",value:function(){return new n2.ui.component.field.Combo({id:"active-filter",renderTo:".n2_left",cls:"n2_object-sync-filter slds-col slds-size_4-of-12",label:{text:"Filter active actions",hidden:!0},placeholder:"All statuses",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],sort:!1,listeners:{change:this._onActiveFilterChange,scope:this}})}},{key:"_onActiveFilterChange",value:function(e){""!==e.value?this.actionsList.addFilter("activeFilter",{dataBindings:[".isActive"],value:e.value}):this.actionsList.removeFilters(["activeFilter"])}},{key:"_createDistributionObjectFilter",value:function(){return new n2.ui.component.field.Combo({id:"distribution-object-filter",renderTo:".n2_left",cls:"n2_object-sync-filter slds-col slds-size_4-of-12",label:{text:"Filter by object",hidden:!0},placeholder:"All objects",options:[],sort:!1,listeners:{change:this._onDistributionObjectChange,scope:this}})}},{key:"_onDistributionObjectChange",value:function(e){""!==e.value?this.actionsList.addFilter("distributionObjectFilter",{dataBindings:[".distributionObjectLabel"],value:e.value}):this.actionsList.removeFilters(["distributionObjectFilter"])}},{key:"_createRelatedObjectFilter",value:function(){return new n2.ui.component.field.Combo({id:"related-object-filter",renderTo:".n2_left",cls:"n2_object-sync-filter slds-col slds-size_4-of-12",label:{text:"Filter by related object",hidden:!0},placeholder:"All related objects",options:[],sort:!1,listeners:{change:this._onRelatedObjectChange,scope:this}})}},{key:"_onRelatedObjectChange",value:function(e){""!==e.value?this.actionsList.addFilter("relatedObjectFilter",{dataBindings:[".relatedObjectLabel"],value:e.value}):this.actionsList.removeFilters(["relatedObjectFilter"])}},{key:"_createAddActionButton",value:function(){return new n2.ui.component.Button({id:"add-action-button",renderTo:".n2_right",cls:"n2_add-action-button",text:"Add Action",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddActionClick,scope:this}})}},{key:"_onAddActionClick",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.objectSyncActionModal.show({});case 1:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"_createToolbarActionMenu",value:function(){var t=this;return new n2.ui.component.Menu({id:"object-sync-toolbar-actions-menu",renderTo:".n2_right",cls:"n2_menu",options:[{id:"activate",label:"Activate"},{id:"deactivate",label:"Deactivate"},{id:"delete",label:"Delete"},{id:"reorder-actions",label:"Reorder"}],listeners:{select:function(e){t._onActionMenuSelect(e,t.actionsList.selection)}}})}},{key:"_onActionMenuSelect",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.id,e.next="edit"===e.t0?3:"activate"===e.t0?5:"deactivate"===e.t0?7:"delete"===e.t0?9:"reorder-actions"===e.t0?11:12;break;case 3:return this.objectSyncActionModal.show({model:n[0]}),e.abrupt("break",12);case 5:return this._activateObjectSyncActions(n),e.abrupt("break",12);case 7:return this._deactivateObjectSyncActions(n),e.abrupt("break",12);case 9:return this._deleteObjectSyncActions(n),e.abrupt("break",12);case 11:this._showReorderActionsModal();case 12:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"_activateObjectSyncActions",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,this._postDataProvider("activate-object-sync-actions",{params:[t]});case 3:this._reloadData();case 4:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"_deactivateObjectSyncActions",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,this._postDataProvider("deactivate-object-sync-actions",{params:[t]});case 3:this._reloadData();case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_deleteObjectSyncActions",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(n){var i=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n2.de.component.DeleteMessageBox.getInstance({renderTo:this._dom.parent,dataProviders:["delete-object-sync-actions"]}).show({itemCount:n.length,type:1===n.length?"action":"actions",listeners:{submit:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i._postDataProvider("delete-object-sync-actions",{params:[n]});case 2:return e.next=4,t.hide();case 4:i._reloadData();case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()}});case 1:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_showReorderActionsModal",value:function(){var e=this;this.reorderActionsModal.show({data:this._model,listeners:{saved:function(){e._clearFilters(),e._reloadData()}}})}},{key:"_reloadData",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-object-sync-actions",{silent:!1,force:!0});case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(c.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-object-sync-actions",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{actionsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.actionsData;_get(_getPrototypeOf(c.prototype),"_onLoadComplete",this).apply(this,arguments),this._model=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t,n){"get-object-sync-actions"===(_get(_getPrototypeOf(c.prototype),"_onLoaded",this).apply(this,arguments),t.id)&&(this._model=e),this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0===t||t,n=e.actionsList,n=void 0===n||n,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshActionsList()}},{key:"_refreshToolbar",value:function(){this._setToolbarActionsVisibility(!1),this.activeFilter.clear({silent:!0}),this.distributionObjectFilter.clear({silent:!0}),this.relatedObjectFilter.clear({silent:!0}),this.distributionObjectFilter.options=this._extractDistributionObjectOptions(this._model),this.relatedObjectFilter.options=this._extractRelatedObjectOptions(this._model),this.toolbar.hidden=n2.isEmpty(this._model)}},{key:"_extractDistributionObjectOptions",value:function(e){return e.map(function(e){return e.distributionObjectLabel}).sort().filter(function(e,t,n){return 0===t||e!==n[t-1]})}},{key:"_extractRelatedObjectOptions",value:function(e){return e.map(function(e){return e.relatedObjectLabel}).sort().filter(function(e,t,n){return 0===t||e!==n[t-1]})}},{key:"_refreshActionsList",value:function(){n2.isUndefined(this.actionsList)||this.actionsList.destroy(),this._insertActionsList()}},{key:"_insertActionsList",value:function(){var i=this;return this._insert(new n2.de.page.objectSync.objectSyncActions.ActionsList({id:"actions-data-table",data:this._model,listeners:{click:this._onActionListClick,selectionChange:function(e){return i._onRowSelectionChange(e)},menuOptionSelect:function(e,t,n){return i._onActionMenuSelect(e,[n.data])},scope:this}}))}},{key:"_onActionListClick",value:function(e,t,n){if(e.isN2Event)switch(e.target.id){case"enable-object-sync":this._onEnableObjectSyncClick();break;case"clear-filters":this._clearFilters();break;case"add-object-sync-action":this._onAddActionClick()}else["td-selectable","menu-cell"].includes(n.id)||this._showActionSidePanel(t.data)}},{key:"_showActionSidePanel",value:function(e){this.slideOutPanel.show({actionData:e,includeNavButtons:!1})}},{key:"_onRowSelectionChange",value:function(e){var e=e.target.parent.selection,t=!n2.isEmpty(e);this._setToolbarActionsVisibility(t),t&&((t=this.toolbarActionsMenu).components.activate.label="Activate (".concat(e.length,")"),t.components.deactivate.label="Deactivate (".concat(e.length,")"),t.components.delete.label="Delete (".concat(e.length,")"))}},{key:"_setToolbarActionsVisibility",value:function(e){var t=this.toolbarActionsMenu;t.components.activate.hidden=!e,t.components.deactivate.hidden=!e,t.components.delete.hidden=!e,t.components["reorder-actions"].hidden=e}},{key:"_clearFilters",value:function(){this.activeFilter.clear(),this.distributionObjectFilter.clear(),this.relatedObjectFilter.clear(),this._refreshToolbar()}},{key:"_onEnableObjectSyncClick",value:function(){this._enableObjectSync(),this._refreshActionsList()}},{key:"_enableObjectSync",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("enable-object-sync",{});case 2:return e.abrupt("return",this._loadDataProvider("get-is-object-sync-enabled",{silent:!1,force:!0}));case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),c}(),n2.de.page.settings.AdvancedSettings=function(){_inherits(s,n2.de.page.Settings);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._PROCESSING_MODES={SYNCHRONOUS:"Synchronous",ASYNCHRONOUS:"Asynchronous",QUEUEABLE:"Queueable",BATCH:"Batch",AUTOMATIC:"Automatic",PARALLEL:"Parallel"},this._SCHEDULER_FREQUENCY_OPTIONS={AS_FAST_AS_POSSIBLE:[{label:"As fast as possible",value:0}],MINUTES:[{label:"5 minutes",value:5},{label:"10 minutes",value:10},{label:"15 minutes",value:15},{label:"20 minutes",value:20},{label:"30 minutes",value:30}],HOURS:[{label:"1 hour",value:60},{label:"2 hours",value:120},{label:"4 hours",value:240},{label:"6 hours",value:360},{label:"12 hours",value:720},{label:"24 hours",value:1440}]},this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-advanced-settings"],this._heading="Advanced Settings",this._headingIcon=n2.de.enum.Icon.SETTINGS,this._helpLinkURL="https://help.nc-squared.com/advanced-settings",this._componentCls="n2-de-settings-advanced-settings",this._activeNavigationId="advanced-settings",this._advancedSettings=null}},{key:"form",get:function(){return this._components["advanced-settings-form"]}},{key:"processingModeField",get:function(){return this.form.components["processing-mode"]}},{key:"processingModeMessage",get:function(){return this.processingModeField.components["processing-mode-message"]}},{key:"processingModeDisabledMessage",get:function(){return this.processingModeField.components["processing-mode-disabled-message"]}},{key:"schedulerFrequencyField",get:function(){return this.form.components["scheduler-frequency"]}},{key:"healthCheckerFrequencyField",get:function(){return this.form.components["health-checker-frequency"]}},{key:"healthCheckerFrequencyDisabledMessage",get:function(){return this.healthCheckerFrequencyField.components["health-checker-frequency-disabled-message"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this),this._insertAdvancedSettingsForm()}},{key:"_insertAdvancedSettingsForm",value:function(){return this._insert(new n2.de.component.Form({id:"advanced-settings-form",mixins:[n2.mixin.DataDriven],dataProviders:["save-advanced-settings"],components:[this._createProcessingModeField(),this._createSchedulerFrequencyField(),this._createHealthCheckerFrequencyField()],listeners:{submit:this._onAdvancedSettingsFormSubmit,saved:this._onAdvancedSettingsFormSaved,cancel:this._onAdvancedSettingsFormCancel,scope:this}}))}},{key:"_onAdvancedSettingsFormSubmit",value:function(e){this._postDataProvider("save-advanced-settings",{params:[this._advancedSettings.json]})}},{key:"_onAdvancedSettingsFormSaved",value:function(e){this.load({force:!0,silent:!1})}},{key:"_onAdvancedSettingsFormCancel",value:function(e){this.load({force:!0,silent:!1})}},{key:"_createProcessingModeField",value:function(){var e=new n2.ui.component.field.Combo({id:"processing-mode",label:"Processing mode",mixins:[n2.mixin.DataDriven],options:this._getProcessingModeOptions(),cls:"slds-m-bottom_medium n2_field-medium",helpText:{text:"The mechanism of how Distribution Engine processes the records and assigns them. Each mode has advantages and disadvantages depending on your requirements and setup.",position:n2.ui.enum.Position.BELOW},required:!0,value:{bindPath:".schedulerProcessingMode"},listeners:{change:this._onProcessingModeChange,scope:this}});return e.insert(new n2.ui.component.HTML({id:"processing-mode-message",hidden:!0,template:'<div id="{{id}}" class="n2_info-message slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_xx-small slds-icon-text-default"}),'\n                <p>Processing mode should be changed with care. Please <a target="_blank" href="https://help.nc-squared.com/advanced-settings">read the knowledgebase</a> for more information.</p>\n            </div>')})),e.insert(new n2.ui.component.HTML({id:"processing-mode-disabled-message",hidden:!0,template:'<div id="{{id}}" class="n2_info-message slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_xx-small slds-icon-text-default"}),'\n                <p>Unable to change the processing mode for this org. Please <a href="mailto:support@ncsquared.com">contact support</a> for more information.</p>\n            </div>')})),e}},{key:"_onProcessingModeChange",value:function(e){this._refreshSchedulerFrequencyField()}},{key:"_getProcessingModeOptions",value:function(){return Object.entries(this._PROCESSING_MODES).map(function(e){e=_slicedToArray(e,2);e[0];return e[1]})}},{key:"_createSchedulerFrequencyField",value:function(){return new n2.ui.component.field.Combo({id:"scheduler-frequency",label:"Scheduler frequency",mixins:[n2.mixin.DataDriven],options:[],required:!0,disabled:!0,sort:!1,cls:"slds-m-bottom_medium n2_field-small",helpText:"How often the scheduler runs to process waiting records.",value:{bindPath:".schedulerFrequency"}})}},{key:"_createHealthCheckerFrequencyField",value:function(){var e=new n2.ui.component.field.Combo({id:"health-checker-frequency",label:"Health Checker frequency",mixins:[n2.mixin.DataDriven],options:[{label:"15 minutes",value:15},{label:"30 minutes",value:30},{label:"Hourly",value:60}],required:!0,disabled:!0,sort:!1,cls:"n2_field-small",helpText:"How often the health checker job runs, which is used to check that Distribution Engine is running correctly.",value:{bindPath:".healthCheckerFrequency"}});return e.insert(new n2.ui.component.HTML({id:"health-checker-frequency-disabled-message",hidden:!0,template:'<div id="{{id}}" class="n2_info-message slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_xx-small slds-icon-text-default"}),'\n                <p>Unable to change the health checker frequency for this org. Please <a href="mailto:support@ncsquared.com">contact support</a> for more information.</p>\n            </div>')})),e}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-advanced-settings",{silent:t,force:n});case 4:return e.t0=e.sent,e.abrupt("return",{advancedSettings:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.advancedSettings;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._advancedSettings=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.processingModeField,t=void 0!==t&&t,n=e.schedulerFrequencyField,n=void 0!==n&&n,i=e.healthCheckerFrequencyField,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshProcessingModeField(),(e||n)&&this._refreshSchedulerFrequencyField(),(e||i)&&this._refreshHealthCheckFrequencyField()}},{key:"_refreshProcessingModeField",value:function(){this.processingModeField.model=this._advancedSettings;var e=this._advancedSettings.get("hasSchedulerProcessingModeFP");this.processingModeField.disabled=e,this.processingModeMessage.hidden=e,this.processingModeDisabledMessage.hidden=!e}},{key:"_refreshSchedulerFrequencyField",value:function(){if(this.schedulerFrequencyField.clear({silent:!0}),this.schedulerFrequencyField.model=this._advancedSettings,this.schedulerFrequencyField.disabled=!1,!this._hasProcessingMode([this._PROCESSING_MODES.BATCH]))return this._hasProcessingMode([this._PROCESSING_MODES.QUEUEABLE,this._PROCESSING_MODES.AUTOMATIC,this._PROCESSING_MODES.PARALLEL])?(this.schedulerFrequencyField.options=this._SCHEDULER_FREQUENCY_OPTIONS.AS_FAST_AS_POSSIBLE,this.schedulerFrequencyField.value={value:0,silent:!0},void(this.schedulerFrequencyField.disabled=!0)):void(this.schedulerFrequencyField.options=n2.merge(this._SCHEDULER_FREQUENCY_OPTIONS.MINUTES,this._SCHEDULER_FREQUENCY_OPTIONS.HOURS));this.schedulerFrequencyField.options=this._SCHEDULER_FREQUENCY_OPTIONS.HOURS}},{key:"_refreshHealthCheckFrequencyField",value:function(){this.healthCheckerFrequencyField.model=this._advancedSettings;var e=this._advancedSettings.get("hasHealthCheckerFrequencyFP");this.healthCheckerFrequencyField.disabled=!this._advancedSettings.get("userHasAuthorApexPermission")||e,this.healthCheckerFrequencyDisabledMessage.hidden=!e}},{key:"_hasProcessingMode",value:function(e){return e.includes(this.processingModeField.value)}}]),s}(),n2.de.page.settings.AppSettings=function(){_inherits(t,n2.de.page.Settings);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._heading="Settings",this._headingIcon=n2.de.enum.Icon.SETTINGS,this._helpLinkURL="https://help.nc-squared.com/distribution-settings",this._componentCls="n2-de-settings-app-settings n2_form-page",this._activeNavigationId="app-settings",this._pageContext=n2.de.page.settings.appSettings.Context.getInstance()}},{key:"appSettingsForm",get:function(){return this._components["app-settings-form"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertAppSettingsForm()}},{key:"_insertAppSettingsForm",value:function(){return this._insert(new n2.de.page.settings.appSettings.AppSettingsForm({id:"app-settings-form"}))}}]),t}(),n2.de.page.settings.ExportImport=function(){_inherits(t,n2.de.page.Settings);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Export/Import",this._headingIcon=n2.de.enum.Icon.PRODUCT_TRANSFER,this._helpLinkURL="https://help.nc-squared.com/import-export",this._componentCls="n2-de-settings-export-import",this.downloadUrl=null,this._activeNavigationId="export-import"}},{key:"export",get:function(){return this._components.export}},{key:"import",get:function(){return this._components.import}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTabs(),this._insertExport(),this._insertImport()}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"export-import-tabs",tabs:[{id:"export",label:"Export"},{id:"import",label:"Import"}],listeners:{change:function(e){return t._onTabChange(e)}},selectedTabId:"export"}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"export":this._showTabContent({showExport:!0});break;case"import":this._showTabContent({showImport:!0})}}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showExport,e=e.showImport,e=void 0!==e&&e;this.export.hidden=!(void 0!==t&&t),this.import.hidden=!e}},{key:"_insertExport",value:function(){return this._insert(new n2.de.page.settings.exportImport.Export({id:"export",downloadUrl:this.downloadUrl}))}},{key:"_insertImport",value:function(){return this._insert(new n2.de.page.settings.exportImport.Import({id:"import",hidden:!0}))}}]),t}(),n2.de.page.settings.LicensedUsers=function(){_inherits(o,n2.de.page.Settings);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-tag-collections"],this._heading="Licensed Users",this._headingIcon=n2.de.enum.Icon.PEOPLE,this._helpLinkURL="https://help.nc-squared.com/licensed-users-list",this._componentCls="n2-de-settings-licensed-users",this._activeNavigationId="licensed-users",this._licensedUsers=null,this._licenseDetails=null,this._canCurrentUserRemoveLicenses=null,this._usedLicenses=null}},{key:"recordList",get:function(){return this.components["licensed-users-record-list"]}},{key:"slideOutPanel",get:function(){return n2.de.page.settings.licensedUsers.licensedUsersRecordList.LicensedUsersSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).call(this),this._insertLicensedUsersList()}},{key:"_insertLicensedUsersList",value:function(){return this.insert(new n2.de.page.settings.licensedUsers.LicensedUsersRecordList({id:"licensed-users-record-list",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){if("export-licensed-users"===e.target.id)return this._onExportLicensedUsersClick();e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_onExportLicensedUsersClick",value:function(){new n2.de.File([this._getCSVFileContent()],{type:"text/csv;charset=utf-8;"}).download("licensed-users-".concat(Date.now(),".csv"))}},{key:"_getCSVFileContent",value:function(){var t=this;return"First Name,Last Name,Username,Is Active,Managed Package License,DE Permission Sets,Is Team Member,Teams\r\n".concat(this._licensedUsers.map(function(e){return t._getLicensedUserCSVContent(e)}).join(""))}},{key:"_getLicensedUserCSVContent",value:function(e){return"".concat(['"'.concat(e.firstName,'"'),'"'.concat(e.lastName,'"'),e.username,e.userIsActive,e.isManagedPackageLicense,this._getCSVPermissionSets(e),e.isTeamMember,this._getCSVTeams(e.teams)].join(","),"\r\n")}},{key:"_getCSVPermissionSets",value:function(e){var t=[];return e.hasAdminPS&&t.push("Admin"),e.hasSystemManagerPS&&t.push("System Manager"),e.hasTeamManagerPS&&t.push("Team Manager"),e.hasUserPS&&t.push("User"),n2.isEmpty(t)?"None":'"'.concat(t.join(","),'"')}},{key:"_getCSVTeams",value:function(e){return n2.isEmpty(e)?"None":'"'.concat(e.map(function(e){return e.teamName}).join(","),'"')}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.name,licensedUserData:e,canCurrentUserRemoveLicenses:this._canCurrentUserRemoveLicenses,listeners:{saved:this._onSlideOutPanelSaved,scope:this}})}},{key:"_onSlideOutPanelSaved",value:function(e,t){this.load()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-licensed-users",{silent:t,force:n}),this._loadDataProvider("get-license-details",{silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{licensedUsers:i,licenseDetails:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoading",value:function(){_get(_getPrototypeOf(o.prototype),"_onLoading",this).apply(this,arguments),this.recordList.dataTable.components["empty-state"].hidden=!0}},{key:"_onLoadComplete",value:function(e){var t=e.licensedUsers,e=e.licenseDetails;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._licensedUsers=t.response.licensedUsers,this._canCurrentUserRemoveLicenses=t.response.canCurrentUserRemoveLicenses,this._usedLicenses=t.response.usedLicenses,this._licenseDetails=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t,n){return _get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-licensed-users"===t.id?(this._licensedUsers=e.licensedUsers,this._canCurrentUserRemoveLicenses=e.canCurrentUserRemoveLicenses,this._usedLicenses=e.usedLicenses,this._refresh({recordList:!0})):"get-license-details"===t.id?(this._licenseDetails=e,this._refresh({licenseDetails:!0})):void 0}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t,n=e.licenseDetails,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&(this._refreshRecordList(),this.slideOutPanel.hidden||this._refreshSidePanel()),(e||n||t)&&this._refreshLicenseDetails()}},{key:"_refreshRecordList",value:function(){this.recordList.data=this._licensedUsers}},{key:"_refreshLicenseDetails",value:function(){var e=this._usedLicenses,t=this._licenseDetails.allowedLicenses,n=this._getUsedLicensesText(e,t);this.pageHeader.additionalHeading='<span class="'.concat(e<t?"slds-text-color_weak":"slds-text-color_destructive",'">').concat(n,'. </span><a target="_blank" href="https://help.nc-squared.com/purchasing-licences">Get more licenses</a>')}},{key:"_refreshSidePanel",value:function(){var t=this,e=this._licensedUsers.find(function(e){return e.id===t.slideOutPanel.currentLicensedUserId});n2.isUndefined(e)?this.slideOutPanel.hide():this._showSlideOutPanel(e)}}]),o}(),n2.de.page.tags.Context=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven,n2.mixin.Singleton],this._lazyLoad=!0}}]),t}(),n2.de.page.tags.Enum={BLANK_SERVER_VALUE:"-- blank --",BLANK_CLIENT_VALUE:"",BLANK_CLIENT_TEXT:"Blank"},n2.de.page.tags.TagAssignmentList=function(){_inherits(a,n2.de.page.Tags);var e,t,n=_createSuper(a);function a(){return _classCallCheck(this,a),n.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Tag Assignment",this._headingIcon=n2.de.enum.Icon.QUOTE,this._helpLinkURL="https://help.nc-squared.com/tag-assignment",this._componentCls="n2-de-tag-assignment-list",this._activeNavigationId="tag-assignment-list",this._pageContext=n2.de.page.tags.tagAssignmentList.Context.getInstance(),this._userTagAssignmentData=null}},{key:"recordList",get:function(){return this.components["tag-assignment-record-list"]}},{key:"slideOutPanel",get:function(){return n2.de.page.tags.tagAssignmentList.TagAssignmentSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(a.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.tags.tagAssignmentList.TagAssignmentRecordList({id:"tag-assignment-record-list",cls:"n2-tag-assignment-record-list",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){switch(e.target.id){case"clone-tag-assignments":return this._onCloneAssignments(e.data);case"change-history":return this._onShowChangeHistory();case"modify-assignments":return this._onModifyAssignments();case"open-tag-collections":return n2.de.page.Navigation.getInstance().open("Tags_TagCollectionList");case"open-teams":return n2.de.page.Navigation.getInstance().open("Team_TeamList");case"menu-cell":return}e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_reload",value:function(){this.load({silent:!1,force:!0})}},{key:"_onCloneAssignments",value:function(e){var t=e.id,e=e.name,n={submit:this._reload,scope:this},i=this.recordList.teamFilter.value;n2.de.page.tags.tagAssignmentList.CloneAssignmentsModal.getInstance({renderTo:this._dom,userTagAssignments:this._userTagAssignmentData}).show({teamFilterValue:i,cloneUserId:t,cloneUserName:e,listeners:n})}},{key:"_onModifyAssignments",value:function(){var e=this.recordList.selectedData,t=e.map(function(e){return e.id}),e=e.map(function(e){return e.name});n2.de.page.tags.tagAssignmentList.ModifyAssignmentsModal.getInstance({renderTo:this._dom,listeners:{submit:this._reload,scope:this}}).show({userIds:t,userNames:e})}},{key:"_onShowChangeHistory",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-tag-assignment-history",{force:!0,silent:!0});case 2:return t=e.sent,e.abrupt("return",(n2.de.page.tags.tagAssignmentList.TagAssignmentChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Tag Assignment history",model:t.response}),t));case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.name,userIds:[e.id],includeNavButtons:!1,listeners:{saved:this._reload,scope:this}})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,this.spinner(),e.next=4,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 4:if(i=[],n2.de.page.tags.tagAssignmentList.Context.getInstance().hasCollections)return e.next=8,this._loadDataProvider("get-user-tag-assignments",{silent:t,force:n});e.next=9;break;case 8:i=e.sent.response;case 9:return e.abrupt("return",{userTagAssignments:i});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),"get-user-tag-assignments"===t.id&&(this._userTagAssignmentData=e,this._refresh()),this.spinner(!1)}},{key:"_onLoadComplete",value:function(e){e=e.userTagAssignments;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._userTagAssignmentData=e,this._refresh(),this.spinner(!1)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filterTable,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshFilterTable()}},{key:"_refreshFilterTable",value:function(){this.recordList.data=this._userTagAssignmentData;var e=n2.de.page.tags.tagAssignmentList.Context.getInstance().tagFilterData;n2.isNull(e)||(this.recordList.setFilter(e),n2.de.page.tags.tagAssignmentList.Context.getInstance().clearTagFilterData())}}]),a}(),n2.de.page.tags.TagCollectionList=function(){_inherits(s,n2.de.page.Tags);var n,e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Tag Collections",this._headingIcon=n2.de.enum.Icon.QUOTE,this.dataProviders=["get-tag-collections"],this._helpLinkURL="https://help.nc-squared.com/distribution-tag-collections",this._componentCls="n2-de-tag-collection-list",this._activeNavigationId="tag-collection-list",this._tagCollections=null}},{key:"slideOutPanel",get:function(){return n2.de.page.tags.tagCollectionList.TagCollectionSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"recordList",get:function(){return this.components["tag-collection-record-list"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.tags.tagCollectionList.TagCollectionRecordList({id:"tag-collection-record-list",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-tag-collections",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{tagCollections:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-tag-collections"===t.id&&(this._tagCollections=e,this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.tagCollections;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollections=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filterTable,t=void 0===t||t;(n2.isEmpty(e)||t)&&this._refreshFilterTable()}},{key:"_refreshFilterTable",value:function(){this.recordList.data=this._tagCollections}},{key:"_handleRecordListAction",value:function(e){var t,n=!1;switch(e.target.id){case"rename-tag-collection":this._onRenameTagCollection(e.data.id),n=!0;break;case"delete-tag-collection":this._onDeleteTagCollection(e.data),n=!0;break;case"delete-tag-collections":this._onDeleteTagCollections(),n=!0;break;case"menu-cell":n=!0}n||n2.isNull(e.data)||!e.data.actions.includes("add-new")?(t=e.relatedTarget instanceof n2.ui.component.dataTable.Row,!n&&t&&this._showSlideOutPanel(e.relatedTarget.data)):this._onAddTagCollection()}},{key:"_onRenameTagCollection",value:function(t){var n=this._tagCollections.find(function(e){return e.id===t}),e=this._getTagCollectionNames().filter(function(e){return e!==n.name});n2.de.page.tags.tagCollectionList.RenameTagCollectionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,listeners:{saved:this._onRenameTagCollectionSaved,scope:this}}).show({tagCollection:n,tagCollectionNames:e})}},{key:"_onRenameTagCollectionSaved",value:function(e){this.load({silent:!1,force:!0})}},{key:"_onDeleteTagCollection",value:function(e){this._deleteTagCollections([e])}},{key:"_onDeleteTagCollections",value:function(){this._deleteTagCollections(this.recordList.selectedData)}},{key:"_deleteTagCollections",value:function(t){var n=this;n2.de.component.DeleteMessageBox.getInstance({dataProviders:["delete-tag-collections"],renderTo:n2.ui.dom.Scope.getInstance().root}).show({type:"tag collections",names:this._getTagCollectionNames({tagCollections:t}),listeners:{submit:function(e){return n._onDeleteTagCollectionSubmit(e,t)},scope:this}})}},{key:"_onDeleteTagCollectionSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-tag-collections",{params:[n]});case 2:return e.next=4,t.hide();case 4:this.load({silent:!1,force:!0});case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onAddTagCollection",value:function(){n2.de.page.tags.tagCollectionList.AddTagCollectionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({tagCollectionNames:this._getTagCollectionNames()})}},{key:"_getTagCollectionNames",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).tagCollections;return(void 0===e?this._tagCollections:e).map(function(e){return e.name})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({tagCollectionId:e.id,heading:e.name,includeNavButtons:!0})}}]),s}(),n2.de.page.tags.TagValueList=function(){_inherits(a,n2.de.page.Tags);var e,n,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-tag-values"],this._heading="",this._headingIcon=n2.de.enum.Icon.QUOTE,this._helpLinkURL="https://help.nc-squared.com/tags",this._componentCls="n2-de-tag-value-list",this._activeNavigationId="tag-collection-list",this._pageContext=n2.de.page.tags.tagValueList.Context.getInstance(),this._tagCollectionData=null}},{key:"recordList",get:function(){return this.components["tag-value-record-list"]}},{key:"slideOutPanel",get:function(){return n2.de.page.tags.tagValueList.TagValueSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(a.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.tags.tagValueList.TagValueRecordList({id:"tag-value-record-list",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){switch(e.target.id){case"rename-tag":return this._onRenameTag(e.data);case"add-tag-from-field":return this._onAddTagFromField();case"delete-tag":return this._onDeleteTag(e.data);case"delete-tags":return this._onDeleteTags();case"menu-cell":return}if(!n2.isNull(e.data)&&e.data.actions.includes("add-new"))return this._onAddTags();e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_onRenameTag",value:function(t){var e=this._getExistingTagNames().filter(function(e){return e!==t.name});n2.de.page.tags.tagValueList.RenameTagModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,listeners:{saved:this._onRenameTagSaved,scope:this}}).show({tag:t,tagNames:e})}},{key:"_onRenameTagSaved",value:function(e){this.load({silent:!1,force:!0})}},{key:"_onDeleteTag",value:function(e){this._deleteTags([e])}},{key:"_onDeleteTags",value:function(){this._deleteTags(this.recordList.selectedData)}},{key:"_deleteTags",value:function(t){var n=this;n2.de.component.DeleteMessageBox.getInstance({dataProviders:["delete-tags"],renderTo:n2.ui.dom.Scope.getInstance().root}).show({type:"tags",names:this._getExistingTagNames({tagValues:t}),listeners:{submit:function(e){return n._onDeleteTagsSubmit(e,t)},scope:this}})}},{key:"_onDeleteTagsSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-tags",{params:[n]});case 2:return e.next=4,t.hide();case 4:this.load({silent:!1,force:!0});case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onAddTags",value:function(){n2.de.page.tags.tagValueList.AddTagsModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({existingTagNames:this._getExistingTagNames(),listeners:{saved:this._onAddTagsSaved,scope:this}})}},{key:"_getExistingTagNames",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).tagValues;return(void 0===e?this.recordList.data.tagValues:e).map(function(e){return e.name})}},{key:"_onAddTagsSaved",value:function(e,t){this.load({silent:!1,force:!0})}},{key:"_onAddTagFromField",value:function(){n2.de.page.tags.tagValueList.AddTagsFromFieldModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({existingTagNames:this._getExistingTagNames(),listeners:{saved:this._onAddTagsFromFieldSaved,scope:this}})}},{key:"_onAddTagsFromFieldSaved",value:function(e,t){this.load({silent:!1,force:!0})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({tagValueId:e.id,heading:e.name})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=n2.de.page.tags.tagValueList.Context.getInstance().tagCollectionId,e.next=6,this._loadDataProvider("get-tag-values",{silent:t,force:n,params:[i]});case 6:return e.t0=e.sent,e.abrupt("return",{tagCollectionData:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),"get-tag-values"===t.id&&(this._tagCollectionData=e,this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.tagCollectionData;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollectionData=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.recordList,t=void 0!==t&&t,n=e.heading,n=void 0!==n&&n,i=e.tagLimit,e=n2.isEmpty(e);(e||t)&&this._refreshRecordList(),(e||n)&&this._refreshHeading(),(e||i)&&this._refreshTagLimit()}},{key:"_refreshRecordList",value:function(){this.recordList.data=this._tagCollectionData}},{key:"_refreshHeading",value:function(){this._heading="".concat(this._tagCollectionData.name," Tags"),this.pageHeader.heading=this._heading}},{key:"_refreshTagLimit",value:function(){n2.de.page.tags.tagValueList.Context.getInstance().tagLimitReached=999<this._tagCollectionData.tagValues.length}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTagCollectionId(e)?"Your tag collection could not be found, please press OK to return to the Tag collection list page.":_get(_getPrototypeOf(a.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){_get(_getPrototypeOf(a.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments),n2.de.Error.isInvalidTagCollectionId(e)?n2.de.page.Navigation.getInstance().open("Tags_TagCollectionList"):_get(_getPrototypeOf(a.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments)}}]),a}(),n2.de.page.team.AssignmentRejection=function(){_inherits(n,n2.de.page.Team);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-assignment-rejection-details"],this._heading="Assignment Rejection",this._headingIcon=n2.de.enum.Icon.CANCEL_TRANSFER,this._helpLinkURL="https://help.nc-squared.com/assignment-rejection",this._cls="n2-de-assignment-rejection",this._activeNavigationId="assignment-rejection"}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(n.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTabs(),this._insertTeamLevelRejection(),this._insertDistributorLevelRejection()}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"assignment-rejection-tabs",tabs:[{id:"team-level",label:"Team-level"},{id:"distributor-level",label:"Distributor-level"}],listeners:{click:function(e){return t._onTabClick(e)},change:function(e){return t._onTabChange(e)}},selectedTabId:"team-level"}))}},{key:"_onTabClick",value:function(e){"team-level"===e.currentTarget.selectedTabId&&n2.de.page.team.Context.getInstance().isDirty&&(e.preventDefault(),n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Changing tabs will lose any unsaved changes, do you want to continue?",listeners:{submit:function(){e.performDefault()}}}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"team-level":this._showTabContent({showTeamLevel:!0});break;case"distributor-level":this._showTabContent({showDistributorLevel:!0})}}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showTeamLevel,e=e.showDistributorLevel,e=void 0!==e&&e,n=this._components["team-level-rejection"];n.hidden=!(void 0!==t&&t),this._components["distributor-level-rejection"].hidden=!e,e&&n.cancel(),n2.de.page.SlideOutPanel.getInstance().hidden=!0}},{key:"_insertTeamLevelRejection",value:function(){return this.insert(new n2.de.page.team.assignmentRejection.TeamLevelRejection({id:"team-level-rejection"}))}},{key:"_insertDistributorLevelRejection",value:function(){return this.insert(new n2.de.page.team.assignmentRejection.DistributorLevelRejection({id:"distributor-level-rejection",cls:"slds-m-around_medium",hidden:!0}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-assignment-rejection-details"!==t.id||(this._components["assignment-rejection-tabs"].components["distributor-level"].disabled=!e.get("rejectionEnabled"),this._components["team-level-rejection"].model=e,this._components["distributor-level-rejection"].model=e)}},{key:"_onServerError",value:function(e){n2.de.Error.isInvalidTeamId(e)&&!n2.isUndefined(this._components["team-level-rejection"])&&this._components["team-level-rejection"].spinner(!1),_get(_getPrototypeOf(n.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidDistributorId(e)?"This distributor no longer exists, please press OK to refresh.":_get(_getPrototypeOf(n.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){!n2.de.Error.isInvalidDistributorId(e)||(n2.isUndefined(n2.de.page.SlideOutPanel.getInstance())||(n2.de.page.SlideOutPanel.getInstance().hidden=!0),n2.isUndefined(this._components["distributor-level-rejection"]))?_get(_getPrototypeOf(n.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components["distributor-level-rejection"].reload()}}]),n}(),n2.de.page.team.Availability=function(){_inherits(o,n2.de.page.Team);var e,t,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-calendar-data"],this._heading="Team Availability",this._headingIcon=n2.de.enum.Icon.IDENTITY,this._helpLinkURL="https://help.nc-squared.com/teams/team-availability",this._componentCls="n2-de-availability",this._activeNavigationId="availability",this._filterOptionsData=null,this._openedDayCell=null,this._REFRESH={filterOptionsData:["calendarRecordList"]}}},{key:"availabilityRecordList",get:function(){return this._components["availability-record-list"]}},{key:"slideOutPanel",get:function(){return n2.de.component.availabilityCalendar.SlideOutPanel.getInstance({mixins:[n2.mixin.DataDriven],dataProviders:["get-calendar-day-data"],renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).call(this),this._insertCalendarRecordList()}},{key:"_insertCalendarRecordList",value:function(){return this._insert(new n2.de.page.team.availability.AvailabilityRecordList({id:"availability-record-list",listeners:{change:this._onRecordListChange,click:this._onRecordListClick,scope:this}}))}},{key:"_onRecordListChange",value:function(e){switch(e.target.id){case this.availabilityRecordList.availabilityCalendar.id:return this._loadCalendarDataForCurrentMonth();case this.availabilityRecordList.toolbar.teamMemberFilter.id:case this.availabilityRecordList.toolbar.tagFilter.id:return this._refresh(["slideOutPanel"])}}},{key:"_onRecordListClick",value:function(e){this._openedDayCell=e.target,this.slideOutPanel.show({listeners:{show:this._onSlideOutPanelShow,click:this._onSlideOutPanelClick,scope:this}})}},{key:"_onSlideOutPanelShow",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._openedDayCell.data,n=new Date(Date.UTC(n.year,n.month-1,n.day)),e.next=3,this._loadSlideOutPanelData(n);case 3:i=e.sent.response,this.slideOutPanel.setProperties({date:n,shiftsData:i.shiftsOnDay,outOfOfficeData:i.ooosForUser,availabilityData:this._openedDayCell.availabilityData,filteredAvailabilityData:this._openedDayCell.filteredAvailabilityData});case 5:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_loadSlideOutPanelData",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._pageContext.teamId,i=this._getDateAsStringParameter(t),s=this._openedDayCell.availabilityData.teamMembersWorking.map(function(e){return[e.userId,e.shiftHoursId]}),e.abrupt("return",this._fetchDataProvider("get-calendar-day-data",{params:[n,i,Object.fromEntries(s)],silent:!1,force:!1,requestId:"".concat(n,"-").concat(i)}));case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_onSlideOutPanelClick",value:function(e){!n2.isNull(e.data)&&e.data.actions.includes("clear-filters")&&this.availabilityRecordList.toolbar.clear()}},{key:"_load",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).call(this,{silent:t,force:n});case 3:return e.next=5,this._loadDataProvider("get-filter-options-data",{params:[this._pageContext.teamId],silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_onLoadComplete",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filterOptionsData,_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,i),e.next=4,this._loadCalendarDataForCurrentMonth();case 4:this._setProperties({filterOptionsData:n.response});case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_loadCalendarDataForCurrentMonth",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=this,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=(t=0<o.length&&void 0!==o[0]?o[0]:{}).silent,n=void 0!==i&&i,i=t.force,s=void 0!==i&&i,this.slideOutPanel.hide(),this.availabilityRecordList.availabilityCalendar.dateRangeWeeks.forEach(function(e,t){a._loadCalendarDataForDateRange(e,t,{silent:n,force:s})});case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadCalendarDataForDateRange",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=n.silent,n=n.force,s=this._pageContext.teamId,a=this._getDateAsStringParameter(e.startDate),e=this._getDateAsStringParameter(e.endDate);return this._fetchDataProvider("get-calendar-data",{params:[s,a,e],silent:i,force:n,requestId:"".concat(s,"-").concat(a,"-").concat(e,"-week-").concat(t)})}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-calendar-data"===t.id&&(t=Number(n.substring(n.length-1)),n=this._combineAvailabilityDayDataWithUserData(e),this.availabilityRecordList.loadAvailabilityData(n,{weekNumber:t}))}},{key:"_combineAvailabilityDayDataWithUserData",value:function(e){var t=e.calendarDays,i=e.usersWithTags;return t.map(function(e){var t=Object.entries(e.teamMembersWorking).map(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return n2.merge(i[t],{shiftHoursId:e})}),n=e.teamMembersOutOfOffice.map(function(e){return i[e]});return n2.sort(t,{property:"userName"}),n2.sort(n,{property:"userName"}),{teamMembersWorking:t,teamMembersOutOfOffice:n,teamHolidayNames:e.teamHolidayNames||[]}})}},{key:"_refreshCalendarRecordList",value:function(){this.availabilityRecordList.filterOptionsData=this._filterOptionsData}},{key:"_refreshSlideOutPanel",value:function(){this.slideOutPanel.hidden||this.slideOutPanel.setProperty("filteredAvailabilityData",this._openedDayCell.filteredAvailabilityData)}},{key:"_getDateAsStringParameter",value:function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}},{key:"_getServerErrorConfig",value:function(e){return{listeners:{submit:this._onServerErrorSubmit,scope:this}}}},{key:"_onServerErrorSubmit",value:function(){this.load({silent:!0,force:!0})}}]),o}(),n2.de.page.team.ChangeHistoryModal=function(){_inherits(i,n2.de.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="change-history-modal",this._cls="n2-de-change-history-modal"}},{key:"show",value:function(e){var t=e.header,t=void 0===t?"Change history":t,n=e.model,n=void 0===n?null:n,e=e.showName,e=void 0!==e&&e,t=(_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header=t,this._getColumns(e));this._insertRecordsDataTable(t),this._components["records-data-table"].data=n}},{key:"_insertRecordsDataTable",value:function(e){return n2.isUndefined(this._components["records-data-table"])||this._components["records-data-table"].destroy(),this._insert(new n2.de.component.DataTable({id:"records-data-table",columns:e,emptyState:{heading:"",content:"There is no history to show at the moment"}}))}},{key:"_getColumns",value:function(){var e=[{header:"Date",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.changeDatetime)}}},{header:"Action",bindPath:".historyString"},{header:"User",cls:"n2_user-column",bindPath:".username"}];return 0<arguments.length&&void 0!==arguments[0]&&arguments[0]&&e.splice(1,0,{header:"Name",cls:"n2_name-column",bindPath:".recordName"}),e}},{key:"_addOkCancelButtons",value:function(){var e=this;this._addButton({id:"cancel-button",text:"Close",listeners:{click:function(){return e._onCancel()}}})}},{key:"_resetButtons",value:function(){this._components["cancel-button"].enable()}}]),i}(),n2.de.page.team.CloneDistributorModal=function(){_inherits(i,n2.de.component.Modal);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="clone-distributor-modal",this.dataProviders=["clone-distributor"],this._cls="n2-de-clone-distributor-modal",this._distributorId=null,this._teamId=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertCloneDistributorForm()}},{key:"_insertCloneDistributorForm",value:function(){this.insert(new n2.ui.component.Form({id:"clone-distributor-form",components:[{type:n2.de.component.field.UniqueNameField,id:"distributor-name",label:"Distributor name",cls:"slds-m-bottom_medium n2_field-width",required:!0,nameValidationMessage:"Distributor names must be unique within a team"}]}))}},{key:"_getOKButtonConfig",value:function(){return{text:"Clone Distributor"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(i.prototype),"_onSaving",this).apply(this,arguments),this._components["clone-distributor-form"].disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),this.spinner(),n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(this._teamId))}},{key:"show",value:function(e){var t=e.distributorData,t=void 0===t?null:t,n=e.distributorsData,n=void 0===n?[]:n,e=e.teamId,e=void 0===e?null:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header="Clone ".concat(t.name),this._distributorId=t.id,this._teamId=e,this._components["clone-distributor-form"].components["distributor-name"].names=n.map(function(e){return n2.isString(e)?e:e.name})}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=this._components["clone-distributor-form"]).validate()&&(_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("clone-distributor").post({params:[this._distributorId,t.components["distributor-name"].value]}));case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onError",this).apply(this,arguments),n2.de.Error.isDE2(e)&&this._components["submit-button"].disable()}},{key:"_reset",value:function(){_get(_getPrototypeOf(i.prototype),"_reset",this).call(this),this._components["clone-distributor-form"].disabled=!1,this._components["clone-distributor-form"].clear()}}]),i}(),n2.de.page.team.CloneTeamModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.id="clone-team-modal",this.dataProviders=["clone-team"],this._cls="n2-de-clone-team-modal",this._teamId=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertCloneTeamForm()}},{key:"_insertCloneTeamForm",value:function(){this.insert(new n2.ui.component.Form({id:"clone-team-form",components:[{type:n2.de.component.field.UniqueNameField,id:"team-name",label:"Team name",cls:"slds-m-bottom_medium n2_field-width",required:!0,nameValidationMessage:"Team names must be unique"}]}))}},{key:"_getOKButtonConfig",value:function(){return{text:"Clone Team"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaving",this).apply(this,arguments),this._components["clone-team-form"].disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this.spinner(),n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(e))}},{key:"show",value:function(e){var t=e.teamData,t=void 0===t?null:t,e=e.teamsData,e=void 0===e?[]:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.header="Clone ".concat(t.name),this._teamId=t.id,this._components["clone-team-form"].components["team-name"].names=e.map(function(e){return e.name||e})}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=this._components["clone-team-form"]).validate()&&(_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("clone-team").post({params:[this._teamId,t.components["team-name"].value]}));case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_reset",value:function(){_get(_getPrototypeOf(n.prototype),"_reset",this).call(this),this._components["clone-team-form"].disabled=!1,this._components["clone-team-form"].clear()}}]),n}(),n2.de.page.team.Context=function(){_inherits(l,n2.Object);var t,e,n=_createSuper(l);function l(){return _classCallCheck(this,l),n.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).call(this),this._mixins=[n2.mixin.DataDriven,n2.mixin.Singleton],this.dataProviders=["get-team-data"],this._lazyLoad=!0,this._teamId=null,this._isQ2QTeam=!1,this._isTriggersEnabled=!1,this._isDirty=!1}},{key:"teamId",get:function(){return this._teamId},set:function(e){this._teamId!==e&&(this._teamId=e)}},{key:"isQ2QTeam",get:function(){return this._isQ2QTeam},set:function(e){this._isQ2QTeam!==e&&(this._isQ2QTeam=e)}},{key:"isTriggersEnabled",get:function(){return this._isTriggersEnabled},set:function(e){this._isTriggersEnabled!==e&&(this._isTriggersEnabled=e)}},{key:"isDirty",get:function(){return this._isDirty},set:function(e){this._isDirty=e}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,r);case 3:return e.next=5,this._loadDataProvider("get-team-data",{silent:t,force:n});case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return");case 8:return s=i.response.teamId,e.next=11,Promise.all([this._loadDataProvider("get-is-q2q-team",{params:[s],silent:t,force:n}),this._loadDataProvider("get-is-triggers-enabled",{params:[s],silent:t,force:n})]);case 11:return s=e.sent,o=_slicedToArray(s,2),a=o[0],o=o[1],e.abrupt("return",{teamData:i,isQ2QTeam:a,isTriggersEnabled:o});case 16:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).call(this,e),this._teamId=e.teamData.response.teamId,e.isQ2QTeam&&!n2.isNull(e.isQ2QTeam.response)&&(this._isQ2QTeam=e.isQ2QTeam.response),e.isTriggersEnabled&&!n2.isNull(e.isTriggersEnabled.response)&&(this._isTriggersEnabled=e.isTriggersEnabled.response)}},{key:"_loadDataProvider",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=1<i.length&&void 0!==i[1]?i[1]:{}).silent,n.force,n2.isNull(this._getDataProviderById(t))){e.next=3;break}return e.abrupt("return",n2.mixin.DataDriven._loadDataProvider.apply(this,i));case 3:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),l}(),n2.de.page.team.DistributionHours=function(){_inherits(n,n2.de.page.Team);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-timezones"],this._pageContext=n2.de.page.team.distributionHours.Context.getInstance(),this._heading="Distribution Hours",this._headingIcon=n2.de.enum.Icon.DATE_TIME,this._helpLinkURL="https://help.nc-squared.com/distribution-hours",this._cls="n2-de-distribution-hours",this._activeNavigationId="distribution-hours"}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(n.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTabs(),this._insertTeamHours(),this._insertTeamMemberHours(),this._insertTeamHolidayRegion()}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"distribution-hours-tabs",tabs:[{id:"team-hours",label:"Team hours"},{id:"team-member-hours",label:"Team member hours"},{id:"team-holiday-region",label:"Holiday region"}],listeners:{click:function(e){return t._onTabClick(e)},change:function(e){return t._onTabChange(e)}},selectedTabId:"team-hours"}))}},{key:"_onTabClick",value:function(e){this._pageContext.isDirty&&(e.preventDefault(),n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Changing tabs will lose any unsaved changes, do you want to continue?",listeners:{submit:function(){e.performDefault()}}}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"team-hours":this._showTabContent({showTeamHours:!0});break;case"team-member-hours":this._showTabContent({showTeamMemberHours:!0});break;case"team-holiday-region":this._showTabContent({showTeamHolidayRegion:!0})}}},{key:"_insertTeamHours",value:function(){return this._insert(new n2.de.page.team.distributionHours.TeamHours({id:"team-hours"}))}},{key:"_insertTeamMemberHours",value:function(){return this._insert(new n2.de.page.team.distributionHours.TeamMemberHours({id:"team-member-hours",hidden:!0}))}},{key:"_insertTeamHolidayRegion",value:function(){return this._insert(new n2.de.page.team.distributionHours.TeamHolidayRegion({id:"team-holiday-region",hidden:!0}))}},{key:"_showTabContent",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=(n=0<a.length&&void 0!==a[0]?a[0]:{}).showTeamHours,s=void 0!==s&&s,t=n.showTeamMemberHours,t=void 0!==t&&t,n=n.showTeamHolidayRegion,(i=this._components["team-hours"]).hidden=!s,this._components["team-member-hours"].hidden=!t,(s=this._components["team-holiday-region"]).hidden=!n,n2.de.page.SlideOutPanel.getInstance().hidden=!0,i.cancel(),s.cancel();case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.force,e.silent;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("get-timezones").get()}},{key:"_onServerError",value:function(e){n2.de.Error.isInvalidId(e)&&!n2.isUndefined(this._components["team-hours"])&&this._components["team-hours"].spinner(!1),_get(_getPrototypeOf(n.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTeamMemberId(e)?"One or more of your team members no longer exists, please press OK to refresh.":_get(_getPrototypeOf(n.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){n2.de.Error.isInvalidDistributionHours(e)||n2.de.Error.isInvalidTeamMemberId(e)?(n2.de.page.SlideOutPanel.getInstance({renderTo:this._dom}).hidden=!0,this._reloadPage()):_get(_getPrototypeOf(n.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments)}},{key:"_reloadPage",value:function(){this._components["team-hours"].reload(),this._components["team-member-hours"].reload()}}]),n}(),n2.de.page.team.DistributorList=function(){_inherits(a,n2.de.page.Team);var e,t,n,i=_createSuper(a);function a(){return _classCallCheck(this,a),i.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._heading="Distributors",this._mixins=n2.merge([n2.mixin.DataDriven,n2.de.mixins.LimitLoads],this._mixins),this._dataProviders=["get-distributors"],this._headingIcon=n2.de.enum.Icon.PROCESS,this._helpLinkURL="https://help.nc-squared.com/distributors",this._cls="n2-de-distributor-list",this._activeNavigationId="distributors",this._distributorListData=null,this._resetSortBy=!1}},{key:"slideOutPanel",get:function(){return n2.de.page.team.distributorList.DistributorSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"tabs",get:function(){return this._components["distributor-tabs"]}},{key:"recordList",get:function(){return this.components.distributors}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(a.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTabs(),this._insertRecordList()}},{key:"_insertTabs",value:function(){return this._insert(new n2.ui.component.Tabs({id:"distributor-tabs",tabs:[{id:"distributor",label:"Standard Distributors"},{id:"pull",label:"Pull Distributors"},{id:"trigger",label:"Trigger Distributors"},{id:"manual",label:"Manual Distributors"}],hidden:!0,listeners:{change:this._onTabSelectionChange,scope:this}}))}},{key:"_onTabSelectionChange",value:function(e){this.slideOutPanel.hide(),this._resetSortBy=!0,this._refresh({recordList:!0}),this._resetSortBy=!1}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.team.distributorList.DistributorRecordList({id:"distributors",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_handleRecordListAction",value:function(e){switch(e.target.id){case"activate":return this._onActivateDistributors(this._getSelectedDistributorsData(e));case"deactivate":return this._onDeactivateDistributors(this._getSelectedDistributorsData(e));case"clone":return this._onOpenCloneDistributor(e.data);case"delete":return this._onDeleteDistributors(this._getSelectedDistributorsData(e));case"preview":return this._onOpenPreviewDistributor(e.data);case"recent":return this._onOpenRecentDistributions(e.data);case"test":return this._onOpenTestTool(e.data);case"reorder-distributors":return this._onOpenReorderDistributors(this.recordList.dataTable.data);case"assignment-simulation":return this._onOpenAssignmentSimulation();case"menu-cell":return}if(!n2.isNull(e.data)&&e.data.actions.includes("add-new"))return this._onAddNewDistributor(e.data.distributorType);e.relatedTarget instanceof n2.ui.component.dataTable.Row&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_showSlideOutPanel",value:function(t){var n=this;this.slideOutPanel.show({heading:t.name,distributorId:t.id,includeNavButtons:!0,listeners:{click:function(e){return n._handleSlideOutPanelClick(e,t)},scope:this}})}},{key:"_handleSlideOutPanelClick",value:function(e,t){"open-button"!==e.target.id&&"heading-button"!==e.target.id||this._onOpenDistributorSettings(t.id)}},{key:"_onOpenDistributorSettings",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_onActivateDistributors",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,this._postDataProvider("activate-distributors",{params:[t]});case 3:this.load({force:!0});case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_onDeactivateDistributors",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,this._postDataProvider("deactivate-distributors",{params:[t]});case 3:this.load({force:!0});case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onOpenCloneDistributor",value:function(e){n2.de.page.team.CloneDistributorModal.getInstance({renderTo:this._dom.parent}).show({distributorData:e,distributorsData:this._flattenDistributorData(),teamId:n2.de.page.team.Context.getInstance().teamId})}},{key:"_onOpenPreviewDistributor",value:function(e){n2.de.component.distributors.PreviewToolModal.getInstance({renderTo:this._dom,dataProviders:["preview-available-objects-for-distributor"]}).show({distributorName:e.name}),this._loadPreviewData(e.id)}},{key:"_loadPreviewData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,t=t.force;return this._fetchDataProvider("preview-available-objects-for-distributor",{params:[e],silent:void 0!==n&&n,force:void 0===t||t})}},{key:"_onOpenRecentDistributions",value:function(t){var n=this;n2.de.component.distributors.RecentDistributionsModal.getInstance({renderTo:this._dom,dataProviders:["get-recent-distribution-logs"]}).show({distributorName:t.name,listeners:{change:function(e){return n._loadRecentDistributions({distributorId:t.id,logDuration:e.data.logDuration,recordName:e.data.recordName})}}}),this._loadRecentDistributions({distributorId:t.id})}},{key:"_loadRecentDistributions",value:function(e){var t=e.distributorId,n=e.logDuration,n=void 0===n?"":n,i=e.recordName,i=void 0===i?"":i,s=e.force,e=e.silent;return this._limitLoads("get-recent-distribution-logs",{params:[t,n,i],force:void 0!==s&&s,silent:void 0!==e&&e,requestId:"".concat(t,"-").concat(n,"-").concat(i)})}},{key:"_onOpenTestTool",value:function(t){this.spinner();var n=this,i=0===(i=n2.de.ApplicationContext.getInstance().namespace).length?"c":i.replace("__","");$Lightning.use(i+":testtoolapp",function(){var e={distributorId:t.id,distributorName:t.name,notFromRecord:!0,fromTeam:!1,fromDistributor:!0,showTestModal:!0};$Lightning.createComponent(i+":deTestToolComponent",e,n.domId,function(e){n.spinner(!1)})})}},{key:"_onDeleteDistributors",value:function(n){var t,i=this,e=n.map(function(e){return e.name});n2.de.component.DeleteMessageBox.getInstance({renderTo:this._dom.parent,dataProviders:["delete-distributors"]}).show({names:e,type:"distributors",listeners:{submit:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i._postDataProvider("delete-distributors",{params:[n]});case 2:return e.next=4,t.hide();case 4:i.load({force:!0});case 5:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}})}},{key:"_onOpenReorderDistributors",value:function(e){var t,n=this;n2.de.page.team.distributorList.ReorderDistributorsModal.getInstance({renderTo:this._dom.parent}).show({data:e,listeners:{saved:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n._resetSortBy=!0,e.next=3,n.load({force:!0});case 3:n._resetSortBy=!1;case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})}})}},{key:"_onAddNewDistributor",value:function(e){n2.de.page.team.distributorList.NewDistributorModal.getInstance({renderTo:this._dom.parent}).show({distributorType:e,distributorsData:this._flattenDistributorData()})}},{key:"_onOpenAssignmentSimulation",value:function(){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=n2.de.page.team.Context.getInstance().teamId,e.next=6,this._loadDataProvider("get-distributors",{params:[i],force:n,silent:t});case 6:return e.t0=e.sent,e.abrupt("return",{distributors:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.distributors;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._distributorListData=e.response,this._refresh()}},{key:"_onServerError",value:function(e){return this.spinner(!1),this.slideOutPanel.hide(),_get(_getPrototypeOf(a.prototype),"_onServerError",this).call(this,e)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidDistributorId(e)?"One or more of your distributors no longer exists, please press OK to refresh.":_get(_getPrototypeOf(a.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){n2.de.Error.isInvalidDistributorId(e)?(n2.isUndefined(n2.de.page.SlideOutPanel.getInstance())||(n2.de.page.SlideOutPanel.getInstance().hidden=!0),this.load({force:!0})):_get(_getPrototypeOf(a.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.tabs,e=e.recordList,e=void 0!==e&&e;(void 0!==n&&n||t)&&this._refreshTabs(),(t||e)&&this._refreshRecordList()}},{key:"_refreshTabs",value:function(){n2.isEmpty(this._distributorListData)?this.tabs.hidden=!0:(this.tabs.selectedTabId=this._getSelectedTabId(),this.tabs.components.distributor.hidden=!this._hasStandardDistributorData(),this.tabs.components.pull.hidden=!this._hasPullDistributorData()||this._isQ2QTeam(),this.tabs.components.trigger.hidden=!this._hasTriggerDistributorData()||!this._isTriggersEnabled(),this.tabs.components.manual.hidden=!this._hasManualDistributorData(),this.tabs.hidden=this._hideTabs())}},{key:"_refreshRecordList",value:function(){this.recordList.distributorType=this._getDistributorTypeByTabId(this._getSelectedTabId()),this.recordList.data=this._distributorListData,this.recordList.hasManualDistributor=this._hasManualDistributorData(),this._resetSortBy&&(this.recordList.dataTable.sortBy={column:0,direction:"asc"})}},{key:"_hideTabs",value:function(){return this.tabs.componentList.filter(function(e){return!e.hidden}).length<=1}},{key:"_getSelectedTabId",value:function(){var e;return n2.isEmpty(this._distributorListData)?null:(e=this._distributorListData[this.tabs.selectedTabId],n2.isEmpty(this.tabs.selectedTabId)||n2.isEmpty(e)?(e=Object.entries(this._distributorListData).find(function(e){e=_slicedToArray(e,2),e[0],e=e[1];return!n2.isEmpty(e)}),_slicedToArray(e,1)[0]):this.tabs.selectedTabId)}},{key:"_getDistributorTypeByTabId",value:function(e){switch(e){case"pull":return n2.de.enum.distributor.Type.PULL;case"trigger":return n2.de.enum.distributor.Type.TRIGGER;case"manual":return n2.de.enum.distributor.Type.MANUAL;default:return n2.de.enum.distributor.Type.STANDARD}}},{key:"_hasStandardDistributorData",value:function(){return!n2.isEmpty(this._distributorListData)&&!n2.isEmpty(this._distributorListData.distributor)}},{key:"_hasPullDistributorData",value:function(){return!n2.isEmpty(this._distributorListData)&&!n2.isEmpty(this._distributorListData.pull)}},{key:"_hasTriggerDistributorData",value:function(){return!n2.isEmpty(this._distributorListData)&&!n2.isEmpty(this._distributorListData.trigger)}},{key:"_hasManualDistributorData",value:function(){return!n2.isEmpty(this._distributorListData)&&!n2.isEmpty(this._distributorListData.manual)}},{key:"_getSelectedDistributorsData",value:function(e){return n2.isNull(e.data)?this.recordList.dataTable.selection:[e.data]}},{key:"_flattenDistributorData",value:function(){return n2.merge(this._distributorListData.distributor||[],this._distributorListData.pull||[],this._distributorListData.trigger||[])}},{key:"_isQ2QTeam",value:function(){return n2.de.page.team.Context.getInstance().isQ2QTeam}},{key:"_isTriggersEnabled",value:function(){return n2.de.page.team.Context.getInstance().isTriggersEnabled}}]),a}(),n2.de.page.team.DistributorSettings=function(){_inherits(l,n2.de.page.Team);var n,e,t,i,s=_createSuper(l);function l(){return _classCallCheck(this,l),s.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven,n2.de.mixins.LimitLoads],this.dataProviders=["get-distributor-settings","save-distributor-settings"],this._heading="Distributor Settings",this._headingIcon=n2.de.enum.Icon.PROCESS,this._helpLinkURL="https://help.nc-squared.com/standard-distributors",this._cls="n2-de-distributor-settings n2_form-page",this._activeNavigationId="distributors",this._pageContext=n2.de.page.team.distributorSettings.Context.getInstance(),this._actionMenuOptions=[{id:"activateDistributorToggle",label:"Activate Distributor"},{id:"cloneDistributor",label:"Clone Distributor"},{id:"deleteDistributor",label:"Delete Distributor"},{id:"testDistributor",label:"Test Distributor"},{id:"recentDistributions",label:"Recent Distributions"},{id:"previewTool",label:"Preview Tool"},{id:"changeHistory",label:"Distributor History"},{id:"assignmentSimulation",label:"Assignment Simulation"}],this._distributorSettings=null,this._distributorNavigationOptions=null}},{key:"activateButton",get:function(){return this.pageHeader.components["activate-button"]}},{key:"distributorNavigation",get:function(){return this.pageHeader.components["distributor-navigation"]}},{key:"distributorSettingsForm",get:function(){return this._components["distributor-settings-form"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(l.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertDistributorNavigation(),this._insertActivateButton(),this._insertDistributorSettingsForm()}},{key:"_insertDistributorNavigation",value:function(){return this.pageHeader.insert(new n2.ui.component.field.Combo({id:"distributor-navigation",mixins:[n2.mixin.DataDriven],label:{text:"Distributor",hidden:!0},cls:"slds-m-right_small",required:!0,sort:!1,options:[],renderTo:this._getDistributorNavigationRenderTo(),listeners:{change:this._onDistributorNavigationChange,scope:this}}))}},{key:"_getDistributorNavigationRenderTo",value:function(){return n2.isNull(this._helpLinkURL)?{target:this.pageHeader.SELECTORS.actions,position:"afterbegin"}:{target:this.pageHeader.SELECTORS.helpLink,position:"beforebegin"}}},{key:"_onDistributorNavigationChange",value:function(e){var t=this;n2.de.page.team.distributorSettings.Context.getInstance().isDirty?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Switching distributors will lose any unsaved changes, do you want to continue?",listeners:{submit:function(){return t._navigateToDistributor(e.value)},cancel:function(){return t._refresh({distributorNavigationCombo:!0})}}}):this._navigateToDistributor(e.value)}},{key:"_navigateToDistributor",value:function(e){var t=n2.de.page.team.distributorSettings.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_insertDistributorSettingsForm",value:function(){return this.insert(new n2.de.page.team.distributorSettings.DistributorSettingsForm({id:"distributor-settings-form",listeners:{saved:this._onDistributorSettingsFormSaved,cancel:this._onDistributorSettingsFormCancel,scope:this}}))}},{key:"_onDistributorSettingsFormSaved",value:function(){this.load()}},{key:"_onDistributorSettingsFormCancel",value:function(){this.load()}},{key:"_insertActivateButton",value:function(){var t=this;return this.pageHeader.insert(new n2.ui.component.Button({id:"activate-button",renderTo:this._getActivateButtonRenderTo(),cls:"n2_activate-button",text:"Activate",hidden:!0,theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onActivateDistributorToggleClick()}}}))}},{key:"_getActivateButtonRenderTo",value:function(){return n2.isNull(this._helpLinkURL)?{target:this.pageHeader.SELECTORS.actions,position:"afterbegin"}:{target:this.pageHeader.SELECTORS.helpLink,position:"afterend"}}},{key:"_onActionMenuClick",value:function(e){switch(_get(_getPrototypeOf(l.prototype),"_onActionMenuClick",this).apply(this,arguments),e.id){case"activateDistributorToggle":this._onActivateDistributorToggleClick();break;case"cloneDistributor":this._onCloneDistributorClick();break;case"deleteDistributor":this._onDeleteDistributorClick();break;case"testDistributor":this._onTestDistributorClick();break;case"recentDistributions":this._onRecentDistributionsClick();break;case"previewTool":this._onPreviewToolClick();break;case"changeHistory":this._onChangeHistoryClick();break;case"assignmentSimulation":this._onAssigmentSimulationClick()}}},{key:"_onActivateDistributorToggleClick",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=!this._distributorSettings.get("isActive"))&&this.activateButton.spinner(),e.next=4,this._postDataProvider("toggle-active-state",{params:[this._distributorSettings.get("id"),this._distributorSettings.get("name"),!this._distributorSettings.get("isActive")]});case 4:this._distributorSettings.getProperty("isActive").set(t,{silent:!0}),this._refreshActivateToggleOption(),t?this._showActivateSuccess():this._refresh({activateButton:!0});case 7:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_showActivateSuccess",value:function(){var e=this;this.activateButton.spinner(!1),this.activateButton.success(),new n2.util.DelayedTask(function(){e._refresh({activateButton:!0})},800).start()}},{key:"_onCloneDistributorClick",value:function(){var e=this._getDataProviderById("get-distributor-names").getResponse();e.push(this._distributorSettings.get("name")),n2.de.page.team.CloneDistributorModal.getInstance({renderTo:this._dom}).show({distributorData:this._distributorSettings.json,distributorsData:e,teamId:n2.de.page.team.distributorSettings.Context.getInstance().teamId})}},{key:"_onDeleteDistributorClick",value:function(){var t,i=this,e=[this._distributorSettings.get("name")];n2.de.component.DeleteMessageBox.getInstance({renderTo:this._dom,dataProviders:["delete-distributor"]}).show({names:e,type:"distributors",listeners:{submit:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=n2.de.page.team.distributorSettings.Context.getInstance().distributorId,e.next=3,i._postDataProvider("delete-distributor",{params:[n]});case 3:return e.next=5,t.hide();case 5:i.spinner(),n=n2.de.page.team.distributorSettings.Context.getInstance().teamId,n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(n));case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}})}},{key:"_onTestDistributorClick",value:function(){n2.de.page.team.distributorSettings.Context.getInstance().isDirty?(n2.ui.component.MessageBox.getInstance({renderTo:this._dom}).show({message:"Unsaved changes will not be reflected in the test tool. Please save before launching.",buttons:n2.ui.enum.Button.OK}),n2.ui.component.MessageBox.getInstance().dom.addClass("n2-de-modal")):this._openTestTool()}},{key:"_onRecentDistributionsClick",value:function(){var t=this,n=n2.de.page.team.distributorSettings.Context.getInstance().distributorId;n2.de.component.distributors.RecentDistributionsModal.getInstance({renderTo:this._dom,dataProviders:["get-recent-distribution-logs"]}).show({listeners:{change:function(e){return t._loadRecentDistributions({distributorId:n,logDuration:e.data.logDuration,recordName:e.data.recordName})}}}),this._loadRecentDistributions({distributorId:n})}},{key:"_onAssigmentSimulationClick",value:function(){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show()}},{key:"_loadRecentDistributions",value:function(e){var t=e.distributorId,n=e.logDuration,n=void 0===n?"":n,i=e.recordName,i=void 0===i?"":i,s=e.force,e=e.silent;return this._limitLoads("get-recent-distribution-logs",{params:[t,n,i],force:void 0!==s&&s,silent:void 0!==e&&e,requestId:"".concat(t,"-").concat(n,"-").concat(i)})}},{key:"_onPreviewToolClick",value:function(){n2.de.page.team.distributorSettings.Context.getInstance().isDirty?(n2.ui.component.MessageBox.getInstance({renderTo:this._dom}).show({message:"Unsaved changes will not be reflected in the preview tool. Please save before launching.",buttons:n2.ui.enum.Button.OK}),n2.ui.component.MessageBox.getInstance().dom.addClass("n2-de-modal")):(n2.de.component.distributors.PreviewToolModal.getInstance({renderTo:this._dom,dataProviders:["preview-available-objects-for-distributor"]}).show(),this._loadPreviewData())}},{key:"_loadPreviewData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,e=e.force,e=void 0===e||e;return this._fetchDataProvider("preview-available-objects-for-distributor",{params:[n2.de.page.team.distributorSettings.Context.getInstance().distributorId],silent:t,force:e})}},{key:"_onChangeHistoryClick",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchDataProvider("get-change-history",{params:[this._distributorSettings.get("id")],force:!0,silent:!1});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:this._dom}).show({header:"Distributor history",model:t.response});case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_openTestTool",value:function(){this.spinner();var t=this,n=this._distributorSettings,i=0===(i=n2.de.ApplicationContext.getInstance().namespace).length?"c":i.replace("__","");$Lightning.use(i+":testtoolapp",function(){var e={distributorId:n.get("id"),showTestModal:!0,notFromRecord:!0,fromTeam:!1,fromDistributor:!0};$Lightning.createComponent(i+":deTestToolComponent",e,t.domId,function(e){t.spinner(!1)})})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).call(this,{silent:t,force:n});case 3:return i=n2.de.page.team.distributorSettings.Context.getInstance().distributorId,s=n2.de.page.team.distributorSettings.Context.getInstance().teamId,e.next=7,Promise.all([this._loadDataProvider("get-distributor-settings",{params:[i],force:n,silent:t}),this._loadDataProvider("get-distributor-navigation-options",{params:[s],force:n,silent:t})]);case 7:return i=e.sent,s=_slicedToArray(i,2),a=s[0],o=s[1],e.abrupt("return",{distributorSettings:a,distributorNavigationOptions:o});case 12:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.distributorSettings,e=e.distributorNavigationOptions;_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).apply(this,arguments),this._distributorSettings=this._prepareDistributorSettingsModel(t.response),this._distributorNavigationOptions=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(l.prototype),"_onLoaded",this).apply(this,arguments),"get-distributor-settings"===t.id&&(this._distributorSettings=this._prepareDistributorSettingsModel(e),this._refresh())}},{key:"_prepareDistributorSettingsModel",value:function(e){return e.get("method")===n2.de.enum.distributor.Method.CURRENT_OWNER&&(e.getProperty("defaultOwnerSettings").value={}),e}},{key:"_onSaving",value:function(e){_get(_getPrototypeOf(l.prototype),"_onSaving",this).apply(this,arguments),this.distributorSettingsForm.disabled=!0}},{key:"_onSaved",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(l.prototype),"_onSaved",this).apply(this,i),this.distributorSettingsForm.disabled=!1,this._showConfirmation();case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_showConfirmation",value:function(){n2.ui.component.Toast.getInstance().show({theme:n2.ui.enum.Theme.SUCCESS,message:"Your changes have been saved."})}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components["distributor-settings-form"])||(this.distributorSettingsForm.spinner(!1),this.distributorSettingsForm.disabled=!1,this.distributorSettingsForm.components["save-footer"].message=""),_get(_getPrototypeOf(l.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.activateButton,i=e.actionMenu,i=void 0!==i&&i,s=e.helpLink,s=void 0!==s&&s,a=e.distributorSettingsForm,a=void 0!==a&&a,e=e.distributorNavigationCombo,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshActivateButton(),(t||i)&&this._refreshActionMenu(),(t||s)&&this._refreshHelpLink(),(t||a)&&this._refreshDistributorSettingsForm(),(t||e)&&this._refreshDistributorNavigationCombo()}},{key:"_refreshActivateButton",value:function(){this.activateButton.reset(),this.activateButton.hidden=this._distributorSettings.get("isActive")}},{key:"_refreshActionMenu",value:function(){this._refreshActivateToggleOption(),this._refreshActionMenuOptions(),this._refreshCreatedBy(),this._refreshModifiedBy()}},{key:"_refreshActivateToggleOption",value:function(){var e=this._distributorSettings.get("isActive")?"Deactivate Distributor":"Activate Distributor";this.actionMenu.components.activateDistributorToggle.label=e}},{key:"_refreshActionMenuOptions",value:function(){var e=this._components["page-header"].components["action-menu"],t=this._distributorSettings.get("distributorType")===n2.de.enum.distributor.Type.STANDARD,n=this._distributorSettings.get("distributorType")===n2.de.enum.distributor.Type.TRIGGER,i=this._distributorSettings.get("distributorType")===n2.de.enum.distributor.Type.MANUAL;e.components.previewTool.hidden=n||i,e.components.cloneDistributor.hidden=i,e.components.testDistributor.hidden=i,e.components.assignmentSimulation.hidden=!t}},{key:"_refreshCreatedBy",value:function(){this.actionMenu.createdBy={name:this._distributorSettings.get("createdByName"),timestamp:this._distributorSettings.get("createdDateTime")}}},{key:"_refreshModifiedBy",value:function(){this.actionMenu.modifiedBy={name:this._distributorSettings.get("lastModifiedByName"),timestamp:this._distributorSettings.get("lastModifiedDateTime")}}},{key:"_refreshHelpLink",value:function(){var e=this._distributorSettings.get("distributorType").toLowerCase();"distributor"!==e&&(this.pageHeader.helpLinkURL="https://help.nc-squared.com/".concat(e,"-distributor-settings"))}},{key:"_refreshDistributorSettingsForm",value:function(){this.distributorSettingsForm.model=this._distributorSettings}},{key:"_refreshDistributorNavigationCombo",value:function(){this.distributorNavigation.options=this._distributorNavigationOptions,this.distributorNavigation.value={value:n2.de.page.team.distributorSettings.Context.getInstance().distributorId,silent:!0}}}]),l}(),n2.de.page.team.PostAssignment=function(){_inherits(n,n2.de.page.Team);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-is-object-sync-compatible"],this._heading="Post Assignment",this._headingIcon=n2.de.enum.Icon.TEXT_TEMPLATE,this._helpLinkURL="https://help.nc-squared.com/post-assignment",this._cls="n2-de-post-assignment",this._activeNavigationId="post-assignment"}},{key:"postAssignmentDistributors",get:function(){return this._components["post-assignment-distributors"]}},{key:"teamObjectSyncSettings",get:function(){return this._components["team-object-sync-settings"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(n.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertPostAssignmentComponents()}},{key:"_insertPostAssignmentComponents",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._insertTabs(),this._insertPostAssignmentDistributors(),this._insertObjectSyncSettings();case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_insertTabs",value:function(){var t=this,e=(n2.isUndefined(this._components["post-assignment-tabs"])||this._components["post-assignment-tabs"].destroy(),[{id:"distributor-settings",label:"Distributor settings"}]);return this._isQ2QTeam()||e.push({id:"object-sync",label:"Object sync"}),this.insert(new n2.ui.component.Tabs({id:"post-assignment-tabs",tabs:e,listeners:{change:function(e){return t._onTabChange(e)}},selectedTabId:"distributor-settings"}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"distributor-settings":this._showTabContent({showDistributorSettings:!0});break;case"object-sync":this._showTabContent({showObjectSyncSettings:!0})}}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showDistributorSettings,e=e.showObjectSyncSettings,e=void 0!==e&&e;this.postAssignmentDistributors.hidden=!(void 0!==t&&t),this.teamObjectSyncSettings.hidden=!e,n2.de.page.SlideOutPanel.getInstance().hidden=!0}},{key:"_insertPostAssignmentDistributors",value:function(){n2.isUndefined(this._components["post-assignment-distributors"])||this._components["post-assignment-distributors"].destroy(),this.insert(new n2.de.page.team.postAssignment.PostAssignmentDistributors({id:"post-assignment-distributors"}))}},{key:"_insertObjectSyncSettings",value:function(){n2.isUndefined(this._components["team-object-sync-settings"])||this._components["team-object-sync-settings"].destroy(),this._isQ2QTeam()||this.insert(new n2.de.page.team.postAssignment.PostAssignmentObjectSync({id:"team-object-sync-settings",hidden:!0}))}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components["post-assignment-distributors"])||this._components["post-assignment-distributors"].spinner(!1),_get(_getPrototypeOf(n.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidDistributorId(e)?"This distributor no longer exists, please press OK to refresh.":_get(_getPrototypeOf(n.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){!n2.de.Error.isInvalidDistributorId(e)||(n2.isUndefined(n2.de.page.SlideOutPanel.getInstance())||(n2.de.page.SlideOutPanel.getInstance().hidden=!0),n2.isUndefined(this._components["post-assignment-distributors"]))?_get(_getPrototypeOf(n.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components["post-assignment-distributors"].reload()}},{key:"_isQ2QTeam",value:function(){return n2.de.page.team.Context.getInstance().isQ2QTeam}}]),n}(),n2.de.page.team.TeamList=function(){_inherits(t,n2.de.Page);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["apvStaticBaseResourceUrl"]),this._pageContext=n2.de.page.team.Context.getInstance(),this._heading="Distribution Teams",this._headingIcon=n2.de.enum.Icon.GROUPS,this._helpLinkURL="https://help.nc-squared.com/distribution-teams",this._cls="n2-de-team-list",this._apvStaticBaseResourceUrl=null}},{key:"apvStaticBaseResourceUrl",set:function(e){this._apvStaticBaseResourceUrl=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isDeveloperOrg&&this._showDeveloperOrgMessage()}},{key:"_showDeveloperOrgMessage",value:function(){n2.ui.component.MessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,mixins:[n2.mixin.DataDriven],dataProviders:["get-license-details"],listeners:{loaded:function(e,t,n){"get-license-details"===n.id&&t.allowedLicenses<=5&&e.show({allowHTML:!0,message:'<p>Sorry we do not currently support Developer Edition</p>\n                        <p>If you have a customer requirement, please get in touch - we\'d be happy to help <a href="mailto:hello@nc-squared.com">hello@nc-squared.com</a></p>'})}}})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().hasNoDEPermissionSet&&this._insertPermissionSetMessage(),this._insertTeams()}},{key:"_insertPermissionSetMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"permission-set-message",renderTo:{target:this.SELECTORS.body,position:"beforebegin"},type:"info",content:'You do not have any Distribution Engine permission sets assigned. <a href="https://help.nc-squared.com/permissions">Add a packaged permission set</a> to ensure you have access to any newly released features.'}))}},{key:"_insertTeams",value:function(){return this._insert(new n2.de.page.team.teamList.Teams({id:"teams",apvStaticBaseResourceUrl:this._apvStaticBaseResourceUrl}))}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components.teams)||this._components.teams.spinner(!1),_get(_getPrototypeOf(t.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTeamId(e)?"One or more of your teams no longer exists, please press OK to refresh.":n2.de.Error.isInvalidDistributorId(e)?"One or more of your distributors no longer exists, please press OK to refresh.":_get(_getPrototypeOf(t.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){_get(_getPrototypeOf(t.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments),!n2.de.Error.isInvalidTeamId(e)&&!n2.de.Error.isInvalidDistributorId(e)||n2.isUndefined(this._components.teams)?_get(_getPrototypeOf(t.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components.teams.reload()}}]),t}(),n2.de.page.team.TeamMemberList=function(){_inherits(o,n2.de.page.Team);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-license-details","get-used-licenses-count"],this._heading="Team Members",this._headingIcon=n2.de.enum.Icon.GROUPS,this._helpLinkURL="https://help.nc-squared.com/adding-and-removing-team-members",this._cls="n2-de-team-member-list",this._activeNavigationId="team-members"}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-license-details",{silent:t,force:n}),this._loadDataProvider("get-used-licenses-count",{silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{licenseDetails:i,usedLicenseCount:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_insertPageComponents",value:function(){var e=this;_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).apply(this,arguments),this.insert(new n2.de.page.team.teamMemberList.TeamMembers({id:"team-members",listeners:{teamMembersRemoved:function(){return e.load({force:!0})},teamMembersAdded:function(){return e.load({force:!0})}}}))}},{key:"_onLoadComplete",value:function(e){var t=this,n=(_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._components["page-header"]),i=e.licenseDetails.response.allowedLicenses,e=e.usedLicenseCount.response;n.additionalHeading=this._getAdditionalHeadingText({allowedLicenseCount:i,usedLicenseCount:e}),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&n.element("additionalHeading").listen("click",function(){return t._onLicenseCountClick()},this)}},{key:"_onLicenseCountClick",value:function(){n2.de.page.Navigation.getInstance().open("Settings_LicensedUsers")}},{key:"_getAdditionalHeadingText",value:function(e){var t=e.allowedLicenseCount,e=e.usedLicenseCount,e=this._getUsedLicensesText(e,t);return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?'<span><a href="javascript:void(0)">'.concat(e,"</a></span>"):e}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components["team-members"])||this._components["team-members"].spinner(!1),_get(_getPrototypeOf(o.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTeamMemberId(e)?"One or more of your team members no longer exists, please press OK to refresh.":_get(_getPrototypeOf(o.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){!n2.de.Error.isInvalidTeamMemberId(e)||n2.isUndefined(this._components["team-members"])?_get(_getPrototypeOf(o.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components["team-members"].reload()}}]),o}(),n2.de.page.team.TeamPerformance=function(){_inherits(o,n2.de.page.Team);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-team-performance-metrics"],this._pageContext=n2.de.page.team.teamPerformance.Context.getInstance(),this._heading="Performance",this._headingIcon=n2.de.enum.Icon.TALENT_DEVELOPMENT,this._helpLinkURL="https://help.nc-squared.com/team-performance",this._componentCls="n2-de-team-performance",this._activeNavigationId="performance",this._teamPerformanceData=null}},{key:"recordList",get:function(){return this.components["team-performance-record-list"]}},{key:"slideOutPanel",get:function(){return n2.de.page.team.teamPerformance.TagAssignmentSlideOutPanel.getInstance({renderTo:this.SELECTORS.body})}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(o.prototype),"_insertPageComponents",this).call(this),this._insertRecordList()}},{key:"_insertRecordList",value:function(){return this.insert(new n2.de.page.team.teamPerformance.TeamPerformanceRecordList({id:"team-performance-record-list",cls:"n2-team-performance-record-list",listeners:{click:this._handleRecordListAction,scope:this}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return i=n2.de.page.team.teamPerformance.Context.getInstance().teamId,s=n2.isNull(this._teamPerformanceData)?null:this._teamPerformanceData.performanceDateRange,e.next=6,this._loadDataProvider("get-team-performance-metrics",{params:[i,s],silent:t,force:n});case 6:return e.t0=e.sent.response,e.abrupt("return",{teamPerformanceData:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-team-performance-metrics"===t.id&&this._refreshRecordList(e)}},{key:"_onLoadComplete",value:function(e){e=e.teamPerformanceData;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._refreshRecordList(e)}},{key:"_refreshRecordList",value:function(e){this._teamPerformanceData=e,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filterTable,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshFilterTable()}},{key:"_refreshFilterTable",value:function(){this.recordList.teamData=this._teamPerformanceData}},{key:"_handleRecordListAction",value:function(e){if("modify-assignments"===e.target.id)return this._onModifyAssignments();e.relatedTarget instanceof n2.ui.component.dataTable.Row&&(this._teamPerformanceData.tagWeightingEnabled||this._teamPerformanceData.teamLevelCapsEnabled)&&this._showSlideOutPanel(e.relatedTarget.data)}},{key:"_onModifyAssignments",value:function(){var e=this.recordList.selectedData,t=e.map(function(e){return e.userId}),e=e.map(function(e){return e.name});n2.de.page.team.teamPerformance.ModifyAssignmentsModal.getInstance({renderTo:this._dom,listeners:{submit:this._reload,scope:this}}).show({userIds:t,userNames:e})}},{key:"_showSlideOutPanel",value:function(e){this.slideOutPanel.show({heading:e.name,userIds:[e.userId],includeNavButtons:!1,listeners:{saved:this._reload,scope:this}})}},{key:"_reload",value:function(){this._load({silent:!1,force:!0})}}]),o}(),n2.de.page.team.TeamSettings=function(){_inherits(s,n2.de.page.Team);var e,t,n=_createSuper(s);function s(){return _classCallCheck(this,s),n.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-team-settings"],this._heading="Settings",this._headingIcon=n2.de.enum.Icon.SETTINGS,this._helpLinkURL="https://help.nc-squared.com/team-settings",this._cls="n2-de-team-settings n2_form-page",this._activeNavigationId="settings",this._actionMenuOptions=[{id:"activateTeamToggle",label:"Activate Team"},{id:"cloneTeam",label:"Clone Team"},{id:"deleteTeam",label:"Delete Team"},{id:"changeHistory",label:"Team History"}]}},{key:"activateButton",get:function(){return this.pageHeader.components["activate-button"]}},{key:"_insertPageComponents",value:function(){var i=this;_get(_getPrototypeOf(s.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertActivateButton(),this.insert(new n2.de.page.team.teamSettings.TeamSettingsForm({id:"team-settings-form",listeners:{loaded:function(e,t,n){"get-team-settings"===n.id&&i._onTeamSettingsModelLoaded(t)}}}))}},{key:"_onTeamSettingsModelLoaded",value:function(e){this._model=e,this._refreshActionMenu(),this._refreshActivateButton()}},{key:"_insertActivateButton",value:function(){var t=this;return this.pageHeader.insert(new n2.ui.component.Button({id:"activate-button",renderTo:this._getActivateButtonRenderTo(),cls:"n2_activate-button",text:"Activate",hidden:!0,theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onActivateTeamToggleClick()}}}))}},{key:"_getActivateButtonRenderTo",value:function(){return n2.isNull(this._helpLinkURL)?{target:this.pageHeader.SELECTORS.actions,position:"afterbegin"}:{target:this.pageHeader.SELECTORS.helpLink,position:"afterend"}}},{key:"_onActionMenuClick",value:function(e){switch(_get(_getPrototypeOf(s.prototype),"_onActionMenuClick",this).apply(this,arguments),e.id){case"activateTeamToggle":this._onActivateTeamToggleClick();break;case"cloneTeam":this._onCloneTeamClick();break;case"deleteTeam":this._onDeleteTeamClick();break;case"changeHistory":this._onChangeHistoryClick()}}},{key:"_onActivateTeamToggleClick",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=!this._model.get("isActive"))&&this.activateButton.spinner(),e.next=4,n2.DataProviderManager.getInstance().get("toggle-active").post({params:[this._model.get("id"),this._model.get("name"),!this._model.get("isActive")]});case 4:this._model.getProperty("isActive").set(t,{silent:!0}),this._refreshActivateToggleOption(),t?this._showActivateSuccess():this._refreshActivateButton();case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_showActivateSuccess",value:function(){var e=this;this.activateButton.spinner(!1),this.activateButton.success(),new n2.util.DelayedTask(function(){e._refreshActivateButton()},800).start()}},{key:"_onCloneTeamClick",value:function(){var e=n2.DataProviderManager.getInstance().get("get-team-names").model;e.push(this._model.get("name")),n2.de.page.team.CloneTeamModal.getInstance({renderTo:this._dom}).show({teamData:this._model.json,teamsData:e})}},{key:"_onDeleteTeamClick",value:function(){var t,n=this,e=[this._model.get("name")];n2.de.component.DeleteMessageBox.getInstance({renderTo:this._dom,dataProviders:["delete-team"]}).show({names:e,type:"teams",listeners:{submit:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("delete-team").post({params:[n._model.get("id")]});case 2:return e.next=4,t.hide();case 4:n.spinner(),n2.de.page.Navigation.getInstance().open("Team_TeamList");case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}})}},{key:"_onChangeHistoryClick",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("get-change-history").get({params:[this._model.get("id")],force:!0,silent:!1});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:this._dom}).show({header:"Team history",model:t});case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){_get(_getPrototypeOf(s.prototype),"_onSaving",this).apply(this,arguments),this._components["team-settings-form"].disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onSaved",this).apply(this,arguments),this._components["team-settings-form"].disabled=!1,this._showConfirmation()}},{key:"_showConfirmation",value:function(){n2.ui.component.Toast.getInstance().show({theme:n2.ui.enum.Theme.SUCCESS,message:"Your changes have been saved."})}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components["team-settings-form"])||(this._components["team-settings-form"].disabled=!1,this._components["team-settings-form"].components["save-footer"].message=""),_get(_getPrototypeOf(s.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_refreshActivateButton",value:function(){this.activateButton.reset(),this.activateButton.hidden=this._model.get("isActive")}},{key:"_refreshActionMenu",value:function(){this._refreshActivateToggleOption(),this._refreshCreatedBy(),this._refreshModifiedBy()}},{key:"_refreshActivateToggleOption",value:function(){var e=this._model.get("isActive")?"Deactivate Team":"Activate Team";this.actionMenu.components.activateTeamToggle.label=e}},{key:"_refreshCreatedBy",value:function(){this.actionMenu.createdBy={name:this._model.get("createdByName"),timestamp:this._model.get("createdDateTime")}}},{key:"_refreshModifiedBy",value:function(){this.actionMenu.modifiedBy={name:this._model.get("lastModifiedByName"),timestamp:this._model.get("lastModifiedDateTime")}}}]),s}(),n2.de.page.team.TeamSummary=function(){_inherits(l,n2.de.page.Team);var e,t=_createSuper(l);function l(){return _classCallCheck(this,l),t.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Home",this._headingIcon=n2.de.enum.Icon.HOME,this._helpLinkURL="https://help.nc-squared.com/team-summary",this._componentCls="n2-de-team-summary",this._activeNavigationId="home"}},{key:"teamListsContainer",get:function(){return this._components["team-lists-container"]}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(l.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTeamInfo(),this._insertEmptyTeamCard(),this._insertStats(),this._insertTeamListsContainer(),this._insertTeamMembersList(),this._insertDistributorsList()}},{key:"_insertTeamInfo",value:function(){return this._insert(new n2.de.page.team.teamSummary.TeamInfo({id:"team-info",dataProviders:["get-team-summary"],isActive:{bindPath:"get-team-summary.isActive"},objectName:{bindPath:"get-team-summary.objectName"},hours:{bindPath:"get-team-summary.teamHours"}}))}},{key:"_insertEmptyTeamCard",value:function(){return this._insert(new n2.de.page.team.teamSummary.EmptyTeamCard({id:"empty-team-card",cls:"n2_empty-team-card",hidden:!0}))}},{key:"_insertStats",value:function(){return this._insert(new n2.de.page.team.teamSummary.Stats({id:"team-stats",hidden:!0}))}},{key:"_insertTeamListsContainer",value:function(){return this._insert(new n2.ui.component.HTML({id:"team-lists-container",template:'<div id="{{id}}" class="n2_team-lists-container slds-grid"></div>'}))}},{key:"_insertTeamMembersList",value:function(){return this.teamListsContainer.insert(new n2.de.page.team.teamSummary.TeamMembersList({id:"team-members-list",dataProviders:["get-team-members"],cls:"n2_team-members-list slds-col",teamMembersData:{bindPath:"get-team-members"}}))}},{key:"_insertDistributorsList",value:function(){return this.teamListsContainer.insert(new n2.de.page.team.teamSummary.DistributorsList({id:"distributors-list",dataProviders:["get-team-distributors"],cls:"n2_team-distributors-list slds-col",distributorsData:{bindPath:"get-team-distributors"}}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(l.prototype),"_afterRender",this).call(this),this._dom.addClass(this._componentCls)}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,r);case 3:return i=n2.de.page.team.Context.getInstance().teamId,e.next=6,Promise.all([this._loadDataProvider("get-team-summary",{params:[i],force:n,silent:t}),this._loadDataProvider("get-team-members",{params:[i],force:n,silent:t}),this._loadDataProvider("get-team-distributors",{params:[i],force:n,silent:t})]);case 6:return i=e.sent,o=_slicedToArray(i,3),s=o[0],a=o[1],o=o[2],e.abrupt("return",{teamSummary:s,teamMembersData:a,teamDistributorsData:o});case 12:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){this.spinner(!1);var t=!n2.isEmpty(e.teamMembersData.response.teamMembers),n=!n2.isEmpty(e.teamDistributorsData.response);this._components["team-info"].isActive=e.teamSummary.response.isActive,this._components["team-info"].objectName=e.teamSummary.response.objectName,this._components["team-info"].hours=e.teamSummary.response.teamHours,this._components["empty-team-card"].hidden=t&&n,this._components["team-stats"].hidden=!t||!n,this.teamListsContainer.components["team-members-list"].teamMembersData=e.teamMembersData.response,this.teamListsContainer.components["distributors-list"].distributorsData=e.teamDistributorsData.response}},{key:"_onServerError",value:function(e){n2.de.Error.isInvalidTeamId(e)&&this.spinner(!1),_get(_getPrototypeOf(l.prototype),"_onServerError",this).apply(this,arguments)}}]),l}(),n2.de.page.team.TrackingAndSlas=function(){_inherits(n,n2.de.page.Team);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-team-tracking-and-slas"],this._heading="Tracking and SLAs",this._headingIcon=n2.de.enum.Icon.NOTIFICATION,this._helpLinkURL="https://help.nc-squared.com/team-tracking",this._cls="n2-de-tracking-and-slas",this._activeNavigationId="tracking-and-slas",this._slaCount=null}},{key:"tabs",get:function(){return this._components["tracking-and-slas-tabs"]}},{key:"_insertPageComponents",value:function(){if(_get(_getPrototypeOf(n.prototype),"_insertPageComponents",this).apply(this,arguments),n2.de.page.team.Context.getInstance().isQ2QTeam)return this._insertEmptyState();this._insertTabs(),this._insertTeamSettings(),this._insertDistributorSettings()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",illustration:n2.ui.component.illustration.FishingDeals,heading:"Tracking and SLAs",content:"Tracking and SLAs are unavailable for Q2Q teams. Tracking and SLAs allow you to monitor the time taken for actions and events to occur after assignment to a Team Member."}))}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"tracking-and-slas-tabs",tabs:[{id:"team-settings",label:"Team-level"},{id:"distributor-settings",label:"Distributor-level"}],listeners:{click:function(e){return t._onTabClick(e)},change:function(e){return t._onTabChange(e)}},selectedTabId:"team-settings"}))}},{key:"_onTabClick",value:function(e){"team-settings"===this.tabs.selectedTabId&&n2.de.page.team.Context.getInstance().isDirty&&(e.preventDefault(),n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Changing tabs will lose any unsaved changes, do you want to continue?",listeners:{submit:function(){e.performDefault()}}}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"team-settings":this._showTabContent({showTeamSettings:!0});break;case"distributor-settings":this._showTabContent({showDistributorSettings:!0})}}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showTeamSettings,e=e.showDistributorSettings,e=void 0!==e&&e,n=this._components["team-settings"];n.hidden=!(void 0!==t&&t),this._components["distributor-settings"].hidden=!e,e&&n.cancel(),n2.de.page.SlideOutPanel.getInstance().hidden=!0}},{key:"_insertTeamSettings",value:function(){var i=this;return this.insert(new n2.de.page.team.trackingAndSlas.TeamSettings({id:"team-settings",cls:"n2-de-tracking-and-slas-team-settings n2_form-page",listeners:{loaded:function(e,t,n){return i._onTeamSettingsLoaded(e,t,n)}}}))}},{key:"_onTeamSettingsLoaded",value:function(e,t,n){n2.isNull(n)&&this._slaCount!==this._getSlaCount(t)&&this._components["distributor-settings"].reload()}},{key:"_insertDistributorSettings",value:function(){return this.insert(new n2.de.page.team.trackingAndSlas.DistributorSettings({id:"distributor-settings",cls:"slds-m-around_medium",hidden:!0}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-team-tracking-and-slas"!==t.id||(this.tabs.components["distributor-settings"].disabled=!e.get("slasEnabled"),this._components["team-settings"].model=e,this._slaCount=this._getSlaCount(e))}},{key:"_getSlaCount",value:function(e){var t=e.get("slasEnabled"),e=e.get("slas");return t&&n2.isArray(e)?e.length:null}},{key:"_onServerError",value:function(e){n2.de.Error.isInvalidTeamId(e)&&!n2.isUndefined(this._components["team-settings"])&&this._components["team-settings"].spinner(!1),_get(_getPrototypeOf(n.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidDistributorId(e)?"This distributor no longer exists, please press OK to refresh.":_get(_getPrototypeOf(n.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){!n2.de.Error.isInvalidDistributorId(e)||(n2.isUndefined(n2.de.page.SlideOutPanel.getInstance())||(n2.de.page.SlideOutPanel.getInstance().hidden=!0),n2.isUndefined(this._components["distributor-settings"]))?_get(_getPrototypeOf(n.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components["distributor-settings"].reload()}}]),n}(),n2.de.page.team.VerticalNavigation=function(){_inherits(s,n2.de.component.VerticalNavigation);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-team-vertical-navigation"),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.SELECTORS=n2.merge(this.SELECTORS,{returnLink:".n2_return-link"}),this.EVENTS=n2.merge(this.EVENTS,{teamChange:function(e){}}),this._returnLink={href:"javascript:void(0)",text:"Return to Teams"},this._teamId=""}},{key:"teamId",get:function(){return this._teamId},set:function(e){this._teamId!==e&&(this._teamId=e,this._refreshTeamId())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertTeamNavigation()}},{key:"_insertTeamNavigation",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"team-navigation",label:{text:"Change team",hidden:!0},cls:"n2_team-navigation",required:!0,renderTo:{target:this.SELECTORS.returnLink,position:"afterend"},value:this._teamId,mixins:[n2.mixin.DataDriven],dataProviders:["get-team-navigation-options"],options:{bindPath:"get-team-navigation-options"},sort:!1,listeners:{change:function(e){return t._onTeamNavigationChange(e)}}}))}},{key:"_onTeamNavigationChange",value:function(e){this.fire("teamChange",{target:e,relatedTarget:null,event:null,data:null})}},{key:"_onReturnLinkClick",value:function(){_get(_getPrototypeOf(s.prototype),"_onReturnLinkClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().open("Team_TeamList")}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-team-navigation-options",{silent:t,force:n});case 4:return e.t0=e.sent,e.abrupt("return",{navigationOptions:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).call(this,e),this._components["team-navigation"].options=e.navigationOptions.response}},{key:"_refreshTeamId",value:function(){this._components["team-navigation"].value=this._teamId}}]),s}(),n2.de.page.team.WeightingAndCaps=function(){_inherits(t,n2.de.page.Team);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=[],this._heading="Weighting and Caps",this._headingIcon=n2.de.enum.Icon.RESOURCE_CAPACITY,this._helpLinkURL="https://help.nc-squared.com/weighting-and-capping",this._cls="n2-de-weighting-and-caps",this._activeNavigationId="weighting-and-caps"}},{key:"_insertPageComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertPageComponents",this).apply(this,arguments),this._insertTabs(),this._insertWeighting(),this._insertCaps(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertDistributorSettings()}},{key:"_insertTabs",value:function(){var t=this;return this.insert(new n2.ui.component.Tabs({id:"weighting-and-caps-tabs",tabs:this._getTabs(),listeners:{click:function(e){return t._onTabClick(e)},change:function(e){return t._onTabChange(e)}},selectedTabId:"weighting"}))}},{key:"_getTabs",value:function(){var e=[{id:"weighting",label:"Team-level weighting"},{id:"caps",label:"Team-level caps"}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.push({id:"distributor-settings",label:"Distributor-level settings"}),e}},{key:"_onTabClick",value:function(e){var t=e.currentTarget.selectedTabId;"weighting"!==t&&"caps"!==t||!n2.de.page.team.Context.getInstance().isDirty||(e.preventDefault(),n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Changing tabs will lose any unsaved changes, do you want to continue?",listeners:{submit:function(){e.performDefault()}}}))}},{key:"_onTabChange",value:function(e){switch(e.data.selectedTabId.newValue){case"weighting":this._showTabContent({showWeighting:!0});break;case"caps":this._showTabContent({showCaps:!0});break;case"distributor-settings":this._showTabContent({showDistributorSettings:!0})}}},{key:"_insertWeighting",value:function(){this.insert(new n2.de.page.team.weightingAndCaps.Weighting({id:"weighting"}))}},{key:"_insertCaps",value:function(){var t=this;this.insert(new n2.de.page.team.weightingAndCaps.TeamCaps({id:"team-caps",hidden:!0,listeners:{saved:function(e){return t._onTeamCapsSaved(e)}}}))}},{key:"_onTeamCapsSaved",value:function(e){n2.isUndefined(this._components["distributor-settings"])||this._components["distributor-settings"].reload()}},{key:"_insertDistributorSettings",value:function(){this.insert(new n2.de.page.team.weightingAndCaps.DistributorSettings({id:"distributor-settings",cls:"slds-m-around_medium",hidden:!0}))}},{key:"_showTabContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showWeighting,t=void 0!==t&&t,n=e.showCaps,n=void 0!==n&&n,e=e.showDistributorSettings,e=void 0!==e&&e;this._components.weighting.hidden=!t,this._components["team-caps"].hidden=!n,n2.isUndefined(this._components["distributor-settings"])||(this._components["distributor-settings"].hidden=!e),n2.de.page.SlideOutPanel.getInstance().hidden=!0,t||n2.isUndefined(this._components.weighting)||this._components.weighting.reload(),n||n2.isUndefined(this._components["team-caps"])||this._components["team-caps"].reload()}},{key:"_onServerError",value:function(e){n2.isUndefined(this._components["distributor-settings"])||this._components["distributor-settings"].spinner(!1),_get(_getPrototypeOf(t.prototype),"_onServerError",this).apply(this,arguments)}},{key:"_getInvalidIdMessageBoxContent",value:function(e){return n2.de.Error.isInvalidTeamMemberId(e)?"One or more of your team members no longer exists, please press OK to refresh.":n2.de.Error.isInvalidDistributorId(e)?"This distributor no longer exists, please press OK to refresh.":_get(_getPrototypeOf(t.prototype),"_getInvalidIdMessageBoxContent",this).apply(this,arguments)}},{key:"_onInvalidIdMessageBoxSubmit",value:function(e){n2.de.Error.isInvalidDistributorId(e)?(n2.isUndefined(n2.de.page.SlideOutPanel.getInstance())||(n2.de.page.SlideOutPanel.getInstance().hidden=!0),n2.isUndefined(this._components["distributor-settings"])?_get(_getPrototypeOf(t.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components["distributor-settings"].reload()):!n2.de.Error.isInvalidTeamMemberId(e)||n2.isUndefined(this._components.weighting)?_get(_getPrototypeOf(t.prototype),"_onInvalidIdMessageBoxSubmit",this).apply(this,arguments):this._components.weighting.reload()}}]),t}(),n2.de.component.availabilityCalendar.slideOutPanel.AbstractShiftDetails=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._slideOutPanelDate=null,this._shiftsData=null,this._teamMembersData=null}},{key:"slideOutPanelDate",set:function(e){this._setProperty("slideOutPanelDate",e,{sync:!1})}},{key:"shiftsData",set:function(e){this._setProperty("shiftsData",e,{sync:!1})}},{key:"teamMembersData",set:function(e){this._setProperty("teamMembersData",e,{sync:!1})}},{key:"_getShiftHoursData",value:function(e){return n2.de.component.hours.Util.formatShiftDays(e.days)}},{key:"_getShiftHoursOutput",value:function(e){var n=this,i=null;return(e="Mon"===this._getCurrentDayOfWeek()?n2.clone(e.sort(function(e,t){return"Sun"===e.day?-1:0})):e).filter(function(e){return!n2.isNull(e.hourBlocks)}).map(function(e){var t=!n2.isNull(i)&&i!==e.day||!n._isSlideOutPanelDayOfWeek(e.day);return i=e.day,"".concat(n._getShiftHourBlocksOutput(e,{includeDay:t}))}).join(" | ")}},{key:"_getShiftHourBlocksOutput",value:function(e){var t=this,n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).includeDay,n=void 0!==n&&n,i=e.hourBlocks.map(function(e){return t._getShiftBlockOutput(e)}).join(" | ");return n?"".concat(e.day," ").concat(i):i}},{key:"_getShiftBlockOutput",value:function(e){var t=e.startTime,e=e.endTime;return"".concat(t.hour,":").concat(t.minute).concat(t.meridiem," to ").concat(e.hour,":").concat(e.minute).concat(e.meridiem)}},{key:"_isShift",value:function(e){return"Shift"===e.shiftType}},{key:"_isTeamShift",value:function(e){return"Team"===e.shiftType}},{key:"_isIndividualShift",value:function(e){return"Individual"===e.shiftType}},{key:"_isSlideOutPanelDayOfWeek",value:function(e){return this._getCurrentDayOfWeek()===e}},{key:"_getCurrentDayOfWeek",value:function(){return n2.getDay(this._slideOutPanelDate,{short:!0})}}]),t}(),n2.de.component.availabilityCalendar.slideOutPanel.IndividualShiftDetails=function(){_inherits(t,n2.de.component.availabilityCalendar.slideOutPanel.AbstractShiftDetails);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._SELECTORS=n2.merge(this._SELECTORS,{shiftHeading:".n2_shift-heading"}),this._template='<div id="{{id}}" class="n2-component n2_availability-details{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <h4 class="n2_shift-heading">{{shiftName}}</h4>\n            <ul>\n                {{#teamMembersData}}<li title="{{shiftHours}}">{{userName}}</li>{{/teamMembersData}}\n            </ul>\n        </div>',this._componentCls="n2-de-availability-calendar-individual-shift-details"}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{shiftName:"Individual",teamMembersData:this._getTeamMembersDataWithShiftHours()})}},{key:"_getTeamMembersDataWithShiftHours",value:function(){var n=this;return this._teamMembersData.map(function(t){var e=n._shiftsData.find(function(e){return e.shiftHoursId===t.shiftHoursId});return n2.merge(t,{shiftHours:"".concat(n._getShiftHoursOutput(n._getShiftHoursData(e))," (").concat(e.timezone,")")})})}}]),t}(),n2.de.component.availabilityCalendar.slideOutPanel.ShiftDetails=function(){_inherits(t,n2.de.component.availabilityCalendar.slideOutPanel.AbstractShiftDetails);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._SELECTORS=n2.merge(this._SELECTORS,{shiftHeading:".n2_shift-heading"}),this._template='<div id="{{id}}" class="n2-component n2_availability-details{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <h4 class="n2_shift-heading">{{#showShiftName}}{{shiftName}}{{/showShiftName}}</h4>\n            <p class="n2_shift-hours">{{shiftHours}} ({{timeZone}})</p>\n            <ul>\n                {{#teamMembersData}}<li>{{userName}}</li>{{/teamMembersData}}\n            </ul>\n        </div>',this._componentCls="n2-de-availability-calendar-shift-details",this._shiftData=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),n2.isEmpty(this._shiftsData)||this._setProperty("shiftData",this._shiftsData[0]),this._isShift(this._shiftData)&&this._insertShiftHeadingLink()}},{key:"_insertShiftHeadingLink",value:function(){return this._insert(new n2.de.component.Link({id:"shift-heading-link",text:this._shiftData.shiftName,renderTo:this._SELECTORS.shiftHeading,listeners:{click:this._onShiftHeadingLinkClick,scope:this}}))}},{key:"_onShiftHeadingLinkClick",value:function(e){n2.de.page.Navigation.getInstance().open("Availability_Shifts","shiftHoursId=".concat(this._shiftData.shiftHoursId))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{showShiftName:this._isTeamShift(this._shiftData),shiftName:this._shiftData.shiftName,shiftHours:this._getShiftHoursOutput(this._getShiftHoursData(this._shiftData)),timeZone:this._shiftData.timezone,teamMembersData:this._teamMembersData})}}]),t}(),n2.de.component.field.tagPicker.TagPickerPopover=function(){_inherits(i,n2.de.component.AbstractPopover);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this.id="tag-picker-popover",this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters",tagSelectionList:".n2_tag-selection-list",noMatchMessage:".n2_no-match-message"}),this._bodyTemplate='<div class="n2_popover-body">\n            <div class="n2_filters"></div>\n            <div class="n2_tag-selection-list">\n                {{> noMatchMessageTemplate}}\n            </div>\n        </div>',this._noMatchMessageTemplate='<p class="n2_no-match-message slds-hide">No tags match your filters. <a class="n2_no-match-message-link" href="javascript:void(0)" rel="nofollow">Clear filters</a></p>',this._componentCls="".concat(this._componentCls," n2-de-tag-picker-popover"),this._tagCollections=null,this._tagMap=null,this._selection=null,this._REFRESH=n2.merge(this._REFRESH,{tagCollections:["tagCollectionFilter","tagSelection"],tagMap:["tagSelection"],selection:["selectedTags"]}),this._tagSelectionComponents=null}},{key:"tagCollections",set:function(e){this._setProperty("tagCollections",e)}},{key:"tagMap",set:function(e){this._setProperty("tagMap",e)}},{key:"tagCollectionFilter",get:function(){return this._components["tag-collection-filter"]}},{key:"quickFilter",get:function(){return this._components["quick-filter"]}},{key:"selection",get:function(){return n2.isNull(this._tagSelectionComponents)?{}:this._tagSelectionComponents.filter(function(e){return!n2.isEmpty(e.value)}).map(function(e){return e.value}).flat()}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this),this._insertTagCollectionFilter(),this._insertQuickFilter(),this._insertCloseButton({renderTo:{target:this.SELECTORS.filters}})}},{key:"_insertTagCollectionFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"tag-collection-filter",renderTo:this.SELECTORS.filters,label:{text:"Tag collection",hidden:!0},options:this._tagCollections,multiple:!0,placeholder:"All collections",listeners:{change:this._onTagCollectionFilterChange,scope:this}}))}},{key:"_onTagCollectionFilterChange",value:function(e){this._refresh(["filteredTagSelection"])}},{key:"_insertQuickFilter",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.filters,label:{text:"Filter by tag name",hidden:!0},placeholder:"Filter by tag name...",listeners:{change:this._onQuickFilterChange,type:this._onQuickFilterChange,scope:this}}))}},{key:"_onQuickFilterChange",value:function(e){this._refresh(["filteredTagSelection"])}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(i.prototype),"_getTemplatePartials",this).call(this),{noMatchMessageTemplate:this._noMatchMessageTemplate})}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(e.target,e.cls,e.listeners,e.tagCollections),t=void 0===t?[]:t,n=e.tagMap,n=void 0===n?[]:n,e=e.selection,e=void 0===e?{}:e;this.tagCollectionFilter.clear(),this.quickFilter.clear(),_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this._setProperties({tagCollections:t,tagMap:n,selection:e})}},{key:"hide",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).reserveSpace;_get(_getPrototypeOf(i.prototype),"hide",this).apply(this,arguments),this._setProperty("selection",[])}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(i.prototype),"_prepareDOM",this).call(this),this.element("noMatchMessage").listen("click",this._onNoMatchMessageClick,{scope:this})}},{key:"_onNoMatchMessageClick",value:function(e){e.target.classList.contains("n2_no-match-message-link")&&(this.tagCollectionFilter.clear(),this.quickFilter.clear())}},{key:"_refreshTagCollectionFilter",value:function(){this.tagCollectionFilter.options=this._tagCollections}},{key:"_refreshTagSelection",value:function(){var i=this;n2.isNull(this._tagSelectionComponents)||(this._tagSelectionComponents.forEach(function(e){return e.destroy()}),this._tagSelectionComponents=null),this._tagSelectionComponents=Object.entries(this._tagMap).map(function(e,t){var e=_slicedToArray(e,2),n=e[0],e=e[1];return i._insertTagSelectionComponent("tag-selection-".concat(t),n,e)}),this._applyVisibleIndexAttributes()}},{key:"_refreshFilteredTagSelection",value:function(){var t,n=this;n2.isNull(this._tagSelectionComponents)||(t=0,this._tagSelectionComponents.forEach(function(e){e.filter({tagName:n.quickFilter.value,tagCollectionIds:n.tagCollectionFilter.value}),t=e.hidden?t+1:t}),this._applyVisibleIndexAttributes(),this._rendered&&t===this._tagSelectionComponents.length?this.element("noMatchMessage").show():this.element("noMatchMessage").hide())}},{key:"_refreshSelectedTags",value:function(){var t=this;n2.isNull(this._tagSelectionComponents)||this._tagSelectionComponents.forEach(function(e){e.value={value:t._selection||[],silent:!0}})}},{key:"_insertTagSelectionComponent",value:function(e,t,n){return this._insert(new n2.de.component.field.tagPicker.tagPickerPopover.TagSelection({id:e,renderTo:this.SELECTORS.tagSelectionList,label:this._tagCollections.find(function(e){return e.value===t}).label,tagCollectionId:t,options:n}))}},{key:"_hasPropertyChanged",value:function(e,t){return"selection"===e?!n2.compare(this.selection,t):_get(_getPrototypeOf(i.prototype),"_hasPropertyChanged",this).apply(this,arguments)}},{key:"_hideOnWindowMouseDown",value:function(e){return _get(_getPrototypeOf(i.prototype),"_hideOnWindowMouseDown",this).apply(this,arguments)&&!this._tagCollectionFilterListBoxContains(e)}},{key:"_hideOnWindowScroll",value:function(e){return _get(_getPrototypeOf(i.prototype),"_hideOnWindowScroll",this).apply(this,arguments)&&!this._isTagCollectionFilterListBox(e)}},{key:"_isTagCollectionFilterListBox",value:function(e){return this.tagCollectionFilter.listBox.dom.find(".slds-listbox").rawDOM===e}},{key:"_tagCollectionFilterListBoxContains",value:function(e){return this.tagCollectionFilter.listBox.dom.rawDOM.contains(e)}},{key:"_applyVisibleIndexAttributes",value:function(){var t=0;this._tagSelectionComponents.forEach(function(e){e.hidden?e.dom.removeAttribute("data-visible-tag-selection-index"):(e.dom.attribute("data-visible-tag-selection-index",t),t++)})}}]),i}(),n2.de.component.field.userPicker.UserPickerPopover=function(){_inherits(s,n2.de.component.AbstractPopover);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters",userList:".n2_user-list"}),this.id="user-picker-popover",this._componentCls="".concat(this._componentCls," n2-de-user-picker-popover"),this._bodyTemplate='<div class="n2_popover-body">\n            <div class="n2_filters"></div>\n            <div class="n2_user-list"></div>\n        </div>',this._users=null,this._selection=null,this._max=null}},{key:"users",set:function(e){n2.compare(this._users,e)||(this._users=e,this.refresh({users:!0}))}},{key:"selection",get:function(){return this.usersDataTable.selection},set:function(e){n2.compare(this.selection,e)||(this._selection=e,this.refresh({selection:!0}))}},{key:"max",set:function(e){n2.compare(this._max,e)||(this._max=e,this.refresh({max:!0}))}},{key:"quickFilter",get:function(){return this._components["quick-filter"]}},{key:"usersDataTable",get:function(){return this._components.users}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertFilters(),this._insertCloseButton({renderTo:this.SELECTORS.filters}),this._insertUsersDataTable()}},{key:"_insertFilters",value:function(){return[this._insertQuickFilter()]}},{key:"_insertQuickFilter",value:function(){return this._insert(new n2.ui.component.field.TextBox(this._getQuickFilterConfig()))}},{key:"_getQuickFilterConfig",value:function(){return{id:"quick-filter",renderTo:this.SELECTORS.filters,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find users...",listeners:{type:this._onQuickFilterType,scope:this}}}},{key:"_onQuickFilterType",value:function(e){n2.isEmpty(e.value)?this.usersDataTable.removeFilters(["quick-filter"]):this.usersDataTable.addFilter("quick-filter",{dataBindings:["name"],value:e.value})}},{key:"_insertUsersDataTable",value:function(){return this._insert(new n2.de.component.DataTable({id:"users",renderTo:this.SELECTORS.userList,columns:[{header:{data:"Avatar",hidden:!0},cell:{cellTemplate:"",cls:"n2_avatar",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",cell:{cls:"n2_user-details",cellTemplate:"<h3>{{content.name}}</h3>"}}],emptyState:{heading:"You don't have any users yet"},selectable:this._isMultiSelect(),listeners:{selectionChange:this._onSelectionChange,click:this._onDataTableClick,scope:this}}))}},{key:"_onSelectionChange",value:function(e){e=this._createEvent(e.target,{data:n2.merge(e.data||{},{selection:this.usersDataTable.selection})}),this.fire("change",e),this._refreshMaxSelection()}},{key:"_onDataTableClick",value:function(e,t,n,i){t.disabled||(this._isMultiSelect()?t.select(!t.selected):this.fire("change",this._createEvent(this,{data:{selection:[t.data]},defaultMethod:this.hide})))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.users,t=void 0===t?[]:t,n=e.selection,n=void 0===n?[]:n,i=e.max,i=void 0===i?null:i;e.target,e.cls,e.listeners;this.quickFilter.value={value:"",silent:!0},this.usersDataTable.removeFilters(),this.usersDataTable.components["empty-state"].hidden=!n2.isEmpty(t),this.users=t,this.selection=n,_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this.max=i,n2.isEmpty(t)?this.element("filters").hide():this.element("filters").show()}},{key:"refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"refresh",this).apply(this,arguments),e.users),t=void 0!==t&&t,n=e.selection,n=void 0!==n&&n,i=e.max,i=void 0!==i&&i,e=n2.isEmpty(e);(t||e)&&this._refreshUsers(),(n||e)&&this._refreshSelection(),(i||e)&&this._refreshDataTableSelectableState()}},{key:"_refreshUsers",value:function(){var e=n2.clone(this._users);n2.sort(e,{property:"nameSort"}),this.usersDataTable.data=e}},{key:"_refreshSelection",value:function(){var t=this;this.usersDataTable.forEachRow(function(e){return e.select(t._selection.includes(e.data.id))})}},{key:"_refreshDataTableSelectableState",value:function(){this.usersDataTable.selectable=this._isMultiSelect()}},{key:"_refreshMaxSelection",value:function(){this._isMaxReached()?this._disableUnselectedRows():this.usersDataTable.disabled=!1}},{key:"_disableUnselectedRows",value:function(){this.usersDataTable.forEachRow(function(e){e.disabled=!e.selected})}},{key:"_isMaxReached",value:function(){return!n2.isNull(this._max)&&this.usersDataTable.selection.length>=this._max}},{key:"_isMultiSelect",value:function(){return n2.isNull(this._max)||1<this._max}}]),s}(),n2.de.component.field.teamMemberPicker.TeamMemberPickerPopover=function(){_inherits(t,n2.de.component.field.userPicker.UserPickerPopover);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.id="team-member-picker-popover",this._componentCls="".concat(this._componentCls," n2-de-team-member-picker-popover")}},{key:"teamFilter",get:function(){return this._components["team-filter"]}},{key:"_insertFilters",value:function(){return[this._insertTeamFilter()].concat(_get(_getPrototypeOf(t.prototype),"_insertFilters",this).apply(this,arguments))}},{key:"_getQuickFilterConfig",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getQuickFilterConfig",this).apply(this,arguments),{placeholder:"Find team members..."})}},{key:"_insertTeamFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"team-filter",renderTo:this.SELECTORS.filters,cls:"n2_team-filter",label:{text:"Team filter",hidden:!0},placeholder:"All teams",options:[],listeners:{change:this._onTeamFilterChange,scope:this}}))}},{key:"_onTeamFilterChange",value:function(t){n2.isEmpty(t.value)?this.usersDataTable.removeFilters(["team-filter"]):this.usersDataTable.addFilter("team-filter",{fcn:function(e){e=e.data.teams.find(function(e){return e.name===t.value});return!n2.isUndefined(e)}})}},{key:"_insertUsersDataTable",value:function(){return this._insert(new n2.de.component.DataTable({id:"users",renderTo:this.SELECTORS.userList,columns:[{header:"Team Member",cls:"n2_avatar-column",cell:{cellTemplate:"",cls:"n2_avatar",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:{data:"Name",hidden:!0},cell:{cls:"n2_team-member-details",cellTemplate:"<h3>{{content.name}}</h3><p>{{content.teams}}</p>",dataAdapter:function(e){return{name:e.name,teams:e.teams.map(function(e){return e.name}).sort().join(", ")}}}}],emptyState:{heading:"You don't have any team members yet"},selectable:this._isMultiSelect(),listeners:{selectionChange:this._onSelectionChange,click:this._onDataTableClick,scope:this}}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.users,e.selection,e.max,e.target,e.cls,e.listeners;this.teamFilter.clear({silent:!0}),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments)}},{key:"_refreshUsers",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshUsers",this).apply(this,arguments),this._refreshTeamFilterOptions()}},{key:"_refreshTeamFilterOptions",value:function(){this.teamFilter.options=this._users.map(function(e){return e.teams}).flat().map(function(e){return e.name}).sort().filter(function(e,t,n){return 0===t||e!==n[t-1]})}},{key:"_hideOnWindowMouseDown",value:function(e){return _get(_getPrototypeOf(t.prototype),"_hideOnWindowMouseDown",this).apply(this,arguments)&&!this._teamFilterListBoxContains(e)}},{key:"_hideOnWindowScroll",value:function(e){return _get(_getPrototypeOf(t.prototype),"_hideOnWindowScroll",this).apply(this,arguments)&&!this._isTeamFilterListBox(e)}},{key:"_isTeamFilterListBox",value:function(e){return this.teamFilter.listBox.dom.find(".slds-listbox").rawDOM===e}},{key:"_teamFilterListBoxContains",value:function(e){return this.teamFilter.listBox.dom.rawDOM.contains(e)}}]),t}(),n2.de.component.field.userOrQueueField.TextBoxButton=function(){_inherits(n,n2.ui.component.field.TextBox);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e,t){}}),this._icon=n2.ui.enum.Icon.EDIT,this.readOnly=!0}},{key:"_prepareDOM",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_prepareDOM",this).call(this),this.dom.listen("click",function(e){t.fire("click",t,e)})}},{key:"_onBlur",value:function(){}}]),n}(),n2.de.component.form.updateFields.Cell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.objectName=null,this.isPersonAccounts=null,this._fieldIndex=null,this._fieldsToHide=[]}},{key:"fieldIndex",set:function(e){e!==this._fieldIndex&&(this._fieldIndex=e,null!=this._editField)&&(this._editField.fieldIndex=this._fieldIndex)}},{key:"fieldsToHide",set:function(e){n2.compare(e,this._fieldsToHide)||(this._fieldsToHide=e,null!=this._editField&&(this._editField.fieldsToHide=this._fieldsToHide))}},{key:"_createEditField",value:function(e){return new n2.de.component.form.UpdateField({id:"update-field",objectName:this.objectName,isPersonAccounts:this.isPersonAccounts,fieldIndex:this._fieldIndex,fieldsToHide:this._fieldsToHide})}}]),t}(),n2.de.component.form.updateFields.DataTable=function(){_inherits(n,n2.ui.component.EditableDataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._rowClass=n2.de.component.form.updateFields.Row,this.objectName=null,this.isPersonAccounts=null,this._fieldsToHide=[]}},{key:"_applyRowIndexAttributes",value:function(){_get(_getPrototypeOf(n.prototype),"_applyRowIndexAttributes",this).call(this);var t=1;this.data.length<=1&&(t=null),this.forEachRow(function(e){null!=(e.fieldIndex=t)&&t++})}},{key:"fieldsToHide",set:function(e){var t=this;n2.compare(e,this._fieldsToHide)||(this._fieldsToHide=e,this.forEachRow(function(e){e.fieldsToHide=t._fieldsToHide}))}}]),n}(),n2.de.component.form.updateFields.Row=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._fieldIndex=null,this._fieldsToHide=[]}},{key:"fieldIndex",set:function(e){var t=this;e!==this._fieldIndex&&(this._fieldIndex=e,this.forEachCell(function(e){e.fieldIndex=t._fieldIndex}))}},{key:"fieldsToHide",set:function(e){var t=this;n2.compare(e,this._fieldsToHide)||(this._fieldsToHide=e,this.forEachCell(function(e){e.fieldsToHide=t._fieldsToHide}))}}]),t}(),n2.de.component.form.updateFields.Combo=function(){_inherits(i,n2.ui.component.field.Combo);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this._optionValuesToHide=[]}},{key:"optionValuesToHide",set:function(e){n2.compare(e,this._optionValuesToHide)||(this._optionValuesToHide=e,this._refreshOptions())}},{key:"_refreshOptions",value:function(){var t,n=this;n2.isEmpty(this._optionValuesToHide)||n2.isEmpty(this._options)?_get(_getPrototypeOf(i.prototype),"_refreshOptions",this).call(this):(t=this.value,this.listBox.options=this._options.filter(function(e){e=e.value,e=void 0===e?null:e;return null==e||e===t||!n._optionValuesToHide.includes(e)}))}}]),i}(),n2.de.component.form.updateFields.UpdateFields=function(){_inherits(s,n2.de.component.form.FieldGroup);var n,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Update Fields",this._toggleActive=!0,this._helpText="Updates chosen fields with new values"}},{key:"_refreshFieldsDataTable",value:function(){var t=this;return n2.isUndefined(this._components["fields-to-update"])||this._components["fields-to-update"].destroy(),this._insert(new n2.de.component.form.updateFields.UpdateFieldsDataTable({id:"fields-to-update",mixins:[n2.mixin.DataDriven],hidden:!0,value:{bindPath:".fieldUpdateConfig",defaultValue:{fields:[]}},model:this._createFieldsModel(),objectName:this._model.get("objectName"),isPersonAccounts:this._model.get("isPersonAccounts"),fieldsToHide:this._collectAllFieldNames(),listeners:{change:function(e){e.fieldsToHide=t._collectAllFieldNames()}}}))}},{key:"_refreshFieldVisibility",value:function(){var e=this._model.get("isEnabled");this._components["fields-to-update"].hidden=!e}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&(this._model=t,this._refreshFieldsDataTable(),this._components["toggle-active"].value={silent:!0,value:t.get("isEnabled")},this._refreshFieldVisibility());case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_createFieldsModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("fieldUpdateEnabled"),{key:"isEnabled"}),e.insert(this._model.getProperty("fieldUpdateConfig",{defaultValue:{fields:[]}}),{key:"fieldUpdateConfig"}),e}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("isEnabled").value=e.isChecked(),e.isChecked()&&this._components["fields-to-update"].clearInvalid(),this._refreshFieldVisibility()}},{key:"_collectAllFieldNames",value:function(){var e=this._model.get("fieldUpdateConfig");if(e&&e.fields)return e.fields.map(function(e){return e.name})}}]),s}(),n2.de.component.form.updateFields.UpdateFieldsDataTable=function(){_inherits(t,n2.de.component.field.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-update-fields",this._newRowData={type:n2.dataProvider.Model,value:{}},this._min=1,this._max=3,this.required=!1,this.label={hidden:!0},this._addRowButtonConfig={text:"Add another field"},this._dataTableClass=n2.de.component.form.updateFields.DataTable,this.objectName=null,this.isPersonAccounts=null,this._fieldsToHide=[]}},{key:"fieldsToHide",set:function(e){n2.compare(e,this._fieldsToHide)||(this._fieldsToHide=e,this.dataTable&&(this.dataTable.fieldsToHide=this._fieldsToHide))}},{key:"dataTable",get:function(){return this._components["data-table"]}},{key:"_getDataTableConfig",value:function(){var e=_get(_getPrototypeOf(t.prototype),"_getDataTableConfig",this).apply(this,arguments);return this._isDataDriven()||(e=n2.merge(e,{data:this._value.fields||[]})),n2.merge(e,{columns:[{header:"",bindPath:".",cell:{type:n2.de.component.form.updateFields.Cell,cellTemplate:"",objectName:this.objectName,isPersonAccounts:this.isPersonAccounts,fieldsToHide:this._fieldsToHide}}],objectName:this.objectName,isPersonAccounts:this.isPersonAccounts,fieldsToHide:this._fieldsToHide,hideHeaderRow:!0,cls:"slds-no-row-hover"})}},{key:"_getDataTableDataDrivenConfig",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getDataTableDataDrivenConfig",this).apply(this,arguments),{data:{bindPath:".fields",defaultValue:[]}})}}]),t}(),n2.de.component.tags.modifyTagAssignments.AbstractToolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"tagCollectionsFilterId",get:function(){return"collections-filter"}},{key:"tagCollectionFilterConfig",get:function(){return{id:this.tagCollectionsFilterId,cls:"n2_collections-filter slds-m-right_small",multiple:!0,options:[],renderTo:this.SELECTORS.left,listeners:{change:this._handleFilter,scope:this}}}},{key:"TagCollectionFilterClass",get:function(){return n2.ui.component.field.Combo}},{key:"collectionsFilter",get:function(){return this._components[this.tagCollectionsFilterId]}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Quick filter"}),this._insertCollectionsFilter()}},{key:"_insertCollectionsFilter",value:function(){return this.insert(new this.TagCollectionFilterClass(this.tagCollectionFilterConfig))}},{key:"clear",value:function(){this.collectionsFilter.clear(),this.quickFilter.clear()}},{key:"reset",value:function(){this.collectionsFilter.value={silent:!0,value:[]},this.quickFilter.value={silent:!0,value:""}}}]),t}(),n2.de.component.tags.modifyTagAssignments.Checkbox=function(){_inherits(n,n2.ui.component.field.Checkbox);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._template='<div class="slds-form-element n2-component{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}" id="{{id}}"{{#title}} title="{{title}}"{{/title}}{{#visibleIndex}} data-visible-checkbox-index="{{visibleIndex}}"{{/visibleIndex}}>\n            <div class="slds-form-element__control {{iconContainerCls}}">\n                {{#fieldLabel}}<span class="slds-form-element__label">{{fieldLabel}}</span>{{/fieldLabel}}\n                    <span class="slds-checkbox">\n                        {{> fieldTemplate}}\n                        {{> labelTemplate}}\n                        {{> helpIconTemplate}}\n                    </span>\n                {{> errorTemplate}}\n            </div>\n        </div>',this.index=null,this.visibleIndex=null,this.isDirty=!1}},{key:"_applyConfig",value:function(e){n2.isNull(this._convertTernaryValue(e.value))&&(this._isIndeterminateValue=!0),_get(_getPrototypeOf(n.prototype),"_applyConfig",this).call(this,e)}},{key:"_onDefined",value:function(){this._value=this._convertTernaryValue(this._value),_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_setDomId",value:function(){this.domId="".concat(this.parent.domId,"_tag-assignment-checkbox-").concat(this.index),_get(_getPrototypeOf(n.prototype),"_setDomId",this).apply(this,arguments)}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{visibleIndex:this.visibleIndex})}},{key:"_onChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,e=e.sync,e=void 0===e||e;_get(_getPrototypeOf(n.prototype),"_onChange",this).call(this,{silent:t,sync:e}),t||(this.isDirty=!0)}},{key:"_setRawValue",value:function(e){e=this._convertTernaryValue(e);_get(_getPrototypeOf(n.prototype),"_setRawValue",this).call(this,e)}},{key:"_convertTernaryValue",value:function(e){if(!n2.isString(e))return e;var t=n2.de.component.tags.modifyTagAssignments.TernaryEnum;switch(e){case t.ALL:return!0;case t.SOME:return null;case t.NONE:return!1}}}]),n}(),n2.de.component.tags.modifyTagAssignments.EmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS||{},{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="There are no tags that match your filters",this._content="",this._hidden=!0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertClearFiltersButton()}},{key:"clearFiltersButton",get:function(){return this.components["clear-filters-button"]}},{key:"_insertClearFiltersButton",value:function(){return this._insert(new n2.ui.component.Button({id:"clear-filters-button",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._handleClick,scope:this}}))}},{key:"_handleClick",value:function(e){this.fire("click",this._createEvent(e))}}]),t}(),n2.de.component.tags.modifyTagAssignments.FieldGroup=function(){_inherits(t,n2.de.component.form.FieldGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.index=null,this._headingTemplate="{{#heading}}<h3>{{heading}}</h3>{{/heading}}"}},{key:"_setDomId",value:function(){this.domId="".concat(this.parent.domId,"_collection-field-group-").concat(this.index),_get(_getPrototypeOf(t.prototype),"_setDomId",this).apply(this,arguments)}}]),t}(),n2.de.component.tags.modifyTagAssignments.Form=function(){_inherits(t,n2.de.component.Form);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["saveDataProviderId"]),this._componentCls="n2-form n2-de-form n2-modify-assignments-form",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._context=null,this._collectionData=null,this.saveDataProviderId=null,this.userIds=null,this._hasInsertedComponents=!1,this._fieldGroupPrefix="n2_field-group-",this._checkboxPrefix="n2_checkbox-",this.isFiltering=!1,this._maxUpdates=0,this._updateCount=0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this.dataProviders=[this.saveDataProviderId]}},{key:"context",set:function(e){this._context=e}},{key:"updateFrequency",get:function(){return 250}},{key:"collectionData",set:function(e){this._collectionData=e,this._upsertData()}},{key:"_getFieldGroupId",value:function(e){return"".concat(this._fieldGroupPrefix).concat(e)}},{key:"_getCheckboxId",value:function(e){return"".concat(this._checkboxPrefix).concat(e)}},{key:"_getTagIdFromCheckbox",value:function(e){return e.id.replace(this._checkboxPrefix,"")}},{key:"_getFieldGroup",value:function(e){return this._components[this._getFieldGroupId(e)]}},{key:"_getCheckbox",value:function(e,t){return e.components[this._getCheckboxId(t)]}},{key:"reset",value:function(){this._context.isDirty||this._hideFooter()}},{key:"getTagSelectionDifferences",value:function(){var t=this,n=[];return this._forEachCheckbox(function(e){e.isDirty&&n.push({tagId:t._getTagIdFromCheckbox(e),selected:e.value})}),n}},{key:"getSelectedTags",value:function(){var t=this,n=[];return this._forEachCheckbox(function(e){e.value&&n.push(t._getTagIdFromCheckbox(e))}),n}},{key:"_insertFormElements",value:function(){var n=this;return this._collectionData.map(function(e,t){return n._insertFieldGroup(e,t)})}},{key:"_insertFieldGroup",value:function(e,t){var n=e.name,i=e.id,s=e.hidden,e=e.tagAssignments,i=this._insert(new n2.de.component.tags.modifyTagAssignments.FieldGroup({id:this._getFieldGroupId(i),cls:"n2_content",index:t,heading:n,hidden:!0===s}));return this._insertCheckboxes(i,e),i}},{key:"_insertCheckboxes",value:function(i,e){var s=this,a=0;return e.map(function(e,t){var n=!0===e.hidden;return i.insert(new n2.de.component.tags.modifyTagAssignments.Checkbox({id:s._getCheckboxId(e.tagId),index:t,visibleIndex:n?null:a.toString(),label:e.tagName,hidden:n,value:e.selectedState,listeners:{change:s._onCheckboxChange,scope:s}})),n||(a+=1),i})}},{key:"_onCheckboxChange",value:function(){this._context.isDirty=!0,this._updateCount+=this.userIds.length,this._updateCount>this._maxUpdates&&(this._maxUpdates=this._updateCount+this.updateFrequency,n2.ui.component.Toast.getInstance().show({message:"Please save frequently to avoid losing your changes.",theme:n2.ui.enum.Theme.INFO,delay:5e3}))}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(t.prototype),"_onSubmit",this).apply(this,arguments),this._postDataProvider(this.saveDataProviderId,{params:[this.userIds,this.getTagSelectionDifferences()]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(t.prototype),"_onSaved",this).call(this),this._context.isDirty=!1}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(t.prototype),"_onCancel",this).call(this),this._context.isDirty=!1}},{key:"_forEachCheckbox",value:function(t){var n=this;this.forEach({type:n2.de.component.tags.modifyTagAssignments.FieldGroup,fcn:function(e){e.forEach({type:n2.de.component.tags.modifyTagAssignments.Checkbox,fcn:function(e){t.call(n,e)}})}})}},{key:"_upsertData",value:function(){var e,t=null;return this._resetSelectionValues(),this._hasInsertedComponents||(e=this._insertFormElements(),this._hasInsertedComponents=!0,t=e),this._refreshFormElements(),this._highlightCheckbox(this._context.selectedTagData),t}},{key:"_resetSelectionValues",value:function(){this._updateCount=0,this._maxUpdates=4e3}},{key:"_refreshFormElements",value:function(){var t=this;this._collectionData.forEach(function(e){t._refreshFieldGroup(e)})}},{key:"_refreshFieldGroup",value:function(e){var t=e.id,n=e.hidden,e=e.tagAssignments,t=this._getFieldGroup(t);t.hidden=!0===n,this._refreshCheckboxes(t,e)}},{key:"_refreshCheckboxes",value:function(i,e){var s=this,a=0;e.forEach(function(e){var t=e.tagId,n=e.selectedState,e=e.hidden,t=s._getCheckbox(i,t);a=s._refreshCheckboxVisibleState(t,!0===e,a),s._updateCheckboxValue(t,n)})}},{key:"_refreshCheckboxVisibleState",value:function(e,t,n){return(e.hidden=t)?(e.dom.removeAttribute("data-visible-checkbox-index"),e.visibleIndex=null,n):(e.dom.attribute("data-visible-checkbox-index",n),(e.visibleIndex=n)+1)}},{key:"_updateCheckboxValue",value:function(e,t){this.isFiltering||(e.isDirty=!1,e.value={value:t,silent:!0})}},{key:"_highlightCheckbox",value:function(e){var t,n;n2.isNull(e)?this._dom.find(".slds-form-element").attribute("scrollTop",0):(t=(e=_slicedToArray(e.split("_"),2))[0],e=e[1],t=this._getFieldGroup(t),(n=this._getCheckbox(t,e)).focus(),n.dom.addClass("n2_active"),new n2.util.DelayedTask(function(){n.dom.removeClass("n2_active")},1e3).start(),this._context.selectedTagData=null)}}]),t}(),n2.de.component.tags.modifyTagAssignments.TernaryEnum={ALL:"All",SOME:"Some",NONE:"None"},n2.de.component.team.summary.MethodSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{methodIcon:".n2_method-icon",method:".n2_method",object:".n2_object"}),this._mixins=[n2.mixin.DataDriven],this._componentCls="n2-de-method-summary",this._contentTemplate='<p><div class="slds-media slds-media_center slds-has-flexi-truncate"><div class="slds-media__figure n2_method-icon">{{{methodIcon}}}</div><div class="slds-media__body n2_method">{{method}}{{#object}} ({{object}}){{/object}}</div></div></p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertComponents()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{method:this._model.method,methodIcon:n2.de.Icon.getMethodIcon(this._model.method),object:this._getObjectValue()})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{fieldTemplate:this._fieldTemplate})}},{key:"_getObjectValue",value:function(){return this._isMethodType("LOOKUP OWNER")?this._model.lookupOwnerDetails.lookupObject:this._isMethodType("RELATED OWNER")?this._model.relatedOwnerObject:null}},{key:"_insertComponents",value:function(){this._insertFieldSummary()}},{key:"_insertFieldSummary",value:function(){var e=this._getFieldData();this._insert(new n2.de.component.summary.FiltersSummary({id:"field-summary",filters:e}))}},{key:"_getFieldData",value:function(){var e=[];return this._isMethodType("LOOKUP OWNER")?(e.push({name:"Assign to",val:this._model.lookupOwnerDetails.assignToFieldLabel}),this._model.lookupOwnerDetails.hasFilter&&e.push(n2.merge(this._model.lookupOwnerDetails.filter,{label:"Where"}))):this._isMethodType("DYNAMIC OWNER")?e.push({name:"Formula",val:this._model.dynamicOwnerFormula}):this._isMethodType("LOAD BALANCING")?e.push({name:"Level",val:this._model.loadBalancingLevel}):this._isMethodType("MANUAL ASSIGNMENT")&&e.push({name:"Treat as rejection",val:this._model.isTreatManualAssignmentAsRejection?"TRUE":"FALSE"}),this._model.isSticky&&(e.push({name:"Sticky Field",val:this._model.stickyField}),e.push({name:"Sticky Level",val:this._model.stickyLevel})),e}},{key:"_getFilterData",value:function(){var e=[];return this._isMethodType("LOOKUP OWNER")&&this._model.lookupOwnerDetails.hasFilter&&e.push(n2.merge(this._model.lookupOwnerDetails.filter,{label:"Where",cls:"slds-m-top_small"})),e}},{key:"_isMethodType",value:function(e){return!n2.isNull(this._model.method)&&this._model.method.toUpperCase()===e.toUpperCase()}}]),t}(),n2.de.component.team.summary.ExtendedMethodSummary=function(){_inherits(t,n2.de.component.team.summary.MethodSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getObjectValue",value:function(){return this._isMethodType("RELATED OWNER")?null:_get(_getPrototypeOf(t.prototype),"_getObjectValue",this).call(this)}},{key:"_getFieldData",value:function(){var e,n=[];return this._isMethodType("ROUND ROBIN")?n.push({name:"Weighting",val:this._getEnabledDisabledText(this._model.weightingEnabled)}):this._isMethodType("LOAD BALANCING")?(n.push({name:"Weighting",val:this._getEnabledDisabledText(this._model.weightingEnabled)}),n.push({name:"Duration",val:this._model.teamLoadBalancingDuration})):this._isMethodType("DYNAMIC OWNER")?n.push({name:"Default owner",op:this._model.defaultOwnerDetails.defaultOwnerType,val:this._model.defaultOwnerDetails.defaultOwnerName}):this._isMethodType("LOOKUP OWNER")?(n2.forEach(this._model.lookupOwnerDetails.lookupFields,function(e,t){n.push({label:"0"===t?"Field":"Or",name:e.uniqueIdField,op:"equals",val:e.matchField})}),n[n.length-1].cls="slds-m-bottom_small"):this._isMethodType("RELATED OWNER")&&(e=this._model.relatedOwnerDetails,n.push({name:"Assign using",val:"".concat(e.relatedOwnerObject1,".").concat(e.relatedOwnerField1)}),n2.isUndefined(e.relatedOwnerObject2)||n.push({name:"Otherwise use",val:"".concat(e.relatedOwnerObject2,".").concat(e.relatedOwnerField2)})),n=n2.merge(n,_get(_getPrototypeOf(t.prototype),"_getFieldData",this).call(this)),this._model.isSticky&&(n[n.length-2].cls="slds-m-top_small",n.push({name:"Sticky Period",val:this._model.stickyPeriod}),n.push({name:"Retain when unavailable",val:this._getEnabledDisabledText(this._model.retainStickyOnOutOfOffice),cls:"slds-m-top_small"}),this._model.userTogglesEnabled)&&n.push({name:"Retain when toggled off",val:this._getEnabledDisabledText(this._model.retainStickyOnWidgetOff)}),this._isMethodType("PULL")||this._isMethodType("MANUAL ASSIGNMENT")||this._isMethodType("CURRENT OWNER")||(n.push({name:"Assign when unavailable",val:this._getEnabledDisabledText(this._model.assignOnOutOfOffice),cls:"slds-m-top_small"}),this._model.userTogglesEnabled&&n.push({name:"Assign when toggled off",val:this._getEnabledDisabledText(this._model.assignOnWidgetOff)})),n}},{key:"_getEnabledDisabledText",value:function(e){return e?"Enabled":"Disabled"}}]),t}(),n2.de.component.team.summary.SourceSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{sourceType:".n2_sourceType",sourceName:".n2_sourceName"}),this._componentCls="n2-de-source-summary",this._contentTemplate='<p><div class="slds-media slds-media_center slds-has-flexi-truncate"><div class="slds-media__body"><span class="n2_sourceType n2_filter-label slds-p-right-xx_small">{{sourceType}}</span> <span class="n2_sourceName">{{sourceName}}</span></div></div></p>',this._sourceType=null,this._sourceName=null}},{key:"sourceType",set:function(e){this._sourceType!==e&&(this._sourceType=e,this._refreshSource())}},{key:"sourceName",set:function(e){this._sourceName!==e&&(this._sourceName=e,this._refreshSource())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshSource()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{sourceType:this._sourceType,sourceName:this._sourceName})}},{key:"_refreshSource",value:function(){this._rendered&&(this.element("sourceType").clear(),this.element("sourceName").clear(),this.element("sourceType").text(this._sourceType),this.element("sourceName").text(this._sourceName))}}]),t}(),n2.de.component.team.summary.TagFiltersSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters"}),this._componentCls="n2-de-tag-filters-summary",this._contentTemplate='<div class="n2_filters"></div>',this._filters=[]}},{key:"filters",set:function(e){n2.compare(this._filters,e||[])||(this._filters=e,this._refreshFilters())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshFilters()}},{key:"_refreshFilters",value:function(){n2.isEmpty(this._components)||this.destroyComponents(),n2.isEmpty(this._filters)||this._insertTagFilters()}},{key:"_insertTagFilters",value:function(){var n=this;this._filters.forEach(function(e,t){n._insert(new n2.de.component.summary.FilterSummary({id:"tag-filter-".concat(t),cls:"slds-m-top_xx-small",renderTo:n.SELECTORS.filters,filter:n._getFilterConfig(e)}))})}},{key:"_getFilterConfig",value:function(e){return"Territory"===e.type?{label:"By Territory"}:{label:e.type,name:e.categoryName,op:e.operator,val:"Static"===e.type?e.tagValues:e.fieldLabel}}}]),t}(),n2.de.page.team.teamList.apv.UserListSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{users:".n2_users"}),this._componentCls="n2-de-user-list-summary",this._contentTemplate='<div class="n2_users slds-m-top_xx-small"></div>',this._users=[]}},{key:"users",set:function(e){this._users!==e&&(this._users=e,this._refreshUsers())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshUsers()}},{key:"_refreshUsers",value:function(){var n=this;this._rendered&&this.destroyComponents(),n2.forEach(this._users,function(e,t){n.insert(new n2.ui.component.HTML({id:"user-".concat(t),renderTo:n.SELECTORS.users,mixins:[n2.mixin.DataDriven],template:'<div id="{{id}}" class="n2_user slds-m-right_xx-small slds-m-bottom_xx-small">\n                    <span class="slds-m-left_x-small">{{model}}</span>\n                </div>',model:e.name,components:[new n2.ui.component.Avatar({id:"user-avatar",renderTo:{position:"afterBegin"},avatar:e.avatarUrl,displayName:e.name})]}))})}}]),t}(),n2.de.page.analytics.distribution.Chart=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=[n2.mixin.Observable],this.SELECTORS=n2.merge(this.SELECTORS,{distributionChart:".n2_distribution-chart",activityChart:".n2_activity-chart"}),this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2_distribution-chart"></div>\n            <div class="n2_activity-chart visavail slds-hide" id="n2_activity">\n                <div id="n2_activity-chart"></div>\n            </div>\n        </div>',this._componentCls="n2-de-analytics-chart",this._cls="c3",this._distributionChart=null,this._activityChart=null,this._distributionData=null,this._distributionDays=null,this._activityData=null,this._xAxisType=null,this._chartType=null,this._showBackButton=!1,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["chart"],distributionData:["distributionChart"],activityData:["activityChart"],xAxisType:["chartConfig"],chartType:["chartType"]})}},{key:"distributionData",set:function(e){this._setProperty("distributionData",e)}},{key:"distributionDays",set:function(e){this._setProperty("distributionDays",e)}},{key:"activityData",set:function(e){this._setProperty("activityData",e)}},{key:"xAxisType",set:function(e){this._setProperty("xAxisType",e)}},{key:"chartType",set:function(e){this._setProperty("chartType",e)}},{key:"backButton",get:function(){return this._components["back-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertBackButton()}},{key:"_insertBackButton",value:function(){return this._insert(new n2.ui.component.Button({id:"back-button",icon:n2.ui.enum.Icon.CLOSE,title:"Back",hidden:!0,cls:"slds-button_icon-border-filled n2_back-button",listeners:{click:this._handleBack,scope:this}}))}},{key:"_handleBack",value:function(){var e=this._createEvent(this.backButton);this.fire(n2.event.EventType.CLICK,e)}},{key:"_handleDrillDown",value:function(e){this._showBackButton=!0;e=this._getStartOfDay(this._distributionDays[e.index]),e=this._createEvent(this._distributionChart,{data:{dateLiteral:"",startDate:e.getTime(),endDate:this._getEndOfDay(e).getTime()}});this.fire(n2.event.EventType.CLICK,e)}},{key:"_getActivityConfig",value:function(){return{custom_categories:!0,id_div_container:"n2_activity",id_div_graph:"n2_activity-chart",custom_time_format:{format_hour:"%-I%p",format_minute:"%-I:%M%p"},sub_title:{enabled:!1},title:{enabled:!1},tooltip:{date_plus_time:!0,position:"overlay"},height:document.documentElement.clientHeight-350,width:1024}}},{key:"_getDistributionConfig",value:function(){var e=250;return n2.ui.SalesforcePage.isClassic()&&(e=380),{bindto:this.element("distributionChart").rawDOM,axis:{x:{type:"category",label:{position:"outer-center",text:"Date"},tick:{centered:!0,culling:!0,multiline:!1,rotate:-45}},y:{label:{text:"Records distributed",position:"outer-middle"}}},data:{columns:[],type:"area",x:"xLabels",onclick:function(e){"Days"===this._xAxisType&&this._handleDrillDown(e)}.bind(this)},grid:{y:{show:!0}},legend:{position:"right"},point:{r:4},size:{height:document.documentElement.clientHeight-e,width:1024},transition:{duration:1e3}}}},{key:"_getStartOfDay",value:function(e){e=new Date(e);return e.setUTCHours(0,0,0,0),e}},{key:"_getEndOfDay",value:function(e){return e.setUTCHours(23,59,59,0),e}},{key:"_refreshChartConfig",value:function(){n2.isNull(this._distributionChart)||this._distributionChart.axis.labels({x:"".concat(this._xAxisType," (").concat(n2.de.ApplicationContext.getInstance().timeZone,")")})}},{key:"_refreshChartType",value:function(){"distribution"===this._chartType?(this.element("activityChart").hide(),this.element("distributionChart").show()):(this.element("activityChart").show(),this.element("distributionChart").hide())}},{key:"_refreshDistributionChart",value:function(){n2.isNull(this._distributionChart)&&(this._distributionChart=c3.generate(this._getDistributionConfig()),this._distributionChart.axis.labels({x:"".concat(this._xAxisType," (").concat(n2.de.ApplicationContext.getInstance().timeZone,")")})),this._distributionChart.load({unload:!0,columns:this._distributionData}),this.backButton.hidden=!this._showBackButton,this._showBackButton=!1}},{key:"_refreshActivityChart",value:function(){n2.isNull(this._activityChart)?this._activityChart=visavail.generate(this._getActivityConfig(),this._activityData):this._activityChart.updateGraph(this._getActivityConfig(),this._activityData)}}]),t}(),n2.de.page.analytics.distribution.Combo=function(){_inherits(t,n2.de.component.field.MaxSelectMultipleCombo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-selection-combo",this._showClear=!0,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["clear"],showClear:["clear"]})}},{key:"showClear",set:function(e){this._setProperty("showClear",e,{sync:!1})}},{key:"clearButton",get:function(){return this._components["clear-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertClearButton()}},{key:"_insertClearButton",value:function(){var e=this;return this._insert(new n2.ui.component.Button({id:"clear-button",icon:n2.ui.enum.Icon.CLEAR,renderTo:{target:this.SELECTORS.field,position:"afterend"},title:"Clear",cls:"slds-input__icon slds-input__icon_right slds-button slds-button_icon n2_clear-combo",listeners:{click:function(){return e.clear()}}}))}},{key:"autoSelect",value:function(n){this.listBox.forEachOption(function(e,t){t<=n&&e.select(!0)})}},{key:"destroyPlaceholderOption",value:function(){var t=this;this.listBox.forEachOption(function(e){e.placeholder&&(t.listBox.remove(e),e.destroy())},{includePlaceholder:!0})}},{key:"_refreshClear",value:function(){this.clearButton.hidden=!this._showClear}}]),t}(),n2.de.page.analytics.distribution.SelectionToolbar=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._componentCls="n2-de-analytics-selection-toolbar",this.SELECTORS=n2.merge(this.SELECTORS,{primaryRow:".n2_primary-row",secondaryRow:".n2_secondary-row",message:".n2_toolbar-message"}),this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2_toolbar-container">\n                <div class="n2_left">\n                    <div class="n2_filters n2_primary-row"></div>\n                    <div class="n2_filters n2_secondary-row"></div>\n                </div>\n                <div class="n2_right"></div>\n            </div>\n            <div class="n2_toolbar-message"></div>\n        </div>',this._messageTemplate="{{#filterMessage}}<p>{{{filterIcon}}}{{filterMessage}}</p>{{/filterMessage}}\n            {{#durationMessage}}<p>{{{durationIcon}}}{{durationMessage}}</p>{{/durationMessage}}",this.hidden=!0,this._teamOptions=null,this._distributorsMap=null,this._trackedActionsMap=null,this._teamMemberUsersMap=null,this._chartConfig=null,this._chartSetupMap=null,this._message=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["teamCombo","dateRange","dataTypeCombo","actionValueCombo","distributorCombo","teamMemberCombo"],chartConfig:["initialValues","teamCombo","chartTypeCombo","durationCombo","dateRange","dataTypeCombo","actionValueCombo"],distributorsMap:["distributorCombo"],message:["message"],teamOptions:["teamCombo"],teamMemberUsersMap:["teamMemberCombo"],trackedActionsMap:["teamCombo","actionValueCombo"]})}},{key:"chartTypeCombo",get:function(){return this.components["chart-type-combo"]}},{key:"teamCombo",get:function(){return this.components["team-combo"]}},{key:"dataTypeCombo",get:function(){return this.components["data-type-combo"]}},{key:"actionValueCombo",get:function(){return this.components["action-value-combo"]}},{key:"distributorCombo",get:function(){return this.components["distributor-combo"]}},{key:"teamMemberCombo",get:function(){return this.components["team-member-combo"]}},{key:"durationCombo",get:function(){return this.components["duration-combo"]}},{key:"dateRangePicker",get:function(){return this.components["date-range-picker"]}},{key:"chartOptions",get:function(){var e=this._getFilterMessage(),t=this._getDurationMessage();return this._setProperty("message",{filterMessage:e,durationMessage:t}),""!==e?null:(e=(t=this.dateRangePicker.value).startDate,t=t.endDate,{actionValue:"time-to-action"!==this.chartTypeCombo.value?null:this.actionValueCombo.value,chartConfig:{chartType:this.chartTypeCombo.value,dateLiteral:this.durationCombo.value,startDate:n2.isNull(e)?null:e.getTime(),endDate:n2.isNull(t)?null:this._getEndOfDay(t),splitBy:this.dataTypeCombo.value,teamId:this.teamCombo.value},teamMemberUserIds:this.teamMemberCombo.value,distributorIds:this.distributorCombo.value})}},{key:"filterOptions",set:function(e){0===e.teams.length||n2.isEmpty(e.distributorsMap)?this.hidden=!0:(this.hidden=!1,this._setProperties({chartConfig:e.chartConfig,teamOptions:e.teams,distributorsMap:e.distributorsMap,teamMemberUsersMap:e.teamMemberUsersMap,trackedActionsMap:e.trackedActionsMap,chartSetupMap:e.chartSetupMap}))}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertTeamCombo(),this._insertChartTypeCombo(),this._insertDataTypeCombo(),this._insertActionValueCombo(),this._insertDurationCombo(),this._insertDateRangePicker(),this._insertTeamMemberCombo(),this._insertDistributorCombo(),this._insertSubmitButton()}},{key:"_insertChartTypeCombo",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"chart-type-combo",cls:"slds-m-right_small",required:!0,renderTo:this.SELECTORS.primaryRow,label:{text:"Graph type",hidden:!0},options:[],sort:!1,value:"distributions-over-time",listeners:{change:function(){e._refresh()}}}))}},{key:"_insertTeamCombo",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"team-combo",cls:"slds-m-right_small",required:!0,renderTo:this.SELECTORS.primaryRow,label:{text:"Team",hidden:!0},options:[],listeners:{change:function(){e._refresh(["chartTypeCombo","distributorCombo","teamMemberCombo","actionValueCombo"])}}}))}},{key:"_insertDataTypeCombo",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"data-type-combo",cls:"slds-m-right_small",required:!0,renderTo:this.SELECTORS.primaryRow,label:{text:"Select data type",hidden:!0},options:[{label:"Data by distributor",value:"Distributor"},{label:"Data by team member",value:"User"}],value:"Distributor",sort:!1,listeners:{change:function(){e._refresh(["distributorCombo","teamMemberCombo"])}}}))}},{key:"_insertActionValueCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"action-value-combo",cls:"slds-m-right_small",required:!0,renderTo:this.SELECTORS.primaryRow,label:{text:"Select action value",hidden:!0},hidden:!0,options:[]}))}},{key:"_insertDurationCombo",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"duration-combo",cls:"slds-m-right_small",renderTo:this.SELECTORS.secondaryRow,placeholder:"Custom",label:{text:"Duration",hidden:!0},options:[{label:"Today",value:"TODAY"},{label:"Last 7 days",value:"LAST_N_DAYS:7"},{label:"Last 15 days",value:"LAST_N_DAYS:15"},{label:"Last 30 days",value:"LAST_N_DAYS:30"},{label:"Last 60 days",value:"LAST_N_DAYS:60"},{label:"Last 90 days",value:"LAST_N_DAYS:90"}],sort:!1,value:"LAST_N_DAYS:7",listeners:{change:function(){e._refresh(["dateRange"])}}}))}},{key:"_insertDateRangePicker",value:function(){return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-picker",renderTo:this.SELECTORS.secondaryRow,label:{text:"Date range",hidden:!0},hideAllDay:!0,showTime:!1,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,hidden:!0}))}},{key:"_insertDistributorCombo",value:function(){return this._insert(new n2.de.page.analytics.distribution.Combo({id:"distributor-combo",cls:"slds-m-right_small",renderTo:this.SELECTORS.secondaryRow,required:!0,multiple:!0,maxItems:40,label:{text:"Distributor",hidden:!0},options:[]}))}},{key:"_insertTeamMemberCombo",value:function(){return this._insert(new n2.de.page.analytics.distribution.Combo({id:"team-member-combo",cls:"slds-m-right_small",multiple:!0,required:!0,renderTo:this.SELECTORS.secondaryRow,maxItems:40,label:{text:"Team member",hidden:!0},options:[]}))}},{key:"_insertSubmitButton",value:function(){return this.insert(new n2.ui.component.Button({id:"update-chart-button",cls:"n2_update-chart-button slds-m-left_small",renderTo:".n2_right",text:"Update Chart",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onButtonClick,scope:this}}))}},{key:"_onButtonClick",value:function(){var e=this._createEventObject({data:this.chartOptions});this.fire(n2.event.EventType.CLICK,e)}},{key:"_getEndOfDay",value:function(e){return e.setUTCHours(23,59,59,0),e.getTime()}},{key:"_getFilterMessage",value:function(){var e="",t=this.dateRangePicker.value,n=t.startDate,t=t.endDate;return""===this.durationCombo.value&&(n2.isNull(n)||n2.isNull(t))&&(e+="Please add a time period for your data. "),"User"===this.dataTypeCombo.value&&0===this.teamMemberCombo.value.length&&(e+="Please select team members. "),"Distributor"===this.dataTypeCombo.value&&0===this.distributorCombo.value.length&&(e+="Please select distributors. "),e}},{key:"_getDurationMessage",value:function(){if(!this._hasDurationWarning())return"";switch(this.chartTypeCombo.value){case"distributions-over-time":case"distributions-hourly-trend":case"time-to-action":return"You have selected a date range that is longer than your org saves Distribution logs for. To record data for longer, update the Maintain Distribution Logs field on Distribution Settings";case"user-activity":return"You have selected a date range that is longer than your org saves User toggle history for. To record data for longer, update the Maintain toggle history field on Distribution Settings"}}},{key:"_hasDurationWarning",value:function(){var e,t,n=this.durationCombo.value;return""===n?(e=this._chartSetupMap[this.chartTypeCombo.value].logDurationStartDate,t=this.dateRangePicker.value.startDate,!n2.isUndefined(e)&&!n2.isNull(t)&&t.getTime()<e):(t=this._chartSetupMap[this.chartTypeCombo.value].logDurationDays,!n2.isUndefined(t)&&Number(n.substring(12))>t)}},{key:"_filterTeamOptions",value:function(){var t=Object.keys(this._trackedActionsMap);return this._teamOptions.filter(function(e){return t.includes(e.value)})}},{key:"_getDefaultTeamOption",value:function(e){var t=this,n=e.find(function(e){return!n2.isUndefined(t._teamMemberUsersMap[e.value])});return n2.isUndefined(n)?e[0]:n}},{key:"_refreshChartTypeCombo",value:function(){var e=[{label:"Distributions over time",value:"distributions-over-time"},{label:"Distributions hourly trend",value:"distributions-hourly-trend"}];this._chartSetupMap["time-to-action"].isFeatureEnabled&&!n2.isEmpty(this._trackedActionsMap[this.teamCombo.value])&&e.push({label:"Time to action",value:"time-to-action"}),this._chartSetupMap["user-activity"].isFeatureEnabled&&e.push({label:"User activity",value:"user-activity"}),this.chartTypeCombo.options=e}},{key:"_refreshTeamCombo",value:function(){var e="time-to-action"===this.chartTypeCombo.value?this._filterTeamOptions():this._teamOptions;this.teamCombo.options=e,""===this.teamCombo.value&&(this.teamCombo.value={value:this._getDefaultTeamOption(e).value,silent:!0})}},{key:"_refreshDistributorCombo",value:function(){var e=this._distributorsMap[this.teamCombo.value],t=this.dataTypeCombo.value;this.distributorCombo.options=e,this.distributorCombo.hidden="user-activity"===this.chartTypeCombo.value,"Distributor"===t?(this.distributorCombo.placeholder="Select distributors",this.distributorCombo.required=!0,this.distributorCombo.destroyPlaceholderOption(),this.distributorCombo.showClear=!0,e.length<=20&&this.distributorCombo.autoSelect(20)):(this.distributorCombo.required=!1,this.distributorCombo.showClear=!1,this.distributorCombo.placeholder="All distributors",this.distributorCombo.clear())}},{key:"_refreshActionValueCombo",value:function(){var e=this._trackedActionsMap[this.teamCombo.value];this.actionValueCombo.hidden="time-to-action"!==this.chartTypeCombo.value,n2.isUndefined(e)?(this.actionValueCombo.value={value:"",silent:!0},this.actionValueCombo.options=[]):(this.actionValueCombo.options=e,""===this.actionValueCombo.value&&(this.actionValueCombo.value={value:e[0],silent:!0}))}},{key:"_refreshTeamMemberCombo",value:function(){var e=this._teamMemberUsersMap[this.teamCombo.value]||[],t=this.dataTypeCombo.value;this.teamMemberCombo.options=e,"User"===t?(this.teamMemberCombo.placeholder="Select team members",this.teamMemberCombo.required=!0,this.teamMemberCombo.destroyPlaceholderOption(),this.teamMemberCombo.showClear=!0,e.length<=20&&this.teamMemberCombo.autoSelect(20)):(this.teamMemberCombo.required=!1,this.teamMemberCombo.showClear=!1,this.teamMemberCombo.placeholder="All team members",this.teamMemberCombo.clear())}},{key:"_refreshDataTypeCombo",value:function(){var e=this.chartTypeCombo.value,e="time-to-action"===e||"user-activity"===e;(this.dataTypeCombo.disabled=e)&&(this.dataTypeCombo.value={value:"User",silent:!0})}},{key:"_refreshDurationCombo",value:function(){var e;n2.isEmpty(this._chartConfig)&&(e=this.chartTypeCombo.value,this.durationCombo.value="user-activity"===e?{value:"TODAY",silent:!0}:{value:"LAST_N_DAYS:7",silent:!0})}},{key:"_refreshDateRange",value:function(){this.dateRangePicker.hidden=!n2.isEmpty(this.durationCombo.value)}},{key:"_refreshInitialValues",value:function(){n2.isEmpty(this._chartConfig)||(this.chartTypeCombo.value={value:this._chartConfig.chartType,silent:!0},this.durationCombo.value={value:this._chartConfig.dateLiteral,silent:!0},n2.isFiniteNumber(this._chartConfig.startDate)&&(this.dateRangePicker.startDate=new Date(this._chartConfig.startDate),this.dateRangePicker.endDate=new Date(this._chartConfig.endDate)),this.dataTypeCombo.value={value:this._chartConfig.splitBy,silent:!0},this.teamCombo.value={value:this._chartConfig.teamId,silent:!0})}},{key:"_refreshMessage",value:function(){this.element("message").clear();var e=n2.ui.Template.render(this._messageTemplate,{filterMessage:this._message.filterMessage,filterIcon:"".concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_xx-small slds-m-right_xx-small slds-icon-text-error"})),durationMessage:this._message.durationMessage,durationIcon:"".concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_xx-small slds-m-right_xx-small slds-icon-text-warning"}))});this.element("message").insert(e)}}]),t}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.Configuration=function(){_inherits(n,n2.de.component.Card);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{expandConfigurationTarget:".n2_configuration-record-details > .n2_expand-target",configurationDetails:".n2_configuration-details"}),this._componentCls="".concat(this._componentCls," n2-de-assignment-simulation-configuration"),this._contentTemplate='<div class="n2_configuration-record-details slds-media slds-media_center slds-has-flexi-truncate">\n            <div class="slds-media__body">\n                <dl class="n2_record-details slds-list_inline">\n                  <dt class="slds-item_label">Record id:</dt>\n                  <dd class="slds-item_detail n2_record-id">{{content.assignableObjectId}}</dd>\n                  <dt class="slds-item_label">Record name:</dt>\n                  <dd class="slds-item_detail n2_record-name"><a href="/{{content.assignableObjectId}}" target="_blank">{{content.recordName}}</a></dd>\n                  <dt class="slds-item_label">Record owner:</dt>\n                  <dd class="slds-item_detail n2_record-owner">{{content.recordOwnerName}}</dd>\n                  <dt class="slds-item_label">Object type:</dt>\n                  <dd class="slds-item_detail n2_object-type">{{content.assignableObjectType}}</dd>\n                </dl>\n            </div>\n            <a href="javascript:void(0);" class="n2_expand-target">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.CHEVRON_RIGHT,{cls:"slds-icon_x-small"}),'\n            </a>\n        </div>\n        <dl class="n2_configuration-details slds-list_horizontal slds-wrap n2_expanding-panel n2_expanding-panel-closed">\n            {{#content.simulatedDateTime}}\n                <dt class="slds-item_label">Simulated date/time:</dt>\n                <dd class="slds-item_detail n2_simulated-date-time-value">{{content.simulatedDateTime}}</dd>\n            {{/content.simulatedDateTime}}\n            {{#content.sourceOverride}}\n                <dt class="slds-item_label n2_source-override-label">Overwritten source ({{content.sourceOverride.type}}):</dt>\n                <dd class="slds-item_detail n2_source-override-value">{{content.sourceOverride.value}}</dd>\n            {{/content.sourceOverride}}\n            {{#content.isClassifierEnabled}}\n                <dt class="slds-item_label">Ignore classifier status:</dt>\n                <dd class="slds-item_detail n2_ignore-classifier-status">\n                    {{#content.ignoreClassifierStatus}}Yes{{/content.ignoreClassifierStatus}}\n                    {{^content.ignoreClassifierStatus}}No{{/content.ignoreClassifierStatus}}\n                </dd>\n            {{/content.isClassifierEnabled}}\n            <dt class="slds-item_label">Ignore caps:</dt>\n            <dd class="slds-item_detail n2_ignore-caps">\n                {{#content.ignoreCaps}}Yes{{/content.ignoreCaps}}\n                {{^content.ignoreCaps}}No{{/content.ignoreCaps}}\n            </dd>\n            <dt class="slds-item_label">Include inactive teams and distributors:</dt>\n            <dd class="slds-item_detail n2_include-inactive">\n                {{#content.includeInactiveTeamsAndDistributors}}Yes{{/content.includeInactiveTeamsAndDistributors}}\n                {{^content.includeInactiveTeamsAndDistributors}}No{{/content.includeInactiveTeamsAndDistributors}}\n            </dd>\n            <dt class="slds-item_label">Stop simulation on successful assignment:</dt>\n            <dd class="slds-item_detail n2_stop-simulation">\n                {{#content.stopSimulationOnSuccessfulAssignment}}Yes{{/content.stopSimulationOnSuccessfulAssignment}}\n                {{^content.stopSimulationOnSuccessfulAssignment}}No{{/content.stopSimulationOnSuccessfulAssignment}}\n            </dd>\n        </dl>'),this._heading="Assignment details",this._simulationConfigurationData=null,this._refererURL=null}},{key:"simulationConfigurationData",set:function(e){this._setProperty("simulationConfigurationData",e,{sync:!1})}},{key:"refererURL",set:function(e){this._setProperty("refererURL",e,{sync:!1})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this),this._insertNewSimulationButton()}},{key:"_insertNewSimulationButton",value:function(){return this._insert(new n2.ui.component.Button({id:"new-simulation",renderTo:this.SELECTORS.heading,text:"New Simulation",cls:"n2_new-simulation",listeners:{click:this._handleNewSimulationClick,scope:this}}))}},{key:"_handleNewSimulationClick",value:function(e){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show({data:{response:this._simulationConfigurationData},refererURL:this._refererURL})}},{key:"_prepareDOM",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_prepareDOM",this).call(this),this.dom.listen("click",function(e){e.target.classList.contains("n2_expand-target")&&(t.element("expandConfigurationTarget").toggleClass("n2_opened"),t.element("configurationDetails").toggleClass("n2_expanding-panel-closed"))},{scope:this})}}]),n}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.TeamResult=function(){_inherits(o,n2.ui.Component);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{expandTeamResultsTarget:".n2_team-result-heading > .n2_expand-target",body:".n2_distributor-results",distributorResultsList:".n2_distributor-results ol"}),this._mixins=n2.merge(this._mixins,[n2.mixin.DataDriven]),this._template='<div id="{{id}}" class="{{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <div class="n2_team-result-heading slds-media slds-media_center slds-has-flexi-truncate">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.GROUPS,{cls:"slds-icon_x-small"}),'\n                <div class="slds-media__body">\n                    <h2>{{teamName}}</h2>\n                </div>\n                <a href="javascript:void(0);" class="n2_expand-target n2_opened">\n                    ').concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.CHEVRON_RIGHT,{cls:"slds-icon_x-small"}),'\n                </a>\n            </div>\n            <div class="n2_distributor-results n2_expanding-panel">\n                <ol class="slds-list_ordered"></ol>\n            </div>\n        </div>'),this._componentCls="n2-de-page-simulation-team-result",this.teamResult=null,this._distributorResults=null,this._distributorResultCmps=null,this._opened=!0,this._distributorOrderStartNumber=1,this._REFRESH=n2.merge(this._REFRESH,{opened:["openedState"],distributorResults:["teamCls","emptyState","distributorResults"],distributorOrderStartNumber:["distributorOrderStartNumber"]})}},{key:"distributorOrderStartNumber",set:function(e){this._setProperty("distributorOrderStartNumber",e,{sync:!1})}},{key:"distributorResults",get:function(){return this._distributorResults}},{key:"emptyState",get:function(){return this._components["empty-state"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).call(this),this._insertEmptyState()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.HTML({id:"empty-state",hidden:!0,template:'<p class="slds-text-align_center{{#hidden}} {{hideCls}}{{/hidden}}">This team has no distributors</p>'}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a),i=n2.de.page.assignmentSimulation.Context.getInstance().simulatedDistributionId,s=this.teamResult.teamId,e.next=5,this._loadDataProvider("get-assignment-simulation-distributor-results-for-team",{params:[i,this.teamResult.teamId],force:n,silent:t,requestId:"".concat(i,"-").concat(s)});case 5:return e.t0=e.sent,e.abrupt("return",{distributorResultsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(o.prototype),"_getTemplateData",this).call(this),{teamName:this.teamResult.teamName})}},{key:"_prepareDOM",value:function(){var t=this;_get(_getPrototypeOf(o.prototype),"_prepareDOM",this).call(this),this.dom.listen("click",function(e){e.target.classList.contains("n2_expand-target")&&t._setProperty("opened",!t._opened)},{scope:this})}},{key:"_onLoadComplete",value:function(e){e=e.distributorResultsData;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperties({opened:!n2.isEmpty(e.response),distributorResults:e.response})}},{key:"_refreshTeamCls",value:function(){var e="".concat(this._cls).concat(this._getTeamResultCls());n2.isEmpty(e)||(this.cls=e.trim())}},{key:"_refreshOpenedState",value:function(){return this._opened?(this.element("expandTeamResultsTarget").addClass("n2_opened"),this.element("body").removeClass("n2_expanding-panel-closed")):(this.element("expandTeamResultsTarget").removeClass("n2_opened"),this.element("body").addClass("n2_expanding-panel-closed"))}},{key:"_refreshEmptyState",value:function(){this.emptyState.hidden=!n2.isEmpty(this._distributorResults)}},{key:"_refreshDistributorResults",value:function(){this._destroyDistributorResults(),this._distributorResultCmps=this._insertDistributorResults()}},{key:"_refreshDistributorOrderStartNumber",value:function(){this.element("distributorResultsList").attribute("start",this._distributorOrderStartNumber)}},{key:"_destroyDistributorResults",value:function(){n2.isNull(this._distributorResultCmps)||this._distributorResultCmps.forEach(function(e){return e.destroy()})}},{key:"_insertDistributorResults",value:function(){var n=this;return this._distributorResults.map(function(e,t){return n._insertDistributorResult(e,{index:t})})}},{key:"_insertDistributorResult",value:function(e,t){t=t.index;return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.DistributorResult({id:"distributor-result-".concat(t),renderTo:this.SELECTORS.distributorResultsList,distributorResult:e,cls:e.isActive?"":"n2_inactive"}))}},{key:"_getTeamResultCls",value:function(){return"".concat(this.teamResult.isActive?"":"n2_inactive").concat(n2.isUndefined(this._distributorResults.find(function(e){return e.hasTestResults}))?" n2_untested":"")}}]),o}(),n2.de.page.assignmentSimulation.newSimulationModal.AssignmentSimulationSourceSelection=function(){_inherits(r,n2.de.component.field.SourceSelection);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this),this._lazyLoad=!0}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).silent,t=void 0!==t&&t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o),n2.isEmpty(this._model)||n2.isEmpty(this._model.get("objectName")))return i={response:[]},e.abrupt("return",{queues:i,statuses:i});e.next=4;break;case 4:return i=this._model.get("objectName"),e.next=7,Promise.all([this._loadDataProvider("get-queues-for-sobject-type",{params:[i],silent:t,force:n,requestId:i}),this._loadDataProvider("get-existing-status-fields",{params:[i],silent:t,force:n,requestId:i})]);case 7:return a=e.sent,a=_slicedToArray(a,2),s=a[0],a=a[1],e.abrupt("return",{queues:s,statuses:a});case 12:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.queues,e=e.statuses;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._refreshQueueOptions(t),this._refreshStatusOptions(e),this.typeSelectionRadioGroup.options=this._getTypeSelectionOptions({queues:t,statuses:e})}},{key:"_getTypeSelectionOptions",value:function(e){var t=e.queues,e=e.statuses,n=[];return n2.isEmpty(t.response)||n.push("Queue"),n.push("User"),n2.isEmpty(e.response.options)||n.push("Status"),n}},{key:"_refreshQueueOptions",value:function(e){this.queueSelection.options=e.response.map(function(e){return{label:e.name,value:e.id}})}},{key:"_refreshStatusOptions",value:function(e){var t;n2.isEmpty(this.statusSelection)||(t=this.statusSelection._components["status-field-selection"],n2.isEmpty(e.response.options))||(t.options=e.response.options)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(r.prototype),"_onLoaded",this).call(this,e,t),this.statusSelection.components["assigned-status-selection"].hidden=!0,this._teamId=null,this.load({force:!1})}},{key:"_refreshDisabled",value:function(){this.typeSelectionRadioGroup.disabled=this._disabled,this.userSelection.disabled=this._disabled,this.queueSelection.disabled=this._disabled,n2.isEmpty(this.statusSelection)||(this.statusFieldSelection.disabled=this._disabled,this.readyStatusFieldSelection.disabled=this._disabled)}},{key:"_enableChildren",value:function(){this._refreshDisabled()}},{key:"_disableChildren",value:function(){this._refreshDisabled()}},{key:"typeSelectionRadioGroup",get:function(){return this.components["type-selection"]}},{key:"statusSelection",get:function(){return this.components["status-selection"]}},{key:"statusFieldSelection",get:function(){return this.statusSelection.components["status-field-selection"]}},{key:"readyStatusFieldSelection",get:function(){return this.statusSelection.components["ready-status-selection"]}},{key:"userSelection",get:function(){return this.components["user-selection"]}},{key:"queueSelection",get:function(){return this.components["queue-selection"]}},{key:"_loadQueues",value:function(){}},{key:"_loadStatusFields",value:function(){}},{key:"_getUserSelectionModal",value:function(){return!this.rendered||this.userSelection.disabled?null:n2.de.page.assignmentSimulation.newSimulationModal.AssignmentSimulationUserSelectionModal.getInstance({teamId:null,renderTo:this._dom})}},{key:"isSourceSelected",get:function(){var e=this.components["type-selection"]._value;return"User"===e||"Queue"===e||"Status"===e}}]),r}(),n2.de.page.assignmentSimulation.newSimulationModal.AssignmentSimulationUserSelectionModal=function(){_inherits(t,n2.de.component.UserSelectionModal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.id="assignment-simulator-user-selection-modal",this._cls="n2-assignment-simulator-user-selection-modal"}}]),t}(),n2.de.page.assignmentSimulation.newSimulationModal.OverwriteSourceSettings=function(){_inherits(t,n2.de.component.form.FieldGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2_de-overwrite-source",this._lazyLoad=!0,this._toggleActive=!0}},{key:"basicSourceSettings",get:function(){return{isSourceOverridden:!1,sourceType:null,sourceUserId:null,sourceUserName:null,sourceQueueId:null,sourceStatusField:null,sourceStatusFieldValue:null}}},{key:"sourceSettings",get:function(){var e,t=this.basicSourceSettings;return t.isSourceOverridden=this._components["toggle-active"].value,t.isSourceOverridden&&(e=this.components["source-selection"]._model.json,t.sourceType=e.selectionType,"Queue"===t.sourceType&&e.selectedId?t.sourceQueueId=e.selectedId:"User"===t.sourceType&&e.selectedId?t.sourceUserId=e.selectedId:"Status"===t.sourceType&&e.selectedStatusField&&e.selectedReadyStatus?(t.sourceStatusField=e.selectedStatusField,t.sourceStatusFieldValue=e.selectedReadyStatus):(t.isSourceOverridden=!1,t.sourceType="None")),t}},{key:"sourceSelection",get:function(){return this.components["source-selection"]}},{key:"toggleFieldGroup",value:function(e){this.sourceSelection.hidden=!e,this.components["toggle-active"].value=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAssignmentSimulationSourceSelection()}},{key:"_insertAssignmentSimulationSourceSelection",value:function(){return this.insert(new n2.de.page.assignmentSimulation.newSimulationModal.AssignmentSimulationSourceSelection({id:"source-selection",mixins:[n2.mixin.DataDriven],label:"Source",helpText:"Overwrite the source value on the record under test",required:!0,cls:"slds-m-bottom_medium n2_restrict-width",allowNoneOption:!1,hidden:!0,disabled:!0}))}},{key:"_onToggleActiveChange",value:function(e){e=e.value;this.components["source-selection"].hidden=!e}},{key:"model",set:function(e){this.components["source-selection"].model=e}},{key:"validate",value:function(){return _get(_getPrototypeOf(t.prototype),"validate",this).apply(this,arguments)}},{key:"_refreshDisabled",value:function(){this.sourceSelection.disabled=this._disabled,this.components["toggle-active"].disabled=this._disabled}},{key:"clear",value:function(){_get(_getPrototypeOf(t.prototype),"clear",this).call(this),this.components["toggle-active"].value=!1}},{key:"reset",value:function(){this.clear(),this.components["toggle-active"].disable=!0}}]),t}(),n2.de.page.assignmentSimulation.newSimulationModal.SimulationDateTimeSettings=function(){_inherits(t,n2.de.component.form.FieldGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2_de-simulation-date-time-settings",this._lazyLoad=!0,this._toggleActive=!0,this._simulatedDateTime=null,this._REFRESH=n2.merge({simulatedDateTime:["simulatedDateTime"]})}},{key:"dateTimeValue",get:function(){return n2.isEmpty(this.simulatedDateTimePicker.value)?null:n2.de.util.Date.getLuxonDateTimeMillis(this.simulatedDateTimePicker.value,n2.de.ApplicationContext.getInstance().timeZone)},set:function(e){e=n2.de.util.Date.getJsDateFromDateTimeMillis(e,n2.de.ApplicationContext.getInstance().timeZone);this._setProperty("simulatedDateTime",e),n2.isEmpty(e)&&(this._components["toggle-active"].value=!1)}},{key:"_refreshSimulatedDateTime",value:function(){this.simulatedDateTimePicker.value={value:this._simulatedDateTime,silent:!0}}},{key:"simulatedDateTimePicker",get:function(){return this._components["simulated-date-time"]}},{key:"isSimulatedDateTimeSet",get:function(){var e=this.simulatedDateTimePicker.components["date-picker"];return!n2.isEmpty(e.value)}},{key:"toggleFieldGroup",value:function(e){this.simulatedDateTimePicker.hidden=!e,this.components["toggle-active"].value=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertSimulatedDateTime()}},{key:"_insertSimulatedDateTime",value:function(){return this.insert(new n2.ui.component.field.DateTimePicker({id:"simulated-date-time",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2-date-time-picker",label:"Date/Time",value:this._simulatedDateTime,minDate:this._getMinDate(),maxDate:this._getMaxDate(),yearRange:1,required:!0,timeHidden:!1,hideComponentLabels:!0,hidden:!0}))}},{key:"_getMinDate",value:function(){return new Date(this._currentYear-1,0,1)}},{key:"_getMaxDate",value:function(){return new Date(this._currentYear+1,11,31)}},{key:"_onToggleActiveChange",value:function(e){this._refreshSimulatedDateTimeOnToggle(e.value)}},{key:"_refreshSimulatedDateTimeOnToggle",value:function(e){this.simulatedDateTimePicker.hidden=!e,e||this.simulatedDateTimePicker.clear()}},{key:"validate",value:function(){return this.components["toggle-active"].value&&this.simulatedDateTimePicker.validate()||!this.components["toggle-active"].value}},{key:"_refreshDisabled",value:function(){var e=this.simulatedDateTimePicker;e.disabled=this._disabled,e.datePickerField.disabled=this._disabled,e.timePickerField._components.hours.disabled=this._disabled,e.timePickerField._components.minutes.disabled=this._disabled,e.timePickerField._components.meridiem.disabled=this._disabled,this.components["toggle-active"].disabled=this._disabled,_get(_getPrototypeOf(t.prototype),"_refreshDisabled",this).call(this)}},{key:"clear",value:function(){_get(_getPrototypeOf(t.prototype),"clear",this).call(this),this.dateTimeValue=null}},{key:"reset",value:function(){_get(_getPrototypeOf(t.prototype),"reset",this).call(this),this._refreshSimulatedDateTimeOnToggle(!1);var e=this.components["toggle-active"];e.value=!1,e.disable=!0}}]),t}(),n2.de.page.availability.outOfOffice.DeleteEventsMessageBox=function(){_inherits(t,n2.de.component.DeleteMessageBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getMessage",value:function(e){var t,n,i=e.names;e.type;return 1<i.length?"You are about to delete ".concat(i.length," out of office events, do you want to continue?"):(i=(e=i[0]).name,t=new Date(e.startDate),n=new Date(e.endDate),"You are about to delete ".concat(i,"'s out of office from ").concat(n2.de.util.Date.formatDateRange(t,n,{startIsAllDay:e.startIsAllDay,endIsAllDay:e.endIsAllDay}),", do you want to continue?"))}}]),t}(),n2.de.page.availability.outOfOffice.EmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS||{},{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this.SELECTORS=n2.merge(this.SELECTORS,{additionalContent:".n2_additional-content"}),this._illustration=n2.de.illustration.Desert,this._heading="There are no Out of Office events scheduled.",this._content="Out of Office allows you to schedule one-off absences for a team member, e.g. for personal time off or training. Team members will not receive assignments during Out of Office events.",this._contentTemplate='<div>\n            <p class="slds-text-body_regular">{{content}}</p>\n            <div class="n2-create-button-container"></div>\n            <div class="n2_additional-content slds-m-top_x-large slds-p-top_x-large slds-border_top{{#hide}} slds-hide{{/hide}}">\n                <h2 class="slds-text-heading_small slds-p-bottom_xx-small">Not what you\'re looking for?</h2>\n                <div class="n2-create-queue-button-container"></div>\n            </div>\n        </div>',this.TEAM_TYPES=n2.de.page.availability.outOfOffice.Enum.TEAM_TYPES,this._teamType=this.TEAM_TYPES.MIXED}},{key:"teamType",set:function(e){this._teamType!==e&&(this._teamType=e,this._refresh())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){this._insertCreateButton(),this._insertQueueButton()}},{key:"_insertCreateButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"create-new-button",text:"Add Out of Office",cls:"n2_create-button",renderTo:".n2-create-button-container",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onOpenModal(e)}}}))}},{key:"_insertQueueButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"create-new-queue-button",text:"Add Queue Out of Office",cls:"n2_create-queue-button",renderTo:".n2-create-queue-button-container",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onOpenModal(e)}}}))}},{key:"_onOpenModal",value:function(e){this.fire("click",this._createEvent(e))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).apply(this,arguments),{hide:this._teamType!==this.TEAM_TYPES.MIXED||n2.de.ApplicationContext.getInstance().isUser})}},{key:"_refresh",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).teamType;void 0!==e&&!e||this._refreshTeamType()}},{key:"_refreshTeamType",value:function(){var e=this._teamType!==this.TEAM_TYPES.MIXED;this._hideAdditionalContent(e)}},{key:"_hideAdditionalContent",value:function(e){this.element("additionalContent").hide(e)}}]),t}(),n2.de.page.availability.outOfOffice.Enum={TEAM_TYPES:{MIXED:"Mixed",STANDARD:"Standard",QUEUE:"Q2Q"}},n2.de.page.availability.outOfOffice.OutOfOfficeChangeHistoryModal=function(){_inherits(o,n2.de.page.team.ChangeHistoryModal);var t,e,n=_createSuper(o);function o(){return _classCallCheck(this,o),n.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this,arguments),this._lazyLoad=!0}},{key:"memberField",get:function(){return this._components["member-picker"]}},{key:"show",value:function(e){e.header,e.model,e.showName;_get(_getPrototypeOf(o.prototype),"show",this).apply(this,arguments),this._insertFilter(),this.load({force:!1})}},{key:"_insertFilter",value:function(){var t=this;return n2.isUndefined(this.memberField)||this.memberField.destroy(),this._insert(new n2.de.component.field.TeamMemberPicker({id:"member-picker",renderTo:{target:this.SELECTORS.body,position:"afterbegin"},label:{text:"Member",hidden:!0},cls:"slds-m-bottom_medium",placeholder:"Pick team member...",max:1,showClear:!0,listeners:{change:function(e){return t._handleMemberChange(e)}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a),this.memberField.spinner(),e.next=4,Promise.all([this._fetchDataProvider("get-queue-team-members",{force:t,silent:n}),this._fetchDataProvider("get-user-team-members",{force:t,silent:n})]);case 4:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",{members:[].concat(_toConsumableArray(i.response),_toConsumableArray(s.response))});case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.members;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this.memberField.users=e,this.memberField.spinner(!1)}},{key:"_handleMemberChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this._components["records-data-table"]).spinner(),i=this.memberField.value,i=n2.isEmpty(i)?null:i[0],e.next=6,this._loadDataProvider("get-out-of-office-change-history",{params:[i],requestId:i,force:!0,silent:!0});case 6:i=e.sent,n.spinner(!1),n.data=i.response;case 8:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_getColumns",value:function(){return[{header:"Date",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.changeDatetime)}}},{header:"Name",cls:"n2_name-column",bindPath:".relatedUserOrQueue"},{header:"Reason",bindPath:".recordName"},{header:"Action",bindPath:".historyString"},{header:"User",cls:"n2_user-column",bindPath:".username"}]}}]),o}(),n2.de.page.availability.outOfOffice.OutOfOfficeDataTable=function(){_inherits(i,n2.de.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS||{},{click:function(e){},menuOptionSelect:function(e){}}),this._selectable=!0,this._cls="n2-out-of-office-data-table",this._sortBy={column:0,direction:"asc"},this._unfilteredData=null,this._MAX_ROWS=n2.de.ApplicationContext.getInstance().OOO_DISPLAY_LIMIT,this._hasMaxRows=!1,this._canEditDeletePastEvents=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager}},{key:"data",get:function(){var t=[];return this.forEachRow(function(e){t.push(e.data)}),t},set:function(e){this._unfilteredData=e,this._data=e,n2.isNull(this._sortBy)||this._sort(this.columns[this._sortBy.column],{direction:this.sortBy.direction}),this._refreshData()}},{key:"hasMaxRows",get:function(){return this._hasMaxRows}},{key:"_onDefined",value:function(){var t=this;this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no out of office events that match your filters",content:"We looked through all events, but none of them match your filters. You can change your terms, or clear them to see all events for the time period.",button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t.fire("click",{target:e,currentTarget:t})}}}}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",sortable:!0,cls:"n2_date-range",sort:{adapter:function(e){return"".concat(e.startDate," ").concat(e.endDate)}},cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}',dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",bindPath:"name",sortable:!0,sort:{bindPath:".nameSort"},cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Team",bindPath:"teams",cell:{cellTemplate:'{{#content}}<div class="slds-truncate"{{#content.title}} title="{{content.title}}"{{/content.title}}>{{content.teamName}}</div>{{/content}}',dataAdapter:function(e){return t._formatTeams(e)}}},{header:"Reason",bindPath:"reason",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Timezone",sortable:!0,sort:{bindPath:"timezone"},cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content.timezoneLabel}}">{{content.timezone}}</div>{{/content}}'}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_formatTeams",value:function(e){var t="",n=null;return 1===e.length?t=e[0].name:1<e.length&&(t="".concat(e.length," teams"),n=e.map(function(e){return e.name}).join(", ")),{teamName:t,title:n}}},{key:"_formatDate",value:function(e){var t=new Date(e.startDate),n=new Date(e.endDate);return n2.de.util.Date.formatDateRange(t,n,{startIsAllDay:e.startIsAllDay,endIsAllDay:e.endIsAllDay})}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"out-of-office-menu",mixins:[n2.mixin.DataDriven],options:[{id:"edit",label:"Edit"},{id:"delete",label:"Delete"}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("menuOptionSelect",{target:e,currentTarget:n,relatedTarget:t.parent})}}}}},{key:"_onMenuLoaded",value:function(e,t){e.hidden=!t.upcoming&&!this._canEditDeletePastEvents}},{key:"addFilter",value:function(e,t){this._filters[e]=t,this._refreshData()}},{key:"removeFilters",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;n2.isNull(e)?this._filters={}:delete this._filters[e],this._refreshData()}},{key:"_sort",value:function(e){var t,n,i=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).direction,i=void 0===i?"asc":i;n2.isEmpty(this._unfilteredData)||(t=e.bindPath,n=null,n2.isObject(e.sort)&&(t=e.sort.bindPath,n=e.sort.adapter||null),n2.sort(this._unfilteredData,{property:t,ascending:"asc"===i,adapter:n}))}},{key:"_makeSelectable",value:function(t){var n;this._canEditDeletePastEvents?_get(_getPrototypeOf(i.prototype),"_makeSelectable",this).apply(this,arguments):(n=!0,this.forEachRow(function(e){e.selectable=t,e.disabled=!e.data.upcoming,e.disabled||(n=!1)}),this.headerRow.selectable=t,this.headerRow.disabled=n)}},{key:"_refreshData",value:function(){var e;this.forEachRow(function(e){e.destroy()}),this._hasMaxRows=!1,n2.isEmpty(this._unfilteredData)||(n2.isEmpty(this._filters)?this._data=this._unfilteredData:(e=Object.values(this._filters),this._data=this._unfilteredData.filter(function(t){return e.every(function(e){return e(t)})})),this._data.length>this._MAX_ROWS&&(this._data=this._data.slice(0,this._MAX_ROWS),this._hasMaxRows=!0),this._refreshRows(),this._makeSelectable(this._selectable))}},{key:"_refreshRows",value:function(){n2.isEmpty(this._data)?(n2.isUndefined(this._components["empty-state"])||this._components["empty-state"].hidden)&&this.showEmptyFilteredState():(this._hideEmptyState(),this._addRows(),this._applySelection(),this._refreshHeaderRowSelection(),this._applyRowIndexAttributes())}},{key:"showEmptyFilteredState",value:function(){this._showEmptyState(this._emptyFilteredState)}}]),i}(),n2.de.page.availability.outOfOffice.OutOfOfficeModal=function(){_inherits(i,n2.de.component.Modal);var e,t,n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="out-of-office-modal",this._componentCls="n2-de-out-of-office-modal",this._eventId=null,this._isQueue=!1}},{key:"form",get:function(){return this._components["out-of-office-form"]}},{key:"memberField",get:function(){return this.form.components.member}},{key:"reasonField",get:function(){return this.form.components.reason}},{key:"dateRangeField",get:function(){return this.form.components["date-range"]}},{key:"timezoneField",get:function(){return this.form.components.timezone}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e=n2.de.ApplicationContext.getInstance(),e=e.isUser?e.currentUserId:this.memberField.value,e=n2.isArray(e)?e:[e],t=this.dateRangeField.value,t={id:this._eventId,endDate:t.endDate.getTime(),endIsAllDay:t.endIsAllDay,startDate:t.startDate.getTime(),startIsAllDay:t.startIsAllDay,reason:this.reasonField.value,timezone:this.timezoneField.value};return this._isQueue?t.queues=e:t.users=e,t}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){var e=[{type:n2.ui.component.field.TextBox,id:"reason",label:"Reason",cls:"slds-m-bottom_medium",required:!0},{type:n2.de.component.field.DateRangePicker,id:"date-range",label:{text:"Date range",hidden:!0},cls:"slds-m-bottom_medium",required:!0},{type:n2.ui.component.field.Combo,id:"timezone",cls:"n2_field-width slds-m-bottom_medium",label:"Timezone",required:!0,sort:!1,options:[]}];return n2.de.ApplicationContext.getInstance().isUser||e.unshift({type:n2.de.component.field.TeamMemberPicker,id:"member",label:"Member",cls:"slds-m-bottom_medium",required:!0}),this.insert(new n2.ui.component.Form({id:"out-of-office-form",components:e}))}},{key:"show",value:function(e){var t=e.model,t=void 0===t?null:t,n=e.timezoneOptions,n=void 0===n?[]:n,e=e.options,e=(_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header=e.header,this._isQueue=e.isQueue,this.form.clear(),this.timezoneField.options=n,n2.de.ApplicationContext.getInstance().isUser||(this._setTeamMembers(),this.memberField.disabled=!n2.isNull(t)),this._setFieldValues(t),"Create Out of Office");n2.isNull(t)||(this._eventId=t.id,e="Save"),this.submitButton.text=e,this.submitButton.reset(),this.cancelButton.enable()}},{key:"_setTeamMembers",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.memberField.spinner(),t=this._isQueue?"get-queue-team-members":"get-user-team-members",e.next=4,this._fetchDataProvider(t,{force:!1});case 4:t=e.sent,this.memberField.spinner(!1),this.memberField.users=t.response;case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_setFieldValues",value:function(e){var t,n=n2.de.ApplicationContext.getInstance().timeZone;n2.isNull(e)?this.dateRangeField.value={value:[{date:new Date,isAllDay:!0},{date:new Date,isAllDay:!0}],silent:!0}:(t=this._isQueue?e.queue:e.user,n=e.timezone,this.reasonField.value={value:e.reason,silent:!0,validate:!1},n2.de.ApplicationContext.getInstance().isUser||(this.memberField.value={value:t,silent:!0,validate:!1}),this.dateRangeField.value={value:[{date:new Date(e.startDate),isAllDay:e.startIsAllDay},{date:new Date(e.endDate),isAllDay:e.endIsAllDay}],silent:!0},this._previousStartDate=new Date(e.startDate)),this.timezoneField.value={value:n,silent:!0,validate:!1}}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(i.prototype),"_onCancel",this).call(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),i}(),n2.de.page.availability.regionalHolidays.Holidays=function(){_inherits(o,n2.ui.Component);var e,t,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-holidays"],this._lazyLoad=!0,this._cls="n2-de-availability-holidays",this._regionOptions=[],this._timezoneOptions=[],this._currentYear=(new Date).getFullYear()}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"toolbarActionMenu",get:function(){return this.toolbar.components["action-menu"]}},{key:"yearFilter",get:function(){return this.toolbar.components["year-filter"]}},{key:"regionFilter",get:function(){return this.toolbar.components["region-filter"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"addHolidayButton",get:function(){return this.toolbar.components["add-holiday-button"]}},{key:"holidayList",get:function(){return this._components["holidays-data-table"]}},{key:"holidayModal",get:function(){return n2.de.page.availability.regionalHolidays.holidays.HolidayModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["save-holiday"]})}},{key:"regionOptions",set:function(e){n2.compare(this._regionOptions,e)||(this._regionOptions=e,this._refresh({toolbar:!0}))}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar()}},{key:"show",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n2.isUndefined(this.holidayList)||(this.holidayList.hidden=!0),_get(_getPrototypeOf(o.prototype),"show",this).apply(this,t),e.next=4,this.load();case 4:n2.isUndefined(this.holidayList)||(this.holidayList.hidden=!1);case 5:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"_insertToolbar",value:function(){var e=[this._createYearFilter(),this._createRegionFilter(),this._createQuickFilter(),this._createToolbarActionMenuButton()];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(3,0,this._createAddHolidayButton()),this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar">\n                <div class="n2_left slds-grid"></div>\n                <div class="n2_right"></div>\n            </div>',components:e}))}},{key:"_createYearFilter",value:function(){var e=this;return new n2.ui.component.field.Combo({id:"year-filter",renderTo:".n2_left",cls:"slds-p-right_x-small n2_year-filter",label:{text:"Filter by year",hidden:!0},options:[],value:this._currentYear,required:!0,listeners:{change:function(){return e._refresh({yearFilter:!0})}}})}},{key:"_createRegionFilter",value:function(){return new n2.ui.component.field.Combo({id:"region-filter",renderTo:".n2_left",label:{text:"Filter by region",hidden:!0},placeholder:"All regions",options:[],listeners:{change:this._onRegionFilterChange,scope:this}})}},{key:"_onRegionFilterChange",value:function(e){""!==e.value?this.holidayList.addFilter("regionFilter",{dataBindings:["regionId"],value:e.value}):this.holidayList.removeFilters(["regionFilter"])}},{key:"_createQuickFilter",value:function(){return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find regional holiday...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}})}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this.holidayList.addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.holidayList.removeFilters(["quickFilter"])}},{key:"_createAddHolidayButton",value:function(){return new n2.ui.component.Button({id:"add-holiday-button",renderTo:".n2_right",cls:"n2_add-holiday-button",text:"Add regional holiday",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddHolidayClick,scope:this}})}},{key:"_onAddHolidayClick",value:function(){this.holidayModal.show({submitButtonText:"Create Holiday",regionOptions:this._regionOptions,timezoneOptions:this._timezoneOptions,defaultRegion:this.regionFilter.value,listeners:{submit:this._onHolidayModalSubmit,scope:this}})}},{key:"_onEditHolidayClick",value:function(e){this.holidayModal.show({header:"Edit ".concat(e.name),submitButtonText:"Save",regionOptions:this._regionOptions,timezoneOptions:this._timezoneOptions,model:e,listeners:{submit:this._onHolidayModalSubmit,scope:this}})}},{key:"_onHolidayModalSubmit",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("save-holiday",{params:[t.data]});case 2:return e.abrupt("return",this._loadDataProvider("get-holidays",{silent:!1,force:!0}));case 3:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_createToolbarActionMenuButton",value:function(){return new n2.ui.component.Menu({id:"action-menu",renderTo:".n2_right",cls:"n2_action-menu",options:this._getToolbarActionOptions(),listeners:{select:this._onToolbarActionMenuSelect,scope:this}})}},{key:"_getToolbarActionOptions",value:function(){var e=[{id:"changeHistory",label:"Regional Holidays History"}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(0,0,{id:"delete",label:"Delete",hidden:!0}),e}},{key:"_onToolbarActionMenuSelect",value:function(e,t){switch(e.id){case"delete":this._onDeleteHolidayClick(this.holidayList.selection);break;case"changeHistory":this._onChangeHistoryClick()}}},{key:"_onDeleteHolidayClick",value:function(t){var n=this;n2.de.page.availability.regionalHolidays.holidays.DeleteHolidaysMessageBox.getInstance({renderTo:this._dom.parent,dataProviders:["delete-holidays"]}).show({names:t,listeners:{submit:function(e){return n._onDeleteHolidaySubmit(e,t)}}})}},{key:"_onDeleteHolidaySubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-holidays",{params:[n]});case 2:return e.next=4,t.hide();case 4:return this.toolbarActionMenu.components.delete.hidden=!0,e.abrupt("return",this._loadDataProvider("get-holidays",{silent:!1,force:!0}));case 6:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onChangeHistoryClick",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-holiday-change-history",{silent:!1,force:!0});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Regional Holidays history",model:t.response,showName:!0});case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0!==t&&t,n=e.holidayList,n=void 0!==n&&n,i=e.yearFilter,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshHolidayList(),(e||i)&&this._refreshYearFilter()}},{key:"_refreshToolbar",value:function(){this.regionFilter.clear({silent:!0}),this.quickFilter.clear({silent:!0});var e=n2.isEmpty(this._model);this.regionFilter.options=this._regionOptions,this.yearFilter.options=this._getYearFilterOptions(),this.quickFilter.hidden=e,this.regionFilter.hidden=e,this.yearFilter.hidden=e,n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this.addHolidayButton.hidden=e)}},{key:"_getYearFilterOptions",value:function(){for(var e=this._currentYear-1,t=this._currentYear+5,n=[],i=e;i<=t;i++)n.push(i);return n}},{key:"_refreshHolidayList",value:function(){n2.isUndefined(this.holidayList)||this.holidayList.destroy(),this._insertHolidayDataTable()}},{key:"_refreshYearFilter",value:function(){var t;n2.isEmpty(this._model)||(t=this.yearFilter.value.toString(),this.holidayList.addFilter("yearFilter",{fcn:function(e){return 0<=e.data.years.indexOf(t)}}))}},{key:"_insertHolidayDataTable",value:function(){return this._insert(new n2.de.page.availability.regionalHolidays.holidays.HolidayList({id:"holidays-data-table",data:this._model,listeners:{selectionChange:this._onHolidayListTableSelectionChange,click:this._onHolidayListClick,scope:this}}))}},{key:"_onHolidayListTableSelectionChange",value:function(e){var t=this.toolbarActionMenu.components.delete;n2.isUndefined(t)||(e=e.target.parent.selection,t.hidden=n2.isEmpty(e),t.label="Delete (".concat(e.length,")"))}},{key:"_onHolidayListClick",value:function(e){if(n2.isObject(e))switch(e.target.id){case"delete":this._onDeleteHolidayClick([e.data.holidayData]);break;case"add-holiday":this._onAddHolidayClick();break;case"clear-filters":this._onClearFiltersClick();break;case"edit":this._onEditHolidayClick(e.data.holidayData)}}},{key:"_onClearFiltersClick",value:function(){this.regionFilter.clear(),this.quickFilter.clear(),this.yearFilter.value=this._currentYear}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-holidays",{silent:t,force:n}),this._loadDataProvider("get-timezone-options",{silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{holidaysData:i,timezones:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._timezoneOptions=e.timezones.response,this._model=e.holidaysData.response,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-holidays"!==t.id||(this._model=e,this._refresh())}}]),o}(),n2.de.page.availability.regionalHolidays.Regions=function(){_inherits(s,n2.ui.Component);var e,n,t,i=_createSuper(s);function s(){return _classCallCheck(this,s),i.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._cls="n2-de-availability-regions"}},{key:"addRegionButton",get:function(){return this.toolbar.components["add-region-button"]}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"toolbarActionMenu",get:function(){return this.toolbar.components["action-menu"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"regionList",get:function(){return this._components["regions-data-table"]}},{key:"regionModal",get:function(){return n2.de.page.availability.regionalHolidays.regions.RegionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["save-holiday-region"]})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar()}},{key:"_insertToolbar",value:function(){var e=[this._createQuickFilter(),this._createToolbarActionMenuButton()];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(1,0,this._createAddRegionButton()),this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',components:e}))}},{key:"_createQuickFilter",value:function(){return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find region...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}})}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this.regionList.addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.regionList.removeFilters(["quickFilter"])}},{key:"_createAddRegionButton",value:function(){return new n2.ui.component.Button({id:"add-region-button",renderTo:".n2_right",cls:"n2_add-region-button",text:"Add region",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddRegionClick,scope:this}})}},{key:"_onAddRegionClick",value:function(){this.regionModal.show({submitButtonText:"Create Region",regionNames:this._getCurrentRegionNames(),listeners:{submit:this._onRegionModalSubmit,scope:this}})}},{key:"_onEditRegionClick",value:function(e){this.regionModal.show({header:"Edit ".concat(e.name),submitButtonText:"Save",model:e,regionNames:this._getCurrentRegionNames(e.name),listeners:{submit:this._onRegionModalSubmit,scope:this}})}},{key:"_getCurrentRegionNames",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=this._model.map(function(e){return e.name});return n2.isNull(t)?e:e.filter(function(e){return e!==t})}},{key:"_onRegionModalSubmit",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("save-holiday-region",{params:[t.data]});case 2:return e.abrupt("return",this._loadDataProvider("get-holiday-regions",{silent:!1,force:!0}));case 3:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_createToolbarActionMenuButton",value:function(){return new n2.ui.component.Menu({id:"action-menu",renderTo:".n2_right",cls:"n2_action-menu",options:this._getToolbarActionOptions(),listeners:{select:this._onToolbarActionMenuSelect,scope:this}})}},{key:"_getToolbarActionOptions",value:function(){var e=[{id:"changeHistory",label:"Regions History"}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.splice(0,0,{id:"delete",label:"Delete",hidden:!0}),e}},{key:"_onToolbarActionMenuSelect",value:function(e,t){switch(e.id){case"delete":this._onDeleteRegionClick(this.regionList.selection);break;case"changeHistory":this._onChangeHistoryClick()}}},{key:"_onDeleteRegionClick",value:function(t){var n=this;n2.de.page.availability.regionalHolidays.regions.DeleteRegionsMessageBox.getInstance({renderTo:this._dom.parent,dataProviders:["delete-holiday-region"]}).show({names:t,listeners:{submit:function(e){return n._onDeleteRegionSubmit(e,t)}}})}},{key:"_onDeleteRegionSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-holiday-region",{params:[n]});case 2:return e.next=4,t.hide();case 4:return this.toolbarActionMenu.components.delete.hidden=!0,e.abrupt("return",this._loadDataProvider("get-holiday-regions",{silent:!1,force:!0}));case 6:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onChangeHistoryClick",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-holiday-region-change-history",{silent:!1,force:!0});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({header:"Regions history",model:t.response});case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0===t||t,n=e.regionList,n=void 0===n||n,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshRegionList()}},{key:"_refreshToolbar",value:function(){var e;n2.isUndefined(this.toolbar)||(this.quickFilter.clear({silent:!0}),e=n2.isEmpty(this._model),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this.addRegionButton.hidden=e),this.quickFilter.hidden=e)}},{key:"_refreshRegionList",value:function(){n2.isUndefined(this.regionList)||this.regionList.destroy(),this._insertRegionsDataTable()}},{key:"_insertRegionsDataTable",value:function(){return this._insert(new n2.de.page.availability.regionalHolidays.regions.RegionList({id:"regions-data-table",data:this._model,listeners:{selectionChange:this._onRegionListTableSelectionChange,click:this._onRegionListClick,scope:this}}))}},{key:"_onRegionListTableSelectionChange",value:function(e){var t=this.toolbarActionMenu.components.delete;n2.isUndefined(t)||(e=e.target.parent.selection,t.hidden=n2.isEmpty(e),t.label="Delete (".concat(e.length,")"))}},{key:"_onRegionListClick",value:function(e){if(n2.isObject(e))switch(e.target.id){case"delete":this._onDeleteRegionClick([e.data.regionData]);break;case"add-region":this._onAddRegionClick();break;case"clear-filters":this.quickFilter.clear();break;case"edit":this._onEditRegionClick(e.data.regionData)}}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}}]),s}(),n2.de.page.availability.shifts.Context=function(){_inherits(s,n2.de.page.availability.Context);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._shiftHoursId=null}},{key:"shiftHoursId",get:function(){return this._shiftHoursId},set:function(e){this._setProperty("shiftHoursId",e,{sync:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-page-url-params",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{pageUrlParams:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.pageUrlParams;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.shiftHoursId=e.response.shiftHoursId||null}}]),s}(),n2.de.page.availability.shifts.ShiftList=function(){_inherits(i,n2.de.component.DataTable);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this.columns=this._getColumns(),this._emptyState={type:n2.de.page.availability.shifts.shiftList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,this._sortBy={column:0,direction:"asc"}}},{key:"_onDefined",value:function(){var t=this,e=(_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._data.length),n=1===e?"shift":"shifts";this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no shifts that match your filters",content:"We looked through ".concat(e," ").concat(n,", but none of them match your filters. You can change your terms, or clear them to see all shifts."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t.fire("click",{target:e,currentTarget:t})}}}}}},{key:"_getColumns",value:function(){var e=[{header:"Name",bindPath:"name",sortable:!0},{header:"Timezone",sortable:!0,sort:{bindPath:"timezone"},cell:{cellTemplate:'{{#content}}<div class="slds-truncate"><span title="{{content.timezoneLabel}}">{{content.timezone}}</span></div>{{/content}}'}},{header:"Used by",cell:{dataAdapter:this._getUsedByCellContent.bind(this)}}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.push({cls:"n2_menu",cell:{id:"td-menu",cls:"n2_menu-column",cellTemplate:"",components:[]}}),e}},{key:"_createRow",value:function(e){return n2.isUndefined(this.columns[3])||(this.columns[3].cell.components=[this._getShiftRowMenuConfig({includeDelete:!e.data.inUse})]),e.cls=e.data.inUse?e.cls:"".concat(e.cls," n2_inactive"),_get(_getPrototypeOf(i.prototype),"_createRow",this).call(this,e)}},{key:"_getUsedByCellContent",value:function(e){var t,n,i,s;return e.inUse?(s=e.teamMemberUsage,n=0<(e=e.teamUsage),i="",(t=0<s)&&(i="".concat(s,1!==s?" team members":" team member")),s="",n&&(s="".concat(e,1!==e?" teams":" team")),"".concat(s).concat(t&&n?" and ":"").concat(i)):{html:"<span>&mdash;</span>"}}},{key:"_getShiftRowMenuConfig",value:function(){var n=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeDelete,t=[{id:"edit",label:"Edit"},{id:"clone",label:"Clone"}];return(void 0===e||e)&&t.push({id:"delete",label:"Delete"}),{type:n2.ui.component.Menu,id:"shift-row-actions-menu",options:t,listeners:{select:function(e,t){n.fire("click",{target:e,currentTarget:n,data:{shiftData:t.parent.data}})},scope:this}}}},{key:"_sort",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_get(_getPrototypeOf(i.prototype),"_sort",this).apply(this,t);case 2:this._destroyed||this._makeSelectable(this._selectable);case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_makeSelectable",value:function(t){var n=!0;this.rows.filter(function(e){return!e.headerRow}).forEach(function(e){e.selectable=t,e.disabled=e.data.inUse,e.disabled||(n=!1)}),this.headerRow.disabled=n}}]),i}(),n2.de.page.availability.shifts.SlideOutPanel=function(){_inherits(o,n2.de.page.SlideOutPanel);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-shifts-slide-out-panel",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-shift-hours"],this._lazyLoad=!0,this._shiftHoursId=null,this._shiftHoursResponse=null,this._shiftHoursUsageResponse=null}},{key:"shiftHoursId",get:function(){return this._shiftHoursId}},{key:"shiftDetailsContainer",get:function(){return this._components["shift-details-container"]}},{key:"shiftHoursComponent",get:function(){return this.shiftDetailsContainer.components["shift-hours"]}},{key:"timezoneSummary",get:function(){return this.shiftDetailsContainer.components["timezone-summary"]}},{key:"shiftHoursUsage",get:function(){return this.shiftDetailsContainer.components["shift-hours-usage"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertShiftDetailsContainer(),this._insertShiftHours(),this._insertTimezoneSummary(),this._insertShiftHoursUsage()}},{key:"_insertActionButtons",value:function(){return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?n2.merge(_get(_getPrototypeOf(o.prototype),"_insertActionButtons",this).call(this),[this._insertEditShiftButton()]):_get(_getPrototypeOf(o.prototype),"_insertActionButtons",this).call(this)}},{key:"_insertEditShiftButton",value:function(){return this._insert(new n2.ui.component.Button({id:"edit-shift-button",renderTo:this.SELECTORS.actions,text:"Edit Shift",theme:n2.ui.component.button.Theme.LINK,cls:"slds-m-right_xx-small",listeners:{click:this._onEditShiftButtonClick,scope:this}}))}},{key:"_onEditShiftButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this,relatedTarget:null,data:{shiftHoursData:this._shiftHoursResponse}})}},{key:"_insertShiftDetailsContainer",value:function(){return this._insert(new n2.ui.component.HTML({id:"shift-details-container",template:'<div id="{{id}}" class="n2_shift-details-container slds-p-horizontal_small slds-p-bottom_small"></div>'}))}},{key:"_insertShiftHours",value:function(){return this.shiftDetailsContainer.insert(new n2.de.component.hours.ShiftHours({id:"shift-hours",cls:"slds-p-top_small"}))}},{key:"_insertTimezoneSummary",value:function(){return this.shiftDetailsContainer.insert(new n2.de.component.field.ReadOnly({id:"timezone-summary",cls:"slds-p-top_small",label:"Timezone"}))}},{key:"_insertShiftHoursUsage",value:function(){return this.shiftDetailsContainer.insert(new n2.de.page.availability.shifts.slideOutPanel.ShiftHoursUsage({id:"shift-hours-usage",cls:"slds-p-top_small"}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.shiftHoursId,t=void 0===t?null:t,n=e.heading,n=void 0===n?"":n,i=e.includeNavButtons,i=void 0!==i&&i,s=e.components,s=void 0===s?[]:s,e=e.listeners,e=void 0===e?{}:e;_get(_getPrototypeOf(o.prototype),"show",this).call(this,{heading:n,includeNavButtons:i,components:s,listeners:e}),n2.de.page.availability.shifts.Context.getInstance().shiftHoursId=t,this._shiftHoursId=t,this._shiftHoursResponse=null,this._shiftHoursUsageResponse=null,this.load({force:!1})}},{key:"hide",value:function(){_get(_getPrototypeOf(o.prototype),"hide",this).call(this),n2.de.page.availability.shifts.Context.getInstance().shiftHoursId=null}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(i=0<a.length&&void 0!==a[0]?a[0]:{}).silent,n=void 0===n||n,i=i.force,i=void 0!==i&&i,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a),t=this._shiftHoursId,e.next=5,Promise.all([this._loadDataProvider("get-shift-hours",{params:[this._shiftHoursId],requestId:t,silent:n,force:i}),this._loadDataProvider("get-shift-usage",{params:[this._shiftHoursId],requestId:t,silent:n,force:i})]);case 5:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",{shiftHours:i,shiftHoursUsage:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._shiftHoursResponse=e.shiftHours.response,this._shiftHoursUsageResponse=e.shiftHoursUsage.response,this._refresh()}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-shift-hours"===t.id&&n===this._shiftHoursId&&(this._shiftHoursResponse=e,this._refresh({shiftUsage:!1}))}},{key:"_onShiftHoursModelChange",value:function(e){this._refresh({shiftUsage:!1})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.heading,n=e.shiftHours,n=void 0===n||n,i=e.timezone,i=void 0===i||i,e=e.shiftUsage,e=void 0===e||e;void 0!==t&&!t||(this.heading=this._shiftHoursResponse.name),n&&this._refreshShiftHours(),i&&this._refreshTimezoneSummary(),e&&this._refreshShiftHoursUsage()}},{key:"_refreshShiftHours",value:function(){this.shiftHoursComponent.shiftDays=this._shiftHoursResponse.days}},{key:"_refreshTimezoneSummary",value:function(){var t=this,e=this._getDataProviderById("get-timezone-options").getResponse().find(function(e){return e.value===t._shiftHoursResponse.timezone});this.timezoneSummary.value=e.label}},{key:"_refreshShiftHoursUsage",value:function(){var e=this._shiftHoursUsageResponse.teamMembers,t=this._shiftHoursUsageResponse.teams,n=!n2.isEmpty(e)||!n2.isEmpty(t);this.shiftHoursUsage.hidden=!n,n&&(this.shiftHoursUsage.teamMembers=e,this.shiftHoursUsage.teams=t)}}]),o}(),n2.de.page.classifier.autoConversionSettings.AutoConversionRules=function(){_inherits(a,n2.ui.Component);var i,e,n,t,s=_createSuper(a);function a(){return _classCallCheck(this,a),s.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="n2-de-auto-conversion-rules",this._autoConversionRules=null,this._autoConversionActionLabelMap=null}},{key:"autoConversionRulesMenu",get:function(){return this._components["auto-conversion-rules-menu"]}},{key:"autoConversionRulesDataTable",get:function(){return this._components["auto-conversion-rules-data-table"]}},{key:"createAutoConversionRuleButton",get:function(){return this._components["create-auto-conversion-rule-button"]}},{key:"reorderRulesModal",get:function(){return n2.de.page.classifier.autoConversionSettings.autoConversionRules.ReorderRulesModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,listeners:{saved:this._onReorderRulesSaved,scope:this}})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).call(this),this._insertAutoConversionRulesMenu(),this._insertAutoConversionRulesDataTable(),this._insertCreateRuleButton()}},{key:"_insertAutoConversionRulesMenu",value:function(){return this._insert(new n2.ui.component.Menu({id:"auto-conversion-rules-menu",cls:"n2_auto-conversion-rules-menu",options:[{id:"reorder-rules",label:"Reorder Rules"}],listeners:{select:this._onAutoConversionRulesMenuSelect,scope:this}}))}},{key:"_onAutoConversionRulesMenuSelect",value:function(e){"reorder-rules"===e.id&&this.reorderRulesModal.show({rules:this._getNonDefaultRules()})}},{key:"_getNonDefaultRules",value:function(){return this._autoConversionRules.filter(function(e){return!e.isDefault})}},{key:"_onReorderRulesSaved",value:function(e,t,n){this.model=t.rules}},{key:"_insertAutoConversionRulesDataTable",value:function(){var t=this;return this._insert(new n2.ui.component.DataTable({id:"auto-conversion-rules-data-table",columns:[{header:"Rule name",cell:{dataAdapter:function(e){return e.isDefault?"".concat(e.name," (Default)"):e.name}}},{header:"Number of filters",bindPath:"numberOfFilters",cls:"n2_number-of-filters",cell:{cls:"n2_number-of-filters-cell"}},{header:"Matching status",bindPath:"matchingStatus",cls:"n2_matching-status"},{header:"Action",bindPath:"action",cls:"n2_match-action",cell:{dataAdapter:function(e){return t._autoConversionActionLabelMap[e]}}},{header:{data:"Action Menu",hidden:!0},cls:"n2_action-menu",cell:{id:"action-menu-cell",cellTemplate:"",cls:"n2_menu-cell",components:[{type:n2.ui.component.Menu,id:"action-menu",options:[{id:"toggle-active-state",label:"Deactivate"},{id:"edit",label:"Edit"},{id:"delete",label:"Delete"}],listeners:{select:this._onRulesTableActionMenuSelect,scope:this}}]}}]}))}},{key:"_onRulesTableActionMenuSelect",value:function(e){var t=e.parent.parent.parent;switch(e.id){case"edit":this._openAutoConversionRuleModal({rule:t.data});break;case"toggle-active-state":this._onToggleRuleActiveState(t);break;case"delete":this._onDeleteRule(t.data)}}},{key:"_onToggleRuleActiveState",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,t.components["action-menu-cell"].spinner(),e.next=4,this._postDataProvider("toggle-auto-conversion-rule-active-state",{params:[n.ruleId,!n.isActive]});case 4:n=e.sent,t.data=n.data,this._refreshAutoConversionRuleRow(t),t.components["action-menu-cell"].spinner(!1);case 6:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onDeleteRule",value:function(t){var n=this;n2.de.component.DeleteMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["delete-auto-conversion-rule"]}).show({names:[t.name],type:"auto-conversion rule",listeners:{submit:function(e){return n._onDeleteMessageBoxSubmit(t.ruleId,e)},scope:this}})}},{key:"_onDeleteMessageBoxSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("delete-auto-conversion-rule",{params:[t]});case 2:i=e.sent,this.model=i.data,n.hide();case 4:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_insertCreateRuleButton",value:function(){return this._insert(new n2.ui.component.Button({id:"create-auto-conversion-rule-button",cls:"slds-m-top_small",theme:n2.ui.component.button.Theme.LINK,icon:n2.ui.enum.Icon.ADD,text:"Add Rule",listeners:{click:this._onCreateRuleButtonClick,scope:this}}))}},{key:"_onCreateRuleButtonClick",value:function(){this._openAutoConversionRuleModal()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=0<n.length&&void 0!==n[0]?n[0]:{}).force,t.silent,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,n);case 3:return e.next=5,this._fetchDataProvider("get-auto-conversion-action-options");case 5:return e.t0=e.sent,e.abrupt("return",{autoConversionActionOptions:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.autoConversionActionOptions;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._autoConversionActionLabelMap=this._buildAutoConversionActionLabelMap(e.response)}},{key:"_buildAutoConversionActionLabelMap",value:function(e){e=e.map(function(e){return[e.value,e.label]});return Object.fromEntries(e)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._autoConversionRules=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.autoConversionRulesMenu,i=e.autoConversionRulesDataTable,i=void 0!==i&&i,e=e.createRuleButton,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshAutoConversionRulesMenu(),(t||i)&&this._refreshAutoConversionRulesDataTable(),(t||e)&&this._refreshCreateRuleButton()}},{key:"_refreshAutoConversionRulesMenu",value:function(){this.autoConversionRulesMenu.disabled=this._autoConversionRules.length<=2}},{key:"_refreshAutoConversionRulesDataTable",value:function(){this.autoConversionRulesDataTable.data=this._autoConversionRules,this.autoConversionRulesDataTable.headerRow.show(),this._refreshAutoConversionRuleRows()}},{key:"_refreshAutoConversionRuleRows",value:function(){var t=this;this.autoConversionRulesDataTable.forEachRow(function(e){return t._refreshAutoConversionRuleRow(e)})}},{key:"_refreshAutoConversionRuleRow",value:function(e){var t=e.data,n=e.components["action-menu-cell"].components["action-menu"],i=n.components["toggle-active-state"];t.isDefault?(e.cls="n2_default-rule",n.components.delete.destroy(),i.destroy()):(i.label=t.isActive?"Deactivate":"Activate",e.cls=t.isActive?"":"n2_inactive")}},{key:"_refreshCreateRuleButton",value:function(){var e=this._autoConversionRules.length,t=10===e;this.createAutoConversionRuleButton.hidden=t,this.createAutoConversionRuleButton.disabled=t,this.createAutoConversionRuleButton.text=0===e?"Add Default Rule":"Add Rule"}},{key:"_openAutoConversionRuleModal",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).rule,e=void 0===e?null:e,t=!n2.isNull(e)&&e.isDefault,n=n2.isNull(e)?null:e.ruleId;n2.de.page.classifier.autoConversionSettings.autoConversionRules.RuleModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({rule:e,isDefaultRule:n2.isEmpty(this._autoConversionRules)||t,ruleNames:this._getRuleNames({excludedRuleId:n}),listeners:{saved:this._onRuleSaved,scope:this}})}},{key:"_onRuleSaved",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,i){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.hide();case 2:this.model=n.rules;case 3:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"_getRuleNames",value:function(e){var t=e.excludedRuleId,e=this._autoConversionRules;return(e=n2.isNull(t)?e:e.filter(function(e){return t!==e.ruleId})).map(function(e){return e.name})}}]),a}(),n2.de.page.classifier.backfill.BackfillWizard=function(){_inherits(r,n2.de.component.Wizard);var e,t,n,i,s,a,o=_createSuper(r);function r(){return _classCallCheck(this,r),o.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).apply(this,arguments),this.id="backfill-wizard",this._componentCls="".concat(this._componentCls," n2-de-backfill-wizard"),this.dataProviders=["perform-backfill"],this._lazyLoad=!0,this._movingToNextStage=!1,this._header="Backfill Records",this._ALL_STAGES={SELECT_BACKFILL_OBJECT:{id:"select-backfill-object",label:"Select backfill object"},SELECT_BACKFILL_TYPE:{id:"select-backfill-type",label:"Select backfill type"},BACKFILL_AUTO_CONVERSION_MESSAGE:{id:"backfill-auto-conversion-message",label:"Auto-Conversion warning"},SELECT_BACKFILL_CRITERIA:{id:"select-backfill-criteria",label:"Select backfill criteria"},CONFIRM_BACKFILL_CRITERIA:{id:"confirm-backfill-criteria",label:"Confirm backfill criteria"},BACKFILL_SUMMARY:{id:"backfill-summary",label:"Backfill summary"}},this._stages=[this._ALL_STAGES.SELECT_BACKFILL_OBJECT,this._ALL_STAGES.SELECT_BACKFILL_TYPE,this._ALL_STAGES.SELECT_BACKFILL_CRITERIA,this._ALL_STAGES.CONFIRM_BACKFILL_CRITERIA,this._ALL_STAGES.BACKFILL_SUMMARY],this._buttons={submit:{text:"Finish"}},this._currentStageId=null,this._backfillSettingsModel=null,this._CLASSIFICATION_MODEL_FIELD_VALUE_MAP=[["territoryMatching","Territory"],["leadMatching","Match"],["autoConversion","AutoConversion"]],this._backfillObjectOptions=null,this._backfillClassificationOptions=null,this._backfillCriteriaOptions=null,this._backfillFieldOptions=null,this._backfillRecordCount=null}},{key:"selectBackfillObject",get:function(){return this._components["select-backfill-object"]}},{key:"selectBackfillType",get:function(){return this._components["select-backfill-type"]}},{key:"backfillAutoConversionMessage",get:function(){return this._components["backfill-auto-conversion-message"]}},{key:"selectBackfillCriteria",get:function(){return this._components["select-backfill-criteria"]}},{key:"confirmBackfillCriteria",get:function(){return this._components["confirm-backfill-criteria"]}},{key:"backfillSummary",get:function(){return this._components["backfill-summary"]}},{key:"currentStage",get:function(){return n2.isNull(this._currentStageId)?null:this._components[this._currentStageId]}},{key:"_onDefined",value:function(){var e=this;_get(_getPrototypeOf(r.prototype),"_onDefined",this).apply(this,arguments),n2.DataProviderManager.getInstance().listen("error",function(){return e._onServerError()},this),this._insertSelectBackfillObject(),this._insertSelectBackfillType(),this._insertBackfillAutoConversionWarningMessage(),this._insertSelectBackfillCriteria(),this._insertConfirmBackfillCriteria(),this._insertBackfillSummary()}},{key:"_onServerError",value:function(){this.spinner(!1)}},{key:"_insertSelectBackfillObject",value:function(){return this._insert(new n2.ui.component.field.RadioGroup({id:this._ALL_STAGES.SELECT_BACKFILL_OBJECT.id,mixins:[n2.mixin.DataDriven],label:"Select which of the configured objects to backfill records for",options:[],required:!0,value:{bindPath:".objectType"},listeners:{change:this._onSelectBackfillObjectChange,scope:this}}))}},{key:"_onSelectBackfillObjectChange",value:function(e){this._backfillSettingsModel.set({filters:[],logic:"",logicEnabled:!0},{key:"backfillFilters"}),this._refresh({confirmBackfillCriteria:!0})}},{key:"_insertSelectBackfillType",value:function(){return this._insert(new n2.ui.component.field.CheckboxGroup({id:this._ALL_STAGES.SELECT_BACKFILL_TYPE.id,label:"Select which type of classification you'd like to perform",options:[],required:!0,hidden:!0,sort:!1,listeners:{change:this._onSelectBackfillTypeChange,scope:this}}))}},{key:"_onSelectBackfillTypeChange",value:function(e){var n=this,i=e.value;this._CLASSIFICATION_MODEL_FIELD_VALUE_MAP.forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];n._backfillSettingsModel.set(i.includes(e),{key:t})}),this._refresh({footer:!0})}},{key:"_insertBackfillAutoConversionWarningMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:this._ALL_STAGES.BACKFILL_AUTO_CONVERSION_MESSAGE.id,hidden:!0,template:'<div id="{{id}}" class="n2_auto-conversion-message slds-grid slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_small slds-m-right_small slds-m-top_xx-small slds-col slds-no-flex"}),'\n                <div class="slds-col">\n                    <p>\n                        Please use caution when using auto-conversion backfill. Auto-conversion and deduplication are non-reversible processes. Please ensure that your auto-conversion and backfill filters restrict changes to only those records you wish to update.\n                    </p>\n                </div>\n            </div>')}))}},{key:"_insertSelectBackfillCriteria",value:function(){return this._insert(new n2.ui.component.field.RadioGroup({id:this._ALL_STAGES.SELECT_BACKFILL_CRITERIA.id,label:"Select one of the predefined criteria to start narrowing down which records to backfill, you can fine-tune your criteria on the next step",options:[],required:!0,hidden:!0,sort:!1,listeners:{change:this._onSelectBackfillCriteriaChange,scope:this}}))}},{key:"_onSelectBackfillCriteriaChange",value:function(e){this._refresh({footer:!0})}},{key:"_insertConfirmBackfillCriteria",value:function(){var n,s=this;return this._insert(new n2.ui.component.field.LogicFilter({id:this._ALL_STAGES.CONFIRM_BACKFILL_CRITERIA.id,mixins:[n2.mixin.DataDriven],cls:"n2_confirm-backfill-criteria",hidden:!0,label:"Update the predefined criteria based on your selection in the previous step to select which records to backfill",max:5,loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),i=n.get("name"),e.next=4,s._fetchDataProvider("get-picklist-field-options",{params:[s.selectBackfillObject.value,i],requestId:"Lead.".concat(i),force:!1,silent:!0});case 4:i=e.sent,t.options=i.response,t.spinner(!1);case 6:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),value:{bindPath:".backfillFilters"}}))}},{key:"_insertBackfillSummary",value:function(){return this._insert(new n2.de.page.classifier.backfill.backfillWizard.Summary({id:this._ALL_STAGES.BACKFILL_SUMMARY.id,mixins:[n2.mixin.DataDriven],hidden:!0}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.backfillObjectOptions,t=void 0===t?null:t;e.currentStageId,e.listeners;this._backfillSettingsModel=this._createBackfillSettingsModel(),this._backfillObjectOptions=t,_get(_getPrototypeOf(r.prototype),"show",this).apply(this,arguments)}},{key:"_createBackfillSettingsModel",value:function(){return new n2.dataProvider.Model({value:{objectType:"",backfillFilters:{filters:[],logicEnabled:!0,logic:""},territoryMatching:!1,leadMatching:!1,autoConversion:!1,sendEmail:!1}})}},{key:"_validateStage",value:function(){return n2.isFunction(this.currentStage.validate)?this.currentStage.validate():_get(_getPrototypeOf(r.prototype),"_validateStage",this).call(this)}},{key:"_moveToNextStage",value:function(){this._movingToNextStage=!0,_get(_getPrototypeOf(r.prototype),"_moveToNextStage",this).call(this),this._movingToNextStage=!1}},{key:"_onStageChange",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(r.prototype),"_onStageChange",this).call(this,t),n2.isNull(this.currentStage)||this.currentStage.hide(),this._currentStageId=t.target.currentStageId,e.t0=this._movingToNextStage,e.t0)return e.next=7,this._loadCurrentStage();e.next=7;break;case 7:this._refresh(_defineProperty({},this._getCurrentStageRefreshId(),!0));case 8:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"_loadCurrentStage",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._isCurrentStage(this._ALL_STAGES.SELECT_BACKFILL_TYPE)?this._loadBackFillClassificationOptions():this._isCurrentStage(this._ALL_STAGES.SELECT_BACKFILL_CRITERIA)?this._loadBackfillCriteriaOptions():this._isCurrentStage(this._ALL_STAGES.CONFIRM_BACKFILL_CRITERIA)?this._loadBackfillFilters():this._isCurrentStage(this._ALL_STAGES.BACKFILL_SUMMARY)?this._loadBackfillCount():void 0);case 1:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"_loadBackFillClassificationOptions",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-backfill-classification-options",{params:[this.selectBackfillObject.value],force:!0,silent:!0});case 2:return t=e.sent,e.abrupt("return",(this._backfillClassificationOptions=t.response,t));case 4:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_loadBackfillCriteriaOptions",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-backfill-criteria-options",{force:!1,silent:!0});case 2:return t=e.sent,e.abrupt("return",(this._backfillCriteriaOptions=t.response,t));case 4:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_loadBackfillFilters",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectBackfillObject.value,n=this.selectBackfillCriteria.value,e.next=4,Promise.all([this._loadDataProvider("get-backfill-field-options",{params:[t],force:!1,silent:!0,requestId:t}),this._loadDataProvider("get-backfill-filters",{params:[n],force:!1,silent:!0,requestId:n})]);case 4:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",(this._backfillFieldOptions=i.response,this._backfillSettingsModel.set(s.response,{key:"backfillFilters"}),[i,s]));case 9:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_loadBackfillCount",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-backfill-record-count",{params:[this.selectBackfillObject.value,this.confirmBackfillCriteria.value],force:!0,silent:!0});case 2:return t=e.sent,e.abrupt("return",(this._backfillRecordCount=t.response,t));case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onWizardSubmit",value:function(){_get(_getPrototypeOf(r.prototype),"_onWizardSubmit",this).call(this),this._postDataProvider("perform-backfill",{params:[this._backfillSettingsModel.json]})}},{key:"_onSaving",value:function(e){_get(_getPrototypeOf(r.prototype),"_onSaving",this).call(this,e),this.backfillSummary.sendEmailField.disabled=!0,this.footer.backButton.disable()}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(r.prototype),"_onSaved",this).call(this,e,t),this.backfillSummary.sendEmailField.disabled=!1,this.footer.backButton.enable()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.selectBackfillObject,i=e.selectBackfillType,i=void 0!==i&&i,s=e.backfillAutoConversionMessage,s=void 0!==s&&s,a=e.selectBackfillCriteria,a=void 0!==a&&a,o=e.confirmBackfillCriteria,o=void 0!==o&&o,r=e.backfillSummary,r=void 0!==r&&r,e=e.footer,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshSelectBackfillObject(),(t||i)&&this._refreshSelectBackfillType(),(t||s)&&this._refreshBackfillAutoConversionMessage(),(t||a)&&this._refreshSelectBackfillCriteria(),(t||o)&&this._refreshConfirmBackfillCriteria(),(t||r)&&this._refreshBackfillSummary(),(t||e)&&this._refreshFooter()}},{key:"_refreshSelectBackfillObject",value:function(){this._refreshStage(this._ALL_STAGES.SELECT_BACKFILL_OBJECT,"Select Object"),this.selectBackfillObject.options=this._backfillObjectOptions,this.selectBackfillObject.model=this._backfillSettingsModel}},{key:"_refreshSelectBackfillType",value:function(){this._refreshStage(this._ALL_STAGES.SELECT_BACKFILL_TYPE,"Select Classification"),this.selectBackfillType.options=this._backfillClassificationOptions||[],this.selectBackfillType.value={value:this._getClassificationFieldValueFromModel(),silent:!0,validate:!1}}},{key:"_refreshBackfillAutoConversionMessage",value:function(){this._refreshStage(this._ALL_STAGES.BACKFILL_AUTO_CONVERSION_MESSAGE,"Auto-Conversion Warning")}},{key:"_refreshSelectBackfillCriteria",value:function(){var t=this;this._refreshStage(this._ALL_STAGES.SELECT_BACKFILL_CRITERIA,"Select Criteria"),this.selectBackfillCriteria.options=this._backfillCriteriaOptions.filter(function(e){return"unknown-territories"!==e.value||t.selectBackfillType.value.includes("Territory")})}},{key:"_refreshConfirmBackfillCriteria",value:function(){this._refreshStage(this._ALL_STAGES.CONFIRM_BACKFILL_CRITERIA,"Confirm Criteria"),this.confirmBackfillCriteria.fieldOptions=n2.de.data.Adapters.backfillFilterFieldOptions(this._backfillFieldOptions||[]),this.confirmBackfillCriteria.model=this._backfillSettingsModel}},{key:"_refreshBackfillSummary",value:function(){this._refreshStage(this._ALL_STAGES.BACKFILL_SUMMARY,"Summary"),this.backfillSummary.recordCount=this._backfillRecordCount,this.backfillSummary.model=this._backfillSettingsModel}},{key:"_refreshStage",value:function(e,t){if(this._isCurrentStage(e))return this.header="Backfill Records > ".concat(t),this._components[e.id].show();this._components[e.id].hide()}},{key:"_refreshFooter",value:function(){1===this._stages.length?this.footer.submitButton.disable():this.footer.submitButton.enable(),this.footer.stages=this._getStages()}},{key:"_getClassificationFieldValueFromModel",value:function(){var n=this;return this._CLASSIFICATION_MODEL_FIELD_VALUE_MAP.filter(function(e){var e=_slicedToArray(e,2),t=e[0];e[1];return n._backfillSettingsModel.get(t)}).map(function(e){e=_slicedToArray(e,2);e[0];return e[1]})}},{key:"_getStages",value:function(){var e=n2.clone(this._stages);return"all"===this.selectBackfillCriteria.value&&e.splice(3,1),this.selectBackfillType.value.includes("AutoConversion")&&e.splice(2,0,this._ALL_STAGES.BACKFILL_AUTO_CONVERSION_MESSAGE),e}},{key:"_isCurrentStage",value:function(e){return this._currentStageId===e.id}},{key:"_getCurrentStageRefreshId",value:function(){return this._currentStageId.replace(/-[a-z]/g,function(e,t){return e.replace("-","").toUpperCase()})}}]),r}(),n2.de.page.console.applicationMonitoring.AdditionalInfoCard=function(){_inherits(s,n2.de.component.Card);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-console-additional-info-card"),this._mixins=[n2.mixin.DataDriven],this._heading="Additional Info",this._content=null,this._contentTemplate='{{#content}}\n            <h3>Licenses</h3>\n            <table class="n2_console-details">\n                <tr>\n                    <th scope="row">Licenses used</th>\n                    <td>\n                        <a href="javascript:void(0)" class="n2_licenses-used n2_mobile-app-hide">{{content.usedLicenses}}{{^content.isSandbox}} / {{content.maxLicenses}}{{/content.isSandbox}}</a>\n                        <span class="n2_main-app-hide">{{content.usedLicenses}}{{^content.isSandbox}} / {{content.maxLicenses}}{{/content.isSandbox}}</span>\n                    </td>\n                </tr>\n                {{#content.expiryDate}}\n                    <tr>\n                        <th scope="row">Expiry date</th>\n                        <td>{{content.expiryDate}}</td>\n                    </tr>\n                {{/content.expiryDate}}\n                 <tr>\n                        <th scope="row">DE version</th>\n                        <td>{{content.deVersionNumber}} ({{content.deVersionName}})</td>\n                 </tr>\n            </table>\n            <div class="n2_mobile-app-hide">\n                {{#content.archivingEnabled}}\n                    <h3>Archiving</h3>\n                    <p>The archiving logs are now found on the <a href="javascript:void(0)" class="n2_distribution-logs-tab">Distribution Logs tab</a></p>\n                {{/content.archivingEnabled}}\n            </div>\n        {{/content}}'}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(s.prototype),"_prepareDOM",this).call(this),this._bindContentClick()}},{key:"_getTemplateContent",value:function(){return n2.isEmpty(this._content)||(n2.isEmpty(this._content.expiryDate)||(this._content.expiryDate=this._formatDate(this._content.expiryDate)),this._content.isSandbox=n2.de.ApplicationContext.getInstance().isSandbox),this._content}},{key:"_refreshContent",value:function(){_get(_getPrototypeOf(s.prototype),"_refreshContent",this).call(this),this._bindContentClick()}},{key:"_bindContentClick",value:function(){this.element("body").listen("click",function(e){e.target.classList.contains("n2_licenses-used")&&n2.de.page.Navigation.getInstance().open("Settings_LicensedUsers"),e.target.classList.contains("n2_distribution-logs-tab")&&n2.de.page.Navigation.getInstance().open("Logs_ArchiveLogList"),e.preventDefault()})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-app-status",{force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{appStatus:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.appStatus;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.content=e.response}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}}]),s}(),n2.de.page.console.component.Card=function(){_inherits(t,n2.de.component.Card);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="".concat(this._componentCls," n2-de-console-card"),this._headingContentTemplate='<a href="javascript:void(0)" class="n2_mobile-app-hide">{{heading}}</a>\n            <span class="n2_main-app-hide">{{heading}}</span>'}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._bindHeadingClick(),this._bindContentClick()}},{key:"_refreshHeading",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshHeading",this).call(this),this._bindHeadingClick()}},{key:"_refreshContent",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshContent",this).call(this),this._bindContentClick()}},{key:"_bindHeadingClick",value:function(){var t=this;this.element("heading").listen("click",function(e){"A"===e.target.tagName&&(t._navigateToPage(),e.preventDefault())})}},{key:"_navigateToPage",value:function(){}},{key:"_bindContentClick",value:function(){}},{key:"_getIconConfig",value:function(e){switch(e){case"Active":return{icon:n2.de.enum.Icon.SUCCESS,cls:"n2_success",title:"Active"};case"Active with Warning":return{icon:n2.de.enum.Icon.WARNING,cls:"n2_warning",title:"Active with warnings"};case"Inactive":return{icon:n2.de.enum.Icon.WAITS,cls:"n2_neutral",title:"Inactive"};case"Errored":return{icon:n2.ui.enum.Icon.ERROR,cls:"n2_error",title:"Errored"}}}},{key:"_getTemplateContent",value:function(){return n2.isEmpty(this._content)||n2.isEmpty(this._content.jobStatus)||(this._content.isRunning=this._getIsRunning(this._content.jobStatus.status),!this._content.isRunning)||n2.isUndefined(this._content.jobStatus.startDatetime)||n2.isNull(this._content.jobStatus.startDatetime)||(this._content.startDate=this._formatDate(this._content.jobStatus.startDatetime)),this._content}},{key:"_getIsRunning",value:function(e){return"Active with Warning"===e||"Active"===e}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}}]),t}(),n2.de.page.console.applicationMonitoring.ClassifierCard=function(){_inherits(s,n2.de.page.console.component.Card);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-console-classifier-card"),this._heading="Classifier",this._content=null,this._contentTemplate='{{#content}}\n            {{#content.isClassifierConfigured}}\n                <h3>Status</h3>\n                {{^content.isRunning}}\n                    <p>Classifier is not running{{#content.jobStatus.errorMessage}}, {{content.jobStatus.errorMessage}}{{/content.jobStatus.errorMessage}}</p>\n                {{/content.isRunning}}\n                {{#content.isRunning}}\n                    <p>Classifier is running.</p>\n                    {{#content.jobStatus.startedByName}}\n                        <table class="n2_console-details">\n                            <tr>\n                                <th scope="row">Initiation</th>\n                                <td>Classifier was started by {{content.jobStatus.startedByName}}{{#content.startDate}} on {{content.startDate}}{{/content.startDate}}</td>\n                            </tr>\n                        </table>\n                    {{/content.jobStatus.startedByName}}\n                    {{#content.jobStatus.runningUserMissingLicense}}\n                        <h3>Warning</h3>\n                        <p>Missing license on running user ({{content.jobStatus.startedByName}})</p>\n                    {{/content.jobStatus.runningUserMissingLicense}}\n                {{/content.isRunning}}\n            {{/content.isClassifierConfigured}}\n            {{^content.isClassifierConfigured}}\n                <h3 class="slds-text-align_center">Configuration</h3>\n                <p class="slds-text-align_center">The Classifier is used to simplify your distribution logic by stamping your records with territory and matching information before assignment. \n                <span class="n2_mobile-app-hide">Click <a href="javascript:void(0)" class="n2_get-started">here</a> to get started</span></p>\n            {{/content.isClassifierConfigured}}\n        {{/content}}'}},{key:"_navigateToPage",value:function(){n2.de.page.Navigation.getInstance().open("ClsTerritoryMapList")}},{key:"_bindContentClick",value:function(){this.element("body").listen("click",function(e){e.target.classList.contains("n2_get-started")&&n2.de.page.Navigation.getInstance().open("ClsTerritoryMapList"),e.preventDefault()})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-classifier-status",{force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{classifierStatus:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.classifierStatus;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._content=e.response,this._content.isClassifierConfigured&&(this._icon=this._getIconConfig(this._content.jobStatus.status)),this._refresh()}}]),s}(),n2.de.page.console.applicationMonitoring.DistributionEngineCard=function(){_inherits(s,n2.de.page.console.component.Card);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-console-distribution-engine-card"),this._heading="Distribution Engine",this._content=null,this._contentTemplate='{{#content}}\n            <h3>Status</h3>\n            {{^content.isRunning}}\n                <p>Distribution Engine is not running{{#content.jobStatus.errorMessage}}, {{content.jobStatus.errorMessage}}{{/content.jobStatus.errorMessage}}</p>\n            {{/content.isRunning}}\n            {{#content.isRunning}}\n                <p>Distribution Engine is running.</p>\n                <table class="n2_console-details">\n                    {{#content.jobStatus.startedByName}}\n                        <tr>\n                            <th scope="row">Initiation</th>\n                            <td>DE was started by {{content.jobStatus.startedByName}}{{#content.startDate}} on {{content.startDate}}{{/content.startDate}}</td>\n                        </tr>\n                    {{/content.jobStatus.startedByName}}\n                    <tr>\n                        <th scope="row">Processing mode</th>\n                        <td>{{content.processingMode}}</td>\n                    </tr>\n                    <tr>\n                        <th scope="row">Frequency</th>\n                        <td>{{content.formattedFrequency}}</td>\n                    </tr>\n                </table>\n                {{#content.jobStatus.runningUserMissingLicense}}\n                    <h3>Warning</h3>\n                    <p>Missing license on running user ({{content.jobStatus.startedByName}})</p>\n                {{/content.jobStatus.runningUserMissingLicense}}\n            {{/content.isRunning}}\n            <h3>Errors</h3>\n            <p>\n                <span class="n2_mobile-app-hide"><a href="javascript:void(0)" class="n2_distribution-errors">{{content.assignmentErrorsInLastDay}} errors</a> </span>\n                <strong class="n2_main-app-hide">{{content.assignmentErrorsInLastDay}} errors </strong>\n                in the last 24 hours\n            </p>\n        {{/content}}'}},{key:"_navigateToPage",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}},{key:"_bindContentClick",value:function(){this.element("body").listen("click",function(e){e.target.classList.contains("n2_distribution-errors")&&n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","status=inError"),e.preventDefault()})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-distribution-status",{force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{distributionStatus:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.distributionStatus;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._content=e.response,this._icon=this._getIconConfig(this._content.jobStatus.status),this._refresh()}},{key:"_getTemplateContent",value:function(){var e=_get(_getPrototypeOf(s.prototype),"_getTemplateContent",this).call(this);return n2.isEmpty(e)||(e.formattedFrequency=this._formatFrequency(e.frequency)),e}},{key:"_formatFrequency",value:function(e){switch(e){case"0.0":return"As fast as possible";case"5.0":return"Every 5 minutes";case"10.0":return"Every 10 minutes";case"15.0":return"Every 15 minutes";case"20.0":return"Every 20 minutes";case"30.0":return"Every 30 minutes";case"60.0":return"Hourly";case"120.0":return"Every 2 hours";case"240.0":return"Every 4 hours";case"360.0":return"Every 6 hours";case"720.0":return"Every 12 hours";case"1440.0":return"Every 24 hours"}}}]),s}(),n2.de.page.console.applicationMonitoring.HealthCheckerCard=function(){_inherits(s,n2.de.page.console.component.Card);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-console-health-checker-card"),this._heading="Health Checker",this._content=null,this._contentTemplate='{{#content}}\n            <h3>Status</h3>\n            {{^content.isRunning}}\n                <p>Health Checker is not running{{#content.jobStatus.errorMessage}}, {{content.jobStatus.errorMessage}}{{/content.jobStatus.errorMessage}}</p>\n            {{/content.isRunning}}\n            {{#content.isRunning}}\n                <p>Health Checker is running.</p>\n                <table class="n2_console-details">\n                    {{#content.jobStatus.startedByName}}\n                        <tr>\n                            <th scope="row">Initiation</th>\n                            <td>Health Checker was started by {{content.jobStatus.startedByName}}{{#content.startDate}} on {{content.startDate}}{{/content.startDate}}</td>\n                        </tr>\n                    {{/content.jobStatus.startedByName}}\n                    <tr>\n                        <th scope="row">Frequency</th>\n                        <td>{{content.formattedFrequency}}</td>\n                    </tr>\n                </table>\n                {{#content.jobStatus.runningUserMissingLicense}}\n                    <h3>Warning</h3>\n                    <p>Missing license on running user ({{content.jobStatus.startedByName}})</p>\n                {{/content.jobStatus.runningUserMissingLicense}}\n            {{/content.isRunning}}\n            <h3>Restarts</h3>\n            <p>\n                <span class="n2_mobile-app-hide"><a href="javascript:void(0)" class="n2_health-checker-errors">{{content.restartsInLastDay}} restarts</a> </span>\n                <strong class="n2_main-app-hide">{{content.restartsInLastDay}} restarts </strong>\n                in the last 24 hours\n            </p>\n        {{/content}}'}},{key:"_navigateToPage",value:function(){n2.de.page.Navigation.getInstance().open("Settings_AdvancedSettings")}},{key:"_bindContentClick",value:function(){this.element("body").listen("click",function(e){e.target.classList.contains("n2_health-checker-errors")&&n2.de.page.Navigation.getInstance().open("Logs_SchedulerLogList","logtype=hc&status=error"),e.preventDefault()})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-health-checker-status",{force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{healthCheckerStatus:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.healthCheckerStatus;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._content=e.response,this._icon=this._getIconConfig(this._content.jobStatus.status),this._refresh()}},{key:"_getTemplateContent",value:function(){var e=_get(_getPrototypeOf(s.prototype),"_getTemplateContent",this).call(this);return n2.isEmpty(e)||(e.formattedFrequency=this._formatFrequency(e.frequency)),e}},{key:"_formatFrequency",value:function(e){switch(e){case"15":return"Every 15 minutes";case"30":return"Every 30 minutes"}return"Hourly"}}]),s}(),n2.de.page.console.applicationMonitoring.ObjectSyncCard=function(){_inherits(s,n2.de.page.console.component.Card);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-console-object-sync-card"),this._heading="Object Sync",this._content=null,this._contentTemplate='{{#content}}\n            {{#content.isObjectSyncConfigured}}\n                <h3>Status</h3>\n                {{^content.isRunning}}\n                    <p>Object Sync is not running{{#content.jobStatus.errorMessage}}, {{content.jobStatus.errorMessage}}{{/content.jobStatus.errorMessage}}</p>\n                {{/content.isRunning}}\n                {{#content.isRunning}}\n                    <p>Object Sync is running.</p>\n                    {{#content.jobStatus.startedByName}}\n                        <table class="n2_console-details">\n                            <tr>\n                                <th scope="row">Initiation</th>\n                                <td>Object Sync was started by {{content.jobStatus.startedByName}}{{#content.startDate}} on {{content.startDate}}{{/content.startDate}}</td>\n                            </tr>\n                        </table>\n                    {{/content.jobStatus.startedByName}}\n                    {{#content.jobStatus.runningUserMissingLicense}}\n                        <h3>Warning</h3>\n                        <p>Missing license on running user ({{content.jobStatus.startedByName}})</p>\n                    {{/content.jobStatus.runningUserMissingLicense}}\n                {{/content.isRunning}}\n            {{/content.isObjectSyncConfigured}}\n            {{^content.isObjectSyncConfigured}}\n                <h3 class="slds-text-align_center">Configuration</h3>\n                <p class="slds-text-align_center">Object Sync allows Distribution Engine to update the owner of child objects to match their parents when the parent object is assigned. \n                <span class="n2_mobile-app-hide">Click <a href="javascript:void(0)" class="n2_get-started">here</a> to get started</p></span>\n            {{/content.isObjectSyncConfigured}}\n        {{/content}}'}},{key:"_navigateToPage",value:function(){n2.de.page.Navigation.getInstance().open("ObjectSync_Actions")}},{key:"_bindContentClick",value:function(){this.element("body").listen("click",function(e){e.target.classList.contains("n2_get-started")&&n2.de.page.Navigation.getInstance().open("ObjectSync_Actions"),e.preventDefault()})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-object-sync-status",{force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{objectSyncStatus:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.objectSyncStatus;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._content=e.response,this._content.isObjectSyncConfigured&&(this._icon=this._getIconConfig(this._content.jobStatus.status)),this._refresh()}}]),s}(),n2.de.page.console.calendar.CalendarRecordList=function(){_inherits(t,n2.de.component.AbstractRecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-calendar-record-list"),this._filterOptionsData=null,this._REFRESH={filterOptionsData:["toolbar"]}}},{key:"filterOptionsData",set:function(e){this._setProperty("filterOptionsData",e,{sync:!1})}},{key:"availabilityCalendar",get:function(){return this._dataTable}},{key:"toolbar",get:function(){return this._toolbar}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.console.calendar.calendarRecordList.Toolbar({id:"calendar-toolbar"}),this._dataTable=new n2.de.component.AvailabilityCalendar({id:"availability-calendar",currentDate:n2.de.util.Date.convertDateToTimeZone(new Date),listeners:{click:this._handleTableClick,scope:this}})}},{key:"_insertFooter",value:function(){return null}},{key:"_handleClick",value:function(e){this.fire("click",e)}},{key:"_handleChange",value:function(e){"team-filter"!==e.target.id&&this._dataTable.filter({userIds:this._toolbar.teamMemberFilter.value,tagIds:this._toolbar.tagFilter.value}),_get(_getPrototypeOf(t.prototype),"_handleChange",this).apply(this,arguments)}},{key:"loadAvailabilityData",value:function(e,t){t=t.weekNumber;this.availabilityCalendar.loadAvailabilityData(e,{weekNumber:t})}},{key:"_refreshToolbar",value:function(){this._toolbar.filterOptionsData=this._filterOptionsData}},{key:"_refreshFooter",value:function(){}}]),t}(),n2.de.page.console.sourceList.DataTable=function(){_inherits(t,n2.de.component.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven,n2.de.mixins.LimitLoads],this._mixins),this._componentCls="n2-source-list-data-table",this._sortBy={column:1,direction:"asc"},this._emptyState={type:n2.de.page.console.sourceList.dataTable.EmptyState}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments)}},{key:"syncCellData",value:function(){this._data=this.data}},{key:"_generateColumnDefinitions",value:function(){return[{header:"Team",sortable:!0,sort:{adapter:function(e){return"".concat(e.teamName," ").concat(e.executionOrder)}},cell:{cellTemplate:"",cls:"slds-truncate",components:[{type:n2.de.page.console.sourceList.Link,id:"team-link",mixins:[n2.mixin.DataDriven],text:{bindPath:".teamName"},title:{bindPath:".teamName"},teamId:{bindPath:".teamId"}}]}},{header:{data:"Order",cls:"slds-text-align_right"},sortable:!0,bindPath:"executionOrder",cls:"n2_order",cell:{cls:"slds-text-align_right"}},{header:"Distributor",cell:{cellTemplate:"",cls:"slds-truncate",components:[{type:n2.de.page.console.sourceList.Link,id:"distributor-link",mixins:[n2.mixin.DataDriven],text:{bindPath:".distributorName"},title:{bindPath:".distributorName"},distributorId:{bindPath:".distributorId"},teamId:{bindPath:".teamId"}}]}},{header:"Object",sortable:!0,sort:{adapter:function(e){return"".concat(e.objectName," ").concat(e.executionOrder)}},bindPath:"objectName"},{header:"Source",sortable:!0,sort:{adapter:function(e){return"".concat(e.sourceName," ").concat(e.executionOrder)}},bindPath:"sourceName",cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}',cls:"slds-truncate"}},{header:{data:"Available",cls:"slds-text-align_right"},cls:"n2_available-count",cell:{id:"available-cell",cls:"slds-text-align_right",type:n2.de.page.console.sourceList.dataTable.AvailableCell}},{header:{data:"On Hold",cls:"slds-text-align_right"},cls:"n2_on-hold-count",cell:{id:"on-hold-cell",cls:"slds-text-align_right",type:n2.de.page.console.sourceList.dataTable.onHoldCell}},{cls:"n2_menu",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"source-list-menu",options:[{id:"test",label:"Test"},{id:"recent",label:"Recent"},{id:"preview",label:"Preview"}],listeners:{select:function(e,t){switch(e.id){case"preview":return n._openPreviewDistributor(t.parent.data);case"recent":return n._openRecentDistributions(t.parent.data);case"test":return n._openTestTool(t.parent.data)}}}}}},{key:"_openPreviewDistributor",value:function(e){n2.de.component.distributors.PreviewToolModal.getInstance({renderTo:this._dom,dataProviders:["preview-available-objects-for-distributor"]}).show({distributorName:e.distributorName}),this._loadPreviewData(e.distributorId)}},{key:"_loadPreviewData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,t=t.force;return this._fetchDataProvider("preview-available-objects-for-distributor",{params:[e],silent:void 0!==n&&n,force:void 0===t||t})}},{key:"_openRecentDistributions",value:function(e){var t=this,n=e.distributorId;n2.de.component.distributors.RecentDistributionsModal.getInstance({renderTo:this._dom,dataProviders:["get-recent-distribution-logs"]}).show({distributorName:e.distributorName,listeners:{change:function(e){return t._loadRecentDistributions({distributorId:n,logDuration:e.data.logDuration,recordName:e.data.recordName})}}}),this._loadRecentDistributions({distributorId:n})}},{key:"_loadRecentDistributions",value:function(e){var t=e.distributorId,n=e.logDuration,n=void 0===n?"":n,i=e.recordName,i=void 0===i?"":i,s=e.force,e=e.silent;return this._limitLoads("get-recent-distribution-logs",{params:[t,n,i],force:void 0!==s&&s,silent:void 0!==e&&e,requestId:"".concat(t,"-").concat(n,"-").concat(i)})}},{key:"_openTestTool",value:function(t){this.spinner();var n=this,i=0===(i=n2.de.ApplicationContext.getInstance().namespace).length?"c":i.replace("__","");$Lightning.use(i+":testtoolapp",function(){var e={distributorId:t.distributorId,distributorName:t.distributorName,showTestModal:!0,notFromRecord:!0,fromTeam:!1,fromDistributor:!0};$Lightning.createComponent(i+":deTestToolComponent",e,n.parent.domId,function(e){n.spinner(!1)})})}}]),t}(),n2.de.page.console.sourceList.Link=function(){_inherits(t,n2.de.component.Link);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["teamId"]),this.teamId=null,this.distributorId=null}},{key:"_onClick",value:function(e){if(e.stopPropagation(),n2.isNull(this.distributorId))return n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(this.teamId));n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(this.distributorId,"&teamId=").concat(this.teamId))}}]),t}(),n2.de.page.console.todaysDistributionList.DataTable=function(){_inherits(t,n2.de.component.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-todays-distribution-list-data-table",this._sortBy={column:0,direction:"asc"},this._emptyState={type:n2.de.page.console.todaysDistributionList.dataTable.EmptyState}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_generateColumnDefinitions",value:function(){return[{header:"Order",sortable:!0,bindPath:"order",cls:"n2_order-column",cell:{cls:"slds-text-align_right"}},{header:"Team",sortable:!0,sort:{bindPath:".teamName"},cls:"n2_teams-column",cell:{cellTemplate:"",cls:"slds-truncate",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"team-link",text:{bindPath:".teamName"},linkType:"team"}]}},{header:"Distributions",sortable:!0,sort:{bindPath:".distributedCount"},cls:"n2_distributions-column",cell:{cellTemplate:"",cls:"slds-truncate slds-text-align_right",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"distributions-link",text:{bindPath:".distributedCount"},linkType:"distributions"}]}},{header:"SLA Alerts",sortable:!0,sort:{bindPath:".inAlertCount"},cls:"n2_alerts-column",cell:{cellTemplate:"",cls:"slds-truncate slds-text-align_right",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"alerts-link",text:{bindPath:".inAlertCount"},linkType:"alerts"}]}},{header:"Reassignments",sortable:!0,sort:{bindPath:".reassignedCount"},cls:"n2_reassignments-column",cell:{cellTemplate:"",cls:"slds-truncate slds-text-align_right",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"reassignments-link",text:{bindPath:".reassignedCount"},linkType:"reassignments"}]}},{header:"Errors",sortable:!0,sort:{bindPath:".inErrorCount"},cls:"n2_errors-column",cell:{cellTemplate:"",cls:"slds-truncate slds-text-align_right",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"errors-link",text:{bindPath:".inErrorCount"},linkType:"errors"}]}},{header:"Available Users",cls:"n2_availibility-column",cell:{cellTemplate:"",cls:"slds-truncate slds-text-align_right",components:[{type:n2.de.page.console.todaysDistributionList.Link,id:"available-link",text:{bindPath:".",adapter:function(e){return"".concat(e.activeMemberCount," / ").concat(e.allMemberCount)}},linkType:"available"}]}}]}}]),t}(),n2.de.page.console.todaysDistributionList.Link=function(){_inherits(t,n2.de.component.Link);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["linkType"]),this.linkType=null}},{key:"_onClick",value:function(e){switch(e.stopPropagation(),this.linkType){case"team":return n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(this._model.teamId));case"distributions":return n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","teamId=".concat(this._model.teamId));case"alerts":return n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","teamId=".concat(this._model.teamId,"&status=inAlert"));case"reassignments":return n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","teamId=".concat(this._model.teamId,"&status=reassigned"));case"errors":return n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","teamId=".concat(this._model.teamId,"&status=inError"));case"available":return n2.de.page.Navigation.getInstance().open("Console_Calendar","teamId=".concat(this._model.teamId))}}}]),t}(),n2.de.page.logs.component.RecordList=function(){_inherits(t,n2.de.component.AbstractRecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{dataTableWrapper:".n2_data-table-wrapper"}),this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <div class="n2_data-table-wrapper"></div>\n        </div>',this.totalLogCount=0}},{key:"_insertToolbar",value:function(){var e=_get(_getPrototypeOf(t.prototype),"_insertToolbar",this).call(this);return e.renderTo={position:"afterbegin"},e}},{key:"_insertDataTable",value:function(){var e=_get(_getPrototypeOf(t.prototype),"_insertDataTable",this).call(this);return e.renderTo=this.SELECTORS.dataTableWrapper,e}},{key:"_fireOrderedFilterEvent",value:function(e){this.fire("change",this._getChangeEvent(e.target))}},{key:"_getChangeEvent",value:function(e){return this._createEvent(e,{data:{changes:[{property:"data",type:"set"}],actions:["ordered-filter"],filterOptions:this.getFilterOptions()}})}},{key:"getFilterOptions",value:function(){return n2.merge({sortOrderField:this._dataTable.sortOrder},this._toolbar.filterData)}},{key:"_refreshDataTable",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshDataTable",this).apply(this,arguments),0!==this.totalLogCount&&n2.isEmpty(this._data)&&this._dataTable.showEmptyFilteredState()}},{key:"_refreshToolbar",value:function(){this._toolbar.hidden=0===this.totalLogCount}},{key:"_refreshFooter",value:function(){this._footer.count={displayedLogCount:this._dataTable.data.length,totalLogCount:this.totalLogCount}}}]),t}(),n2.de.page.logs.archiveLogList.ArchiveLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"data",set:function(e){n2.compare(e,this._data)?this._dataTable.sortLogs():(this._data=e,this._refresh())}},{key:"dataTable",get:function(){return this._components["archive-logs-data-table"]}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.archiveLogList.archiveLogsRecordList.Toolbar({id:"archive-logs-toolbar",listeners:{click:this._handleToolbarClick,scope:this}}),this._dataTable=new n2.de.page.logs.archiveLogList.archiveLogsRecordList.DataTable({id:"archive-logs-data-table",listeners:{selectionChange:this._updateMenu,sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"archive-logs-footer"})}},{key:"_handleToolbarClick",value:function(e){"filter-button"===e.target.id&&this._fireOrderedFilterEvent(e)}},{key:"_updateMenu",value:function(e){var t=this._dataTable.selection,n=0===t.length;(this._toolbar.menu.disabled=n)||(this._toolbar.menu.components["restore-logs"].label="Restore (".concat(t.length,")"))}},{key:"_refreshToolbar",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshToolbar",this).apply(this,arguments),this._updateMenu()}}]),t}(),n2.de.page.logs.autoConversionLogList.AutoConversionLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.autoConversionLogList.autoConversionLogsRecordList.Toolbar({id:"auto-conversion-logs-toolbar",listeners:{click:this._fireOrderedFilterEvent,scope:this}}),this._dataTable=new n2.de.page.logs.autoConversionLogList.autoConversionLogsRecordList.DataTable({id:"auto-conversion-logs-data-table",listeners:{sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"auto-conversion-logs-footer"})}}]),t}(),n2.de.page.logs.autoConversionLogList.AutoConversionSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content"}),this._componentCls="n2-de-auto-conversion-slide-out-panel",this._log=null,this._avatar=null,this._logTemplate='<div class="n2_content">\n            {{#inError}}\n                <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                <p class="n2_error-message">{{errorMessage}}</p>\n            {{/inError}}\n            <h3>Conversion Type</h3>\n            <p class="n2_conversion-type">{{accountType}}</p>\n            {{#matchConvertObjects.length}}\n                <h3>Conversions</h3>\n                <dl class="n2_inline">\n                    {{#matchConvertObjects}}\n                        <dt class="n2_object-name">{{objectName}}</dt>\n                        <dd class="n2_record-name">\n                            {{#hasRecordId}}\n                                <a href="javascript:void();" class="n2_record-link" data-record-id="{{recordId}}">{{recordName}}</a>\n                            {{/hasRecordId}}\n                            {{^hasRecordId}}\n                                <span class="n2_record-text">{{recordName}}</span>\n                            {{/hasRecordId}}\n                        </dd>\n                    {{/matchConvertObjects}}\n                </dl>\n            {{/matchConvertObjects.length}}\n            {{#userName}}\n                <h3>Assignee</h3>\n                <div class="n2_assignee"><span class="n2_avatar"></span> {{userName}}</div>\n            {{/userName}}\n        </div>')}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._log=t,this._refreshLogData()}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(n.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().openObject(this._log.recordId)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){n2.isNull(this.element("content"))||this.element("content").destroy(),n2.isNull(this._avatar)||(this._avatar.destroy(),this._avatar=null)}},{key:"_insertLogData",value:function(){this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._getLogData())),this.element("content").listen("click",function(e){if(e.target.classList.contains("n2_record-link"))return n2.de.page.Navigation.getInstance().openObject(e.target.dataset.recordId)}),n2.isNull(this._log.userName)||(this._avatar=this._insertAvatar())}},{key:"_insertAvatar",value:function(){return this._insert(new n2.ui.component.Avatar({id:this._log.userId,renderTo:".n2_avatar",avatar:this._log.avatarUrl,displayName:this._log.userName}))}},{key:"_getLogData",value:function(){return n2.merge({},this._log,{matchConvertObjects:this._getMatchConvertObjects(),accountType:this._getAutoConversionType()})}},{key:"_getMatchConvertObjects",value:function(){return this._log.matchConvertObjects.map(function(e){return{objectName:e.objectName,recordId:e.recordId,recordName:e.recordName,hasRecordId:!n2.isUndefined(e.recordId)}})}},{key:"_getAutoConversionType",value:function(){return this._log.isAutoConversion?"Conversion":this._log.isDeduplication?"De-duplication":"None"}}]),n}(),n2.de.page.logs.component.ConfirmationMessageBox=function(){_inherits(n,n2.ui.component.MessageBox);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="n2-de-modal n2-confirmation-message-box",this._hideOnSubmit=!1}},{key:"_onSaving",value:function(){this._components["ok-button"].spinner(),this._components["cancel-button"].disable()}},{key:"_onSaved",value:function(){this._components["ok-button"].spinner(!1),this._components["ok-button"].success()}},{key:"_onError",value:function(){_get(_getPrototypeOf(n.prototype),"_onError",this).apply(this,arguments),this._reset()}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.message,e=e.listeners,e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).call(this,{message:t,buttons:n2.ui.enum.Button.OK_CANCEL,listeners:e})}},{key:"_reset",value:function(){this._components["ok-button"].reset(),this._components["cancel-button"].enable()}},{key:"hide",value:function(){var e=arguments,t=this;return new n2.util.DelayedTask(function(){_get(_getPrototypeOf(n.prototype),"hide",t).apply(t,e)},500).start()}}]),n}(),n2.de.page.logs.component.DateRangePicker=function(){_inherits(t,n2.de.component.field.DateRangePicker);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._startDate=null,this._endDate=null}},{key:"startDate",set:function(e){this._startDate=e,this._refresh({startDate:!0})}},{key:"endDate",set:function(e){this._endDate=e,this._refresh({endDate:!0})}},{key:"_insertComponents",value:function(){this._insertStartDate().yearRange=10,this._insertStartDateAllDay(),this._insertEndDate().yearRange=10,this._insertEndDateAllDay()}},{key:"_getMinDate",value:function(){var e=new Date;return e.setFullYear(e.getFullYear()-10),e}},{key:"_getMaxDate",value:function(){var e=new Date;return e.setDate(e.getDate()+2),e}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.startDate,t=void 0!==t&&t,n=e.endDate,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshStartDate(),(e||n)&&this._refreshEndDate()}},{key:"_refreshStartDate",value:function(){var e;n2.isNull(this._startDate)||(this.startDateField.value={value:this._startDate,silent:!0,validate:!1},e=this._calculateEndDateFromStartDate(this._startDate),this.endDateField.minTime=this._getEndDateMinTime(this._startDate,e),this.endDateField.minDate=n2.de.util.Date.getDateAsUTC(this._startDate),this._previousStartDate=this._startDate,this.endDateField.value={value:e,silent:!0,validate:!1})}},{key:"_refreshEndDate",value:function(){this.endDateField.minTime=this._getEndDateMinTime(this._startDate,this._endDate),this.endDateField.value={value:this._endDate,silent:!0,validate:!1}}}]),t}(),n2.de.page.logs.distributionLogList.Context=function(){_inherits(a,n2.de.page.logs.Context);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._logFilterData=null,this._isMyLogsFilterEnabled=null,this._displayLastAction=null}},{key:"logFilterData",get:function(){return this._logFilterData}},{key:"isMyLogsFilterEnabled",get:function(){return this._isMyLogsFilterEnabled},set:function(e){this._isMyLogsFilterEnabled!==e&&(this._isMyLogsFilterEnabled=e)}},{key:"displayLastAction",get:function(){return this._displayLastAction}},{key:"clearLogFilterData",value:function(){this._logFilterData=null}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=e.sent,i=i.loggingData,e.t0=i,e.next=8,this._loadDataProvider("get-page-url-params",{silent:t,force:n});case 8:return e.t1=e.sent,e.next=11,this._loadDataProvider("get-show-last-action",{silent:t,force:n});case 11:return e.t2=e.sent,e.abrupt("return",{loggingData:e.t0,logFilterData:e.t1,displayLastAction:e.t2});case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.logFilterData,e=e.displayLastAction;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._logFilterData=this._getLogFilterData(t.response),this._isMyLogsFilterEnabled=!!t.response.userId,this._displayLastAction=e.response.displayLastAction}},{key:"_getLogFilterData",value:function(e){for(var t={},n=0,i=Object.entries(e);n<i.length;n++){var s=_slicedToArray(i[n],2),a=s[0],s=s[1];""!==s&&("userId"===a?t.teamMemberOwnerId=s:t[a]=s)}return t}}]),a}(),n2.de.page.logs.distributionLogList.DistributionLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"toolbar",get:function(){return this._components["distribution-logs-toolbar"]}},{key:"footer",get:function(){return this._components["distribution-logs-footer"]}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.distributionLogList.distributionLogsRecordList.Toolbar({id:"distribution-logs-toolbar",listeners:{click:this._handleToolbarClick,scope:this}}),this._dataTable=new n2.de.page.logs.distributionLogList.distributionLogsRecordList.DataTable({id:"distribution-logs-data-table",cls:n2.de.page.logs.distributionLogList.Context.getInstance().displayLastAction?"n2_with-last-action":"",listeners:{selectionChange:this._updateMenu,sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.distributionLogList.distributionLogsRecordList.Footer({id:"distribution-logs-footer"})}},{key:"_handleToolbarClick",value:function(e){"filter-button"===e.target.id&&this._fireOrderedFilterEvent(e)}},{key:"_updateMenu",value:function(e){var t=this._dataTable.selection,n=0===t.length;(this._toolbar.menu.disabled=n)||(this._toolbar.menu.components["delete-logs"].label="Delete (".concat(t.length,")"))}},{key:"_refreshToolbar",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshToolbar",this).apply(this,arguments);var e=n2.de.ApplicationContext.getInstance();(e.isAdminOrSystemManager||e.isTeamManager)&&this._updateMenu()}}]),t}(),n2.de.page.logs.distributionLogList.DistributionSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content",retryButton:".n2_retry-button",rejectButton:".n2_reject-button",reassignedToAvatar:".n2_reassigned-to-avatar",assignedToAvatar:".n2_assigned-to-avatar",currentOwnerAvatar:".n2_current-owner-avatar"}),this._componentCls="n2-de-distribution-slide-out-panel",this._log=null,this._logTemplate='<div class="n2_content">\n            {{#canRejectAssignment}}<div class="n2_reject-button"></div>{{/canRejectAssignment}}\n            {{#inError}}\n                <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                <p class="n2_error-message">{{errorMessage}}</p>\n            {{/inError}}\n            {{#status}}\n                <h3>Status</h3>\n                <p class="n2test_status">{{status}}</p>\n                {{#onHoldTooltip}}<p class="n2test_on-hold-tooltip">{{onHoldTooltip}}</p>{{/onHoldTooltip}}\n                {{#isOnHold}}<div class="n2_retry-button"></div>{{/isOnHold}}\n                {{#rejectTooltip}}<p class="n2test_reject-tooltip">{{rejectTooltip}}</p>{{/rejectTooltip}}\n                {{#alertTip}}<p class="n2test_alert-tip">{{alertTip}}</p>{{/alertTip}}\n                {{#reassignedOwnerName}}\n                    <h3>Reassigned to</h3>\n                    <div class="n2_avatar-container n2test_reassigned-to">\n                        <span class="n2_reassigned-to-avatar"></span>\n                        {{#isReassignedOwnerAQueue}}{{reassignedOwnerName}}{{/isReassignedOwnerAQueue}}\n                        {{^isReassignedOwnerAQueue}}\n                            <a href="javascript:void();" class="n2_reassigned-to-link">{{reassignedOwnerName}}</a>\n                        {{/isReassignedOwnerAQueue}}\n                    </div>\n                {{/reassignedOwnerName}}\n            {{/status}}\n            {{#assignedObjectName}}\n                <h3>Object</h3>\n                <p class="n2test_assigned-object-name">{{assignedObjectName}}</p>\n            {{/assignedObjectName}}\n            <h3>Team / Distributor</h3>\n            <dl class="n2_inline">\n                <dt>Team</dt>\n                <dd class="n2_team-name">\n                    {{#isTeamDeleted}}{{#teamName}}{{teamName}}{{/teamName}}{{^teamName}}&mdash;{{/teamName}}{{/isTeamDeleted}}\n                    {{^isTeamDeleted}}\n                        {{#showTeamLink}}<a href="javascript:void();" class="n2_team-link">{{teamName}}</a>{{/showTeamLink}}\n                        {{^showTeamLink}}{{teamName}}{{/showTeamLink}}\n                    {{/isTeamDeleted}}\n                </dd>\n                <dt>Distributor</dt>\n                <dd class="n2_distributor-name">\n                    {{#isDistributorDeleted}}{{#distributorName}}{{distributorName}}{{/distributorName}}{{^distributorName}}&mdash;{{/distributorName}}{{/isDistributorDeleted}}\n                    {{^isDistributorDeleted}}\n                        {{#showDistributorLink}}<a href="javascript:void();" class="n2_distributor-link">{{distributorName}}</a>{{/showDistributorLink}}\n                        {{^showDistributorLink}}{{distributorName}}{{/showDistributorLink}}\n                    {{/isDistributorDeleted}}\n                </dd>\n            </dl>\n            {{#method}}\n                <h3>Method</h3>\n                <div class="slds-media slds-media_center slds-has-flexi-truncate">\n                    <div class="slds-media__figure n2_method-icon">{{{methodIcon}}}</div>\n                    <div class="slds-media__body n2_method">{{method}}</div>\n                </div>\n                <ul class="n2_inline-pill-list slds-m-top_xx-small">\n                    {{#isSticky}}<li>Sticky</li>{{/isSticky}}\n                    {{#isSubstitute}}<li>Substitute</li>{{/isSubstitute}}\n                 </ul>\n                 {{#logDetailMessage}}<p class="n2test_log-detail-message">{{logDetailMessage}}</p>{{/logDetailMessage}}\n            {{/method}}\n            {{#assignedOwnerName}}\n                <h3>Assigned to</h3>\n                <div class="n2_avatar-container n2test_assigned-to">\n                    <span class="n2_assigned-to-avatar"></span>\n                    {{#isAssignedOwnerAQueue}}{{assignedOwnerName}}{{/isAssignedOwnerAQueue}}\n                    {{^isAssignedOwnerAQueue}}\n                        <a href="javascript:void();" class="n2_assigned-to-link">{{assignedOwnerName}}</a>\n                    {{/isAssignedOwnerAQueue}}\n                </div>\n            {{/assignedOwnerName}}\n            {{#assignmentDate}}\n                <h3>Assignment date</h3>\n                <p class="n2test_assignment-date">{{formattedAssignmentDate}}</p>\n            {{/assignmentDate}}\n            {{#lastAction}}\n                <h3>Last action</h3>\n                <p class="n2test_last-action">{{lastAction}}</p>\n            {{/lastAction}}\n            {{#lastActionDate}}\n                <h3>Last action date</h3>\n                <p class="n2test_last-action-date">{{formattedLastActionDate}}</p> \n            {{/lastActionDate}}\n            {{#currentAssignedOwnerName}} \n                <h3>Current assigned user</h3>\n                <div class="n2_avatar-container n2test_current-assigned-to"">\n                    <span class="n2_current-owner-avatar"></span>\n                    {{#isCurrentOwnerAQueue}}{{currentAssignedOwnerName}}{{/isCurrentOwnerAQueue}}\n                    {{^isCurrentOwnerAQueue}}\n                        <a href="javascript:void();" class="n2_current-assigned-user-link">{{currentAssignedOwnerName}}</a>\n                    {{/isCurrentOwnerAQueue}}\n                </div>\n            {{/currentAssignedOwnerName}}')}},{key:"retryButton",get:function(){return this._components["retry-button"]}},{key:"rejectButton",get:function(){return this._components["reject-button"]}},{key:"reassignedToAvatar",get:function(){return this._components["reassign-to-avatar"]}},{key:"assignedToAvatar",get:function(){return this._components["assigned-to-avatar"]}},{key:"currentOwnerAvatar",get:function(){return this._components["current-owner-avatar"]}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._log=t,this._refreshLogData()}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(n.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().openObject(this._log.assignedObjectId)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){this._destroyComponents(),n2.isNull(this.element("content"))||this.element("content").destroy()}},{key:"_insertLogData",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._getLogData())),this._insertComponents(),this.element("content").listen("click",function(e){return e.target.classList.contains("n2_team-link")?n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(t._log.teamId)):e.target.classList.contains("n2_distributor-link")?n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(t._log.distributorId,"&teamId=").concat(t._log.teamId)):e.target.classList.contains("n2_assigned-to-link")?n2.de.page.Navigation.getInstance().openObject(t._log.assignedOwnerId):e.target.classList.contains("n2_current-assigned-user-link")?n2.de.page.Navigation.getInstance().openObject(t._log.currentOwnerId):e.target.classList.contains("n2_reassigned-to-link")?n2.de.page.Navigation.getInstance().openObject(t._log.reassignedToId):void 0})}},{key:"_getLogData",value:function(){return n2.merge({showTeamLink:!n2.de.ApplicationContext.getInstance().isUser,showDistributorLink:!n2.de.ApplicationContext.getInstance().isUser&&!n2.de.ApplicationContext.getInstance().isTeamManager,methodIcon:this._log.method?n2.de.Icon.getMethodIcon(this._log.method):null,status:this._getStatus(),formattedAssignmentDate:this._log.assignmentDate?this._formatDate(this._log.assignmentDate):null,formattedLastActionDate:this._log.lastActionDate?this._formatDate(this._log.lastActionDate):null,isAssignedOwnerAQueue:this._log.assignedOwnerId?this._isQueue(this._log.assignedOwnerId):null,isCurrentOwnerAQueue:this._log.currentOwnerId?this._isQueue(this._log.currentOwnerId):null,isReassignedOwnerAQueue:this._log.reassignedToId?this._isQueue(this._log.reassignedToId):null},this._log)}},{key:"_getStatus",value:function(){return this._log.inAlert?"SLA Alert":this._log.isReassignedToQueue?"Reassigned":n2.isUndefined(this._log.rejectLogId)?this._log.isOnHold?"On Hold":null:"Rejected"}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_isQueue",value:function(e){return"00G"===e.substring(0,3)}},{key:"_insertComponents",value:function(){this._log.isOnHold&&this._insertRetryButton(),this._log.canRejectAssignment&&this._insertRejectButton(),this._log.reassignedOwnerName&&this._insertReassignedToAvatar(),this._log.assignedOwnerName&&this._insertAssignedToAvatar(),this._log.currentAssignedOwnerName&&this._insertCurrentOwnerAvatar()}},{key:"_destroyComponents",value:function(){n2.isUndefined(this.retryButton)||this.retryButton.destroy(),n2.isUndefined(this.rejectButton)||this.rejectButton.destroy(),n2.isUndefined(this.reassignedToAvatar)||this.reassignedToAvatar.destroy(),n2.isUndefined(this.assignedToAvatar)||this.assignedToAvatar.destroy(),n2.isUndefined(this.currentOwnerAvatar)||this.currentOwnerAvatar.destroy()}},{key:"_insertRetryButton",value:function(){return this._insert(new n2.ui.component.Button({id:"retry-button",renderTo:this.SELECTORS.retryButton,text:"Retry",theme:n2.ui.component.button.Theme.OUTLINE_BRAND,cls:"n2_retry",listeners:{click:this._handleClick,scope:this}}))}},{key:"_insertRejectButton",value:function(){return this._insert(new n2.ui.component.Button({id:"reject-button",renderTo:this.SELECTORS.rejectButton,text:"Reject",theme:n2.ui.component.button.Theme.OUTLINE_BRAND,cls:"n2_reject",listeners:{click:this._handleClick,scope:this}}))}},{key:"_handleClick",value:function(e){this.fire("click",this._createEvent(e,{data:this._log}))}},{key:"_insertReassignedToAvatar",value:function(){return this._insert(new n2.ui.component.Avatar({id:"reassign-to-avatar",renderTo:this.SELECTORS.reassignedToAvatar,avatar:this._log.reassignedOwnerAvatarUrl,displayName:this._log.reassignedOwnerName}))}},{key:"_insertAssignedToAvatar",value:function(){return this._insert(new n2.ui.component.Avatar({id:"assigned-to-avatar",renderTo:this.SELECTORS.assignedToAvatar,avatar:this._log.assignedOwnerAvatarUrl,displayName:this._log.assignedOwnerName}))}},{key:"_insertCurrentOwnerAvatar",value:function(){return this._insert(new n2.ui.component.Avatar({id:"current-owner-avatar",renderTo:this.SELECTORS.currentOwnerAvatar,avatar:this._log.currentOwnerAvatarUrl,displayName:this._log.currentAssignedOwnerName}))}}]),n}(),n2.de.page.logs.leadMatchingLogList.LeadMatchingLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.leadMatchingLogList.leadMatchingLogsRecordList.Toolbar({id:"lead-matching-logs-toolbar",listeners:{click:this._fireOrderedFilterEvent,scope:this}}),this._dataTable=new n2.de.page.logs.leadMatchingLogList.leadMatchingLogsRecordList.DataTable({id:"lead-matching-logs-data-table",listeners:{sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"lead-matching-logs-footer"})}}]),t}(),n2.de.page.logs.leadMatchingLogList.LeadMatchingSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content"}),this._componentCls="n2-de-lead-matching-slide-out-panel",this._log=null,this._logTemplate='<div class="n2_content">\n            {{#status}}\n                <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                <p class="n2_error-message">{{status}}</p>\n            {{/status}}\n            <h3>Match Date</h3>\n            <p class="n2_match-date">{{matchDate}}</p>\n            {{#matchedAccountId}}\n                <h3>Matched Account</h3>\n                <dl class="n2_inline">\n                    <dt>Name</dt>\n                    <dd class="n2_matched-account-name">\n                        {{#isMatchedAccountDeleted}}\n                            {{#matchedAccountName}}\n                                <span class="n2_matched-account-text">{{matchedAccountName}}</span>\n                                <span class="n2_matched-account-type"> ({{matchedAccountType}})</span>\n                            {{/matchedAccountName}}\n                            {{^matchedAccountName}}<span class="n2_matched-account-text">&mdash;</span>{{/matchedAccountName}}\n                        {{/isMatchedAccountDeleted}}\n                        {{^isMatchedAccountDeleted}}\n                            <a href="javascript:void();" class="n2_matched-account-link">{{matchedAccountName}}</a>\n                            <span class="n2_matched-account-details"> ({{matchedAccountType}})</span>\n                        {{/isMatchedAccountDeleted}}\n                    </dd>\n                    <dt>Confidence</dt>\n                    <dd class="n2_matched-account-confidence">{{matchedAccountConfidence}}</dd>\n                    {{#accountContactRule}}\n                        <dt>Rule</dt>\n                        <dd class="n2_matched-account-rule">{{accountContactRule}}</dd>\n                    {{/accountContactRule}}\n                </dl>\n            {{/matchedAccountId}}\n            {{#matchedContactId}}\n                <h3>Matched Contact</h3>\n                <dl class="n2_inline">\n                    <dt>Name</dt>\n                    <dd class="n2_matched-contact-name">\n                        {{#isMatchedContactDeleted}}\n                            <span class="n2_matched-contact-text">\n                                {{#matchedContactName}}{{matchedContactName}}{{/matchedContactName}}\n                                {{^matchedContactName}}&mdash;{{/matchedContactName}}\n                            </span>\n                        {{/isMatchedContactDeleted}}\n                        {{^isMatchedContactDeleted}}\n                            <a href="javascript:void();" class="n2_matched-contact-link">{{matchedContactName}}</a>\n                        {{/isMatchedContactDeleted}}\n                    </dd>\n                    <dt>Confidence</dt>\n                    <dd class="n2_matched-contact-confidence">{{matchedContactConfidence}}</dd>\n                    {{#accountContactRule}}\n                        <dt>Rule</dt>\n                        <dd class="n2_matched-contact-rule">{{accountContactRule}}</dd>\n                    {{/accountContactRule}}\n                </dl>\n            {{/matchedContactId}}\n            {{#matchedLeadId}}\n                <h3>Matched Lead</h3>\n                <dl class="n2_inline">\n                    <dt>Name</dt>\n                    <dd class="n2_matched-lead-name">\n                        {{#isMatchedLeadDeleted}}\n                            <span class="n2_matched-lead-text">\n                                {{#matchedLeadName}}{{matchedLeadName}}{{/matchedLeadName}}\n                                {{^matchedLeadName}}&mdash;{{/matchedLeadName}}\n                            </span>\n                        {{/isMatchedLeadDeleted}}\n                        {{^isMatchedLeadDeleted}}\n                            <a href="javascript:void();" class="n2_matched-lead-link">{{matchedLeadName}}</a>\n                        {{/isMatchedLeadDeleted}}\n                    </dd>\n                    <dt>Confidence</dt>\n                    <dd class="n2_matched-lead-confidence">{{matchedLeadConfidence}}</dd>\n                    {{#leadRule}}\n                        <dt>Rule</dt>\n                        <dd class="n2_matched-lead-rule">{{leadRule}}</dd>\n                    {{/leadRule}}\n                </dl>\n            {{/matchedLeadId}}')}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._log=t,this._refreshLogData()}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(n.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().openObject(this._log.recordId)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){n2.isNull(this.element("content"))||this.element("content").destroy()}},{key:"_insertLogData",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._getLogData())),this.element("content").listen("click",function(e){return e.target.classList.contains("n2_matched-account-link")?n2.de.page.Navigation.getInstance().openObject(t._log.matchedAccountId):e.target.classList.contains("n2_matched-contact-link")?n2.de.page.Navigation.getInstance().openObject(t._log.matchedContactId):e.target.classList.contains("n2_matched-lead-link")?n2.de.page.Navigation.getInstance().openObject(t._log.matchedLeadId):void 0})}},{key:"_getLogData",value:function(){return n2.merge({matchDate:this._formatDate(this._log.lastProcessedDate),matchedAccountConfidence:this._getConfidence(this._log.accountContactConfidence),matchedContactConfidence:this._getConfidence(this._log.accountContactConfidence),matchedLeadConfidence:this._getConfidence(this._log.leadConfidence)},this._log)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getConfidence",value:function(e){return 100===e?"Exact":"Fuzzy (".concat(e,"%)")}}]),n}(),n2.de.page.logs.objectSyncLogList.ObjectSyncLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.objectSyncLogList.objectSyncLogsRecordList.Toolbar({id:"object-sync-logs-toolbar",listeners:{click:this._fireOrderedFilterEvent,scope:this}}),this._dataTable=new n2.de.page.logs.objectSyncLogList.objectSyncLogsRecordList.DataTable({id:"object-sync-logs-data-table",listeners:{sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"object-sync-logs-footer"})}}]),t}(),n2.de.page.logs.objectSyncLogList.ObjectSyncSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content"}),this._componentCls="n2-de-object-sync-slide-out-panel",this._log=null,this._logTemplate='<div class="n2_content">\n            {{#inError}}\n                <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                <p class="n2_error-message">{{errorMessage}}</p>\n                <dl class="n2_inline">\n                    <dt>Failures to sync</dt>\n                    <dd class="n2_error-count">{{numberOfErrors}}</dd>\n                </dl>\n            {{/inError}}\n            <h3>Object</h3>\n            <p class="n2_object-name">{{objectName}}</p>\n            <h3>User details</h3>\n            <dl class="n2_inline">\n                <dt>Team</dt>\n                <dd class="n2_team-name">\n                    {{#isTeamDeleted}}{{#teamName}}{{teamName}}{{/teamName}}{{^teamName}}&mdash;{{/teamName}}{{/isTeamDeleted}}\n                    {{^isTeamDeleted}}<a href="javascript:void();" class="n2_team-link">{{teamName}}</a>{{/isTeamDeleted}}\n                </dd>\n                <dt>User</dt>\n                <dd><a href="javascript:void();" class="n2_user-link">{{userName}}</a></dd>\n            </dl>\n            <h3>Actions performed</h3>\n                {{#relatedObjectActionNames.length}}\n                    <ul class="n2_action-names n2_inline-pill-list">\n                        {{#relatedObjectActionNames}}\n                            <li>{{.}}</li>\n                        {{/relatedObjectActionNames}}\n                     </ul>\n                 {{/relatedObjectActionNames.length}}\n                 {{^relatedObjectActionNames.length}}\n                    <p class="n2_no-action-names">No related actions</p>\n                 {{/relatedObjectActionNames.length}}\n            {{#numberOfSyncedRecords}} \n                <h3>Related records synced</h3>\n                <p class="n2_sync-count">{{numberOfSyncedRecords}}</p>\n            {{/numberOfSyncedRecords}}\n        </div>')}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._log=t,this._refreshLogData()}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(n.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().openObject(this._log.recordId)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){n2.isNull(this.element("content"))||this.element("content").destroy()}},{key:"_insertLogData",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._log)),this.element("content").listen("click",function(e){return e.target.classList.contains("n2_team-link")?n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(t._log.teamId)):e.target.classList.contains("n2_user-link")?n2.de.page.Navigation.getInstance().openObject(t._log.userId):void 0})}}]),n}(),n2.de.page.logs.schedulerLogList.Context=function(){_inherits(a,n2.de.page.logs.Context);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._logFilterData=null}},{key:"logFilterData",get:function(){return this._logFilterData}},{key:"clearLogFilterData",value:function(){this._logFilterData=null}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=e.sent,i=i.loggingData,e.t0=i,e.next=8,this._loadDataProvider("get-page-url-params",{silent:t,force:n});case 8:return e.t1=e.sent,e.abrupt("return",{loggingData:e.t0,logFilterData:e.t1});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.logFilterData;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._logFilterData=this._getLogFilterData(e.response)}},{key:"_getLogFilterData",value:function(e){for(var t={},n=0,i=Object.entries(e);n<i.length;n++){var s=_slicedToArray(i[n],2),a=s[0],s=s[1];""!==s&&(t[a]=s)}return t}}]),a}(),n2.de.page.logs.schedulerLogList.DateRangePicker=function(){_inherits(t,n2.de.page.logs.component.DateRangePicker);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getMinDate",value:function(){var e=new Date;return e.setDate(e.getDate()-7),e}}]),t}(),n2.de.page.logs.schedulerLogList.SchedulerLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"toolbar",get:function(){return this._components["scheduler-logs-toolbar"]}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.schedulerLogList.schedulerLogsRecordList.Toolbar({id:"scheduler-logs-toolbar",listeners:{click:this._handleToolbarClick,scope:this}}),this._dataTable=new n2.de.page.logs.schedulerLogList.schedulerLogsRecordList.DataTable({id:"scheduler-logs-data-table",listeners:{sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"scheduler-logs-footer"})}},{key:"_handleToolbarClick",value:function(e){"filter-button"===e.target.id&&this._fireOrderedFilterEvent(e)}}]),t}(),n2.de.page.logs.schedulerLogList.SchedulerSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content"}),this._componentCls="n2-de-scheduler-slide-out-panel",this._log=null,this._logTemplate='<div class="n2_content">\n            {{#errorMessage}}\n                <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                <p class="n2test_error-message">{{errorMessage}}</p>\n            {{/errorMessage}}\n            {{#logType}}\n                <h3>Type</h3>\n                <p class="n2test_log-type">{{logType}}</p>\n            {{/logType}}\n            {{#numberOfAssignments}}\n                <h3>Number of assignments</h3>\n                <p class="n2test_number-of-assignments">{{numberOfAssignments}}</p>\n            {{/numberOfAssignments}}\n            {{#timeTaken}}\n                <h3>Time taken (seconds)</h3>\n                <p class="n2test_time-taken">{{timeTaken}}</p>\n            {{/timeTaken}}'),this._REFRESH={log:["logData"]}}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._setProperty("log",t)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){n2.isNull(this.element("content"))||this.element("content").destroy()}},{key:"_insertLogData",value:function(){this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._getLogData()))}},{key:"_getLogData",value:function(){return n2.merge(this._log,{logType:this._log.logType,numberOfAssignments:this._getNumberOfAssignments(),timeTaken:n2.isUndefined(this._log.timeTaken)?null:this._log.timeTaken.toString(),errorMessage:this._log.errorMessage})}},{key:"_getNumberOfAssignments",value:function(){return"health checker"===this._log.logType.toLowerCase()?null:this._log.numberOfAssignments.toString()}}]),n}(),n2.de.page.logs.territoriesLogList.TerritoriesLogsRecordList=function(){_inherits(t,n2.de.page.logs.component.RecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.logs.territoriesLogList.territoriesLogsRecordList.Toolbar({id:"territories-logs-toolbar",listeners:{click:this._fireOrderedFilterEvent,scope:this}}),this._dataTable=new n2.de.page.logs.territoriesLogList.territoriesLogsRecordList.DataTable({id:"territories-logs-data-table",listeners:{sort:this._fireOrderedFilterEvent,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.logs.component.recordList.Footer({id:"territories-logs-footer"})}}]),t}(),n2.de.page.logs.territoriesLogList.TerritoriesSlideOutPanel=function(){_inherits(n,n2.de.page.SlideOutPanel);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{content:".n2_content"}),this._componentCls="n2-de-territories-slide-out-panel",this._log=null,this._logTemplate='<div class="n2_content">\n            {{#status}}\n                <div class="n2_log-section n2_log-error">\n                    <h3 class="n2_error">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),' Error</h3>\n                    <p>{{status}}</p>\n                </div>\n            {{/status}}\n            <div class="n2_log-section n2_match-date">\n                <h3>Match date and time</h3>\n                <p>{{matchDate}}</p>\n            </div>\n            <div class="n2_log-section n2_object-name-section">\n                <h3>Object</h3>\n                <p>{{objectName}}</p>\n            </div>\n            {{#matchedTerritoryName}}\n                <div class="n2_log-section n2_territory-name">\n                    <h3>Match territory</h3>\n                    <p>{{matchedTerritoryName}}</p>\n                </div>\n            {{/matchedTerritoryName}}\n            {{#hasCleanedData}}\n                <div class="n2_log-section n2_cleaned-data">\n                    <h3>Cleaned territory data</h3>\n                    <dl class="n2_inline">\n                        {{#matchedTerritoryLevel}}\n                            <dt class="n2_match-level">Match level</dt>\n                            <dd class="n2_match-level-value">{{matchedTerritoryLevel}}</dd>\n                        {{/matchedTerritoryLevel}}\n                        {{#cleanedCountry}}\n                            <dt class="n2_match-level-country">Country</dt>\n                            <dd class="n2_match-level-country-value">{{cleanedCountry}}</dd>\n                        {{/cleanedCountry}}\n                        {{#cleanedState}}\n                            <dt class="n2_match-level-state">State/Province</dt>\n                            <dd class="n2_match-level-state-value">{{cleanedState}}</dd>\n                        {{/cleanedState}}\n                        {{#cleanedZip}}\n                            <dt class="n2_match-level-zip">Zip/Postal</dt>\n                            <dd class="n2_match-level-zip-value">{{cleanedZip}}</dd>\n                        {{/cleanedZip}}\n                    </dl>\n                </div>\n            {{/hasCleanedData}}\n        </div>')}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.log;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._log=t,this._refreshLogData()}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(n.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().openObject(this._log.recordId)}},{key:"_refreshLogData",value:function(){this._removeLogData(),this._insertLogData()}},{key:"_removeLogData",value:function(){n2.isNull(this.element("content"))||this.element("content").destroy()}},{key:"_insertLogData",value:function(){this.element("body").insert(n2.ui.Template.render(this._logTemplate,this._getLogData()))}},{key:"_getLogData",value:function(){return n2.merge({hasCleanedData:this._getHasCleanedData(),matchDate:this._formatDate(this._log.lastProcessedDate)},this._log)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getHasCleanedData",value:function(){return!n2.isUndefined(this._log.cleanedCountry)||!n2.isUndefined(this._log.cleanedState)||!n2.isUndefined(this._log.cleanedZip)}}]),n}(),n2.de.page.objectSync.objectSyncActions.ActionModal=function(){_inherits(a,n2.de.component.Modal);var e,t,n,i,s=_createSuper(a);function a(){return _classCallCheck(this,a),s.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this,arguments),this.id="object-sync-action-modal",this.dataProviders=["save-object-sync-action"],this._componentCls="n2-de-object-sync-action-modal",this._isEdit=!1,this._actionData=null,this._previousDistributionObject=null,this._previousRelatedObject=null}},{key:"objectSyncActionForm",get:function(){return this._components["object-sync-action-form"]}},{key:"distributionObjectField",get:function(){return this.objectSyncActionForm.components["distribution-object"]}},{key:"relatedObjectField",get:function(){return this.objectSyncActionForm.components["related-object"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).call(this,arguments),this._insertActionForm()}},{key:"_insertActionForm",value:function(){this._insert(new n2.de.component.Form({id:"object-sync-action-form",cls:"n2_object-sync-action-form",includeFooter:!1,components:[{type:n2.ui.component.field.Combo,id:"distribution-object",cls:"n2_field-width slds-m-bottom_medium",label:"Distribution Object",mixins:[n2.mixin.DataDriven],dataProviders:["get-distribution-object-options"],listeners:{change:this._onDistributionObjectOptionChange,scope:this},options:{bindPath:"get-distribution-object-options",adapter:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}},required:!0,sort:!0},{type:n2.ui.component.field.Combo,id:"related-object",cls:"n2_field-width slds-m-bottom_medium",label:"Related Object",mixins:[n2.mixin.DataDriven],dataProviders:["get-related-object-options"],listeners:{change:this._onRelatedObjectOptionChange,scope:this},disabled:!0,options:{bindPath:"get-related-object-options",adapter:function(e){return e.map(function(e){return{label:e.label+" ("+e.fieldLabel+")",value:e.value+"."+e.fieldName}})}},required:!0,sort:!0}]}))}},{key:"_onDistributionObjectOptionChange",value:function(e){this._getRelatedObjectOptions(e.value),this._previousDistributionObject=e.value,this.submitButton.disable()}},{key:"_onRelatedObjectOptionChange",value:function(e){e=this._getRelatedObjectName(e.value);n2.isEmpty(e)?this.submitButton.disable():this.submitButton.enable(),this.spinner(!0),this._refreshRelatedObjectFilters(e),this._previousRelatedObject=e,this.spinner(!1)}},{key:"show",value:function(e){e=e.model,e=void 0===e?null:e;this.objectSyncActionForm.clear(),this.submitButton.disable(),this._actionData={},n2.isNull(e)?(this._isEdit=!1,this.header="Add new Action",this.submitButton.text="Add Action",this._getDistributionObjects(),this.distributionObjectField.show(),this.relatedObjectField.show()):(this._isEdit=!0,this._actionData=e,this.submitButton.text="Update Action",this.header="Edit Action",this.distributionObjectField.hide(),this.relatedObjectField.hide(),this.submitButton.enable()),this._refreshObjectLabels(),this._refreshRelatedObjectFilters(),_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this.submitButton.reset(),this.cancelButton.enable()}},{key:"_getDistributionObjects",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-distribution-object-options",{silent:!1,force:!1});case 2:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_refreshObjectLabels",value:function(){n2.isUndefined(this._components["object-sync-action-objects"])||this._components["object-sync-action-objects"].destroy(),this._isEdit&&this._insert(new n2.ui.component.HTML({id:"object-sync-action-objects",mixins:[n2.mixin.DataDriven],renderTo:{target:".n2_object-sync-action-form",position:"beforeBegin"},model:this._actionData,template:'<div class="slds-grid slds-wrap slds-p-bottom_small">\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-label">Object</div>\n                    <div class="slds-col slds-size_1-of-5"></div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-label">Related Object</div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-value">{{model.distributionObjectLabel}}</div>\n                    <div class="slds-col slds-size_1-of-5 n2_action-detail-value">&rarr;</div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-value">{{model.relatedObjectLabel}}</div>\n                </div>'}))}},{key:"_refreshRelatedObjectFilters",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._isEdit?this._actionData.relatedObject:t,this._previousRelatedObject!==n&&(n2.isUndefined(this.objectSyncActionForm.components["field-filter"])||this.objectSyncActionForm._components["field-filter"].destroy(),n))return i=!!this._isEdit&&this._actionData.hasFieldFilters,s=this._isEdit?this._actionData.logicAndFilters:{filters:[]},(a=new n2.dataProvider.Model({value:{}})).insert(n,{key:"objectName"}),a.insert(i,{key:"hasFieldFilters"}),a.insert(s,{key:"logicAndFilters"}),a.insert(!1,{key:"isAdvancedFilter"}),a.insert(!1,{key:"advancedFiltersEnabled"}),a.insert(!0,{key:"hideLogic"}),a.insert("",{key:"advancedSoql"}),this.objectSyncActionForm.insert(new n2.de.component.form.FieldFilter({id:"field-filter",heading:"Related object filter",helpText:"If defined, only related objects that match the filter criteria will be synced.",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_small-heading n2_object-sync-filters",maxRows:3,model:a,includeParents:!1})),e.next=13,this._loadDataProvider("get-team-object-field-options",{params:[n],silent:!1,force:!0});e.next=13;break;case 13:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_getRelatedObjectOptions",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=""!==t&&this._previousDistributionObject!==t,e.t0)return this.relatedObjectField.clear({silent:!0}),this.relatedObjectField.disabled=!1,e.next=6,this._loadDataProvider("get-related-object-options",{params:[t],silent:!1,force:!0});e.next=8;break;case 6:this._refreshRelatedObjectFilters(null),this._previousRelatedObject=null;case 8:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.objectSyncActionForm.validate())return this._isEdit||(this._actionData.distributionObject=this.distributionObjectField.value,t=this.relatedObjectField.value,this._actionData.relatedObject=this._getRelatedObjectName(t),this._actionData.lookupField=this._getLookupField(t)),this._actionData.hasFieldFilters=this.objectSyncActionForm.components["field-filter"].model.json.hasFieldFilters,this._actionData.logicAndFilters=this.objectSyncActionForm.components["field-filter"].model.json.logicAndFilters,e.next=6,this._postDataProvider("save-object-sync-action",{params:[this._actionData]});e.next=9;break;case 6:return e.next=8,this._loadDataProvider("get-object-sync-actions",{silent:!1,force:!0});case 8:_get(_getPrototypeOf(a.prototype),"_onSubmit",this).call(this);case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_getRelatedObjectName",value:function(e){return n2.isEmpty(e)?null:e.split(".")[0]}},{key:"_getLookupField",value:function(e){return n2.isEmpty(e)?null:e.split(".")[1]}}]),a}(),n2.de.page.objectSync.objectSyncActions.ActionsList=function(){_inherits(s,n2.de.component.DataTable);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},menuOptionSelect:function(e,t,n){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this.columns=this._getColumns(),this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,this._sortBy={column:0,direction:"asc"}}},{key:"_onDefined",value:function(){var t=this,e=(this._emptyState={type:n2.de.page.objectSync.objectSyncActions.actionsList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._data.length),n=1===e?"action":"actions";this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no actions that match your filters",content:"We looked through ".concat(e," ").concat(n,", but none of them match your filters. You can change your terms, or clear them to see all actions."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t.fire("click",t._createEvent(e,{currentTarget:t}))}}}},_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_getColumns",value:function(){return[{header:{data:"Order",cls:"slds-text-align_right"},bindPath:"order",cls:"n2_order-column",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:"Object",bindPath:"distributionObjectLabel",sortable:!0},{header:"Related object",bindPath:"relatedObjectLabel",sortable:!0},{header:"Filters",cell:{dataAdapter:this._getFiltersCountCellContent.bind(this)}},{header:"Status",sortable:!0,sort:{bindPath:".isActive",adapter:function(e){return e?"Active":"Inactive"}},cell:{cellTemplate:"{{#content.isActive}}Active{{/content.isActive}}{{^content.isActive}}Inactive{{/content.isActive}}"}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getActionMenuConfig()]}}]}},{key:"_getActionMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"object-sync-action-action-menu",options:[{id:"edit",label:"Edit"},{id:"activate",label:"Activate"},{id:"deactivate",label:"Deactivate"},{id:"delete",label:"Delete"}],listeners:{select:function(e,t){n.fire("menuOptionSelect",e,t,t.parent)}}}}},{key:"_createRow",value:function(e){var t=_get(_getPrototypeOf(s.prototype),"_createRow",this).apply(this,arguments),n=t.data.isActive,i=t.components["menu-cell"].components["object-sync-action-action-menu"];return n?i.components.activate.hidden=!0:(t.cls="n2_inactive",i.components.deactivate.hidden=!0),t}},{key:"_getFiltersCountCellContent",value:function(e){return 0===e.logicAndFilters.filters.length?{html:"<span>&mdash;</span>"}:(e=e.logicAndFilters.filters.length,"".concat(e,1!==e?" filters":" filter"))}}]),s}(),n2.de.page.objectSync.objectSyncActions.ReorderActionsModal=function(){_inherits(t,n2.de.component.Modal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this.id="reorder-object-sync-actions-modal",this.dataProviders=["reorder-object-sync-actions"],this._componentCls="n2-de-reorder-object-sync-actions-modal",this._header="Reorder Object Sync Actions"}},{key:"orderedActionsList",get:function(){return this._components["ordered-actions-data-table"]}},{key:"_getOKButtonConfig",value:function(){return{text:"Set Order"}}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).apply(this,arguments),this.element("content").insert('<p class="slds-m-bottom_medium">The priority order for object sync stops a related object being assigned twice when multiple source objects relate to it and are updated in a single run. In this case, only the highest priority action will complete.</p>',"afterbegin")}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(t.prototype),"_onSaving",this).apply(this,arguments),this.orderedActionsList.reorderable=!1}},{key:"_onSaved",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){e.hide(),e._reset()},500).start()}},{key:"show",value:function(e){e=e.data,e=void 0===e?null:e;n2.sort(e,{property:"order"}),this._insertReorderDataTable(e),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this.orderedActionsList.headerRow.dom.hide(!1)}},{key:"_insertReorderDataTable",value:function(e){return this._insert(new n2.ui.component.DataTable({id:"ordered-actions-data-table",columns:[{header:"Actions",cell:{cellTemplate:'<span>{{content.distributionObjectLabel}}</span><span class="slds-m-horizontal_small">&rarr;</span><span>{{content.relatedObjectLabel}}</span>',dataAdapter:function(e){return{distributionObjectLabel:e.distributionObjectLabel,relatedObjectLabel:e.relatedObjectLabel}}}}],data:e,reorderable:!0}))}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(t.prototype),"_onSubmit",this).call(this),this._postDataProvider("reorder-object-sync-actions",{params:[this.orderedActionsList.data]})}},{key:"_reset",value:function(){_get(_getPrototypeOf(t.prototype),"_reset",this).call(this),this.orderedActionsList.destroy()}}]),t}(),n2.de.page.objectSync.objectSyncActions.SlideOutPanel=function(){_inherits(a,n2.de.page.SlideOutPanel);var e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{container:".n2_action-details-container",detail:".n2_action-detail"}),this._componentCls="n2-de-object-sync-action-panel",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._lazyLoad=!0,this._heading=null,this._detailTemplate='<div class="n2_action-detail slds-p-around_medium">\n                <div class="slds-grid slds-wrap">\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-label">Object</div>\n                    <div class="slds-col slds-size_1-of-5"></div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-label">Related Object</div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-value">{{actionData.distributionObjectLabel}}</div>\n                    <div class="slds-col slds-size_1-of-5 n2_action-detail-value">&rarr;</div>\n                    <div class="slds-col slds-size_2-of-5 n2_action-detail-value">{{actionData.relatedObjectLabel}}</div>\n                </div>\n                <div class="slds-p-top_medium n2_action-description">We will synchronise the owner from {{actionData.distributionObjectLabel}} to {{actionData.relatedObjectLabel}} after assignment.</div>\n            </div>',this._actionData=null}},{key:"actionData",get:function(){return this._actionData},set:function(e){this._actionData!==e&&(this._actionData=e,this._refreshPanelContent())}},{key:"objectSyncActionModal",get:function(){return n2.de.page.objectSync.objectSyncActions.ActionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertActionDetailsContainer()}},{key:"_insertActionButtons",value:function(){return[this._insertEditActionButton()]}},{key:"_insertActionDetailsContainer",value:function(){return this._insert(new n2.ui.component.HTML({id:"action-details-container",template:'<div id="{{id}}" class="n2_action-details-container"></div>'}))}},{key:"_insertEditActionButton",value:function(){return this._insert(new n2.ui.component.Button({id:"edit-action-button",renderTo:this.SELECTORS.actions,text:"Edit",theme:n2.ui.component.button.Theme.LINK,cls:"slds-m-right_xx-small",listeners:{click:this._onEditActionButtonClick,scope:this}}))}},{key:"_onEditActionButtonClick",value:function(e){this.objectSyncActionModal.show({model:this._actionData,listeners:{saved:this._onActionModalSave,scope:this}})}},{key:"_onActionModalSave",value:function(e,t){this.actionData=t}},{key:"_refreshPanelContent",value:function(){this._refreshActionDetail(),this._refreshFilters()}},{key:"_refreshActionDetail",value:function(){var e;n2.isNull(this.element("detail"))||this.element("detail").destroy(),n2.isEmpty(this._actionData)||(e=n2.ui.Template.render(this._detailTemplate,this._getTemplateData(),this._getTemplatePartials()),this.element("container").insert(e,"afterbegin"),this.element("detail",!0))}},{key:"_refreshFilters",value:function(){n2.isUndefined(this._components["action-filters"])||this._components["action-filters"].destroy(),n2.isEmpty(this._actionData.logicAndFiltersLabels.filters)||this._insert(new n2.de.component.summary.LogicFiltersSummary({id:"action-filters",label:"Filters",cls:"slds-p-horizontal_medium slds-p-vertical_small",isAdvanced:!1,filters:this._actionData.logicAndFiltersLabels.filters}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.heading,t=void 0===t?null:t,n=e.actionData,i=e.includeNavButtons,i=void 0!==i&&i,s=e.components,s=void 0===s?[]:s,e=e.listeners,e=void 0===e?{}:e;this.actionData=void 0===n?null:n,_get(_getPrototypeOf(a.prototype),"show",this).call(this,{heading:t,includeNavButtons:i,components:s,listeners:e})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(a.prototype),"_getTemplateData",this).call(this),{actionData:this._actionData})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(a.prototype),"_getTemplatePartials",this).call(this),{detailTemplate:this._detailTemplate})}}]),a}(),n2.de.page.settings.appSettings.AppSettingsForm=function(){_inherits(s,n2.de.component.Form);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-app-settings","save-app-settings"],this._appSettings=null}},{key:"schedulerAbortedMessage",get:function(){return this._components["scheduler-aborted-message"]}},{key:"healthCheckerAbortedMessage",get:function(){return this._components["health-checker-aborted-message"]}},{key:"maintenanceModeOnMessage",get:function(){return this._components["maintenance-mode-on-message"]}},{key:"operationsFieldGroup",get:function(){return this._components["operations-field-group"]}},{key:"distributionEngineFieldGroup",get:function(){return this.operationsFieldGroup.components["distribution-engine-field-group"]}},{key:"loggingAndArchivingFieldGroup",get:function(){return this._components["logging-and-archiving-field-group"]}},{key:"calendarIntegrationFieldGroup",get:function(){return this._components["calendar-integration-field-group"]}},{key:"distributionSettingsFieldGroup",get:function(){return this._components["distribution-settings-field-group"]}},{key:"notificationsFieldGroup",get:function(){return this._components["notifications-field-group"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertSchedulerAbortedMessage(),this._insertHealthCheckerAbortedMessage(),this._insertMaintenanceModeOnMessage(),this._insertOperationsFieldGroup(),this._insertLoggingAndArchivingFieldGroup(),this._insertCalendarIntegrationFieldGroup(),this._insertDistributionSettingsFieldGroup(),this._insertNotificationsFieldGroup()}},{key:"_insertSchedulerAbortedMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"scheduler-aborted-message",renderTo:{target:this.SELECTORS.formBody,position:"beforebegin"},type:"info",content:"The scheduler has aborted. Please restart Distribution Engine.",hidden:!0}))}},{key:"_insertHealthCheckerAbortedMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"health-checker-aborted-message",renderTo:{target:this.SELECTORS.formBody,position:"beforebegin"},type:"info",content:"The Health Checker job has aborted. Please restart Distribution Engine to get it running again.",hidden:!0}))}},{key:"_insertMaintenanceModeOnMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"maintenance-mode-on-message",renderTo:{target:this.SELECTORS.formBody,position:"beforebegin"},type:"info",content:"Distribution Engine is in maintenance mode. No distribution will be performed at this time.",hidden:!0}))}},{key:"_insertOperationsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.Operations({id:"operations-field-group",cls:"n2_indent-left",listeners:{click:this._onOperationsFieldGroupClick,scope:this}}))}},{key:"_onOperationsFieldGroupClick",value:function(e){e.target.id===this.distributionEngineFieldGroup.id&&this._loadAppSettings({silent:!0,force:!0})}},{key:"_insertLoggingAndArchivingFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.LoggingAndArchiving({id:"logging-and-archiving-field-group",cls:"n2_indent-left"}))}},{key:"_insertCalendarIntegrationFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.CalendarIntegration({id:"calendar-integration-field-group",cls:"n2_indent-left"}))}},{key:"_insertDistributionSettingsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.DistributionSettings({id:"distribution-settings-field-group",cls:"n2_indent-left"}))}},{key:"_insertNotificationsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.Notifications({id:"notifications-field-group",cls:"n2_indent-left"}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadAppSettings({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{appSettingsData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadAppSettings",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,e=e.silent;return this._loadDataProvider("get-app-settings",{silent:void 0!==e&&e,force:void 0!==t&&t})}},{key:"_onLoadComplete",value:function(e){e=e.appSettingsData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._appSettings=e.response,this._refresh({footer:!0,messages:!0,fieldGroups:!0})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-app-settings"===t.id&&(this._appSettings=e,n2.de.page.settings.appSettings.Context.getInstance().isDirty=!1,this._refresh({footer:!0,messages:!0,fieldGroups:!0}))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments),e.messages),t=void 0!==t&&t,n=e.fieldGroups,n=void 0!==n&&n,i=e.autoSaveFields,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshMessages(),(e||n)&&this._refreshFieldGroups(),(e||i)&&this._refreshAutoSaveFields()}},{key:"_refreshMessages",value:function(){this.schedulerAbortedMessage.hidden=!this._appSettings.get("schedulerAborted"),this.healthCheckerAbortedMessage.hidden=!this._appSettings.get("healthCheckerAborted"),this.maintenanceModeOnMessage.content=this._appSettings.get("maintenanceModeMessage"),this.maintenanceModeOnMessage.hidden=!this._appSettings.get("maintenanceModeOn")}},{key:"_refreshFieldGroups",value:function(){this.operationsFieldGroup.model=this._appSettings,this.loggingAndArchivingFieldGroup.model=this._appSettings,this.calendarIntegrationFieldGroup.model=this._appSettings,this.distributionSettingsFieldGroup.model=this._appSettings,this.notificationsFieldGroup.model=this._appSettings}},{key:"_refreshAutoSaveFields",value:function(){this.distributionEngineFieldGroup.refreshDistributionEngineToggle(),this.loggingAndArchivingFieldGroup.refreshArchivingToggle()}},{key:"_onFieldChange",value:function(e){_get(_getPrototypeOf(s.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.settings.appSettings.Context.getInstance().isDirty||(n2.de.page.settings.appSettings.Context.getInstance().isDirty=!0,this._refresh({autoSaveFields:!0}))}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(s.prototype),"_onSubmit",this).apply(this,arguments),this._postDataProvider("save-app-settings",{params:[this._appSettings.json]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(s.prototype),"_onSaved",this).apply(this,arguments),this._loadAppSettings({force:!0})}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(s.prototype),"_onCancel",this).apply(this,arguments),this._loadAppSettings({force:!0})}}]),s}(),n2.de.page.settings.appSettings.Context=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._mixins=[n2.mixin.Singleton],this._isDirty=!1}},{key:"isDirty",get:function(){return this._isDirty},set:function(e){this._isDirty=e}}]),t}(),n2.de.page.settings.exportImport.ErrorModal=function(){_inherits(a,n2.de.component.Modal);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this,arguments),this.id="export-import-error-modal",this._cls="n2-de-export-import-error-modal",this.SELECTORS=n2.merge(this.SELECTORS,{errorInfo:".n2_error-info",errorMessage:".n2_error-message"}),this._errorInfo=null,this._errorMessage=null,this._errorInfoTemplate='<div class="n2_error-info"><p>{{errorInfo}}</p><p>Please try again or <a href="mailto:support@nc-squared.com">contact support</a>.</p></div>',this._errorMessageTemplate='<div class="n2_error-message slds-scoped-notification slds-scoped-notification_light slds-m-vertical_medium site">{{errorMessage}}</div>',this._migrationId=null}},{key:"removeButton",get:function(){return this._components["remove-button"]}},{key:"closeButton",get:function(){return this._components["close-modal-button"]}},{key:"_addFooterButtons",value:function(){var e=this;this._addButton({id:"remove-button",listeners:{click:function(){return e._onSubmit()}}}),this._addButton({id:"close-modal-button",text:"Close",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(){return e._onCancel()}}})}},{key:"_onKeyUp",value:function(e){if("button"!==e.target.tagName.toLowerCase())switch(n2.ui.Key.get(e.key)){case n2.ui.enum.Key.ENTER:n2.isNull(this.closeButton)||n2.isUndefined(this.closeButton)||this.closeButton.disabled||(document.activeElement.blur(),this._onCancel());break;case n2.ui.enum.Key.ESCAPE:this._onCancel()}}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _get(_getPrototypeOf(a.prototype),"_onSubmit",this).call(this),e.next=3,this._postDataProvider("delete-import-export",{params:[this._migrationId]});case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_resetButtons",value:function(){this.closeButton.reset(),this.closeButton.enable(),this.removeButton.spinner(!1),this.removeButton.enable()}},{key:"show",value:function(e){var t=e.header,t=void 0===t?"":t,n=e.migrationId,n=void 0===n?null:n,i=e.errorInfo,i=void 0===i?null:i,s=e.errorMessage,s=void 0===s?null:s,e=e.removeButtonText,e=void 0===e?"Remove":e;_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this.header=t,this.removeButton.text=e,this._migrationId=n,this._errorInfo=i,this._errorMessage=s,this._refresh(),this.removeButton.reset(),this.closeButton.enable()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.errorInfo,t=void 0!==t&&t,n=e.errorMessage,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshErrorInfo(),(e||n)&&this._refreshErrorMessage()}},{key:"_refreshErrorInfo",value:function(){n2.isNull(this.element("errorInfo"))||this.element("errorInfo").remove();var e=n2.ui.Template.render(this._errorInfoTemplate,{errorInfo:this._errorInfo});this.element("body").insert(e,"afterbegin")}},{key:"_refreshErrorMessage",value:function(){n2.isNull(this.element("errorMessage"))||this.element("errorMessage").remove();var e=n2.ui.Template.render(this._errorMessageTemplate,{errorMessage:this._errorMessage});this.element("body").insert(e,"beforeend")}},{key:"_onSaving",value:function(e){this.removeButton.spinner(),this.closeButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.removeButton.spinner(!1),this.removeButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}}]),a}(),n2.de.page.settings.exportImport.Export=function(){_inherits(o,n2.ui.Component);var e,t,n,i=_createSuper(o);function o(){return _classCallCheck(this,o),i.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-settings-export",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins||[]),this.dataProviders=["get-migrations"],this.downloadUrl="",this._contentTypeFilterOptions=[],this._exportPollingService=null}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"contentTypeFilter",get:function(){return this.toolbar.components["content-type-filter"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"exportList",get:function(){return this._components["export-list"]}},{key:"exportModal",get:function(){return n2.de.page.settings.exportImport.export.ExportModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["start-export"]})}},{key:"errorModal",get:function(){return n2.de.page.settings.exportImport.ErrorModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["delete-import-export"]})}},{key:"_onDefined",value:function(){var e=this;_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar(),this._insertExportList(),this._exportPollingService=new n2.de.PollingService(function(){e._loadExports({silent:!1,force:!0,requestId:"poll-exports"})},15e3)}},{key:"_insertToolbar",value:function(){return this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar{{#hidden}} {{hideCls}}{{/hidden}}">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',hidden:!0,components:[this._createContentTypeFilter(),this._createQuickFilter(),this._createStartExportButton()]}))}},{key:"_createContentTypeFilter",value:function(){return new n2.ui.component.field.Combo({id:"content-type-filter",renderTo:".n2_left",label:{text:"Filter by content type",hidden:!0},placeholder:"All",options:this._contentTypeFilterOptions,listeners:{change:this._onContentFilterChange,scope:this}})}},{key:"_onContentFilterChange",value:function(e){""!==e.value?this.exportList.addFilter("contentTypeFilter",{dataBindings:["migrationContentType"],value:e.value}):this.exportList.removeFilters(["contentTypeFilter"])}},{key:"_createQuickFilter",value:function(){return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find exports...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}})}},{key:"_onQuickFilterType",value:function(e){var t=e.value.toLowerCase();""!==t&&this.exportList.addFilter("quickFilter",{dataBindings:["contentNames"],fcn:function(e){e=e.data.contentNames.find(function(e){return e.toLowerCase().includes(t)});return!n2.isUndefined(e)}}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.exportList.removeFilters(["quickFilter"])}},{key:"_createStartExportButton",value:function(){return new n2.ui.component.Button({id:"start-export-button",renderTo:".n2_right",cls:"n2_start-export-button",text:"Start Export",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onStartExportClick,scope:this}})}},{key:"_onStartExportClick",value:function(){this.exportModal.show({listeners:{submit:this._onExportModalSubmit,scope:this}})}},{key:"_onExportModalSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("start-export",{params:[t.data.contentType,t.data.objectIds]});case 2:return e.abrupt("return",this._loadExports({silent:!1,force:!0,requestId:"export"}));case 3:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_loadExports",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(i=0<s.length&&void 0!==s[0]?s[0]:{}).force,t=void 0!==t&&t,n=i.silent,n=void 0!==n&&n,i=i.requestId,i=void 0===i?null:i,e.next=3,this._loadDataProvider("get-migrations",{params:["Export"],silent:n,force:t,requestId:i});case 3:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_insertExportList",value:function(){var t=this;return this._insert(new n2.de.component.DataTable({id:"export-list",columns:[{header:"Export date",sortable:!0,bindPath:"startDatetime",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e)}}},{header:"Content type",bindPath:"migrationContentType"},{header:"Contents",cell:{dataAdapter:this._getContentsCellOutput.bind(this)},cls:"n2_contents"},{header:"User",bindPath:"userName"},{header:{data:"Status",hidden:!0},cls:"n2_status",cell:{type:n2.de.page.settings.exportImport.StatusCell,cls:"n2_status-cell",downloadUrl:this.downloadUrl,migrationType:"export",listeners:{click:function(e){return t._onErrorButtonClick(e)}}}}],emptyState:{type:n2.de.page.settings.exportImport.export.EmptyState,listeners:{click:this._onStartExportClick,scope:this}},sortBy:{column:0,direction:"dsc"},hidden:!0}))}},{key:"_onErrorButtonClick",value:function(e){var t,n=this;n2.isEmpty(e.currentTarget)||(t=1<(e=e.currentTarget.data).contentNames.length?"".concat(e.contentNames.length," tag collections"):e.contentNames,this.errorModal.show({header:"Export Error",migrationId:e.migrationId,errorInfo:"There was an error exporting ".concat(t,"."),errorMessage:e.errorMessage,removeButtonText:"Remove Export",listeners:{submit:function(){return n._loadExports({silent:!1,force:!0,requestId:"export"})}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-migration-content-types",{silent:t,force:!1}),this._loadDataProvider("get-migrations",{params:["Export"],silent:t,force:n,requestId:"export"})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{contentTypes:i,exports:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.exports,e=e.contentTypes;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._model=t.response,this._contentTypeFilterOptions=e.response,this._refresh(),this._checkPollingService()}},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"export"===n?(this._model=e,this._exportPollingService.stop(),this._refresh(),this._checkPollingService()):"poll-exports"===n&&(this._model=e,this._refresh({exportList:!0}),this._checkPollingService())}},{key:"_checkPollingService",value:function(){n2.isEmpty(this._getExportsInProgress())?this._exportPollingService.stop():this._exportPollingService.start()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0!==t&&t,n=e.exportList,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshExportList()}},{key:"_refreshToolbar",value:function(){this.toolbar.hidden=n2.isEmpty(this._model),this.contentTypeFilter.options=this._contentTypeFilterOptions}},{key:"_refreshExportList",value:function(){this.exportList.data=this._model,this.exportList.hidden=!1,this.exportList.emptyFilteredState=this._getEmptyFilteredState(this._model)}},{key:"_getExportsInProgress",value:function(){return this._model.filter(function(e){return!1===e.isCompleted&&!1===e.isError}).map(function(e){return e.migrationId})}},{key:"_getContentsCellOutput",value:function(e){var t,n,i=e.contentNames,s=e.contentCount;return 0===i.length?{html:n2.ui.Template.render('<span class="n2_deleted-migration-content">{{value}}</span>',{value:1<s?"".concat(s," ").concat(e.migrationContentTypePlural.toLowerCase()," deleted"):"".concat(e.migrationContentType," deleted")})}:1===i.length&&1===s?i:(t=i.slice(),i.length!==s&&(n=1<(i=s-i.length)?e.migrationContentTypePlural:e.migrationContentType,t.push("".concat(i," ").concat(n.toLowerCase()," deleted"))),{html:n2.ui.Template.render('<span title="{{title}}" class="n2_multiple-tag-collections">{{value}}</span>',{title:t.join(", "),value:"".concat(s," ").concat(e.migrationContentTypePlural.toLowerCase())})})}},{key:"_getEmptyFilteredState",value:function(e){var t;return n2.isEmpty(e)?null:(t=1===(e=e.length)?"export":"exports",{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no exports that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all exports."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._clearFilters,scope:this}}})}},{key:"_clearFilters",value:function(){this.contentTypeFilter.clear(),this.quickFilter.clear()}},{key:"_onError",value:function(){_get(_getPrototypeOf(o.prototype),"_onError",this).apply(this,arguments),n2.isNull(this._exportPollingService)||this._exportPollingService.stop()}}]),o}(),n2.de.page.settings.exportImport.Import=function(){_inherits(o,n2.ui.Component);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-settings-import",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins||[]),this.dataProviders=["get-migrations"],this._lazyLoad=!0,this._contentTypeFilterOptions=[],this._importPollingService=null,this._forceImportDataLoad=!1}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"contentTypeFilter",get:function(){return this.toolbar.components["content-type-filter"]}},{key:"quickFilter",get:function(){return this.toolbar.components["quick-filter"]}},{key:"importList",get:function(){return this._components["import-list"]}},{key:"errorModal",get:function(){return n2.de.page.settings.exportImport.ErrorModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["delete-import-export"]})}},{key:"importWizard",get:function(){return n2.de.page.settings.exportImport.import.ImportWizard.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_onDefined",value:function(){var e=this;_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar(),this._insertImportList(),this._importPollingService=new n2.de.PollingService(function(){e._loadImports({requestId:"poll-imports"})},15e3)}},{key:"_insertToolbar",value:function(){return this._insert(new n2.ui.component.HTML({id:"toolbar",template:'<div id="{{id}}" class="n2_toolbar{{#hidden}} {{hideCls}}{{/hidden}}">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',hidden:!0,components:[this._createContentTypeFilter(),this._createQuickFilter(),this._createStartImportButton()]}))}},{key:"_createContentTypeFilter",value:function(){return new n2.ui.component.field.Combo({id:"content-type-filter",renderTo:".n2_left",label:{text:"Filter by content type",hidden:!0},placeholder:"All",options:[],listeners:{change:this._onContentFilterChange,scope:this}})}},{key:"_onContentFilterChange",value:function(e){""!==e.value?this.importList.addFilter("contentTypeFilter",{dataBindings:["migrationContentType"],value:e.value}):this.importList.removeFilters(["contentTypeFilter"])}},{key:"_createStartImportButton",value:function(){return new n2.ui.component.Button({id:"start-import-button",renderTo:".n2_right",cls:"n2_start-import-button",text:"Start Import",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onStartImportClick,scope:this}})}},{key:"_onStartImportClick",value:function(){this.importWizard.show({listeners:{saved:this._onImportWizardSaved,scope:this}})}},{key:"_onImportWizardSaved",value:function(){this._loadImports()}},{key:"_createQuickFilter",value:function(){return new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",label:{text:"Quick filter",hidden:!0},cls:"n2_quick-filter",icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find imports...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}})}},{key:"_onQuickFilterType",value:function(e){var t=e.value.toLowerCase();""!==t&&this.importList.addFilter("quickFilter",{dataBindings:["contentNames"],fcn:function(e){e=e.data.contentNames.find(function(e){return e.toLowerCase().includes(t)});return!n2.isUndefined(e)}}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.importList.removeFilters(["quickFilter"])}},{key:"_insertImportList",value:function(){var t=this;return this._insert(new n2.de.component.DataTable({id:"import-list",columns:[{header:"Import date",sortable:!0,bindPath:"startDatetime",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e)}}},{header:"Content type",bindPath:"migrationContentType"},{header:"Contents",cell:{dataAdapter:this._getContentsCellOutput.bind(this)},cls:"n2_contents"},{header:"User",bindPath:"userName"},{header:{data:"Status",hidden:!0},cls:"n2_status",cell:{type:n2.de.page.settings.exportImport.StatusCell,cls:"n2_status-cell",migrationType:"import",listeners:{click:function(e){return t._onErrorButtonClick(e)}}}}],emptyState:{type:n2.de.page.settings.exportImport.import.EmptyState,listeners:{click:function(){return t._onStartImportClick()}}},sortBy:{column:0,direction:"dsc"},hidden:!0}))}},{key:"_onErrorButtonClick",value:function(e){var t,n=this;n2.isEmpty(e.currentTarget)||(t=1<(e=e.currentTarget.data).contentNames.length?"".concat(e.contentNames.length," tag collections"):e.contentNames,this.errorModal.show({header:"Import Error",migrationId:e.migrationId,errorInfo:"There was an error importing ".concat(t,"."),errorMessage:e.errorMessage,removeButtonText:"Remove Import",listeners:{submit:function(){return n._loadDataProvider("get-migrations",{params:["Import"],silent:!1,force:!0,requestId:"import"})}}}))}},{key:"show",value:function(){var e=_get(_getPrototypeOf(o.prototype),"show",this).apply(this,arguments);return this.load({force:this._forceImportDataLoad}),e}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-migration-content-types",{silent:t,force:!1}),this._loadImports({silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{contentTypes:i,importData:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadImports",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,n=e.force,e=e.requestId;return this._loadDataProvider("get-migrations",{params:["Import"],silent:void 0!==t&&t,force:void 0===n||n,requestId:void 0===e?"import":e})}},{key:"_onLoadComplete",value:function(e){var t=e.contentTypes,e=e.importData;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._contentTypeFilterOptions=t.response,this._onImportDataLoaded(e.response)}},{key:"_onLoaded",value:function(e,t,n){if(_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-migrations"===t.id)switch(n){case"import":this._onImportDataLoaded(e);break;case"poll-imports":this._onImportDataPolled(e)}}},{key:"_onImportDataLoaded",value:function(e){this._importPollingService.stop(),this._model=e,this._refresh(),this._checkPollingService(),this._forceImportDataLoad=!1}},{key:"_onImportDataPolled",value:function(e){this._model=e,this._refresh({importList:!0}),this._checkPollingService(),this._forceImportDataLoad=!0}},{key:"_checkPollingService",value:function(){n2.isEmpty(this._getImportsInProgressIds())?this._importPollingService.stop():this._importPollingService.start()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toolbar,t=void 0!==t&&t,n=e.importList,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshToolbar(),(e||n)&&this._refreshImportList()}},{key:"_refreshToolbar",value:function(){this.toolbar.hidden=n2.isEmpty(this._model),this.contentTypeFilter.options=this._contentTypeFilterOptions}},{key:"_refreshImportList",value:function(){this.importList.data=this._model,this.importList.hidden=!1,this.importList.emptyFilteredState=this._getEmptyFilteredState(this._model)}},{key:"_getImportsInProgressIds",value:function(){return this._model.filter(function(e){return!1===e.isCompleted&&!1===e.isError}).map(function(e){return e.migrationId})}},{key:"_getContentsCellOutput",value:function(e){var t,n,i=e.contentNames,s=e.contentCount;return!n2.isEmpty(i)||e.isCompleted&&!e.isError?0===i.length?{html:n2.ui.Template.render('<span class="n2_deleted-migration-content">{{value}}</span>',{value:1<s?"".concat(s," ").concat(e.migrationContentTypePlural.toLowerCase()," deleted"):"".concat(e.migrationContentType," deleted")})}:1===i.length&&1===s?i:(t=i.slice(),i.length!==s&&(n=1<(i=s-i.length)?e.migrationContentTypePlural:e.migrationContentType,t.push("".concat(i," ").concat(n.toLowerCase()," deleted"))),{html:n2.ui.Template.render('<span title="{{title}}" class="n2_multiple-tag-collections">{{value}}</span>',{title:t.join(", "),value:"".concat(s," ").concat(e.migrationContentTypePlural.toLowerCase())})}):{html:"<span>&mdash;</span>"}}},{key:"_getEmptyFilteredState",value:function(e){var t;return n2.isEmpty(e)?null:(t=1===(e=e.length)?"import":"imports",{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no imports that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all imports."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._clearFilters,scope:this}}})}},{key:"_clearFilters",value:function(){this.contentTypeFilter.clear(),this.quickFilter.clear()}}]),o}(),n2.de.page.settings.exportImport.StatusCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._cellTemplate="",this.downloadUrl="",this.migrationType=""}},{key:"spinnerTemplate",get:function(){return'<div id="'.concat(this.domId,'_spinner" class="n2_in-progress">\n            <div class="slds-spinner slds-spinner_xx-small" role="status">\n                <span class="slds-assistive-text">Loading</span>\n                <div class="slds-spinner__dot-a"></div>\n                <div class="slds-spinner__dot-b"></div>\n            </div>\n            ').concat(this.spinnerMessageTemplate,"\n        </div>")}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._data.isError?this._insertErrorButton():this._data.isCompleted?this._cellTemplate=this._getCellTemplate():this.spinner(this._getInProgressMessage())}},{key:"_insertErrorButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"error-button",mixins:[n2.mixin.DataDriven],theme:n2.ui.component.button.Theme.LINK,text:"Failed to ".concat(this.migrationType),cls:"n2_error-button",icon:n2.de.enum.Icon.WARNING,listeners:{click:function(e){return t._onErrorButtonClick(e)}}}))}},{key:"_onErrorButtonClick",value:function(e){this.fire("click",this._createEvent(e))}},{key:"_getInProgressMessage",value:function(){return this._isExport()?"Exporting":"Importing"}},{key:"_getCellTemplate",value:function(){return this._isExport()?this._getSuccessfulExportOutput():this._getSuccessfulImportOutput()}},{key:"_getSuccessfulExportOutput",value:function(){return n2.isUndefined(this._data.downloadId)?null:n2.ui.Template.render('<a class="n2_download-button" href="{{downloadUrl}}">{{value}}</a>',{downloadUrl:"".concat(this.downloadUrl).concat(this._data.downloadId),value:"Download"})}},{key:"_getSuccessfulImportOutput",value:function(){return n2.ui.Icon.getSVG(n2.de.enum.Icon.SUCCESS,{cls:"slds-icon_x-small slds-icon-text-success"})}},{key:"_isExport",value:function(){return"export"===this.migrationType}}]),t}(),n2.de.page.settings.licensedUsers.LicensedUsersRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"dataTable",get:function(){return this._components["licensed-users-data-table"]}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.settings.licensedUsers.licensedUsersRecordList.Toolbar({id:"licensed-users-toolbar"}),this._dataTable=new n2.de.page.settings.licensedUsers.licensedUsersRecordList.DataTable({id:"licensed-users-data-table",listeners:{selectionChange:this._updateMenu,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.settings.licensedUsers.licensedUsersRecordList.Footer({id:"licensed-users-footer"})}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;""===t?(this._dataTable.removeFilters([e.id]),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)):e.id===this._toolbar.quickFilter.id&&(this._dataTable.addFilter(this._toolbar.quickFilter.id,{dataBindings:["name"],value:t}),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments))}}]),n}(),n2.de.page.settings.licensedUsers.licensedUsersRecordList.LicensedUsersSlideOutPanel=function(){_inherits(i,n2.de.page.SlideOutPanel);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["remove-managed-package-license","remove-user-from-team","remove-user-from-all-teams"],this._componentCls="n2-de-licensed-users-slide-out-panel",this._licensedUserData=null,this._canCurrentUserRemoveLicenses=null}},{key:"currentLicensedUserId",get:function(){return n2.isNull(this._licensedUserData)?null:this._licensedUserData.id}},{key:"userInactiveMessage",get:function(){return this._components["user-inactive-message"]}},{key:"removeManagedPackageLicense",get:function(){return this._components["remove-managed-package-license"]}},{key:"permissionSets",get:function(){return this._components["permission-sets"]}},{key:"teamList",get:function(){return this._components["team-list"]}},{key:"removeFromAllTeamsButton",get:function(){return this._components["remove-from-all-teams"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._insertUserInactiveMessage(),this._insertRemoveManagedPackageLicenseButton(),this._insertPermissionSets(),this._insertTeamList(),this._insertRemoveFromAllTeamsButton()}},{key:"_insertUserInactiveMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:"user-inactive-message",cls:"slds-m-horizontal_small slds-m-top_small",template:'<div id="{{id}}" class="{{cls}}">\n                <p>User is inactive in Salesforce</p>\n            </div>'}))}},{key:"_insertRemoveManagedPackageLicenseButton",value:function(){return this._insert(new n2.ui.component.Button({id:"remove-managed-package-license",text:"Remove Managed Package License",theme:n2.ui.component.button.Theme.TEXT_DESTRUCTIVE,cls:"n2_remove-managed-package-license",listeners:{click:this._onRemoveManagedPackageLicenseButtonClick,scope:this}}))}},{key:"_onRemoveManagedPackageLicenseButtonClick",value:function(e){var t=this,n="You are trying to remove ".concat(this._licensedUserData.name," from the managed package license.  Are you sure you want to continue?");this._showConfirmRemovalMessageBox(n,function(){return t._onRemoveManagedPackageLicenseButtonConfirm(e)})}},{key:"_onRemoveManagedPackageLicenseButtonConfirm",value:function(e){this._postDataProvider("remove-managed-package-license",{params:[this._licensedUserData.id]})}},{key:"_insertPermissionSets",value:function(){return this._insert(new n2.ui.component.HTML({id:"permission-sets",mixins:[n2.mixin.DataDriven],cls:"slds-m-horizontal_small slds-m-top_medium",template:'<div id="{{id}}" class="{{cls}}">\n                <h3 class="slds-form-element__label">Permission sets</h3>\n                <p>{{model}}</p>\n            </div>'}))}},{key:"_insertTeamList",value:function(){return this._insert(new n2.ui.component.DataTable({id:"team-list",cls:"slds-m-left_xx-small slds-m-right_small slds-m-top_small",columns:[{header:"Team name",bindPath:"teamName"},{header:"Assignments",bindPath:"dailyAssignments",cls:"n2_daily-assignments",cell:{cls:"slds-text-align_right"}},{header:{data:"Remove",hidden:!0},cls:"n2_actions",cell:{cellTemplate:"",cls:"slds-text-align_right",components:[{id:"remove-team",type:n2.ui.component.Button,title:"Remove from team",icon:n2.ui.enum.Icon.CLOSE,cls:"n2_close-button",listeners:{click:this._onRemoveTeamButtonClick,scope:this}}]}}]}))}},{key:"_onRemoveTeamButtonClick",value:function(e){var t=this,n=e.parent.data.teamName;this._showConfirmRemovalMessageBox(this._getRemoveUserFromTeamsMessage([n]),function(){return t._onRemoveTeamConfirm(e)})}},{key:"_onRemoveTeamConfirm",value:function(e){e=e.parent.data.teamId;this._postDataProvider("remove-user-from-team",{params:[this._licensedUserData.id,e]})}},{key:"_insertRemoveFromAllTeamsButton",value:function(){return this._insert(new n2.ui.component.Button({id:"remove-from-all-teams",text:"Remove From All Teams",theme:n2.ui.component.button.Theme.TEXT_DESTRUCTIVE,cls:"n2_remove-from-all-teams",listeners:{click:this._onRemoveFromAllTeamsButtonClick,scope:this}}))}},{key:"_onRemoveFromAllTeamsButtonClick",value:function(e){var t=this,n=this._licensedUserData.teams.map(function(e){return e.teamName});this._showConfirmRemovalMessageBox(this._getRemoveUserFromTeamsMessage(n),function(){return t._onRemoveFromAllTeamsConfirm(e)})}},{key:"_onRemoveFromAllTeamsConfirm",value:function(e){this._postDataProvider("remove-user-from-all-teams",{params:[this._licensedUserData.id]})}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.licensedUserData,t=void 0===t?null:t,n=e.canCurrentUserRemoveLicenses,n=void 0!==n&&n;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this._licensedUserData=t,this._canCurrentUserRemoveLicenses=n,this._refresh()}},{key:"hide",value:function(){_get(_getPrototypeOf(i.prototype),"hide",this).apply(this,arguments),this._licensedUserData=null,this._canCurrentUserRemoveLicenses=null}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.removeManagedPackageLicensesButton,n=void 0!==n&&n,i=e.permissionSets,i=void 0!==i&&i,e=e.teamList,e=void 0!==e&&e;t&&this._refreshUserInactiveMessage(),(n||t)&&this._refreshRemoveManagedPackageLicenseButton(),(i||t)&&this._refreshPermissionSets(),(e||t)&&this._refreshTeamList()}},{key:"_refreshUserInactiveMessage",value:function(){this.userInactiveMessage.hidden=this._licensedUserData.userIsActive}},{key:"_refreshRemoveManagedPackageLicenseButton",value:function(){this.removeManagedPackageLicense.hidden=!this._canCurrentUserRemoveLicenses||!this._licensedUserData.isManagedPackageLicense}},{key:"_refreshPermissionSets",value:function(){this.permissionSets.model=this._getPermissionSets()}},{key:"_refreshTeamList",value:function(){this.teamList.hidden=n2.isEmpty(this._licensedUserData.teams),this.teamList.data=this._licensedUserData.teams,this._refreshTeamListRows(),this._refreshRemoveAllTeamsButton()}},{key:"_refreshTeamListRows",value:function(){var t=this;this.teamList.forEachRow(function(e){return t._refreshTeamListRow(e)})}},{key:"_refreshTeamListRow",value:function(e){e.cls="",e.title="",e.data.teamIsActive&&e.data.memberIsActive||(e.cls="n2_inactive",!e.data.teamIsActive&&e.data.memberIsActive?e.title="Team is inactive":!e.data.memberIsActive&&e.data.teamIsActive?e.title="Team member is inactive":e.title="Team and team member are inactive")}},{key:"_refreshRemoveAllTeamsButton",value:function(){this.removeFromAllTeamsButton.hidden=n2.isEmpty(this._licensedUserData.teams)}},{key:"_getPermissionSets",value:function(){var e=[];return this._licensedUserData.hasAdminPS&&e.push("Admin"),this._licensedUserData.hasSystemManagerPS&&e.push("System Manager"),this._licensedUserData.hasTeamManagerPS&&e.push("Team Manager"),this._licensedUserData.hasUserPS&&e.push("User"),n2.isEmpty(e)?"None":e.join(", ")}},{key:"_showConfirmRemovalMessageBox",value:function(e,t){n2.de.component.ConfirmationMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({message:e,listeners:{submit:t,scope:this}})}},{key:"_getRemoveUserFromTeamsMessage",value:function(e){return"You are trying to remove ".concat(this._licensedUserData.name," from ").concat(this._getTeamNamesMessage(e),".  Are you sure you want to continue?")}},{key:"_getTeamNamesMessage",value:function(e){return 5<e.length?"".concat(e.length," teams"):1<e.length?"".concat(e.slice(0,-1).join(", ")," and ").concat(e.slice(-1)):e[0]}}]),i}(),n2.de.page.tags.component.TagsSlideOutPanel=function(){_inherits(t,n2.de.page.SlideOutPanel);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{emptyState:".n2_empty-state",distributorsUsage:".n2_distributors-usage",teamCapsUsage:".n2_team-caps-usage",teamWeightingsUsage:".n2_team-weightings-usage"}),this._componentCls="n2-de-tags-slide-out-panel",this._lazyLoad=!0,this._distributorFilterUsage=null,this._teamCapsUsage=null,this._teamWeightingUsage=null,this._emptyStateTemplate='<p class="n2_empty-state">This tag collection is not used by any teams for caps or weighting, or for distributor filters.</p>',this._distributorsUsageTemplate='<div class="n2_usage-list n2_distributors-usage n2_content">\n            <h3>Distributor filters</h3>\n            <ul>\n                {{#.}}\n                    <li{{^isActive}} class="n2_is-inactive"{{/isActive}}>\n                        <a href="javascript:void();" data-distributor-id="{{distributorId}}" data-team-id="{{teamId}}">{{distributorName}}</a>\n                        &nbsp;({{teamName}})&nbsp;\n                        {{#hasDynamicFilter}}<span class="n2_is-dynamic">Dynamic</span>{{/hasDynamicFilter}}\n                    </li>\n                {{/.}}\n            </ul>\n        </div>',this._teamCapsUsageTemplate='<div class="n2_usage-list n2_team-caps-usage n2_content">\n            <h3>Team caps</h3>\n            <ul>\n                {{#.}}<li{{^teamIsActive}} class="n2_is-inactive"{{/teamIsActive}}><a href="javascript:void();" data-team-id="{{teamId}}">{{teamName}}</a></li>{{/.}}\n            </ul>\n        </div>',this._teamWeightingsUsageTemplate='<div class="n2_usage-list n2_team-weightings-usage n2_content">\n            <h3>Team weightings</h3>\n            <ul>\n                {{#.}}<li{{^teamIsActive}} class="n2_is-inactive"{{/teamIsActive}}><a href="javascript:void();" data-team-id="{{teamId}}">{{teamName}}</a></li>{{/.}}\n            </ul>\n        </div>'}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).apply(this,arguments),{emptyStateTemplate:this._emptyStateTemplate})}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).apply(this,arguments),this.element("body").insert(n2.ui.Template.render(this._emptyStateTemplate,this._getTemplateData(),this._getTemplatePartials()))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.emptyState,t=void 0!==t&&t,n=e.distributorsUsage,n=void 0!==n&&n,i=e.teamCapsUsage,i=void 0!==i&&i,s=e.teamWeightingsUsage,s=void 0!==s&&s,e=n2.isEmpty(e);(t||e)&&this._refreshEmptyState(),(n||e)&&this._refreshDistributorsUsage(),(i||e)&&this._refreshTeamCapsUsage(),(s||e)&&this._refreshTeamWeightingsUsage()}},{key:"_refreshEmptyState",value:function(){this._hasUsages()?this._hideEmptyState():this._showEmptyState()}},{key:"_hideEmptyState",value:function(){this.element("emptyState").hide()}},{key:"_showEmptyState",value:function(){this.element("emptyState").show()}},{key:"_refreshDistributorsUsage",value:function(){this._removeDistributorsUsageDOM(),this._hasDistributorsUsage()&&this._insertDistributorsUsageDOM()}},{key:"_removeDistributorsUsageDOM",value:function(){n2.isNull(this.element("distributorsUsage"))||this.element("distributorsUsage").destroy()}},{key:"_insertDistributorsUsageDOM",value:function(){var t=this,e=this._distributorFilterUsage.map(function(e){return e.isActive=e.distributorIsActive&&e.teamIsActive,e});this.element("body").insert(n2.ui.Template.render(this._distributorsUsageTemplate,e)),this.element("distributorsUsage").listen("click",function(e){"A"===e.target.tagName&&t._navigateToDistributor(e.target.dataset.distributorId,e.target.dataset.teamId)})}},{key:"_navigateToDistributor",value:function(e,t){n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_refreshTeamCapsUsage",value:function(){this._removeTeamCapsUsageDOM(),this._hasTeamCapsUsage()&&this._insertTeamCapsUsageDOM()}},{key:"_removeTeamCapsUsageDOM",value:function(){n2.isNull(this.element("teamCapsUsage"))||this.element("teamCapsUsage").destroy()}},{key:"_insertTeamCapsUsageDOM",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._teamCapsUsageTemplate,this._teamCapsUsage)),this.element("teamCapsUsage").listen("click",function(e){"A"===e.target.tagName&&t._navigateToTeamWeightingsAndCaps(e.target.dataset.teamId)})}},{key:"_refreshTeamWeightingsUsage",value:function(){this._removeTeamWeightingsUsageDOM(),this._hasTeamWeightingsUsage()&&this._insertTeamWeightingsUsageDOM()}},{key:"_removeTeamWeightingsUsageDOM",value:function(){n2.isNull(this.element("teamWeightingsUsage"))||this.element("teamWeightingsUsage").destroy()}},{key:"_insertTeamWeightingsUsageDOM",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._teamWeightingsUsageTemplate,this._teamWeightingUsage)),this.element("teamWeightingsUsage").listen("click",function(e){"A"===e.target.tagName&&t._navigateToTeamWeightingsAndCaps(e.target.dataset.teamId)})}},{key:"_navigateToTeamWeightingsAndCaps",value:function(e){n2.de.page.Navigation.getInstance().open("Team_WeightingAndCaps","teamId=".concat(e))}},{key:"_hasUsages",value:function(){return this._hasDistributorsUsage()||this._hasTeamCapsUsage()||this._hasTeamWeightingsUsage()}},{key:"_hasDistributorsUsage",value:function(){return!n2.isEmpty(this._distributorFilterUsage)}},{key:"_hasTeamCapsUsage",value:function(){return!n2.isEmpty(this._teamCapsUsage)}},{key:"_hasTeamWeightingsUsage",value:function(){return!n2.isEmpty(this._teamWeightingUsage)}}]),t}(),n2.de.page.tags.tagAssignmentList.CloneAssignmentsModal=function(){_inherits(s,n2.de.component.Modal);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{infoMessage:".n2_clone-tags-info-message"}),this._headerTemplate='{{#header}}\n            <div class="slds-media slds-media_center slds-has-flexi-truncate">\n                <div class="slds-media__body">\n                    <h2 class="slds-text-heading_medium slds-hyphenate" id="{{id}}_heading"{{#header.title}} title="{{header.title}}"{{/header.title}}>{{header.text}}</h2>\n                </div>\n            </div>\n        {{/header}}',this._informationMessageTemplate='<div id="{{id}}_info-message" class="n2_clone-tags-info-message slds-grid">\n            <div class="slds-col">\n                <p>Select one or more other users to copy all of {{cloneUserName}}\'s tag assignments to.</p>\n            </div>\n        </div>',this.id="clone-assignments-modal",this.dataProviders=["clone-tag-assignments"],this._componentCls="n2-de-clone-assignments-modal",this._checkboxPrefix="n2_checkbox-",this.header="Clone Assignments",this._cloneUserId=null,this._cloneUserName=null,this._userTagAssignments=null,this._teamFilterValue=null,this._REFRESH=n2.merge(this._REFRESH,{cloneUserId:["infoMessage","form"]})}},{key:"userTagAssignments",set:function(e){this._userTagAssignments=e}},{key:"form",get:function(){return this._components["clone-assignments-form"]}},{key:"teamMemberPicker",get:function(){return this.form.components["member-picker"]}},{key:"cloneType",get:function(){return this.form.components["clone-type-selection"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){this._insertForm(),this._setTeamMembers(),_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments)}},{key:"show",value:function(e){var t=e.teamFilterValue,t=void 0===t?null:t,n=e.cloneUserId,n=void 0===n?null:n,i=e.cloneUserName,i=void 0===i?null:i;e.listeners;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this.form.clear(),this.cloneType.value="Append",this._setProperties({teamFilterValue:t,cloneUserId:n,cloneUserName:i}),this.submitButton.text="Clone Assignments",this.submitButton.reset(),this.cancelButton.enable()}},{key:"_refreshInfoMessage",value:function(){n2.isNull(this.element("infoMessage"))||this.element("infoMessage").destroy();var e=n2.ui.Template.render(this._informationMessageTemplate,this._getTemplateData(),this._getTemplatePartials());this.element("body").insert(e,"afterbegin")}},{key:"_refreshForm",value:function(){this._setTeamMembers()}},{key:"_setTeamMembers",value:function(){var t=this,n=[];n2.forEach(this._userTagAssignments,function(e){e.id!==t._cloneUserId&&n.push(e)}),this.teamMemberPicker.users=n}},{key:"_insertForm",value:function(){var e=[this._createTeamMemberPicker(),this._createCloneType()];return this.insert(new n2.ui.component.Form({id:"clone-assignments-form",components:e}))}},{key:"_createTeamMemberPicker",value:function(){return new n2.de.component.field.TeamMemberPicker({id:"member-picker",label:"Users",cls:"slds-m-bottom_medium",required:!0,users:this._userTagAssignments})}},{key:"_createCloneType",value:function(){return new n2.de.component.field.RadioButtonGroup({id:"clone-type-selection",cls:"slds-m-top_small",label:{text:"Select clone type"},required:!0,value:"Append",options:[{label:"Append",value:"Append"},{label:"Replace",value:"Replace"}]})}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.form.validate())return t=this.cloneType.value,n=this.teamMemberPicker.value,e.next=4,this._postDataProvider("clone-tag-assignments",{params:[t,this._cloneUserId,n]});e.next=5;break;case 4:_get(_getPrototypeOf(s.prototype),"_onSubmit",this).call(this);case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaved",value:function(){var e=this;_get(_getPrototypeOf(s.prototype),"_onSaved",this).call(this),new n2.util.DelayedTask(function(){e.destroy()},500).start()}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(s.prototype),"_getTemplateData",this).call(this),{cloneUserName:this._cloneUserName})}},{key:"_reset",value:function(){_get(_getPrototypeOf(s.prototype),"_reset",this).call(this),this.form.disabled=!1,this.form.clear(),this.cloneType.value="Append"}}]),s}(),n2.de.page.tags.tagAssignmentList.Context=function(){_inherits(n,n2.de.page.tags.Context);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._hasCollections=null,this._tagFilterData=null,this.selectedTagData=null,this.isDirty=!1}},{key:"hasCollections",get:function(){return this._hasCollections},set:function(e){this._hasCollections=e}},{key:"tagFilterData",get:function(){return this._tagFilterData}},{key:"clearTagFilterData",value:function(){this._tagFilterData=null}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,Promise.all([this._loadDataProvider("get-tag-filter-data",{silent:t,force:n}),this._loadDataProvider("get-tag-collections",{silent:t,force:n})]);case 3:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",{tagFilterData:i,tagCollections:s});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.tagFilterData,e=e.tagCollections;_get(_getPrototypeOf(n.prototype),"_onLoadComplete",this).apply(this,arguments),this._hasCollections=0<e.response.length,this._tagFilterData=this._getTagFilterData(t.response)}},{key:"_getTagFilterData",value:function(e){return""===e.tagCollectionId||""===e.tagId?null:e}}]),n}(),n2.de.page.tags.tagAssignmentList.ModifyAssignments=function(){_inherits(s,n2.de.component.tags.AbstractModifyTagAssignments);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"context",get:function(){return n2.de.page.tags.tagAssignmentList.Context.getInstance()}},{key:"ToolbarClass",get:function(){return n2.de.page.tags.tagAssignmentList.modifyAssignments.Toolbar}},{key:"saveDataProviderId",get:function(){return"save-tag-assignments"}},{key:"show",value:function(e){e.userIds,e.model;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this.load()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0===n||n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-collection-tag-assignments",{params:[this._userIds],silent:t,force:n});case 4:return e.t0=e.sent,e.abrupt("return",{collectionTagAssignments:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.collectionTagAssignments;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._collectionTagAssignments=e.response,this.context.isDirty=!1,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-collection-tag-assignments"===t.id&&(this._collectionTagAssignments=e,this.context.isDirty=!1,this._refresh())}}]),s}(),n2.de.page.tags.tagAssignmentList.ModifyAssignmentsModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this._headerTemplate='{{#header}}\n            <div class="slds-media slds-media_center slds-has-flexi-truncate">\n                <div class="slds-media__body">\n                    <h2 class="slds-text-heading_medium slds-hyphenate" id="{{id}}_heading"{{#header.title}} title="{{header.title}}"{{/header.title}}>{{header.text}}</h2>\n                </div>\n            </div>\n        {{/header}}',this.id="modify-assignments-modal",this.dataProviders=["save-tag-assignments"],this._componentCls="n2-de-modify-assignments-modal",this.header="Modify Assignments",this._userIds=null,this._userNames=null}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertModifyAssignments()}},{key:"modifyAssignments",get:function(){return this._components["n2_modify-assignments"]}},{key:"_insertModifyAssignments",value:function(){return this._insert(new n2.de.page.tags.tagAssignmentList.ModifyAssignments({id:"n2_modify-assignments",includeFormFooter:!1}))}},{key:"show",value:function(e){var t=e.userIds,t=void 0===t?null:t,e=e.userNames,e=void 0===e?[]:e;this.submitButton.text="Save Assignments",this.submitButton.reset(),this.cancelButton.enable(),this._userIds=t,this._userNames=e,this.modifyAssignments.show({userIds:t}),_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments)}},{key:"_getHeaderData",value:function(){return 1===this._userNames.length?{text:"Edit ".concat(this._userNames[0])}:{text:"Edit ".concat(this._userNames.length," users"),title:"".concat(this._userNames.join(", "))}}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),e.next=3,this._postDataProvider("save-tag-assignments",{params:[this._userIds,this.modifyAssignments.assignmentsForm.getTagSelectionDifferences()]});case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),n2.de.page.tags.tagAssignmentList.Context.getInstance().isDirty=!1,this.destroy()}}]),n}(),n2.de.page.tags.tagAssignmentList.TagAssignmentChangeHistoryModal=function(){_inherits(t,n2.de.page.team.ChangeHistoryModal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getColumns",value:function(){return[{header:"Date",cls:"n2_date-column",cell:{dataAdapter:function(e){return n2.de.util.Date.formatTimestamp(e.changeDatetime)}}},{header:"Name",cls:"n2_name-column",bindPath:".relatedUserOrQueue"},{header:"Action",bindPath:".historyString"},{header:"User",cls:"n2_user-column",bindPath:".username"}]}}]),t}(),n2.de.page.tags.tagAssignmentList.TagAssignmentRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"teamFilter",get:function(){return this._toolbar.teamFilter}},{key:"setFilter",value:function(e){var t=e.tagCollectionId,e=e.tagId;this._toolbar.tagCollectionFilter.value=t,this._toolbar.tagFilter.value=[e]}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.Toolbar({id:"tag-assignments-toolbar"}),this._dataTable=new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.DataTable({id:"tag-assignments-data-table",listeners:{selectionChange:this._updateMenu,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.Footer({id:"tag-assignments-footer"})}},{key:"_updateMenu",value:function(){var e=this._dataTable.selection,t=0<e.length,n=this._toolbar.menu.components["modify-assignments"];n.hidden=!t,t&&(n.label="Modify (".concat(e.length,")"))}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;if(n2.isEmpty(t))this._handleRemoveFilters(e);else switch(e.id){case this._toolbar.quickFilter.id:this._handleQuickFilter(t);break;case this._toolbar.teamFilter.id:this._handleTeamFilter(t);break;case this._toolbar.tagCollectionFilter.id:this._handleTagCollectionFilter(t);break;case this._toolbar.tagFilter.id:this._handleTagFilter(t)}_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)}},{key:"_handleRemoveFilters",value:function(e){var t=[e.id];e.id===this._toolbar.tagCollectionFilter.id&&(t.push(this._toolbar.tagFilter.id),this._toolbar.hideTagFilter()),this._dataTable.removeFilters(t)}},{key:"_handleQuickFilter",value:function(e){this._dataTable.addFilter(this._toolbar.quickFilter.id,{dataBindings:["name"],value:e})}},{key:"_handleTeamFilter",value:function(t){this._dataTable.addFilter(this._toolbar.teamFilter.id,{fcn:function(e){return e.data.teams.some(function(e){return e.id===t})}})}},{key:"_handleTagCollectionFilter",value:function(t){this._toolbar.reloadTagFilter(t),this._dataTable.addFilter(this._toolbar.tagCollectionFilter.id,{fcn:function(e){return e.data.tags.some(function(e){return e.collectionId===t})}})}},{key:"_handleTagFilter",value:function(n){this._dataTable.addFilter(this._toolbar.tagFilter.id,{fcn:function(e){return e.data.tags.some(function(t){return n.some(function(e){return t.tagId===e})})}})}},{key:"_refreshToolbar",value:function(){this._toolbar.clear(),this._toolbar.hideFilters(n2.isEmpty(this._data)),this._updateMenu()}}]),n}(),n2.de.page.tags.tagAssignmentList.TagAssignmentSlideOutPanel=function(){_inherits(a,n2.de.page.SlideOutPanel);var e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.Observable],this._mixins),this._componentCls="n2-tag-assignment-slide-out-panel"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertModifyAssignments()}},{key:"modifyAssignments",get:function(){return this._components["n2_modify-assignments"]}},{key:"_insertModifyAssignments",value:function(){return this._insert(new n2.de.page.tags.tagAssignmentList.ModifyAssignments({id:"n2_modify-assignments",listeners:{saved:this._handleSaved,cancel:this._handleCancel,scope:this}}))}},{key:"_handleSaved",value:function(){var e=this;this.fire.apply(this,["saved"].concat(Array.prototype.slice.call(arguments))),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_handleCancel",value:function(e){this.hide()}},{key:"show",value:function(){var e=arguments,t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.userIds,s=void 0===i?null:i;n.heading,n.includeNavButtons,n.components,n.listeners;n2.de.page.tags.tagAssignmentList.Context.getInstance().isDirty?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({message:"Changing users will lose any unsaved changes, are you sure you want to continue?",listeners:{submit:function(){_get(_getPrototypeOf(a.prototype),"show",t).apply(t,e),t.modifyAssignments.show({userIds:s})}}}):(_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this.modifyAssignments.show({userIds:s}))}},{key:"hide",value:function(){_get(_getPrototypeOf(a.prototype),"hide",this).apply(this,arguments),n2.de.page.tags.tagAssignmentList.Context.getInstance().isDirty=!1,this.modifyAssignments.reset()}}]),a}(),n2.de.page.tags.tagCollectionList.AddTagCollectionModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.id="add-tag-collection-modal",this.dataProviders=["add-tag-collection"],this._componentCls="n2-de-add-tag-collection-modal",this.header="New Tag Collection"}},{key:"form",get:function(){return this._components["add-form"]}},{key:"tagCollectionName",get:function(){return this.form.components["tag-collection-name"]}},{key:"tags",get:function(){return this.form.components.tags}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){return this.insert(new n2.ui.component.Form({id:"add-form",components:[{type:n2.de.component.field.UniqueNameField,id:"tag-collection-name",label:"Name",cls:"slds-m-bottom_medium",required:!0,maxLength:80},{type:n2.de.page.tags.component.field.TagPillList,id:"tags",label:"Tags",helpText:"You can create multiple tags by using a comma or pressing the tab key"}]}))}},{key:"show",value:function(e){e=e.tagCollectionNames,e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.form.clear(),this.tagCollectionName.names=e,this.submitButton.text="Create Tag Collection",this.submitButton.reset(),this.cancelButton.enable()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&(_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),this._postDataProvider("add-tag-collection",{params:[this.tagCollectionName.value,this.tags.value]}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(e){var t=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){t.spinner(!0),n2.de.page.Navigation.getInstance().open("Tags_TagValueList","tagCollectionId=".concat(e))},500).start()}}]),n}(),n2.de.page.tags.tagCollectionList.RenameTagCollectionModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.id="rename-tag-collection-modal",this.dataProviders=["edit-tag-collection"],this._componentCls="n2-de-rename-tag-collection-modal",this.header="Rename Tag Collection",this._tagCollectionModel=null}},{key:"form",get:function(){return this._components["rename-form"]}},{key:"tagCollectionName",get:function(){return this.form.components["tag-collection-name"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){return this.insert(new n2.ui.component.Form({id:"rename-form",components:[{type:n2.de.component.field.UniqueNameField,id:"tag-collection-name",mixins:[n2.mixin.DataDriven],label:"Name",cls:"slds-m-bottom_medium",required:!0,maxLength:80,value:{bindPath:".name"}}]}))}},{key:"show",value:function(e){var t=e.tagCollection,t=void 0===t?null:t,e=e.tagCollectionNames,e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.form.clear(),this._tagCollectionModel=new n2.dataProvider.Model({value:t}),this.tagCollectionName.model=this._tagCollectionModel,this.tagCollectionName.names=e,this.submitButton.text="Save",this.submitButton.reset(),this.cancelButton.enable()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&(_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),this._postDataProvider("edit-tag-collection",{params:[this._tagCollectionModel.json]}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),n}(),n2.de.page.tags.tagCollectionList.TagCollectionRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.tags.tagCollectionList.tagCollectionRecordList.Toolbar({id:"tag-collections-toolbar"}),this._dataTable=new n2.de.page.tags.tagCollectionList.tagCollectionRecordList.DataTable({id:"tag-collections-data-table",listeners:{selectionChange:this._updateMenu,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.tags.tagCollectionList.tagCollectionRecordList.Footer({id:"tag-collections-footer"})}},{key:"_updateMenu",value:function(){var e=this._dataTable.selection,t=0===e.length;(this._toolbar.menu.disabled=t)||(this._toolbar.menu.components["delete-tag-collections"].label="Delete (".concat(e.length,")"))}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;""===t?(this._dataTable.removeFilters([e.id]),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)):e.id===this._toolbar.quickFilter.id&&(this._dataTable.addFilter(this._toolbar.quickFilter.id,{dataBindings:["name"],value:t}),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments))}},{key:"_refreshToolbar",value:function(){_get(_getPrototypeOf(n.prototype),"_refreshToolbar",this).apply(this,arguments),this._updateMenu()}}]),n}(),n2.de.page.tags.tagCollectionList.TagCollectionSlideOutPanel=function(){_inherits(s,n2.de.page.tags.component.TagsSlideOutPanel);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{territoryCollectionMessage:".n2_territory-collection-message"}),this._componentCls="".concat(this._componentCls," n2-de-tag-collection-slide-out-panel"),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-tag-collection-usage"],this._tagCollectionId=null,this._tagCollectionUsage=null,this._territoryCollectionMessageTemplate='<p class="n2_territory-collection-message">This is a Territory tag collection for the {{territoryMapName}} map.</p>'}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.tagCollectionId,t=void 0===t?null:t;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this._tagCollectionId=t,this.load({force:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-tag-collection-usage",{params:[this._tagCollectionId],silent:t,force:n,requestId:this._tagCollectionId});case 4:return e.t0=e.sent,e.abrupt("return",{tagCollectionUsage:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.tagCollectionUsage;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollectionUsage=e.response,this._distributorFilterUsage=this._tagCollectionUsage.distributorFilterUsage,this._teamCapsUsage=this._tagCollectionUsage.teamCapsUsage,this._teamWeightingUsage=this._tagCollectionUsage.teamWeightingUsage,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-tag-collection-usage"===t.id&&(this._tagCollectionUsage=e,this._distributorFilterUsage=this._tagCollectionUsage.distributorFilterUsage,this._teamCapsUsage=this._tagCollectionUsage.teamCapsUsage,this._teamWeightingUsage=this._tagCollectionUsage.teamWeightingUsage,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments),e.territoryCollectionMessage),t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshTerritoryCollectionMessage()}},{key:"_refreshEmptyState",value:function(){if(this._isTerritoryCollection())return this._hideEmptyState();_get(_getPrototypeOf(s.prototype),"_refreshEmptyState",this).apply(this,arguments)}},{key:"_refreshDistributorsUsage",value:function(){if(this._isTerritoryCollection())return this._removeDistributorsUsageDOM();_get(_getPrototypeOf(s.prototype),"_refreshDistributorsUsage",this).apply(this,arguments)}},{key:"_refreshTeamCapsUsage",value:function(){if(this._isTerritoryCollection())return this._removeTeamCapsUsageDOM();_get(_getPrototypeOf(s.prototype),"_refreshTeamCapsUsage",this).apply(this,arguments)}},{key:"_refreshTeamWeightingsUsage",value:function(){if(this._isTerritoryCollection())return this._removeTeamWeightingsUsageDOM();_get(_getPrototypeOf(s.prototype),"_refreshTeamWeightingsUsage",this).apply(this,arguments)}},{key:"_refreshTerritoryCollectionMessage",value:function(){n2.isNull(this.element("territoryCollectionMessage"))||this._removeTerritoryCollectionMessageDOM(),this._isTerritoryCollection()&&this._insertTerritoryCollectionMessageDOM()}},{key:"_removeTerritoryCollectionMessageDOM",value:function(){this.element("territoryCollectionMessage").destroy()}},{key:"_insertTerritoryCollectionMessageDOM",value:function(){this.element("body").insert(n2.ui.Template.render(this._territoryCollectionMessageTemplate,this._tagCollectionUsage))}},{key:"_onOpenButtonClick",value:function(e){_get(_getPrototypeOf(s.prototype),"_onOpenButtonClick",this).apply(this,arguments),n2.de.page.Navigation.getInstance().open("Tags_TagValueList","tagCollectionId=".concat(this._tagCollectionId))}},{key:"_hasTagCollectionUsages",value:function(){return this._hasDistributorsUsage()||this._hasTeamCapsUsage()||this._hasTeamWeightingsUsage()}},{key:"_isTerritoryCollection",value:function(){return this._tagCollectionUsage.isTerritoryCollection}}]),s}(),n2.de.page.tags.tagValueList.AddTagsFromFieldModal=function(){_inherits(r,n2.de.component.Modal);var e,t,n,i,s,a,o=_createSuper(r);function r(){return _classCallCheck(this,r),o.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this,arguments),this.id="add-tags-from-field-modal",this.dataProviders=["add-tags"],this._componentCls="n2-de-add-tag-from-field-modal",this.header="Add Tags From Field",this._informationMessageTemplate='<div id="{{id}}_info-message" class="n2_add-tags-info-message slds-grid slds-m-top_x-large">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p>Only values that dont match existing tags will be added to the tag collection</p>\n            </div>\n        </div>'),this._lazyLoad=!0}},{key:"form",get:function(){return this._components["add-form"]}},{key:"teamObject",get:function(){return this.form.components["team-object"]}},{key:"fieldSelection",get:function(){return this.form.components["field-selection"]}},{key:"tags",get:function(){return this.form.components.tags}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(r.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){return this.insert(new n2.ui.component.Form({id:"add-form",components:[{type:n2.ui.component.field.Combo,id:"team-object",mixins:[n2.mixin.DataDriven],label:"Team object",cls:"slds-m-bottom_medium",required:!0,options:{bindPath:"."},listeners:{change:this._onTeamObjectChange,scope:this}},{type:n2.ui.component.field.Combo,id:"field-selection",mixins:[n2.mixin.DataDriven],label:"Field",cls:"slds-m-bottom_medium",required:!0,hidden:!0,options:[],listeners:{change:this._onFieldSelectionChange,scope:this}},{type:n2.de.page.tags.component.field.TagPillList,id:"tags",mixins:[n2.mixin.DataDriven],label:"Tags",required:!0,hidden:!0}]}))}},{key:"_onTeamObjectChange",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n2.isEmpty(this.teamObject.value)){e.next=5;break}return e.next=3,this._loadAllFieldObjects(this.teamObject.value);case 3:return t=e.sent,e.abrupt("return",(this._onAllFieldObjectsLoaded(t),t));case 5:this.fieldSelection.hidden=!0;case 6:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_loadAllFieldObjects",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,this._fetchDataProvider("get-all-field-objects",{params:[t],requestId:t,silent:!0,force:!1});case 3:return n=e.sent,e.abrupt("return",(this.spinner(!1),n));case 5:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_onAllFieldObjectsLoaded",value:function(e){e=n2.de.data.Adapters.objectFieldOptions(e.response,{validTypes:[n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.MULTIPICKLIST]});if(n2.isEmpty(e))return this.teamObject.markInvalid("No available picklists for the selected object");this.teamObject.clearInvalid(),this.fieldSelection.clear(),this.fieldSelection.hidden=!1,this.fieldSelection.options=e}},{key:"_onFieldSelectionChange",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n2.isEmpty(this.fieldSelection.value)){e.next=6;break}return this.tags.hidden=!1,this.tags.clear(),e.next=4,this._loadPicklistOptions(this.teamObject.value,this.fieldSelection.value);case 4:return t=e.sent,e.abrupt("return",(this._onPicklistOptionsLoaded(t),t));case 6:this.tags.hidden=!0;case 7:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_loadPicklistOptions",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.tags.spinner(),e.next=3,this._fetchDataProvider("get-picklist-options",{params:[t,n],requestId:"".concat(t,"-").concat(n),silent:!0,force:!1});case 3:return i=e.sent,e.abrupt("return",(this.tags.spinner(!1),i));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onPicklistOptionsLoaded",value:function(e){this.tags.value={value:e.response.map(function(e){return{text:e.label,value:e.value}}),validate:!1}}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(r.prototype),"_prepareDOM",this).call(this),this.element("body").insert(n2.ui.Template.render(this._informationMessageTemplate,this._getTemplateData(),this._getTemplatePartials()))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.listeners,e.existingTagNames),e=void 0===e?null:e;_get(_getPrototypeOf(r.prototype),"show",this).apply(this,arguments),this.form.clear(),this.tags.existingTagNames=e,this.submitButton.text="Add Tags",this.submitButton.reset(),this.cancelButton.enable(),this.load({silent:!0,force:!1})}},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=0<i.length&&void 0!==i[0]?i[0]:{}).silent,n=void 0===n||n,t.force,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-team-objects",{silent:n,force:!1});case 5:return e.t0=e.sent,e.abrupt("return",{teamObjects:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.teamObjects;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this.teamObject.model=e.response}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(r.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&(_get(_getPrototypeOf(r.prototype),"_onSubmit",this).call(this),this._postDataProvider("add-tags",{params:[n2.de.page.tags.tagValueList.Context.getInstance().tagCollectionId,this.tags.value]}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),r}(),n2.de.page.tags.tagValueList.AddTagsModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.id="add-tags-modal",this.dataProviders=["add-tags"],this._componentCls="n2-de-add-tag-modal",this.header="Add Tags"}},{key:"form",get:function(){return this._components["add-form"]}},{key:"tags",get:function(){return this.form.components.tags}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){return this.insert(new n2.ui.component.Form({id:"add-form",components:[{type:n2.de.page.tags.component.field.TagPillList,id:"tags",label:"Tags",helpText:"You can create multiple tags by using a comma or pressing the tab key",required:!0}]}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.listeners,e.existingTagNames),e=void 0===e?null:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.form.clear(),this.tags.existingTagNames=e,this.submitButton.text="Add Tags",this.submitButton.reset(),this.cancelButton.enable()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&(_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),this._postDataProvider("add-tags",{params:[n2.de.page.tags.tagValueList.Context.getInstance().tagCollectionId,this.tags.value]}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),n}(),n2.de.page.tags.tagValueList.Context=function(){_inherits(n,n2.de.page.tags.Context);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this._tagCollectionId=null,this._hasTeams=null,this._tagLimitReached=null}},{key:"tagCollectionId",get:function(){return this._tagCollectionId},set:function(e){this._tagCollectionId!==e&&(this._tagCollectionId=e)}},{key:"hasTeams",get:function(){return this._hasTeams},set:function(e){this._hasTeams!==e&&(this._hasTeams=e)}},{key:"tagLimitReached",get:function(){return this._tagLimitReached},set:function(e){this._tagLimitReached!==e&&(this._tagLimitReached=e,this.fire("change",this._createChangeEvent(this,[{property:"value",type:"set"}],{data:{tagLimitReached:this._tagLimitReached}})))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,Promise.all([this._loadDataProvider("get-tag-collection-data",{silent:t,force:n}),this._loadDataProvider("get-team-objects",{silent:t,force:n})]);case 3:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",{tagCollectionData:i,teamObjects:s});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.tagCollectionData,e=e.teamObjects;_get(_getPrototypeOf(n.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollectionId=t.response.tagCollectionId,this._hasTeams=0<e.response.length}}]),n}(),n2.de.page.tags.tagValueList.RenameTagModal=function(){_inherits(i,n2.de.component.Modal);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="rename-tag-modal",this.dataProviders=["edit-tag"],this._componentCls="n2-de-rename-tag-modal",this.header="Rename Tag",this._tagModel=null}},{key:"form",get:function(){return this._components["rename-form"]}},{key:"tagName",get:function(){return this.form.components["tag-name"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_insertForm",value:function(){var t=this;return this.insert(new n2.ui.component.Form({id:"rename-form",components:[{type:n2.de.component.field.UniqueNameField,id:"tag-name",mixins:[n2.mixin.DataDriven],label:"Name",cls:"slds-m-bottom_medium",maxLength:80,value:{bindPath:".name",adapter:function(e){return t._getTagNameAsClientValue(e)}}}]}))}},{key:"show",value:function(e){var t=this,n=e.tag,n=void 0===n?null:n,e=e.tagNames,e=void 0===e?null:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.form.clear(),this._tagModel=new n2.dataProvider.Model({value:n}),this.tagName.model=this._tagModel,this.tagName.names=e.map(function(e){return t._getTagNameAsClientValue(e)}),this.submitButton.text="Save",this.submitButton.reset(),this.cancelButton.enable()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(i.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&(_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this),(t=this._tagModel.getProperty("name")).set(this._getTagNameAsServerValue(t.json),{silent:!0}),this._postDataProvider("edit-tag",{params:[this._tagModel.json]}));case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}},{key:"_getTagNameAsClientValue",value:function(e){return e===n2.de.page.tags.Enum.BLANK_SERVER_VALUE?n2.de.page.tags.Enum.BLANK_CLIENT_VALUE:e}},{key:"_getTagNameAsServerValue",value:function(e){return e===n2.de.page.tags.Enum.BLANK_CLIENT_VALUE?n2.de.page.tags.Enum.BLANK_SERVER_VALUE:e}}]),i}(),n2.de.page.tags.tagValueList.TagValueRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.tags.tagValueList.tagValueRecordList.Toolbar({id:"tag-value-toolbar"}),this._dataTable=new n2.de.page.tags.tagValueList.tagValueRecordList.DataTable({id:"tag-value-data-table",listeners:{selectionChange:this._updateMenu,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.tags.tagValueList.tagValueRecordList.Footer({id:"tag-value-footer"})}},{key:"_updateMenu",value:function(){var e,t,n=this._toolbar.menu;this._data.isTerritoryCollection?n.hidden=!0:(n.hidden=!1,t=0===(e=this._dataTable.selection).length,(this._toolbar.menu.disabled=t)||(n.components["delete-tags"].label="Delete (".concat(e.length,")")))}},{key:"_updateAddButton",value:function(){this._toolbar.addNewSplitButton.hidden=this._data.isTerritoryCollection}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;""===t?(this._dataTable.removeFilters([e.id]),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)):e.id===this._toolbar.quickFilter.id&&(this._dataTable.addFilter(this._toolbar.quickFilter.id,{dataBindings:["name"],value:t}),_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments))}},{key:"_refreshToolbar",value:function(){this._toolbar.clear(),this._toolbar.hidden=n2.isEmpty(this._data.tagValues),this._updateMenu(),this._updateAddButton()}},{key:"_refreshDataTable",value:function(){this._dataTable.selectable=!this._data.isTerritoryCollection,this._dataTable.data=this._data.tagValues}}]),n}(),n2.de.page.tags.tagValueList.TagValueSlideOutPanel=function(){_inherits(s,n2.de.page.tags.component.TagsSlideOutPanel);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{userAssignments:".n2_user-assignments"}),this._componentCls="".concat(this._componentCls," n2-de-tag-value-slide-out-panel"),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-tag-value-usage"],this._emptyStateTemplate='<p class="n2_empty-state">This tag is not assigned to any users or used by any teams for caps or weighting, or for distributor filters.</p>',this._tagValueId=null,this._tagValueUsage=null,this._userAssignments='<div class="n2_usage-list n2_user-assignments n2_content">\n            <div class="n2_header">\n                <h3>User assignments</h3>\n                <a href="javascript:void();" class="slds-button slds-button_neutral">Assign tags</a>\n            </div>\n            <p>{{{userAssignmentText}}} been assigned this tag</p>\n        </div>'}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.tagValueId,t=void 0===t?null:t;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this._tagValueId=t,this.load({force:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-tag-value-usage",{params:[this._tagValueId],silent:t,force:n,requestId:this._tagValueId});case 4:return e.t0=e.sent,e.abrupt("return",{tagValueUsage:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.tagValueUsage;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagValueUsage=e.response,this._distributorFilterUsage=this._tagValueUsage.distributorFilterUsage,this._teamCapsUsage=this._tagValueUsage.teamCapsUsage,this._teamWeightingUsage=this._tagValueUsage.teamWeightingUsage,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-tag-value-usage"===t.id&&(this._tagValueUsage=e,this._distributorFilterUsage=this._tagValueUsage.distributorFilterUsage,this._teamCapsUsage=this._tagValueUsage.teamCapsUsage,this._teamWeightingUsage=this._tagValueUsage.teamWeightingUsage,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._refreshUserAssignments(),_get(_getPrototypeOf(s.prototype),"_refresh",this).call(this,e)}},{key:"_refreshUserAssignments",value:function(){this._removeUserAssignments(),this._hasUserAssignments()&&this._insertUserAssignmentsDOM()}},{key:"_removeUserAssignments",value:function(){n2.isNull(this.element("userAssignments"))||this.element("userAssignments").destroy()}},{key:"_insertUserAssignmentsDOM",value:function(){var t=this;this.element("body").insert(n2.ui.Template.render(this._userAssignments,{userAssignmentText:this._getUserAssignmentText()})),this.element("userAssignments").listen("click",function(e){"A"===e.target.tagName&&t._navigateToTagAssignmentList()})}},{key:"_getUserAssignmentText",value:function(){var e=this._tagValueUsage.assignedUsersCount;return 1===e?"<strong>1 user</strong> has":"<strong>".concat(e," users</strong> have")}},{key:"_navigateToTagAssignmentList",value:function(){var e=n2.de.page.tags.tagValueList.Context.getInstance().tagCollectionId;n2.de.page.Navigation.getInstance().open("Tags_TagAssignmentList","tagCollectionId=".concat(e,"&tagId=").concat(this._tagValueId))}},{key:"_hasUsages",value:function(){return _get(_getPrototypeOf(s.prototype),"_hasUsages",this).call(this)||this._hasUserAssignments()}},{key:"_hasUserAssignments",value:function(){return 0<this._tagValueUsage.assignedUsersCount}}]),s}(),n2.de.page.team.assignmentRejection.DistributorLevelRejection=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{toolbar:".n2_toolbar"}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-de-distributor-level-assignment-rejection{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><div class="n2_toolbar"></div></div>',this._modelChanged=!1,this._cachedDistributor=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter()}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.toolbar,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Find distributor...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this._components["distributor-assignment-rejections"].addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this._components["distributor-assignment-rejections"].removeFilters(["quickFilter"])}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadAssignmentRejection({force:t,silent:e})}},{key:"_loadAssignmentRejection",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-assignment-rejection-details").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onAssignmentRejectionDataLoaded(e)}},{key:"_onAssignmentRejectionDataLoaded",value:function(e){this._modelChanged=!1,this._model=e,this._insertDistributorAssignmentRejections(),this._components["quick-filter"].hidden=n2.isEmpty(this._model.get("distributors")),e.listen("change",this._onDistributorAssignmentRejectionsChange,this),n2.de.page.SlideOutPanel.getInstance().hidden||this._reloadSlideOutPanel()}},{key:"_reloadSlideOutPanel",value:function(){var e;n2.isNull(this._cachedDistributor)?n2.de.page.SlideOutPanel.getInstance().hidden=!0:(e=this._getDistributorModel(this._cachedDistributor.distributorId),n2.de.page.SlideOutPanel.getInstance().components["assignment-rejection-form"].model=e,this._cachedDistributor=e.json)}},{key:"_insertDistributorAssignmentRejections",value:function(){var s=this,e=(n2.isUndefined(this._components["distributor-assignment-rejections"])||this._components["distributor-assignment-rejections"].destroy(),this._model.get("distributors").length),t=1===e?"distributor":"distributors";return this._insert(new n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionDataTable({id:"distributor-assignment-rejections",data:this._model.get("distributors"),emptyState:{type:n2.de.page.team.assignmentRejection.distributorLevelRejection.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no distributors that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all distributors."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){s._components["quick-filter"].clear()}}}},listeners:{click:function(e,t,n,i){return s._onDataTableClick(e,t,n,i)}}}))}},{key:"_onDataTableClick",value:function(e,t,n,i){n2.isNull(this._cachedDistributor)||this._resetCachedDistributor();t=this._getDistributorModel(t.data.distributorId);this._cachedDistributor=t.json,this._showSlideOutPanel(t)}},{key:"_resetCachedDistributor",value:function(){var t,e,n=this._model.getProperty("distributors");n&&(t=this._cachedDistributor.distributorId,e=n.items.find(function(e){return e.distributorId===t}))&&(e=n.findChild(e).key,n2.isNull(e)||(n.remove(e,{silent:!0}),n.insert(this._cachedDistributor,{key:e,silent:!0})))}},{key:"_getDistributorModel",value:function(t){var n=new n2.dataProvider.Model({value:{}});return n.insert(this._model.getProperty("objectName"),{key:"objectName"}),n.insert(this._model.getProperty("supportsQueue"),{key:"supportsQueue"}),n.insert(this._model.getProperty("isPersonAccounts"),{key:"isPersonAccounts"}),n2.forEach(this._model.get("distributors").find(function(e){return e.distributorId===t}),function(e,t){n.insert(e,{key:t})}),n}},{key:"_showSlideOutPanel",value:function(t){var n=this;n2.de.page.SlideOutPanel.getInstance().show({heading:t.get("name"),components:[new n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionForm({id:"assignment-rejection-form",model:t})],listeners:{click:function(e){return n._onSlideOutPanelClick(e,t)}}})}},{key:"_onSlideOutPanelClick",value:function(e,t){switch(e.target.id){case"open-button":case"heading-button":this._onSlideOutPanelOpenButtonClick(t.get("distributorId"));break;case"close-button":this._modelChanged&&this._loadAssignmentRejection({force:!0}),this._cachedDistributor=null}}},{key:"_onSlideOutPanelOpenButtonClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_onDistributorAssignmentRejectionsChange",value:function(e){this._modelChanged=!0}},{key:"reload",value:function(){this._cachedDistributor=null,this._loadData({force:!0})}}]),n}(),n2.de.page.team.assignmentRejection.TeamLevelRejection=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{rejectionLimitOptions:".n2-de-rejection-limit-options",rejectionLimitValue:".n2-de-rejection-limit-value"}),this._mixins=[n2.mixin.DataDriven,n2.mixin.Observable],this.dataProviders=["save-team-assignment-rejection-settings"],this.layout='<div class="n2-de-rejection-limit slds-grid slds-grid_vertical-align-end"><div class="slds-col n2-de-rejection-limit-options"></div><div class="slds-col n2-de-rejection-limit-value"></div></div>',this._LIMIT_OPTIONS={UNLIMITED:"Unlimited",MANAGER_ONLY:"Manager-only",LIMITED:"Limited"},this._limitOption=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState(),this._insertRejectionLimitOptions(),this._insertDisableAssignmentRejectionButton()}},{key:"_insertEmptyState",value:function(){var e=this,t=this._insert(new n2.ui.component.Illustration({id:"empty-state",renderTo:this.SELECTORS.formBody,hidden:!0,illustration:n2.ui.component.illustration.FishingDeals,heading:"Assignment Rejection",content:"Allow team members to reject assignments and receive replacements. Rejection can be redirected on a per-distributor basis."}));return t.insert(new n2.ui.component.Button({id:"enable-assignment-rejection",text:"Enable Assignment Rejection",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(){return e._onEnableAssignmentRejectionButtonClick()}}})),t}},{key:"_onEnableAssignmentRejectionButtonClick",value:function(){this._model.getProperty("rejectionEnabled").value=!0}},{key:"_insertRejectionLimitOptions",value:function(){var t=this;return this._insert(new n2.de.component.field.RadioButtonGroup({id:"rejection-limit-options",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:{text:"Optionally impose restrictions on the number of rejections a user can make, or if only admins and system managers can reject.",position:n2.ui.enum.Position.BELOW},renderTo:this.SELECTORS.rejectionLimitOptions,required:!0,label:"Daily assignment rejection limit",options:[this._LIMIT_OPTIONS.UNLIMITED,this._LIMIT_OPTIONS.MANAGER_ONLY,this._LIMIT_OPTIONS.LIMITED],sort:!1,hidden:!0,listeners:{loaded:function(e){return t._onRejectionLimitOptionsLoaded(e)},change:function(e){return t._onRejectionLimitChange(e)}}}))}},{key:"_onRejectionLimitOptionsLoaded",value:function(e){this._limitOption=this._getRejectionLimitOption(),e.value={value:this._limitOption,silent:!0},this._refreshRejectionLimitValueVisibility()}},{key:"_onRejectionLimitChange",value:function(e){this._limitOption=e.value;e=this._getRejectionLimitValue();this._model.getProperty("teamRejectionValue")?this._model.getProperty("teamRejectionValue").value=e:this._model.insert(e,{key:"teamRejectionValue"}),this._refreshRejectionLimitValueVisibility()}},{key:"_getRejectionLimitOption",value:function(){var e=this._model.get("teamRejectionValue"),t=this._LIMIT_OPTIONS.UNLIMITED;return 0===e?t=this._LIMIT_OPTIONS.MANAGER_ONLY:0<e&&(t=this._LIMIT_OPTIONS.LIMITED),t}},{key:"_getRejectionLimitValue",value:function(){switch(this._limitOption){case this._LIMIT_OPTIONS.MANAGER_ONLY:return 0;case this._LIMIT_OPTIONS.LIMITED:return 1;default:return null}}},{key:"_refreshRejectionLimitValueVisibility",value:function(){this._limitOption===this._LIMIT_OPTIONS.LIMITED?this._showRejectionLimitValue():this._hideRejectionLimitValue()}},{key:"_showRejectionLimitValue",value:function(){n2.isUndefined(this._components["rejection-limit-value"])&&this._insertRejectionLimitValue(),this._components["rejection-limit-value"].model=this._model,this._components["rejection-limit-value"].hidden=!1,this._components["rejection-limit-value"].clearInvalid()}},{key:"_hideRejectionLimitValue",value:function(){n2.isUndefined(this._components["rejection-limit-value"])||(this._components["rejection-limit-value"].hidden=!0)}},{key:"_insertRejectionLimitValue",value:function(){return this._insert(new n2.ui.component.field.Number({id:"rejection-limit-value",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium slds-m-left_x-small",renderTo:this.SELECTORS.rejectionLimitValue,required:!0,min:1,label:{text:"Assignment Rejection Limit Value",hidden:!0},value:{bindPath:".teamRejectionValue"},hidden:!0}))}},{key:"_insertDisableAssignmentRejectionButton",value:function(){var e=this,t=this._insert(new n2.de.component.form.FieldGroup({id:"disable-assignment-rejection",hidden:!0,heading:"Disable assignment rejection",cls:"n2_disable-assignment-rejection"}));return t.insert(new n2.ui.component.Button({id:"disable-assignment-rejection-button",text:"Disable Assignment Rejection",theme:n2.ui.component.button.Theme.TEXT_DESTRUCTIVE,listeners:{click:function(){return e._onDisableAssignmentRejectionButtonClick()}}})),t}},{key:"_onDisableAssignmentRejectionButtonClick",value:function(){var e=this;n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom.parent}).show({message:"Are you sure you want to disable assignment rejection?",listeners:{submit:function(){return e._onDisableAssignmentRejectionConfirm()}}})}},{key:"_onDisableAssignmentRejectionConfirm",value:function(){var e=this._model.json;e.rejectionEnabled=!1,this.spinner(),this._resetFooter(),this._saveAssignmentRejection(e)}},{key:"_saveAssignmentRejection",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._model.json,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).silent,t=void 0!==t&&t;n2.DataProviderManager.getInstance().get("save-team-assignment-rejection-settings").post({params:[e],silent:t})}},{key:"_loadAssignmentRejection",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-assignment-rejection-details").get({params:[n],force:t,silent:e})}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadAssignmentRejection({force:t,silent:e})}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-team-level-assignment-rejection")}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadAssignmentRejection({force:!0})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onAssignmentRejectionDataLoaded(e)}},{key:"_onAssignmentRejectionDataLoaded",value:function(e){n2.de.page.team.Context.getInstance().isDirty=!1,this._model=e,this._refreshFieldVisibility(),(this._components["rejection-limit-options"].model=e).listen("change",this._onAssignmentRejectionModelChange,this)}},{key:"_onAssignmentRejectionModelChange",value:function(e){n2.de.page.team.Context.getInstance().isDirty=!0,this._refreshFieldVisibility(),this._showFooter()}},{key:"_refreshFieldVisibility",value:function(){this._model.get("rejectionEnabled")?(this._showEditView(),this._showEmptyState({show:!1})):(this._showEmptyState(),this._showEditView({show:!1}))}},{key:"_showEditView",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).show,e=void 0===e||e;this._components["rejection-limit-options"].hidden=!e,this._components["disable-assignment-rejection"].hidden=!e}},{key:"_showEmptyState",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).show;this._components["empty-state"].hidden=!(void 0===e||e)}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(n.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.Context.getInstance().isDirty=!0}},{key:"_onSubmit",value:function(){this._saveAssignmentRejection()}},{key:"_onCancel",value:function(){this._loadAssignmentRejection({force:!0})}}]),n}(),n2.de.page.team.availability.AvailabilityRecordList=function(){_inherits(t,n2.de.component.AbstractRecordList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-availability-record-list"),this._filterOptionsData=null,this._REFRESH={filterOptionsData:["toolbar"]}}},{key:"filterOptionsData",set:function(e){this._setProperty("filterOptionsData",e,{sync:!1})}},{key:"availabilityCalendar",get:function(){return this._dataTable}},{key:"toolbar",get:function(){return this._toolbar}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.team.availability.availabilityRecordList.Toolbar({id:"availability-toolbar"}),this._dataTable=new n2.de.component.AvailabilityCalendar({id:"availability-calendar",currentDate:n2.de.util.Date.convertDateToTimeZone(new Date),listeners:{click:this._handleTableClick,scope:this}})}},{key:"_insertFooter",value:function(){return null}},{key:"_handleClick",value:function(e){this.fire("click",e)}},{key:"_handleChange",value:function(e){this._dataTable.filter({userIds:this._toolbar.teamMemberFilter.value,tagIds:this._toolbar.tagFilter.value}),_get(_getPrototypeOf(t.prototype),"_handleChange",this).apply(this,arguments)}},{key:"loadAvailabilityData",value:function(e,t){t=t.weekNumber;this.availabilityCalendar.loadAvailabilityData(e,{weekNumber:t})}},{key:"_refreshToolbar",value:function(){this._toolbar.clear(),this._toolbar.filterOptionsData=this._filterOptionsData}},{key:"_refreshFooter",value:function(){}}]),t}(),n2.de.page.team.distributionHours.Context=function(){_inherits(t,n2.de.page.team.Context);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._teamShiftHoursId=null}},{key:"teamShiftHoursId",get:function(){return this._teamShiftHoursId},set:function(e){this._teamShiftHoursId!==e&&(this._teamShiftHoursId=e)}}]),t}(),n2.de.page.team.distributionHours.ShiftSummary=function(){_inherits(s,n2.de.component.form.FieldGroup);var n,e,t,i=_createSuper(s);function s(){return _classCallCheck(this,s),i.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{shiftsBody:".n2_shifts-body",body:null}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-de-shift-summary slds-grid slds-grid_vertical{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2_shifts-body slds-m-top_medium"></div>\n        </div>',this.EDIT_MODE={NONE:"NONE",SHIFT:"SHIFT",HOURS:"HOURS"},this._editMode=null,this._dirtyModel=!1,this._dirty=!1}},{key:"dirty",get:function(){return this._dirty},set:function(e){this._dirty!==e&&(this._dirty=e)}},{key:"editMode",set:function(e){this._editMode!==e&&(this._editMode=e,this._refreshEditMode())}},{key:"shiftHoursComponent",get:function(){return this._components["shift-hours"]}},{key:"shiftPageMessage",get:function(){return this._components["shift-page-message"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertShiftSelection(),this._insertNoShiftsMessage(),this._insertShiftPageMessage(),this._insertTimezoneSummary(),this._insertEditHoursButton()}},{key:"_insertShiftSelection",value:function(){var t=this;return this._insert(new n2.ui.component.field.Combo({id:"shift-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-shift-names"],cls:"slds-m-top_medium n2_field-medium",label:"Shift",required:!0,renderTo:{target:this.SELECTORS.shiftsBody,position:"beforebegin"},options:{bindPath:"get-shift-names"},value:{bindPath:".shiftHoursId"},listeners:{change:function(e){return t._onShiftSelectionChange(e)}},disabled:{bindPath:"get-shift-names",adapter:function(e){return n2.isEmpty(e)}}}))}},{key:"_onShiftSelectionChange",value:function(e){this._loadShiftHours(e.value,{force:!0}),this._refreshEditMode()}},{key:"_insertNoShiftsMessage",value:function(){var e=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager;return this._insert(new n2.ui.component.HTML({id:"no-shifts-message",mixins:[n2.mixin.DataDriven],template:'<div id="{{id}}" class="n2_no-shifts-message slds-grid slds-hide">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_x-small slds-m-right_small slds-col slds-no-flex slds-icon-text-default"}),'\n                <div class="slds-col">\n                    {{#model}}<p>Before you can use shifts, you\'ll need to add a shift</p>{{/model}}\n                    {{^model}}<p>There are no shifts available to be assigned</p>{{/model}}\n                </div>\n            </div>'),model:e}))}},{key:"_insertShiftPageMessage",value:function(){var e;return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?(e=new n2.ui.component.Button({id:"shift-page-link",cls:"n2_shift-page-link",text:"shift list page",renderTo:".n2_shift-page-link",listeners:{click:function(e){n2.de.page.Navigation.getInstance().open("Availability_Shifts")}}}),this._insert(new n2.ui.component.HTML({id:"shift-page-message",template:'<p id="{{id}}" class="n2_shift-page-message">Shifts are global across all teams. Manage shifts from the <span class="n2_shift-page-link"></span></p>',components:[e]}))):null}},{key:"_insertTimezoneSummary",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"timezone-summary",label:"Timezone",disabled:!0}))}},{key:"_insertEditHoursButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"edit-hours",mixins:[n2.mixin.DataDriven],text:"Edit Hours",cls:"n2_edit-button",listeners:{click:function(e){return t._onEditHoursButtonClick(e)}}}))}},{key:"_onEditHoursButtonClick",value:function(e){var t=this,n=this._getShiftHoursModel();n2.de.component.hours.ShiftHoursModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({model:n,header:this._getEditModalHeader(),timezoneOptions:n2.DataProviderManager.getInstance().get("get-timezones").model,shiftNames:this._getCurrentShiftNames({includeCurrentShiftName:!1}),listeners:{submit:function(e){return t._onEditShiftHoursModalSubmit(e)},change:function(){return t._onShiftHoursChange()}}})}},{key:"_onShiftHoursChange",value:function(){this._dirtyModel=!0}},{key:"_getEditModalHeader",value:function(){var e=this._getShiftHoursModel();return e.isShiftHours?"Edit ".concat(e.name):this._model.get("name")?"Edit ".concat(this._model.get("name"),"'s hours"):"Edit hours"}},{key:"_onEditShiftHoursModalSubmit",value:function(e){e.hide(),this._dirtyModel&&(this._dirty=!0,this._model.getProperty("shiftHours").set(e.data),this._isShiftHours()&&this._refreshSelectedShiftOption(),this._refreshSummary())}},{key:"_refreshSelectedShiftOption",value:function(){var e=this._getShiftHoursModel().name,t=this._components["shift-selection"];t.element("field").attribute("value",e),t.listBox.selectedOptions[0].label=e}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,e=e.force,e=void 0!==e&&e;_get(_getPrototypeOf(s.prototype),"_loadData",this).apply(this,arguments),this.loadShiftNames({silent:t,force:e})}},{key:"_loadShiftHours",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(n=1<s.length&&void 0!==s[1]?s[1]:{}).force,i=void 0!==i&&i,n=n.silent,n=void 0!==n&&n,e.next=3,n2.DataProviderManager.getInstance().get("get-shift-hours").get({params:[t],force:i,silent:n});case 3:i=e.sent,this._onShiftHoursLoaded(i);case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onShiftHoursLoaded",value:function(e){e.isShiftHours&&(this._components["shift-selection"].model=this._model),this._model.getProperty("shiftHours").set(e),this._refreshNoShiftsMessage(),this._refreshSummary()}},{key:"loadShiftNames",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0!==t&&t,n=n.force,n=void 0!==n&&n,this._components["no-shifts-message"].hidden=!0,n2.DataProviderManager.getInstance().get("get-shift-names").get({force:n,silent:t});case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&this._onTeamHoursModelLoaded();case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onTeamHoursModelLoaded",value:function(){this._dirty=!1,this._dirtyModel=!1,this._isShiftHours()&&(this._components["shift-selection"].model=this._model),this._refreshNoShiftsMessage(),this._refreshTimezoneSummary(),this._refreshDays(),this._refreshShiftPageMessage()}},{key:"validate",value:function(){var e=_get(_getPrototypeOf(s.prototype),"validate",this).apply(this,arguments),t=this._components["shift-selection"];return e=t.hidden||!t.disabled||t.validate()?e:!1}},{key:"_destroyNewShiftOption",value:function(){var e=this._components["shift-selection"];n2.isUndefined(e.listBox.components["new-shift-option"])||e.listBox.remove("new-shift-option",{destroy:!0})}},{key:"_refreshEditMode",value:function(){switch(this._editMode){case this.EDIT_MODE.NONE:this._components["shift-selection"].hidden=!0,this._components["edit-hours"].hidden=!0,this._refreshShiftPageMessage();break;case this.EDIT_MODE.HOURS:this._components["shift-selection"].hidden=!0,this._components["edit-hours"].hidden=!1,this._refreshShiftPageMessage();break;case this.EDIT_MODE.SHIFT:this._components["shift-selection"].hidden=!1,this._components["edit-hours"].hidden=!0,this._refreshShiftPageMessage()}}},{key:"_refreshSummary",value:function(){this._refreshDays(),this._refreshTimezoneSummary()}},{key:"_refreshNoShiftsMessage",value:function(){this._components["no-shifts-message"].hidden=!this._isShiftHours()||!n2.isEmpty(this._getCurrentShiftNames())}},{key:"_refreshShiftPageMessage",value:function(){n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this.shiftPageMessage.hidden=this._editMode!==this.EDIT_MODE.SHIFT)}},{key:"_refreshDays",value:function(){var e=this._isShiftHours()?this.model.get("shiftHoursId"):null;e&&this.model.get("hoursType")!==n2.de.enum.distributionHours.HoursType.TEAM&&(this._components["shift-selection"].value={value:e,silent:!0}),n2.isUndefined(this.shiftHoursComponent)||this.shiftHoursComponent.destroy(),this._insertShiftHoursComponent()}},{key:"_insertShiftHoursComponent",value:function(){var e=this._getShiftHoursModel();return this._insert(new n2.de.component.hours.ShiftHours({id:"shift-hours",renderTo:this.SELECTORS.shiftsBody,shiftDays:e.days}))}},{key:"_refreshTimezoneSummary",value:function(){var e=this._isShiftHours()&&n2.isEmpty(this._components["shift-selection"].value);(this._components["timezone-summary"].hidden=e)||(this._components["timezone-summary"].value={value:this._getTimezoneLabel(),silent:!0})}},{key:"_getTimezoneLabel",value:function(e){var t=this;return n2.DataProviderManager.getInstance().get("get-timezones").model.find(function(e){return e.value===t._getShiftHoursModel().timezone}).label}},{key:"_formatBlocksTimeOutput",value:function(e){var t=this;return e.map(function(e){return t._formatBlockTimeOutput(e)})}},{key:"_formatBlockTimeOutput",value:function(e){return{startTime:this._formatTimeOutput(e.startHour,e.startMinute),endTime:this._formatTimeOutput(e.endHour,e.endMinute)}}},{key:"_formatTimeOutput",value:function(e,t){return"".concat(this._getHourValue(e),":").concat(this._getMinuteValue(t)).concat(this._getMeridiemValue(e))}},{key:"_getHourValue",value:function(e){return 24<e?e-24:12<e?e-12:0===e?12:e}},{key:"_getMinuteValue",value:function(e){return e<10?"0".concat(e):e}},{key:"_getMeridiemValue",value:function(e){return 24<=e?"am (+1)":12<=e?"pm":"am"}},{key:"_getCurrentShiftNames",value:function(){var t=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeCurrentShiftName,e=void 0===e||e,n=n2.DataProviderManager.getInstance().get("get-shift-names").model;return n2.isNull(n)?[]:(n=e?n:n.filter(function(e){return e.value!==t._model.get("shiftHoursId")})).map(function(e){return e.label})}},{key:"_isShiftHours",value:function(){return this._getShiftHoursModel().isShiftHours}},{key:"_getShiftHoursModel",value:function(){return this._model.get("shiftHours")}}]),s}(),n2.de.page.team.distributionHours.TeamHolidayRegion=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-holiday-region-options","get-team-holiday-region","save-team-holiday-region"],this._template='<div id="{{id}}" class="n2-de-team-holiday-region n2-de-form{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2-de-field-group slds-form-element"></div>\n        </div>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this),this._insertEmptyState(),this._insertTeamHolidayRegionField()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.de.page.team.distributionHours.teamHolidayRegion.EmptyState({id:"empty-state",renderTo:this.SELECTORS.formBody,hidden:!0}))}},{key:"_insertTeamHolidayRegionField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"team-holiday-region",mixins:[n2.mixin.DataDriven],label:"Team holiday region",helpText:{text:"The holiday region used for this teams holiday events",position:n2.ui.enum.Position.BELOW},hidden:!0,cls:"n2_field-large",placeholder:"None",options:[],value:{bindPath:".holidayRegion"}}))}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadTeamHolidayRegionOptions({force:t,silent:e}),this._loadTeamHolidayRegion()}},{key:"_loadTeamHolidayRegionOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;return n2.DataProviderManager.getInstance().get("get-holiday-region-options").get({force:t,silent:e})}},{key:"_loadTeamHolidayRegion",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.distributionHours.Context.getInstance().teamId;return n2.DataProviderManager.getInstance().get("get-team-holiday-region").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){switch(_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),t.id){case"get-holiday-region-options":this._onHolidayRegionOptionsLoaded(e);break;case"get-team-holiday-region":this._onTeamHolidayRegionLoaded(e)}}},{key:"_onHolidayRegionOptionsLoaded",value:function(e){var t=!n2.isEmpty(e);this._components["empty-state"].hidden=t,this._components["team-holiday-region"].hidden=!t,this._components["team-holiday-region"].options=e}},{key:"_onTeamHolidayRegionLoaded",value:function(e){n2.de.page.team.distributionHours.Context.getInstance().isDirty=!1,this._model=e,this._components["team-holiday-region"].model=e,this._model.listen("change",this._onTeamRegionModelChange,this)}},{key:"_onTeamRegionModelChange",value:function(e){n2.de.page.team.distributionHours.Context.getInstance().isDirty=!0,this._showFooter()}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(n.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.distributionHours.Context.getInstance().isDirty=!0}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),this._saveTeamHolidayRegion()}},{key:"_saveTeamHolidayRegion",value:function(){var e=this._model.json;return""===e.holidayRegion&&(e.holidayRegion=null),n2.DataProviderManager.getInstance().get("save-team-holiday-region").post({params:[e]})}},{key:"_onSaved",value:function(e){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadTeamHolidayRegion({force:!0})}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),n2.de.page.team.distributionHours.Context.getInstance().isDirty&&this._loadTeamHolidayRegion({force:!0})}}]),n}(),n2.de.page.team.distributionHours.TeamHours=function(){_inherits(s,n2.de.component.Form);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-team-hours","save-team-hours"],this._template='<div id="{{id}}" class="n2-de-team-hours n2-de-form{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2-de-field-group slds-form-element"></div>\n        </div>',this._DEFAULT_SHIFT_HOURS={isShiftHours:!0},this._DEFAULT_TEAM_HOURS={days:n2.de.enum.distributionHours.DefaultHours.TEAM_HOURS,isShiftHours:!1,timezone:n2.de.ApplicationContext.getInstance().timeZone},this._shiftHoursCache=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertAvailabilitySelection(),this._insertShiftSummary()}},{key:"_insertAvailabilitySelection",value:function(){var t=this;return this._insert(new n2.ui.component.field.RadioButtonGroup({id:"availability",mixins:[n2.mixin.DataDriven],label:"Availability",helpText:{text:"Distribute 24x7 or wait for business hours before assigning - by selecting an existing shift or setting team hours.",position:n2.ui.enum.Position.BELOW},options:[{label:"Team hours",value:n2.de.enum.distributionHours.HoursType.TEAM},n2.de.enum.distributionHours.HoursType.SHIFT],sort:!1,value:{bindPath:".hoursType"},listeners:{change:function(e){return t._onAvailabilityChange(e)}}}))}},{key:"_onAvailabilityChange",value:function(e){var t,n=this._shiftHoursCache;this._cacheShiftHours(),this._model.getProperty("shiftHoursId").set(null),n2.isNull(n)?(t=this._isShiftHours()?this._DEFAULT_SHIFT_HOURS:this._DEFAULT_TEAM_HOURS,this._model.getProperty("shiftHours").set(t),this._refreshShiftSummary(),this._components["shift-summary"].dirty=!this._isShiftHours()):(this._applyShiftHourCache(n),this._refreshShiftSummary(),this._components["shift-summary"].dirty=n.dirty)}},{key:"_cacheShiftHours",value:function(){this._shiftHoursCache={shiftHoursId:this._model.get("shiftHoursId"),shiftHours:this._model.get("shiftHours"),dirty:this._components["shift-summary"].dirty}}},{key:"_applyShiftHourCache",value:function(e){this._model.getProperty("shiftHoursId").set(e.shiftHoursId),this._model.getProperty("shiftHours").set(e.shiftHours)}},{key:"_insertShiftSummary",value:function(){return this._insert(new n2.de.page.team.distributionHours.ShiftSummary({id:"shift-summary",renderTo:this.SELECTORS.formBody}))}},{key:"reload",value:function(){this._components["shift-summary"].loadShiftNames({force:!0}),this._loadData({force:!0}),this._components["save-footer"].hide()}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(s.prototype),"_loadData",this).apply(this,arguments),this._loadTeamHours({force:t,silent:e}),this._shiftHoursCache=null}},{key:"_loadTeamHours",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.distributionHours.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-team-hours").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-team-hours"===t.id&&(n2.de.page.team.distributionHours.Context.getInstance().teamShiftHoursId=e.get("shiftHoursId"),this._onTeamHoursModelLoaded(e))}},{key:"_onTeamHoursModelLoaded",value:function(e){n2.de.page.team.distributionHours.Context.getInstance().isDirty=!1,this._model=e,this._components.availability.model=this._model,this._refreshShiftSummary(),this._model.listen("change",this._onTeamHoursModelChange,this)}},{key:"_refreshShiftSummary",value:function(){var e=this._components["shift-summary"];e.model=this._model,e.editMode=this._isShiftHours()?e.EDIT_MODE.SHIFT:e.EDIT_MODE.HOURS}},{key:"_onTeamHoursModelChange",value:function(e){n2.de.page.team.distributionHours.Context.getInstance().isDirty=!0,this._showFooter()}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(s.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.distributionHours.Context.getInstance().isDirty=!0}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(s.prototype),"_onSubmit",this).apply(this,arguments);var e=n2.de.page.team.distributionHours.Context.getInstance().teamId,t=this._model.get("hoursType"),n="new-shift"===(n=this._model.get("shiftHoursId"))?null:n,i=null;this._components["shift-summary"].dirty&&(i=this._model.get("shiftHours")),n2.DataProviderManager.getInstance().get("save-team-hours").post({params:[e,t,n,i]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(s.prototype),"_onSaved",this).apply(this,arguments),this._components["shift-summary"].loadShiftNames({force:!0}),this._loadData({force:!0})}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(s.prototype),"_onCancel",this).apply(this,arguments),n2.de.page.team.distributionHours.Context.getInstance().isDirty&&(this._components["shift-summary"].loadShiftNames({force:!0}),this._loadData({force:!0}))}},{key:"_isShiftHours",value:function(){return this._components.availability.value===n2.de.enum.distributionHours.HoursType.SHIFT}}]),s}(),n2.de.page.team.distributionHours.TeamMemberHours=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{toolbar:".n2_toolbar"}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-de-team_member_hours slds-m-around_medium{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2_toolbar">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>\n        </div>',this._VIEWS={MEMBER_HOURS:"member-hours",SHIFT_PLANNER:"shift-planner"},this._currentView=null}},{key:"currentView",set:function(e){if(this._currentView!==e){var t=Object.values(this._VIEWS);if(!t.includes(e))throw new Error("Current type must be one of ".concat(t));this._currentView=e,this._showCurrentViewComponent()}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this),this._insertActiveFilter(),this._insertTeamFilter(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertCurrentViewSwitch(),this._insertTeamMembers(),this._insertShiftPlanner()}},{key:"_insertActiveFilter",value:function(){var n=this;this.insert(new n2.ui.component.field.Combo({id:"active-filter",renderTo:".n2_left",cls:"slds-col slds-size_7-of-12 n2_active-filter",label:{text:"Filter team members",hidden:!0},placeholder:"All statuses",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],sort:!1,listeners:{change:function(e){var t=n._getViewComponents(),e=""===e.value?null:{value:e.value};t.current.filter("activeFilter",e)}}}))}},{key:"_insertTeamFilter",value:function(){var t=this;return this._insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:".n2_right",cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Quick filter...",allowClear:!0,listeners:{type:function(e){t._getViewComponents().current.filter("quick",{value:e.value})},change:function(e){n2.isEmpty(e.value)&&t._getViewComponents().current.filter("quick",null)}}}))}},{key:"_insertCurrentViewSwitch",value:function(){this._insert(new n2.ui.component.Button({id:"current-type-switch",cls:"n2-current-type-switch",renderTo:".n2_right",text:"",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._onCurrentViewChange,scope:this}}))}},{key:"_onCurrentViewChange",value:function(e){var t=this;this._currentView===this._VIEWS.SHIFT_PLANNER?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom}).show({message:"Switching to Member Hours will remove all shift changes. Are you sure you want to continue?",listeners:{submit:function(){t._loadToggleView()}}}):this._loadToggleView()}},{key:"_insertTeamMembers",value:function(){return this._insert(new n2.de.page.team.distributionHours.teamMemberHours.MemberHours({id:"member-hours",cls:"n2_member-hours",listeners:{loaded:this._onTeamMembersLoaded,click:this._onViewComponentClick,scope:this},hidden:!0}))}},{key:"_onTeamMembersLoaded",value:function(e,t,n){n2.isNull(n)||"get-team-member-hours"!==n.id||(n=t.get("teamMembers"),t=n2.isEmpty(n),this._components["quick-filter"].hidden=t,this._components["active-filter"].hidden=t)}},{key:"_insertShiftPlanner",value:function(){return this._insert(new n2.de.page.team.distributionHours.teamMemberHours.ShiftPlanner({id:"shift-planner",cls:"n2_shift-planner",listeners:{loadComplete:this._onShiftPlannerLoadComplete,click:this._onViewComponentClick,scope:this},hidden:!0}))}},{key:"_onShiftPlannerLoadComplete",value:function(e,t){t=n2.isEmpty(t.model.teamMemberShifts)||t.model.isCloneInProgress;this._components["quick-filter"].hidden=t,this._components["active-filter"].hidden=t}},{key:"_getViewComponents",value:function(){var e={current:null,disused:null};switch(this._currentView){case this._VIEWS.MEMBER_HOURS:e.current=this._components["member-hours"],e.disused=this._components["shift-planner"];break;case this._VIEWS.SHIFT_PLANNER:e.current=this._components["shift-planner"],e.disused=this._components["member-hours"]}return e}},{key:"_showCurrentViewComponent",value:function(){var e,t=this._getViewComponents(),t=(t.current.hidden=!1,t.disused.hidden=!0,this._components["current-type-switch"]);n2.isUndefined(t)||(e=this._currentView===this._VIEWS.SHIFT_PLANNER?"Switch to Member Hours":"Switch to Shift Planner",t.text=e)}},{key:"_onViewComponentClick",value:function(e){e.data.types.includes("clearFilters")&&this._clearFilters()}},{key:"reload",value:function(){n2.isNull(this._currentView)||this._getViewComponents().current.reload()}},{key:"show",value:function(){_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),n2.isNull(this._currentView)?this._loadView():this.reload()}},{key:"_loadView",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0===t||t,e=e.force,e=void 0!==e&&e,n=n2.de.page.team.distributionHours.Context.getInstance().teamId;this._loadDataProvider("is-shift-planner-enabled",{params:[n],silent:t,force:e})}},{key:"_loadToggleView",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0===t||t,e=e.force,e=void 0===e||e,n=n2.de.page.team.distributionHours.Context.getInstance().teamId;this._loadDataProvider("toggle-shift-planner",{params:[n],silent:t,force:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),"is-shift-planner-enabled"===t.id&&(this.currentView=e?this._VIEWS.SHIFT_PLANNER:this._VIEWS.MEMBER_HOURS,this._updateFilterPlaceholder()),"toggle-shift-planner"===t.id&&(this._toggleView(),n2.de.page.team.distributionHours.Context.getInstance().isDirty=!1)}},{key:"_toggleView",value:function(){this._currentView===this._VIEWS.MEMBER_HOURS?this.currentView=this._VIEWS.SHIFT_PLANNER:this.currentView=this._VIEWS.MEMBER_HOURS,this._clearFilters()}},{key:"_updateFilterPlaceholder",value:function(){var e="Quick filter...";this._currentView===this._VIEWS.SHIFT_PLANNER&&(e="Find member..."),this._components["quick-filter"].placeholder=e}},{key:"_clearFilters",value:function(){this._updateFilterPlaceholder(),this._components["active-filter"].clear(),this._components["quick-filter"].clear();var e=this._getViewComponents();e.current.filter("quick",null),e.current.filter("activeFilter",null)}}]),n}(),n2.de.page.team.distributorList.DistributorRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._componentCls="".concat(this._componentCls," n2-de-distributor-record-list"),this._distributorType=null,this._hasManualDistributor=!1}},{key:"distributorType",set:function(e){n2.compare(e,this._distributorType)||(this._distributorType=e,this._refresh({dataTable:!0,toolbar:!0}))}},{key:"hasManualDistributor",set:function(e){n2.compare(e,this._hasManualDistributor)||(this._hasManualDistributor=e,this._refresh({toolbar:!0}))}},{key:"dataTable",get:function(){return this._dataTable}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.team.distributorList.distributorRecordList.Toolbar({id:"distributors-toolbar"}),this._dataTable=new n2.de.page.team.distributorList.distributorRecordList.DataTable({id:"distributors-data-table",listeners:{selectionChange:this._handleSelectionChange,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.team.distributorList.distributorRecordList.Footer({id:"distributors-footer"})}},{key:"_handleSelectionChange",value:function(){this._refresh({toolbar:!0})}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;switch(e.id){case this._toolbar.quickFilter.id:this._handleQuickFilter(t);break;case this._toolbar.activeStatusFilter.id:this._handleActiveStatusFilter(t)}_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)}},{key:"_handleQuickFilter",value:function(e){this._dataTable.addFilter(this._toolbar.quickFilter.id,{dataBindings:["name"],value:e})}},{key:"_handleActiveStatusFilter",value:function(e){""===e?this._dataTable.removeFilters(["activeStatusFilter"]):this._dataTable.addFilter("activeStatusFilter",{dataBindings:["isActive"],value:e})}},{key:"_refreshToolbar",value:function(){_get(_getPrototypeOf(n.prototype),"_refreshToolbar",this).call(this),this._toolbar.distributorType=this._distributorType,this._toolbar.hasManualDistributor=this._hasManualDistributor,this._toolbar.recordSelectionCount=this._dataTable.selection.length,"Distributor"===this._distributorType?this._toolbar.showAssignmentSimulationMenuOption=0<this._dataTable.distributorsData.length:this._toolbar.showAssignmentSimulationMenuOption=!1}},{key:"_refreshDataTable",value:function(){this._dataTable.distributorType=this._distributorType,this._dataTable.distributorsData=this._getDistributorDataByType(this._distributorType),this._dataTable.clearSelection({silent:!0})}},{key:"_getDistributorDataByType",value:function(e){if(n2.isEmpty(this._data))return[];switch(this._distributorType){case n2.de.enum.distributor.Type.PULL:return this._data.pull||[];case n2.de.enum.distributor.Type.TRIGGER:return this._data.trigger||[];case n2.de.enum.distributor.Type.MANUAL:return this._data.manual||[];default:return this._data.distributor||[]}}}]),n}(),n2.de.page.team.distributorList.DistributorSlideOutPanel=function(){_inherits(s,n2.de.page.SlideOutPanel);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-distributor-slide-out-panel",this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-distributor-summary"],this._lazyLoad=!0,this._distributorId=null,this._distributorSummaryData=null}},{key:"distributorSummary",get:function(){return this._components["distributor-summary"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertDistributorSummary()}},{key:"_insertDistributorSummary",value:function(){return this._insert(new n2.de.page.team.distributorList.distributorSlideOutPanel.DistributorSummary({id:"distributor-summary"}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.distributorId,t=void 0===t?null:t;e.heading,e.includeNavButtons,e.components,e.listeners;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this._distributorId=t,this.load({force:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-distributor-summary",{params:[this._distributorId],silent:t,force:n,requestId:this._distributorId});case 4:return e.t0=e.sent,e.abrupt("return",{distributorSummaryData:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.distributorSummaryData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._distributorSummaryData=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"distributor-summary"===t.id&&(this._distributorSummaryData=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.distributorSummary,t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshDistributorSummary()}},{key:"_refreshDistributorSummary",value:function(){this.distributorSummary.model=this._distributorSummaryData}}]),s}(),n2.de.page.team.distributorList.NewDistributorModal=function(){_inherits(i,n2.de.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="new-distributor-modal",this.dataProviders=["get-new-distributor-settings","create-distributor"],this._cls="n2-de-new-distributor-modal",this._distributorType=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertNewDistributorForm()}},{key:"_onLoaded",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),"get-new-distributor-settings"===t.id&&(this._model=e,this._model.getProperty("distributorType",{defaultValue:n2.de.enum.distributor.Type.STANDARD}).value=this._distributorType,this._components["new-distributor-form"].components["distributor-name"].model=e,this._distributorRequiresSource())&&((t=new n2.dataProvider.Model({value:{}})).insert(this._model.getProperty("objectName"),{key:"objectName"}),t.insert(this._model.getProperty("supportsQueues"),{key:"supportsQueues"}),t.insert(this._model.getProperty("sourceType",{defaultValue:this._model.get("supportsQueues")?"Queue":"User"}),{key:"selectionType"}),t.insert(this._model.getProperty("sourceId",{defaultValue:""}),{key:"selectedId"}),t.insert(this._model.getProperty("sourceName",{defaultValue:""}),{key:"selectedName"}),t.insert(this._model.getProperty("sourceStatusField",{defaultValue:""}),{key:"selectedStatusField"}),t.insert(this._model.getProperty("sourceReadyStatus",{defaultValue:""}),{key:"selectedReadyStatus"}),t.insert(this._model.getProperty("sourceAssignedStatus",{defaultValue:""}),{key:"selectedAssignedStatus"}),this._components["new-distributor-form"].components.source.model=t)}},{key:"_distributorRequiresSource",value:function(){return this._distributorType!==n2.de.enum.distributor.Type.TRIGGER&&this._distributorType!==n2.de.enum.distributor.Type.MANUAL}},{key:"_insertNewDistributorForm",value:function(){var e=new n2.ui.component.Form({id:"new-distributor-form"});e.insert(new n2.de.component.field.UniqueNameField({id:"distributor-name",mixins:[n2.mixin.DataDriven],label:"Distributor name",cls:"slds-m-bottom_medium n2_field-width",required:!0,value:{bindPath:".name"},nameValidationMessage:"Distributor names must be unique within a team"})),e.insert(new n2.de.component.field.SourceSelection({id:"source",mixins:[n2.mixin.DataDriven],label:"Source",required:!0,cls:"slds-m-bottom_medium",allowNoneOption:!1,teamId:n2.de.page.team.Context.getInstance().teamId,hidden:!0})),this.insert(e)}},{key:"_getOKButtonConfig",value:function(){return{text:"Create Distributor"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(i.prototype),"_onSaving",this).apply(this,arguments),this._components["new-distributor-form"].disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),this.spinner();var n=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","teamId=".concat(n,"&distributorId=").concat(e))}},{key:"show",value:function(e){var t=e.distributorType,t=void 0===t?"Distributor":t,e=e.distributorsData,e=void 0===e?[]:e,t=(_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header=t!==n2.de.enum.distributor.Type.STANDARD?"New ".concat(t," Distributor"):"New Distributor",this._distributorType=t,this._components["new-distributor-form"]),t=(t.components.source.hidden=!this._distributorRequiresSource(),t.components["distributor-name"].names=e.map(function(e){return e.name}),n2.de.page.team.Context.getInstance().teamId);n2.DataProviderManager.getInstance().get("get-new-distributor-settings").get({params:[t],force:!0,silent:!1})}},{key:"_onSubmit",value:function(){this._components["new-distributor-form"].validate()&&(_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("create-distributor").post({params:[this._model.json]}))}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onError",this).apply(this,arguments),n2.de.Error.isDE2(e)&&this._components["submit-button"].disable()}},{key:"_reset",value:function(){_get(_getPrototypeOf(i.prototype),"_reset",this).call(this),this._components["new-distributor-form"].disabled=!1,this._components["new-distributor-form"].clear()}}]),i}(),n2.de.page.team.distributorList.ReorderDistributorsModal=function(){_inherits(t,n2.de.component.Modal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this.id="reorder-distributors-modal",this.dataProviders=["reorder-distributors"],this._cls="n2-de-reorder-distributors-modal",this._header="Reorder Distributors"}},{key:"_getOKButtonConfig",value:function(){return{text:"Set Order"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(t.prototype),"_onSaving",this).apply(this,arguments),this._components["ordered-distributors-data-table"].reorderable=!1}},{key:"_onSaved",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){e.hide(),e._reset()},500).start()}},{key:"show",value:function(e){e=e.data,e=void 0===e?null:e;n2.sort(e,{property:"order"}),this._insertReorderDataTable(e),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this._components["ordered-distributors-data-table"].headerRow.dom.hide(!1)}},{key:"_insertReorderDataTable",value:function(e){e=new n2.ui.component.DataTable({id:"ordered-distributors-data-table",columns:[{header:"Distributor Name",bindPath:"name"}],data:e,reorderable:!0});this.insert(e)}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(t.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("reorder-distributors").post({params:[this._components["ordered-distributors-data-table"].data]})}},{key:"_reset",value:function(){_get(_getPrototypeOf(t.prototype),"_reset",this).call(this),this._components["ordered-distributors-data-table"].destroy()}}]),t}(),n2.de.page.team.distributorSettings.Context=function(){_inherits(l,n2.de.page.team.Context);var e,t=_createSuper(l);function l(){return _classCallCheck(this,l),t.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).apply(this,arguments),this._distributorId=null}},{key:"distributorId",get:function(){return this._distributorId},set:function(e){this._distributorId!==e&&(this._distributorId=e)}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,r);case 3:return o=e.sent,i=o.teamData,s=o.isQ2QTeam,a=o.isTriggersEnabled,o=o.licenseDetails,e.t0=i,e.t1=s,e.t2=a,e.t3=o,e.next=14,this._fetchDataProvider("get-distributor-data",{silent:t,force:n});case 14:return e.t4=e.sent,e.abrupt("return",{teamData:e.t0,isQ2QTeam:e.t1,isTriggersEnabled:e.t2,licenseDetails:e.t3,distributorData:e.t4});case 16:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).call(this,e),this._distributorId=e.distributorData.response.distributorId}}]),l}(),n2.de.page.team.distributorSettings.DistributorSettingsForm=function(){_inherits(l,n2.de.component.Form);var e,t,n,i=_createSuper(l);function l(){return _classCallCheck(this,l),i.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-distributor-settings"],this._lazyLoad=!0,this._distributorSettings=null,this._distributorNames=null,this._teamObjectFieldOptions=null,this._resetTeamMemberFilterOptionsOnCancel=!1}},{key:"generalSettings",get:function(){return this._components["general-settings"]}},{key:"methodSettings",get:function(){return this._components["method-settings"]}},{key:"sourceSettings",get:function(){return this._components["source-settings"]}},{key:"teamMemberFilter",get:function(){return this._components["team-member-filter"]}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(l.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.distributorSettings.Context.getInstance().isDirty=!0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(l.prototype),"_onDefined",this).apply(this,arguments),this._insertGeneralSettings(),this._insertMethodSettings(),this._insertSourceSettings(),this._insertTeamMemberFilter()}},{key:"_insertGeneralSettings",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.GeneralSettings({id:"general-settings"}))}},{key:"_insertMethodSettings",value:function(){var t=this;return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.MethodSettings({id:"method-settings",cls:"n2_indent-left n2-de-method-settings",listeners:{methodTypeChange:function(e){t._refresh({teamMemberFilter:!0}),t.teamMemberFilter.refreshTeamMemberExclusion()}}}))}},{key:"_insertSourceSettings",value:function(){var n=this;return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.SourceSettings({id:"source-settings",cls:"n2_indent-left",listeners:{change:function(e,t){n._shouldRefreshTeamMemberFilterOptions(t)&&(n._resetTeamMemberFilterOptionsOnCancel||(n._resetTeamMemberFilterOptionsOnCancel=!0),t=e.model.get("sourceType"),e=e.model.get("sourceId"),e="User"!==t||n2.isEmpty(e)||"None"===e?null:e,n.teamMemberFilter.refreshTeamMemberSelection({newSourceType:t,newSourceId:e}))}}}))}},{key:"_insertTeamMemberFilter",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.TeamMemberFilter({id:"team-member-filter",cls:"n2_indent-left",hidden:!0}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(l.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._distributorSettings=e,this.load({force:!1}))}},{key:"_load",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,r);case 3:return s=n2.de.page.team.distributorSettings.Context.getInstance().distributorId,i=n2.de.page.team.distributorSettings.Context.getInstance().teamId,a=this._distributorSettings.get("objectName"),e.next=8,Promise.all([this._loadDataProvider("get-distributor-names",{params:[i,s],force:n,silent:t}),this._loadDataProvider("get-team-object-field-options",{params:[a],force:n,silent:t,requestId:a})]);case 8:return i=e.sent,s=_slicedToArray(i,2),a=s[0],o=s[1],e.abrupt("return",{distributorNames:a,teamObjectFieldOptions:o});case 13:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e.distributorSettings;var t=e.distributorNames,e=e.teamObjectFieldOptions;_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).apply(this,arguments),this._distributorNames=t.response,this._teamObjectFieldOptions=e.response,this._refresh()}},{key:"_onError",value:function(){_get(_getPrototypeOf(l.prototype),"_onError",this).call(this),this.spinner(!1)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.generalSettings,i=e.methodSettings,i=void 0!==i&&i,s=e.sourceSettings,s=void 0!==s&&s,e=e.teamMemberFilter,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshGeneralSettings(),(t||i)&&this._refreshMethodSettings(),(t||s)&&this._refreshSourceSettings(),(t||e)&&this._refreshTeamMemberFilter()}},{key:"_refreshGeneralSettings",value:function(){this.generalSettings.distributorNames=this._distributorNames,this.generalSettings.model=this._distributorSettings}},{key:"_refreshMethodSettings",value:function(){this.methodSettings.teamObjectFieldOptions=this._teamObjectFieldOptions,this.methodSettings.model=this._distributorSettings}},{key:"_refreshSourceSettings",value:function(){this.sourceSettings.teamObjectFieldOptions=this._teamObjectFieldOptions,this.sourceSettings.model=this._distributorSettings,this.sourceSettings.hidden=this._isManualDistributorType()}},{key:"_refreshTeamMemberFilter",value:function(){this.teamMemberFilter.hidden=this._shouldHideTeamMemberFilters(this._distributorSettings.get("method")),this.teamMemberFilter.hidden||(this.teamMemberFilter.model=this._distributorSettings)}},{key:"_onSubmit",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._distributorSettings.get("distributorType")===n2.de.enum.distributor.Type.TRIGGER&&this._distributorSettings.get("method")===n2.de.enum.distributor.Method.LOAD_BALANCING&&(this._distributorSettings.getProperty("isSticky").value=!1),t=this._distributorSettings.json,e.next=4,this._postDataProvider("save-distributor-settings",{params:[t]});case 4:this._resetDirtyFlag(),this._resetTeamMemberFilterOptionsOnCancelFlag();case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onCancel",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._resetDirtyFlag(),e.t0=this._resetTeamMemberFilterOptionsOnCancel,e.t0)return e.next=5,this.teamMemberFilter.refreshTeamMemberSelection({refreshTeamMemberOptionsOnly:!0});e.next=6;break;case 5:this._resetTeamMemberFilterOptionsOnCancelFlag();case 6:this.validate();case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_disable",value:function(t){_get(_getPrototypeOf(l.prototype),"_disable",this).apply(this,arguments),this.forEach({type:n2.de.component.form.FieldGroup,fcn:function(e){e.disabled=t}})}},{key:"_resetDirtyFlag",value:function(){n2.de.page.team.distributorSettings.Context.getInstance().isDirty=!1}},{key:"_shouldRefreshTeamMemberFilterOptions",value:function(e){return!this.teamMemberFilter.hidden&&this.teamMemberFilter.model.get("hasTeamMemberFilter")&&"source"===e.id}},{key:"_resetTeamMemberFilterOptionsOnCancelFlag",value:function(){this._resetTeamMemberFilterOptionsOnCancel=!1}},{key:"_shouldHideTeamMemberFilters",value:function(e){return e===n2.de.enum.distributor.Method.LOOKUP_OWNER||e===n2.de.enum.distributor.Method.RELATED_OWNER||this._isManualDistributorType()}},{key:"_isManualDistributorType",value:function(){return this._distributorSettings.get("distributorType")===n2.de.enum.distributor.Type.MANUAL}}]),l}(),n2.de.page.team.postAssignment.PostAssignmentDataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._cls="n2-de-post-assignment-data-table",this._HEADERS={distributor:"Distributor",type:"Type",order:"Order",enabled:"Enabled",fieldToUpdate:"Fields to update"},this.columns=[{header:this._HEADERS.distributor,bindPath:"name"},{header:this._HEADERS.type,bindPath:"distributorType",cls:"n2_type-column"},{header:this._HEADERS.order,bindPath:"order",cls:"n2_order-column",cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.enabled,cell:{cellTemplate:"{{#content.fieldUpdateEnabled}}Yes{{/content.fieldUpdateEnabled}}{{^content.fieldUpdateEnabled}}No{{/content.fieldUpdateEnabled}}"},cls:"n2_enabled-column"},{header:this._HEADERS.fieldToUpdate,cell:{cellTemplate:"",type:n2.ui.component.dataTable.Cell,components:[{id:"distributor-field-update-label",cls:"n2-de-summary",mixins:[n2.mixin.DataDriven],type:n2.de.component.MultiFieldUpdateLabel}]}}]}},{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(n.prototype),"_addHeaderRow",this).apply(this,arguments);var t=[this._HEADERS.order];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_createRow",value:function(){var e=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return e.data.isActive||(e.cls="n2_inactive"),e}}]),n}(),n2.de.page.team.postAssignment.PostAssignmentDistributors=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters",activeFilterContainer:".n2_active-filter-container",actions:".n2_actions",distributorsContainer:".n2_distributors-container"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-distributors"],this._template='<div id="{{id}}" class="n2-component n2-de-distributors {{cls}}">\n            <div class="n2_filters n2_fixed-height slds-grid slds-grid_vertical-align-center slds-hide">\n                <div class="n2_active-filter-container slds-col slds-grid"></div>\n                <div class="n2_actions slds-col"></div>\n            </div>\n            <div class="n2_distributors-container"></div>\n        </div>',this._modelChanged=!1,this._cachedDistributor=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertActiveFilter(),this._insertQuickFilter()}},{key:"_insertActiveFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"active-status-filter",renderTo:this.SELECTORS.activeFilterContainer,cls:"slds-col slds-size_5-of-12 n2_active-filter",label:{text:"Filter distributors",hidden:!0},placeholder:"All",options:[{label:"Enabled",value:!0},{label:"Disabled",value:!1}],sort:!1,listeners:{change:function(e){""===e.value?t.components["post-assignment-data-table"].removeFilters(["activeFilter"]):t.components["post-assignment-data-table"].addFilter("activeFilter",{dataBindings:["fieldUpdateEnabled"],value:e.value})}}}))}},{key:"_insertQuickFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.actions,cls:"n2_quick-filter",label:{text:"Find distributor",hidden:!0},placeholder:"Find distributor...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this.components["post-assignment-data-table"].addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this.components["post-assignment-data-table"].removeFilters(["quickFilter"])}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadDistributorPostAssignments({force:t,silent:e})}},{key:"_loadDistributorPostAssignments",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributors").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-distributors"!==t.id||this._onDistributorPostAssignmentLoaded(e)}},{key:"_onDistributorPostAssignmentLoaded",value:function(e){var t=this;this._modelChanged=!1,this._model=e,this._components["active-status-filter"].clear(),this._components["quick-filter"].clear(),n2.isEmpty(e.json)?this.element("filters").hide():this.element("filters").show(),this._insertPostAssignmentDataTable(),e.listen("change",function(){return t._onModelChange()},this),n2.de.page.SlideOutPanel.getInstance().hidden||this._reloadSlideOutPanel()}},{key:"_reloadSlideOutPanel",value:function(){var e;n2.isNull(this._cachedDistributor)?n2.de.page.SlideOutPanel.getInstance().hidden=!0:(e=this._getDistributorModel(this._cachedDistributor.distributorId),this._cachedDistributor=e.json,n2.de.page.SlideOutPanel.getInstance().components["post-assignment-form"].model=e)}},{key:"_insertPostAssignmentDataTable",value:function(){var i=this,e=(n2.isUndefined(this._components["post-assignment-data-table"])||this._components["post-assignment-data-table"].destroy(),this._model.json.length),t=1===e?"distributor":"distributors";return this.insert(new n2.de.page.team.postAssignment.PostAssignmentDataTable({id:"post-assignment-data-table",renderTo:this.SELECTORS.distributorsContainer,data:this._model,emptyState:{type:n2.de.page.team.postAssignment.postAssignmentDataTable.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no distributors that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all distributors."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){i._components["active-status-filter"].clear(),i._components["quick-filter"].clear()}}}},listeners:{click:function(e,t,n){return i._onDataTableClick(e,t,n)}}}))}},{key:"_onDataTableClick",value:function(e,t,n){n2.isNull(this._cachedDistributor)||this._resetCachedDistributor();t=this._getDistributorModel(t.data.distributorId);this._cachedDistributor=t.json,this._showSlideOutPanel(t)}},{key:"_resetCachedDistributor",value:function(){var e=this._getDistributorModel(this._cachedDistributor.distributorId),e=this._model.findChild(e).key;n2.isNull(e)||(this._model.remove(e,{silent:!0}),this._model.insert(this._cachedDistributor,{key:e,silent:!0}))}},{key:"_getDistributorModel",value:function(t){return this._model.items.find(function(e){return e.get("distributorId")===t})}},{key:"_showSlideOutPanel",value:function(t){var n=this;n2.de.page.SlideOutPanel.getInstance().show({heading:t.get("name"),components:[new n2.de.page.team.postAssignment.PostAssignmentForm({id:"post-assignment-form",model:t})],listeners:{click:function(e){return n._onSlideOutPanelClick(e,t)}}})}},{key:"_onSlideOutPanelClick",value:function(e,t){switch(e.target.id){case"open-button":case"heading-button":this._onSlideOutPanelOpenButtonClick(t.get("distributorId"));break;case"close-button":this._modelChanged&&this._loadDistributorPostAssignments({force:!0}),this._cachedDistributor=null}}},{key:"_onSlideOutPanelOpenButtonClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_onModelChange",value:function(){this._modelChanged=!0}},{key:"reload",value:function(){this._cachedDistributor=null,this._loadData({force:!0})}}]),n}(),n2.de.page.team.postAssignment.PostAssignmentForm=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-distributor-post-assignment-settings"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertPostAssignmentSettings()}},{key:"_insertPostAssignmentSettings",value:function(){return this._insert(new n2.de.page.team.postAssignment.PostAssignmentSettings({id:"post-assignment-settings",cls:"n2-de-post-assignment-settings slds-p-horizontal_medium slds-p-vertical_small"}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["post-assignment-settings"].model=e)}},{key:"_showFooter",value:function(){this._components["save-footer"].message="",this._components["save-footer"].hidden=!1}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("save-distributor-post-assignment-settings").post({params:[this._model.json]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadDistributors({force:!0})}},{key:"_onCancel",value:function(){this._loadDistributors({force:!0})}},{key:"_loadDistributors",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributors").get({params:[n],force:t,silent:e})}}]),n}(),n2.de.page.team.postAssignment.PostAssignmentObjectSync=function(){_inherits(a,n2.ui.Component);var t,e,n=_createSuper(a);function a(){return _classCallCheck(this,a),n.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._componentCls="n2-team-object-sync",this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} slds-p-around_medium {{cls}}">\n            <div class="n2_team-object-sync-settings slds-p-bottom_medium"></div>           \n            <div class="n2_team-object-sync-actions"></div>\n        </div>',this._actionTemplate='<div id="{{id}}" class="slds-grid slds-m-top_small slds-border_left">\n            <div class="slds-col slds-size_2-of-12 slds-border_top slds-border_bottom">\n                <div class="slds-p-around_small">\n                    <div class="n2_action-detail-label">Related object</div>      \n                    <div id="{{id}}_related-object" class="n2_action-detail-value">{{model.relatedObjectLabel}}</div>         \n                </div>\n            </div>          \n            <div class="slds-col slds-size_4-of-12 slds-border_left slds-border_right slds-border_top slds-border_bottom">\n                <div class="slds-p-around_small">\n                    <div class="n2_action-detail-label">Filters</div>\n                    <div class="n2_action-filters-container"></div>\n                </div>\n            </div>        \n        </div>'}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=n2.de.page.team.Context.getInstance().teamId,e.next=6,this._loadDataProvider("get-team-object-sync-settings",{params:[i],silent:t,force:n});case 6:return e.t0=e.sent,e.abrupt("return",{teamObjectSyncSettings:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.teamObjectSyncSettings;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._model=e.response,this._insertEmptyState(),this._insertObjectSyncToggle(),this._insertActionsList()}},{key:"_insertEmptyState",value:function(){if(n2.isUndefined(this._components["empty-state"])||this._components["empty-state"].destroy(),n2.isEmpty(this._model.objectSyncActions))return this._insert(new n2.de.page.team.postAssignment.postAssignmentObjectSync.EmptyState({id:"empty-state",objectName:this._model.objectName}))}},{key:"_insertObjectSyncToggle",value:function(){var t=this;if(n2.isUndefined(this._components["toggle-object-sync-enabled"])||this._components["toggle-object-sync-enabled"].destroy(),!n2.isEmpty(this._model.objectSyncActions))return this._insert(new n2.ui.component.field.CheckboxToggle({id:"toggle-object-sync-enabled",cls:"n2_toggle-active n2_large",label:{text:"Enable Object sync",hidden:!1},helpText:"Enabling Object Sync will update the following related objects to the same owner when an object is assigned by this team.",renderTo:{target:".n2_team-object-sync-settings",position:"afterBegin"},value:this._model.isTeamObjectSyncEnabled,listeners:{change:function(e){return t._onObjectSyncToggleChange(e)}}}))}},{key:"_onObjectSyncToggleChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(!0),this._model.isTeamObjectSyncEnabled=t.value,e.next=4,this._postDataProvider("save-team-object-sync-settings",{params:[this._model]});case 4:n2.isUndefined(this._components["object-sync-actions-container"])||(this._components["object-sync-actions-container"].cls=this._model.isTeamObjectSyncEnabled?"":"n2_inactive-actions"),this.spinner(!1);case 6:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_insertActionsList",value:function(){var e,n,i=this;if(n2.isUndefined(this._components["object-sync-actions-container"])||this._components["object-sync-actions-container"].destroy(),!n2.isEmpty(this._model.objectSyncActions))return e=this._model.isTeamObjectSyncEnabled?"":"n2_inactive-actions",n=this._insert(new n2.ui.component.HTML({id:"object-sync-actions-container",renderTo:{target:".n2_team-object-sync-actions",position:"beforeEnd"},cls:e,template:'<div id="{{id}}" class="{{cls}}"><div class="slds-form-element__label">Actions</div></div>'})),this._model.objectSyncActions.forEach(function(e,t){n.insert(new n2.ui.component.HTML({id:"action-container-".concat(t),mixins:[n2.mixin.DataDriven],model:e,template:i._actionTemplate})).insert(new n2.de.component.summary.LogicFiltersSummary({id:"action-filters",cls:"slds-p-horizontal_medium slds-p-vertical_small",renderTo:{target:".n2_action-filters-container",position:"afterBegin"},isAdvanced:!1,filters:e.logicAndFiltersLabels.filters}))}),n}}]),a}(),n2.de.page.team.postAssignment.PostAssignmentSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertPostAssignmentUpdateField(),this._insertSendEmail()}},{key:"_insertPostAssignmentUpdateField",value:function(){return this._insert(new n2.de.component.form.updateFields.UpdateFields({id:"fields-to-update",cls:"n2_small-heading",heading:"Update fields on Assignment",helpText:{text:"Optionally update chosen fields with new values on assignment",position:n2.ui.enum.Position.BELOW}}))}},{key:"_insertSendEmail",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"send-standard-email-notifications",mixins:[n2.mixin.DataDriven],cls:"n2_send-standard-email-notifications slds-m-bottom_medium",label:"Send standard email notifications",helpText:{text:"Allows this Distributor to send Standard Email Notifications on assignment. Note: requires Distribution Engine Notification workflow rule to be enabled.",position:n2.ui.enum.Position.BELOW},value:{bindPath:".emailNotificationsEnabled"},hidden:n2.de.page.team.Context.getInstance().isQ2QTeam}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["fields-to-update"].model=this._getUpdateFieldsModel(),this._components["send-standard-email-notifications"].model=e)}},{key:"_getUpdateFieldsModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("fieldUpdateEnabled",{defaultValue:!1}),{key:"isEnabled"}),e.insert(this._model.getProperty("fieldUpdateConfig",{defaultValue:{fields:[]}}),{key:"fieldUpdateConfig"}),e.insert(this._model.getProperty("objectName"),{key:"objectName"}),e.insert(this._model.getProperty("isPersonAccounts"),{key:"isPersonAccounts"}),e}}]),n}(),n2.de.page.team.teamList.APV=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["data","staticBaseResourceUrl"]),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this.SELECTORS=n2.merge(this.SELECTORS,{apvContainer:".n2-apv-container"}),this._mixins=[n2.mixin.Observable],this._template='<div id="{{id}}" class="n2-component n2-apv {{cls}}">\n            <div class="n2-apv-container"></div>\n        </div>',this._MAX_DISTRIBUTORS=200,this._hasMaxTeams=!1,this._hasDifferentObjects=!1,this._METHOD_ICONS={"ROUND ROBIN":n2.de.icon.RoundRobin,"ROUND ROBIN STICKY ASSIGNMENT":n2.de.icon.RoundRobin,"LOAD BALANCING":n2.de.icon.LoadBalancing,"LOAD BALANCING STICKY ASSIGNMENT":n2.de.icon.LoadBalancing,"ROUND ROBIN LOOKUP OWNER":n2.de.icon.LookupOwner,"RELATED OWNER":n2.de.icon.RelatedOwner,"CURRENT OWNER":n2.de.icon.CurrentOwner,"DYNAMIC OWNER":n2.de.icon.DynamicOwner,"PULL FROM QUEUE":n2.de.icon.PullDistributor,"MANUAL ASSIGNMENT":n2.de.icon.ManualAssignment},this._data=null,this._filteredData=null,this._filters={},this._staticBaseResourceUrl=null,this._emptyState=null,this._emptyFilteredState=null}},{key:"data",set:function(e){this._data=this._removeEmptyTeams(e),this._applyFilters()}},{key:"staticBaseResourceUrl",set:function(e){this._staticBaseResourceUrl=e}},{key:"emptyState",set:function(e){this._emptyState=e}},{key:"emptyFilteredState",set:function(e){this._emptyFilteredState=e}},{key:"_refreshData",value:function(){this._rendered&&(n2.apv.destroy(),this._components["invalid-browser"]&&this._components["invalid-browser"].destroy(),this._components["empty-state"]&&this._components["empty-state"].destroy(),this._components["empty-filtered-state"]&&this._components["empty-filtered-state"].destroy(),this._components["teams-limit-message"]&&this._components["teams-limit-message"].destroy(),this._insertAPVComponent())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._data&&(this._data=this._removeEmptyTeams(this._data),this._applyFilters())}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).call(this),this._insertAPVComponent()}},{key:"_insertAPVComponent",value:function(){var e,t,n,i,a=this;n2.apv.isSupported()?(e=this._filteredData||this._data,n2.isEmpty(e.teams)?(t=n2.isEmpty(this._data.teams)?(i=n2.clone(this._emptyState),"empty-state"):(i=n2.clone(this._emptyFilteredState),"empty-filtered-state"),n=i.button,delete i.button,i=this.insert(new n2.ui.component.Illustration(n2.merge(i,{id:t,renderTo:this._dom,cls:"n2-apv-empty-state"}))),n2.isNull(n)||i.insert(new n2.ui.component.Button(n2.merge(n,{id:"".concat(t,"-button")})))):(this._hasMaxTeams&&this.insert(new n2.ui.component.HTML({id:"teams-limit-message",renderTo:{target:this._dom,position:"afterBegin"},template:'<div id="{{id}}" class="n2_teams-limit-message slds-grid slds-m-bottom_small">\n                        '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n                    <div class="slds-col">\n                        <p>Displaying ').concat(this._filteredData.teams.length," teams, use the filters to find others.</p>\n                    </div>\n                </div>")})),n2.apv.init({apvSelector:this.SELECTORS.apvContainer,data:e,baseResourceUrl:this._staticBaseResourceUrl,onClick:function(e){var t=e.type,n=e.section,i=e.id,s=e.parentId,e=e.name;return a.fire("click",{target:a,relatedTarget:null,data:{type:t,section:n,id:i,parentId:s,name:e}})},methodIcons:this._METHOD_ICONS,showObjectType:this._hasDifferentObjects}))):this.insert(new n2.ui.component.Illustration({id:"invalid-browser",renderTo:this._dom,cls:"n2-apv-invalid-browser",heading:"Your browser does not support the Assignment Process Viewer",content:"We are only able to support modern browsers for the Assignment Process Viewer. Please switch to an updated browser to use this feature."}))}},{key:"destroy",value:function(){n2.apv.destroy(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"addFilter",value:function(e,t){this._filters[e]=t,this._applyFilters()}},{key:"removeFilters",value:function(e){var t=this;n2.forEach(e,function(e){delete t._filters[e]}),this._applyFilters()}},{key:"_applyFilters",value:function(){var t=this,n=(this._filteredData={sources:n2.clone(this._data.sources),teams:[]},{}),i=0,s=(this._hasMaxTeams=!1,this._hasDifferentObjects=!1,null);n2.forEach(this._data.teams,function(e){return t._shouldShowTeam(e)&&(t._filteredData.teams.push(e),n2.isNull(s)?s=e.objectName:t._hasDifferentObjects||s===e.objectName||(t._hasDifferentObjects=!0),n2.forEach(e.distributors,function(e){if(n2.isNull(e.sourceId))return!0;i++>=t._MAX_DISTRIBUTORS&&(t._hasMaxTeams=!0),n[e.sourceId]=!0})),!t._hasMaxTeams}),this._filteredData.sources=[],n2.forEach(this._data.sources,function(e){n[e.id]&&t._filteredData.sources.push(e)}),this._refreshData()}},{key:"_shouldShowTeam",value:function(i){var s,a=this;return!!n2.isEmpty(this._filters)||(s=!1,n2.forEach(this._filters,function(e){var t=e.dataBindings,t=void 0===t?null:t,n=e.value,n=void 0===n?null:n,e=e.fcn,e=void 0===e?null:e;return s=n2.isNull(e)?a._doesTeamMatch(i,n,t):e.call(a,i)}),s)}},{key:"_doesTeamMatch",value:function(t,n){var i=!1;return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:null).some(function(e){e=n2.resolvePath(t,e);return i=n2.isString(e)&&n2.isString(n)?e.toLowerCase().includes(n.toLowerCase()):n2.compare(e,n)}),i}},{key:"_removeEmptyTeams",value:function(e){return e.teams=e.teams.filter(function(e){return e.distributors&&0<e.distributors.length}),e}}]),t}(),n2.de.page.team.teamList.NewTeamModal=function(){_inherits(i,n2.de.component.Modal);var e,t,n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="new-team-modal",this.dataProviders=["create-team"],this._cls="n2-de-new-team-modal",this._teamModel=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._teamModel=new n2.dataProvider.Model({value:{type:"",teamName:"",distributionObject:"",assignmentField:"OwnerId"}}),this._insertNewTeamForm()}},{key:"_insertNewTeamForm",value:function(){var t=this,e=new n2.ui.component.Form({id:"new-team-form"}),n=(e.insert(new n2.de.component.field.UniqueNameField({id:"team-name",mixins:[n2.mixin.DataDriven],model:this._teamModel,label:"Team name",cls:"slds-m-bottom_medium n2_field-width",required:!0,value:{bindPath:".teamName"},nameValidationMessage:"Team names must be unique"})),e.insert(new n2.de.page.team.teamList.newTeamModal.DistributionObjectComponent({id:"distribution-object",mixins:[n2.mixin.DataDriven],dataProviders:["get-distribution-object-options"],model:this._teamModel,label:"Distribution object",cls:"n2_field-width",required:!0,options:{bindPath:"get-distribution-object-options"},value:{bindPath:".distributionObject"}})));n.components["load-all-objects-button"].listen("click",function(){n.clear(),t._loadDistributionObjectOptions({showAllObjects:!0}),n.hideAllObjectsButton(),e.insert(new n2.de.page.team.teamList.newTeamModal.DistributionObjectCombo({id:"assignment-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-assignment-field-options"],model:t._teamModel,label:"Assignment field",cls:"slds-m-top_medium slds-m-bottom_x-small n2_field-width",required:!0,options:{bindPath:"get-assignment-field-options"},hidden:{bindPath:"get-assignment-field-options",defaultValue:!0,adapter:function(e){var t=e.find(function(e){return"OwnerId"===e.value});return n2.isEmpty(e)||!n2.isEmpty(t)}},value:{bindPath:".assignmentField"}})),n.listen("change",function(e){return t._onDistributionObjectChange(e)},t)},this),this.insert(e)}},{key:"_onDistributionObjectChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n2.isEmpty(t.value))return e.abrupt("return");e.next=2;break;case 2:return this.spinner(),e.next=5,n2.DataProviderManager.getInstance().get("get-assignment-field-options").get({params:[t.value],force:!0});case 5:n=e.sent,this.spinner(!1),n2.isEmpty(n)?(this._components["submit-button"].disable(),t.markInvalid("The selected distribution object doesn't have any suitable fields for assigning records to.")):(this._components["submit-button"].enable(),t.clearInvalid(),n=n.find(function(e){return"OwnerId"===e.value}),this._components["new-team-form"].components["assignment-field"].value=n2.isEmpty(n)?"":"OwnerId");case 7:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_loadDistributionObjectOptions",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0<n.length&&void 0!==n[0]?n[0]:{}).showAllObjects,t=void 0!==t&&t,n2.DataProviderManager.getInstance().get("get-distribution-object-options").get({params:[this._teamModel.get("type"),t],force:!0});case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getOKButtonConfig",value:function(){return{text:"Create Team"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(i.prototype),"_onSaving",this).apply(this,arguments),this._components["new-team-form"].disabled=!0}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),this.spinner(),n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(e))}},{key:"show",value:function(e){var t=e.teamType,t=void 0===t?"Standard":t,e=e.teamsData,e=void 0===e?[]:e,t=(_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.header="Q2Q"===t?"New ".concat(t," Team"):"New Team",this._teamModel.getProperty("type").value=t,this._components["new-team-form"]),e=(t.components["team-name"].names=e.map(function(e){return e.name}),t.components["distribution-object"]),t=t.components["assignment-field"];e.showAllObjectsButton(),t&&(t.destroy(),e.removeListeners("change",{scope:this})),this._loadDistributionObjectOptions()}},{key:"_onSubmit",value:function(){this._components["new-team-form"].validate()&&(_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("create-team").post({params:[this._teamModel.get("teamName"),this._teamModel.get("distributionObject"),this._teamModel.get("type"),this._teamModel.get("assignmentField")]}))}},{key:"_reset",value:function(){_get(_getPrototypeOf(i.prototype),"_reset",this).call(this),this._components["new-team-form"].disabled=!1,this._components["new-team-form"].clear()}}]),i}(),n2.de.page.team.teamList.ReorderTeamsModal=function(){_inherits(t,n2.de.component.Modal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this.id="reorder-teams-modal",this.dataProviders=["reorder-teams"],this._cls="n2-de-reorder-teams-modal",this._header="Reorder Teams"}},{key:"_getOKButtonConfig",value:function(){return{text:"Set Order"}}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(t.prototype),"_onSaving",this).apply(this,arguments),this._components["ordered-teams-datatable"].reorderable=!1}},{key:"_onSaved",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){e.hide(),e._reset()},500).start()}},{key:"show",value:function(e){e=e.data,e=void 0===e?null:e;n2.sort(e,{property:"order"}),this._insertReorderDataTable(e),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this._components["ordered-teams-datatable"].headerRow.dom.hide(!1)}},{key:"_insertReorderDataTable",value:function(e){e=new n2.ui.component.DataTable({id:"ordered-teams-datatable",columns:[{header:"Team Name",bindPath:"name"}],data:e,reorderable:!0});this.insert(e)}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(t.prototype),"_onSubmit",this).call(this),n2.DataProviderManager.getInstance().get("reorder-teams").post({params:[this._components["ordered-teams-datatable"].data]})}},{key:"_reset",value:function(){_get(_getPrototypeOf(t.prototype),"_reset",this).call(this),this._components["ordered-teams-datatable"].destroy()}}]),t}(),n2.de.page.team.teamList.Teams=function(){_inherits(a,n2.ui.Component);var t,n,i,s,e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["apvStaticBaseResourceUrl"]),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters",leftFilterContainer:".n2_left-filter-container",actions:".n2_actions"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["teams","teams-apv"],this._template='<div id="{{id}}" class="n2-component n2-de-teams {{cls}}">\n            <div class="n2_filters n2_fixed-height slds-grid slds-grid_vertical-align-center slds-hide">\n                <div class="n2_left-filter-container slds-col slds-grid"></div>\n                <div class="n2_actions slds-col"></div>\n            </div>\n        </div>',this.Views={LIST:"list",APV:"apv"},this._apvStaticBaseResourceUrl=null,this._currentView=this.Views.LIST,this._pendingForceLoad=!1,this._DEFAULT_SORT_BY={column:0,direction:"asc"},this._currentSortBy=this._DEFAULT_SORT_BY,this._currentFilters={},this._cachedTeamAPVModel=null,this._cachedDistributorAPVModel=null}},{key:"apvStaticBaseResourceUrl",set:function(e){this._apvStaticBaseResourceUrl=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbarComponents()}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(a.prototype),"_loadData",this).apply(this,arguments),this._pendingForceLoad=this._pendingForceLoad||t,this._currentView===this.Views.LIST?n2.DataProviderManager.getInstance().get("teams").get({force:t,silent:e}):this._currentView===this.Views.APV&&n2.DataProviderManager.getInstance().get("teams-apv").get({force:t,silent:e})}},{key:"_forceLoadData",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).resetSort,e=void 0!==e&&e;this._clearFilters(),e&&this._resetSort(),this._loadData({force:!0})}},{key:"_resetSort",value:function(){this._currentSortBy=this._DEFAULT_SORT_BY,this._components["teams-datatable"].sortBy=this._currentSortBy}},{key:"_insertToolbarComponents",value:function(){this._insertActiveFilter(),this._insertObjectTypeFilter(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertViewSelection(),this._insertQuickFilter(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this._insertAddTeamButton(),this._insertMenu())}},{key:"_insertActiveFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.Combo({id:"active-status-filter",renderTo:this.SELECTORS.leftFilterContainer,cls:"slds-col slds-size_3-of-12 slds-p-right_x-small n2_active-filter",label:{text:"Filter active teams",hidden:!0},placeholder:"All statuses",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],sort:!1,listeners:{change:function(e){""===e.value?t._removeFilters(["activeFilter"]):t._addFilter("activeFilter",{dataBindings:["isActive"],value:e.value})}}}))}},{key:"_insertObjectTypeFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.Combo({id:"object-type-filter",renderTo:this.SELECTORS.leftFilterContainer,cls:"slds-col slds-size_3-of-12 slds-p-right_x-small n2_object-type-filter",label:{text:"Filter object types",hidden:!0},placeholder:"All objects",mixins:[n2.mixin.DataDriven],dataProviders:["teams"],options:{bindPath:"teams",adapter:function(e){return _toConsumableArray(new Set(e.map(function(e){return e.distributionObject}))).map(function(e){return{label:e,value:e}})}},listeners:{change:function(e){""===e.value?t._removeFilters(["objectTypeFilter"]):t._addFilter("objectTypeFilter",{dataBindings:["distributionObject"],value:e.value})}}}))}},{key:"_insertViewSelection",value:function(){var t=this;this.insert(new n2.de.component.ButtonToggleGroup({id:"team-view-selection",renderTo:this.SELECTORS.leftFilterContainer,cls:"slds-col slds-size_3-of-12 n2_team-view-selection",buttons:[{title:"List View",icon:{sprite:"utility",icon:"picklist_type"},selected:!0},{title:"Process View",icon:{sprite:"utility",icon:"process"}}],listeners:{click:function(e){e.target;e=e.data.index;return t._onViewChange(1===e?t.Views.APV:t.Views.LIST)}}}))}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.actions,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Find team...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){""===e.value?t._removeFilters(["quickFilter"]):t._addFilter("quickFilter",{dataBindings:["name"],value:e.value})},change:function(e){""===e.value&&t._removeFilters(["quickFilter"])}}}))}},{key:"_insertAddTeamButton",value:function(){var t=this;return this.insert(new n2.ui.component.SplitButton({id:"new-team-button",renderTo:this.SELECTORS.actions,cls:"n2_new-team",buttonText:"New Team",menuOptions:[{id:"Q2Q",label:"New Q2Q Team"}],listeners:{click:function(){return t._showNewTeamModal("Standard")},select:function(e){return t._showNewTeamModal(e.target.id)}}}))}},{key:"_insertMenu",value:function(){var t=this;this.insert(new n2.ui.component.Menu({id:"team-actions-menu",renderTo:this.SELECTORS.actions,cls:"n2_menu",options:[{id:"activate",label:"Activate"},{id:"deactivate",label:"Deactivate"},{id:"delete",label:"Delete"},{id:"test",label:"Test"},{id:"reorder-teams",label:"Reorder Teams"},{id:"assignment-simulation",label:"Assignment Simulation"}],listeners:{select:function(e){switch(e.id){case"activate":t._activateTeams(t._components["teams-datatable"].selection);break;case"deactivate":t._deactivateTeams(t._components["teams-datatable"].selection);break;case"reorder-teams":t._showReorderTeamsModal();break;case"delete":t._deleteTeams(t._components["teams-datatable"].selection);break;case"test":t._openTestTool();break;case"assignment-simulation":t._openAssignmentSimulationModal()}}}}))}},{key:"_showNewTeamModal",value:function(e){n2.de.page.team.teamList.NewTeamModal.getInstance({renderTo:this._dom.parent}).show({teamType:e,teamsData:this._components["teams-datatable"].data})}},{key:"_showReorderTeamsModal",value:function(){var e=this;n2.de.page.team.teamList.ReorderTeamsModal.getInstance({renderTo:this._dom.parent}).show({data:n2.DataProviderManager.getInstance().get("teams").model,listeners:{saved:function(){e._forceLoadData({resetSort:!0})}}})}},{key:"_openTestTool",value:function(t){this.spinner();var n=this,i=0===(i=n2.de.ApplicationContext.getInstance().namespace).length?"c":i.replace("__","");$Lightning.use(i+":testtoolapp",function(){var e={showTestModal:!0,notFromRecord:!0,fromTeam:!0,fromDistributor:!1};n2.isUndefined(t)?e.fromTeam=!1:(e.teamId=t.id,e.teamName=t.name),$Lightning.createComponent(i+":deTestToolComponent",e,n.domId,function(e){n.spinner(!1)})})}},{key:"_openAssignmentSimulationModal",value:function(){n2.de.page.assignmentSimulation.AssignmentSimulationModal.getInstance({renderTo:this._dom.parent}).show()}},{key:"_deleteTeams",value:function(n){var t,i=this,e=n.map(function(e){return e.name});n2.de.component.DeleteMessageBox.getInstance({renderTo:this._dom.parent,dataProviders:["delete-teams"]}).show({names:e,type:"teams",listeners:{submit:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("delete-teams").post({params:[n]});case 2:return e.next=4,t.hide();case 4:i._forceLoadData();case 5:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}})}},{key:"_activateTeams",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,n2.DataProviderManager.getInstance().get("activate-teams").post({params:[t]});case 3:this._forceLoadData();case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_deactivateTeams",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),e.next=3,n2.DataProviderManager.getInstance().get("deactivate-teams").post({params:[t]});case 3:this._forceLoadData();case 4:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_onLoaded",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(a.prototype),"_onLoaded",this).call(this,arguments),this._destroyDataTableAndAPV(),"teams"===n.id?(t=n2.isNull(this._model),this._model=e,this._insertTeamsDataTable({model:e,sortBy:this._currentSortBy}),n2.isEmpty(e)?this.element("filters").hide():(this.element("filters").show(),t&&this._hasActiveTeams()&&(this._components["active-status-filter"].value=!0))):"teams-apv"===n.id&&this._insertAPVComponent({model:e}),this._setTeamMenuOptionVisibility(!1),this._applyFilters()}},{key:"_hasActiveTeams",value:function(){return!n2.isEmpty(this._getTeamsByActiveStatus(this._model,{activeStatus:!0}))}},{key:"_getTeamsByActiveStatus",value:function(e,t){var n=t.activeStatus;return e.filter(function(e){return e.isActive===n})}},{key:"_addFilter",value:function(e,t){this._currentFilters[e]=t,this._currentView===this.Views.LIST?this.components["teams-datatable"].addFilter(e,t):this._currentView===this.Views.APV&&(this._hideSlideOutPanel(),this.components["teams-apv"].addFilter(e,t))}},{key:"_removeFilters",value:function(e){var t=this;e.forEach(function(e){return delete t._currentFilters[e]}),this._currentView===this.Views.LIST?this.components["teams-datatable"].removeFilters(e):this._currentView===this.Views.APV&&(this._hideSlideOutPanel(),this.components["teams-apv"].removeFilters(e))}},{key:"_applyFilters",value:function(){var n=this._currentView===this.Views.LIST?this.components["teams-datatable"]:this.components["teams-apv"];n2.forEach(this._currentFilters,function(e,t){n.addFilter(t,e)})}},{key:"_clearFilters",value:function(){this._components["active-status-filter"].clear(),this._components["object-type-filter"].clear(),this._components["quick-filter"].clear()}},{key:"_destroyDataTableAndAPV",value:function(){this._components["teams-datatable"]&&(this._currentSortBy=this._components["teams-datatable"].currentSortBy,this._components["teams-datatable"].destroy()),this._hideSlideOutPanel(),this._components["teams-apv"]&&(this._components["teams-apv"].destroy(),this._cachedTeamAPVModel=null,this._cachedDistributorAPVModel=null)}},{key:"_insertTeamsDataTable",value:function(e){var i=this,t=e.model,e=e.sortBy,n=t.length,s=1===n?"team":"teams";this.insert(new n2.de.page.team.teamList.TeamsDataTable({id:"teams-datatable",data:t,sortBy:e,listeners:{selectionChange:function(e){return i._onRowSelectionChange(e)},menuOptionSelect:function(e,t,n){return i._onRowMenuOptionSelect(e,n)}},emptyState:{type:n2.de.page.team.teamList.teamsDataTable.EmptyState,listeners:{click:function(e){"add-q2q-team"===e.target.id?i._showNewTeamModal("Q2Q"):i._showNewTeamModal("Standard")}}},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no teams that match your filters",content:"We looked through ".concat(n," ").concat(s,", but none of them match your filters. You can change your terms, or clear them to see all teams"),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){i._clearFilters()}}}}}))}},{key:"_onRowSelectionChange",value:function(e){var e=e.target.parent.selection,t=!n2.isEmpty(e);this._setTeamMenuOptionVisibility(t),t&&(t=this._components["team-actions-menu"],n2.isUndefined(t)||(t.components.activate.label="Activate (".concat(e.length,")"),t.components.deactivate.label="Deactivate (".concat(e.length,")"),t.components.delete.label="Delete (".concat(e.length,")")))}},{key:"_onRowMenuOptionSelect",value:function(e,t){switch(e.id){case"activate":this._activateTeams([t.data]);break;case"deactivate":this._deactivateTeams([t.data]);break;case"delete":this._deleteTeams([t.data]);break;case"clone":this._showCloneTeamModal(t.data);break;case"test":this._openTestTool(t.data)}}},{key:"_showCloneTeamModal",value:function(e){n2.de.page.team.CloneTeamModal.getInstance({renderTo:this._dom.parent}).show({teamData:e,teamsData:this._components["teams-datatable"].data})}},{key:"_setTeamMenuOptionVisibility",value:function(e){var t=this._components["team-actions-menu"];n2.isUndefined(t)||(t.components.activate.hidden=!e,t.components.deactivate.hidden=!e,t.components.delete.hidden=!e,t.components["reorder-teams"].hidden=e,this._handleAssignmentSimulationOptionEnablement(t))}},{key:"_handleAssignmentSimulationOptionEnablement",value:function(e){var t=!n2.isEmpty(this._model)&&this._model.some(function(e){return e.hasDistributorsForAssignmentSimulation});e.components["assignment-simulation"].hidden=!t}},{key:"_insertAPVComponent",value:function(e){var t=this,e=e.model,n=e.teams.length,i=1===n?"team":"teams";this.insert(new n2.de.page.team.teamList.APV({id:"teams-apv",data:e,staticBaseResourceUrl:this._apvStaticBaseResourceUrl,listeners:{click:function(e){return t._handleAPVClick(e)}},emptyState:{illustration:n2.de.illustration.OpenRoad,heading:"No Distributors",content:"You havent created any Distributors for your teams. Distributors are the rules that define what assignments will be made to team members.",button:{text:"Add your first distributor from a team",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._showTeamListView,scope:this}}},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no teams that match your filters",content:"We looked through ".concat(n," ").concat(i,", but none of them match your filters. You can change your terms, or clear them to see all teams"),button:{text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._clearFilters,scope:this}}}}))}},{key:"_showTeamListView",value:function(){this._currentView=this.Views.LIST,this._components["team-view-selection"].currentSelectedIndex=0,this._loadData({force:this._pendingForceLoad}),this._pendingForceLoad=!1}},{key:"_handleAPVClick",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,i=n2.de.page.SlideOutPanel.getInstance(),this._shouldShowSlideOutPanel(n)?(i.hidden&&this._showSlideOutPanel(n),this._updateSlideOutPanel(n)):i.hidden=!0;case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_shouldShowSlideOutPanel",value:function(e){var t=e.type,e=e.section;return!n2.isUndefined(t)&&!n2.isUndefined(e)&&("team"===t||"distributor"===t&&"name"!==e)}},{key:"_showSlideOutPanel",value:function(e){var t=e.type,n=e.section,e=e.name;n2.de.page.SlideOutPanel.getInstance().show({heading:e,includeNavButtons:!0,components:[new n2.de.page.team.teamList.apv.APVSidePanel({id:"apv-side-panel",title:this._getApvPanelTitle({type:t,section:n})})],listeners:{click:function(){}}})}},{key:"_getApvPanelTitle",value:function(e){var t=e.type,e=e.section;return"team"===t?"Team":"filter"===e?"Filter":"algorithm"===e?"Method":"assignment"===e?"Members":"outcome"===e?"Post-assignment":void 0}},{key:"_updateSlideOutPanel",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s,a,o,r,l=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,i=t.section,s=t.id,a=t.parentId,r=t.name,(o=n2.de.page.SlideOutPanel.getInstance()).heading=r,o.removeListeners("click",{caller:this}),o.listen("click",function(e){"open-button"!==e.target.id&&"heading-button"!==e.target.id||l._onOpenButtonClick({type:n,section:i,id:s,parentId:a})},this),(r=o.components["apv-side-panel"]).spinner(),r.destroyComponents(),r.title=this._getApvPanelTitle({type:n,section:i}),"team"!==n)e.next=16;else{if(e.t0=n2.isNull(this._cachedTeamAPVModel)||this._cachedTeamAPVModel.id!==s,e.t0)return e.next=12,n2.DataProviderManager.getInstance().get("team-summary-apv").get({params:[s],force:!0});e.next=13}break;case 12:this._cachedTeamAPVModel=e.sent;case 13:r.model=this._cachedTeamAPVModel,e.next=24;break;case 16:if(e.t1="distributor"===n,e.t1){if(e.t2=n2.isNull(this._cachedDistributorAPVModel)||this._cachedDistributorAPVModel.id!==s,e.t2)return e.next=22,n2.DataProviderManager.getInstance().get("distributor-summary-apv").get({params:[s],force:!0});e.next=23}else e.next=24;break;case 22:this._cachedDistributorAPVModel=e.sent;case 23:r.model=this._cachedDistributorAPVModel;case 24:r.displayType({type:n,section:i,id:s});case 25:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_hideSlideOutPanel",value:function(){n2.de.page.SlideOutPanel.getInstance().hidden=!0}},{key:"_onOpenButtonClick",value:function(e){var t=e.type,n=e.section,i=e.id,e=e.parentId;"team"===t?n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(i)):"distributor"===t&&("outcome"===n?n2.de.page.Navigation.getInstance().open("Team_PostAssignment","teamId=".concat(e)):n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(i,"&teamId=").concat(e)))}},{key:"_onViewChange",value:function(e){this._currentView!==e&&((this._currentView=e)===this.Views.APV&&n2.isFunction(window.n2__logDETabView)&&window.n2__logDETabView("APV"),this._loadData({force:this._pendingForceLoad}),this._pendingForceLoad=!1)}},{key:"reload",value:function(){this._forceLoadData()}}]),a}(),n2.de.page.team.teamList.TeamsDataTable=function(){_inherits(s,n2.de.component.DataTable);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS||{},{menuOptionSelect:function(e,t,n){}}),this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,this._cls="n2-teams-data-table",this._HEADERS={order:"Order",name:"Name",distributionObject:"Object",teamMembers:"Members",standardDistributors:"Distributors",pullDistributors:"Pull",triggerDistributors:"Trigger",manualDistributors:"Manual",type:"Type",status:"Status"}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(this._data),_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this)}},{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(s.prototype),"_addHeaderRow",this).apply(this,arguments);var t=[this._HEADERS.order,this._HEADERS.teamMembers,this._HEADERS.standardDistributors,this._HEADERS.pullDistributors,this._HEADERS.triggerDistributors,this._HEADERS.manualDistributors];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_generateColumnDefinitions",value:function(){return this._filterDataTableColumns(this._data,[{header:this._HEADERS.order,bindPath:"order",cls:"n2_order-column",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.name,cls:"n2_name-column",sortable:!0,sort:{bindPath:".name"},cell:{cellTemplate:"",components:[this._getNavigationButtonConfig()]}},{header:this._HEADERS.distributionObject,bindPath:"distributionObject",sortable:!0},{header:this._HEADERS.teamMembers,bindPath:"teamMemberCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.standardDistributors,bindPath:"activeStdDistributorCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.pullDistributors,bindPath:"activePullDistributorCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.triggerDistributors,bindPath:"activeTriggerDistributorCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.manualDistributors,bindPath:"activeManualDistributorCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.type,bindPath:"type",sortable:!0},{header:this._HEADERS.status,cls:"n2_status-column",sortable:!0,sort:{bindPath:".isActive",adapter:function(e){return e?"Active":"Inactive"}},cell:{cellTemplate:"{{#content.isActive}}Active{{/content.isActive}}{{^content.isActive}}Inactive{{/content.isActive}}"}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getTeamActionMenuConfig()]}}])}},{key:"_filterDataTableColumns",value:function(e,t){var n=!1,i=!1,s=!1,a=!1;return e.some(function(e){return n=n||"Q2Q"===e.type,s=s||0<e.activeManualDistributorCount,i=i||0<e.activeTriggerDistributorCount,a=a||0<e.activePullDistributorCount,n&&i&&a&&s}),n||t.splice(8,1),s||t.splice(7,1),i||t.splice(6,1),a||t.splice(5,1),t}},{key:"_getNavigationButtonConfig",value:function(){return{type:n2.ui.component.Button,id:"view-team",theme:n2.ui.component.button.Theme.LINK,cls:"n2_view-team-button",mixins:[n2.mixin.DataDriven],text:{bindPath:".name"},listeners:{click:function(e){n2.de.page.Navigation.getInstance().open("Team_TeamSummary","teamId=".concat(e.model.id))}}}}},{key:"_getTeamActionMenuConfig",value:function(){var n=this,e=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?[{id:"activate",label:"Activate"},{id:"deactivate",label:"Deactivate"},{id:"clone",label:"Clone"},{id:"test",label:"Test"},{id:"delete",label:"Delete"}]:[{id:"test",label:"Test"}];return{type:n2.ui.component.Menu,id:"team-actions-menu",options:e,listeners:{select:function(e,t){n.fire("menuOptionSelect",e,t,t.parent)}}}}},{key:"_createRow",value:function(e){var t,n=_get(_getPrototypeOf(s.prototype),"_createRow",this).apply(this,arguments),i=n.data.isActive;return i||(n.cls="n2_inactive"),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(t=n.components["menu-cell"].components["team-actions-menu"],i?t.components.activate.hidden=!0:t.components.deactivate.hidden=!0),n}}]),s}(),n2.de.page.team.teamMemberList.AddQueueMemberModal=function(){_inherits(i,n2.de.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="add-queue-member-modal",this.dataProviders=["get-available-tm-queues","add-team-member-queues","get-max-team-members-per-team"],this._cls="n2-de-add-queue-member-modal",this.header="Add Team Members",this._currentTeamMemberCount=0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertFilters(),this._insertQueuesDataTable()}},{key:"_addFooterButtons",value:function(e){this._insertCreateActiveCheckbox(),_get(_getPrototypeOf(i.prototype),"_addFooterButtons",this).call(this,e)}},{key:"_getOKButtonConfig",value:function(){return{text:"Add Team Members",disabled:!0}}},{key:"_insertFilters",value:function(){var t=this;this.insert(new n2.ui.component.Form({id:"filter-form",cls:"n2_filters slds-grid slds-wrap slds-p-bottom_small"})).insert(new n2.ui.component.field.TextBox({id:"search",label:{text:"Search queues",hidden:!0},cls:"slds-col slds-size_1-of-1 slds-p-bottom_xx-small n2_field-width",placeholder:"Find queues...",icon:n2.ui.enum.Icon.SEARCH,listeners:{type:function(e){n2.isEmpty(e.value)?t._components["queues-data-table"].removeFilters(["quickFilter"]):t._components["queues-data-table"].addFilter("quickFilter",{dataBindings:[".name"],value:e.value})}}}))}},{key:"_insertCreateActiveCheckbox",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"create-active",renderTo:this.SELECTORS.footerButtons,cls:"slds-m-bottom_x-small",label:"Create active",value:!0}))}},{key:"_insertQueuesDataTable",value:function(){var t=this;this.insert(new n2.de.component.DataTable({id:"queues-data-table",columns:[{header:"Name",bindPath:"name",sortable:!0}],selectable:!0,sortBy:{column:0,direction:"asc"},data:[],listeners:{selectionChange:function(e){e=e.target.parent.selection;n2.isEmpty(e)?(t._components["submit-button"].disable(),t._clearFooterValidation()):e.length+t._currentTeamMemberCount>t._maxTeamMemberCount?(t._showFooterValidation({message:"Cannot add more than ".concat(t._maxTeamMemberCount," team members.")}),t._components["submit-button"].disable()):(t._clearFooterValidation(),t._components["submit-button"].enable())}}}))}},{key:"_loadData",value:function(){_get(_getPrototypeOf(i.prototype),"_loadData",this).apply(this,arguments),this._loadQueuesData({sortAscending:!0}),n2.DataProviderManager.getInstance().get("get-max-team-members-per-team").get()}},{key:"_loadQueuesData",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).sortAscending;var e=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-available-tm-queues").get({params:[e],force:!0})}},{key:"_onLoading",value:function(){this._components["filter-form"].disabled=!0,this._components["queues-data-table"].spinner()}},{key:"_onLoaded",value:function(e,t){var n;_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),"get-available-tm-queues"===t.id&&((n=this._components["queues-data-table"]).data=e,n.spinner(!1),this._components["filter-form"].disabled=!1),"get-max-team-members-per-team"===t.id&&(this._maxTeamMemberCount=e)}},{key:"_onSaved",value:function(e,t){var n=this;_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){n.hide(),n._reset()},500).start()}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onError",this).apply(this,arguments),n2.de.Error.isDE2(e)&&this._components["submit-button"].enable()}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).teamMemberCount,e=void 0===e?0:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this._currentTeamMemberCount=e,this._loadQueuesData()}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this);var e=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("add-team-member-queues").post({params:[e,this._components["create-active"].value,this._components["queues-data-table"].selection]})}},{key:"_reset",value:function(){_get(_getPrototypeOf(i.prototype),"_reset",this).call(this),this._components["filter-form"].clear(),this._components["create-active"].value=!0;var e=this._components["queues-data-table"];e.removeFilters(),e.sortBy={column:0,direction:"asc"},this._clearSelection()}},{key:"_clearSelection",value:function(){this._components["queues-data-table"].forEachRow(function(e){e.selected=!1},{includeHeaderRow:!0})}},{key:"_resetButtons",value:function(){_get(_getPrototypeOf(i.prototype),"_resetButtons",this).call(this),this._components["submit-button"].disable()}}]),i}(),n2.de.page.team.teamMemberList.AddStandardMemberModal=function(){_inherits(i,n2.de.component.Modal);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this._mixins=n2.merge(this._mixins,[n2.de.mixins.LimitLoads]),this.id="add-standard-member-modal",this.dataProviders=["add-team-member-users","get-max-team-members-per-team"],this._cls="n2-de-add-standard-member-modal",this.header="Add Team Members",this._maxTeamMemberCount=null,this._currentTeamMemberCount=0,this._informationMessageTemplate='<div id="{{id}}" class="n2_user-limit-message slds-grid slds-m-bottom_small slds-hide">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Displaying '+n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT+" users, use the filters to find others.</p></div></div>",this._performingReset=!1}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this.insert(new n2.ui.component.HTML({id:"user-limit-message",template:this._informationMessageTemplate,hidden:!0})),this._insertFilters(),this._insertUsersDataTable()}},{key:"_addFooterButtons",value:function(e){this._insertCreateActiveCheckbox(),_get(_getPrototypeOf(i.prototype),"_addFooterButtons",this).call(this,e)}},{key:"_getOKButtonConfig",value:function(){return{text:"Add Team Members",disabled:!0}}},{key:"_insertFilters",value:function(){var e=this,t=this.insert(new n2.ui.component.Form({id:"filter-form",cls:"n2_filters slds-grid slds-wrap slds-p-bottom_small"}));t.insert(new n2.ui.component.field.TextBox({id:"search",label:{text:"Search users",hidden:!0},cls:"slds-col slds-size_1-of-1 slds-p-bottom_xx-small",placeholder:"Find users...",icon:n2.ui.enum.Icon.SEARCH,listeners:{type:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.de.component.field.ChangeOnCloseCombo({id:"profiles",label:"Profiles",placeholder:"All profiles",cls:"slds-col slds-size_1-of-3 slds-p-right_x-small",mixins:[n2.mixin.DataDriven],dataProviders:["get-profiles"],options:{bindPath:"get-profiles"},multiple:!0,listeners:{change:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.ui.component.field.Combo({id:"date-added",label:"Date Added",placeholder:"All Time",cls:"slds-col slds-size_1-of-3 slds-p-right_x-small",mixins:[n2.mixin.DataDriven],dataProviders:["get-created-date-options"],options:{bindPath:"get-created-date-options"},listeners:{change:function(){return e._loadTeamMemberData()}},sort:!1})),t.insert(new n2.de.component.field.ChangeOnCloseCombo({id:"roles",label:"Roles",placeholder:"All roles",cls:"slds-col slds-size_1-of-3",mixins:[n2.mixin.DataDriven],dataProviders:["get-roles"],options:{bindPath:"get-roles"},multiple:!0,listeners:{change:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.ui.component.field.Checkbox({id:"standard",label:"Standard users only",helpText:"Filter to only users with the Standard user type. User type is the category of user license linked to their assigned Salesforce profile",cls:"slds-p-top_small",value:!0,listeners:{change:function(){return e._loadTeamMemberData()}}}))}},{key:"_insertCreateActiveCheckbox",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"create-active",renderTo:this.SELECTORS.footerButtons,cls:"slds-m-bottom_x-small",label:"Create active",value:!0}))}},{key:"_insertUsersDataTable",value:function(){var i=this;this.insert(new n2.de.page.team.teamMemberList.addStandardMemberModal.AddStandardMemberModalDataTable({id:"users-data-table",columns:[{header:"Name",bindPath:"name",sortable:!0},{header:"Username",bindPath:"username"}],selectable:!0,sortBy:{column:0,direction:"asc"},cls:"slds-is-relative",sortFunction:function(e,t){var t=t.direction,t=void 0===t?"asc":t,n=i._components["users-data-table"];if(n&&n.sortBy.direction!==t)return i._loadTeamMemberData({sortAscending:"asc"===t})},listeners:{selectionChange:function(e){return i._onUserSelectionChange(e)}}}))}},{key:"_onUserSelectionChange",value:function(e){var e=e.target.parent.selection,t=this._components["submit-button"];n2.isEmpty(e)?(t.text="Add Team Members",t.disable(),this._clearFooterValidation()):(t.text="Add Team Members (".concat(e.length,")"),e.length+this._currentTeamMemberCount>this._maxTeamMemberCount?(this._showFooterValidation({message:"Cannot add more than ".concat(this._maxTeamMemberCount," team members.")}),t.disable()):(this._clearFooterValidation(),t.enable()))}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).teamMemberCount,e=void 0===e?0:e;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this._currentTeamMemberCount=e,this._loadTeamMemberData({sortAscending:!0,silent:!1}),this._loadFilterData(),n2.DataProviderManager.getInstance().get("get-max-team-members-per-team").get()}},{key:"_loadTeamMemberData",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.sortAscending,n=void 0===n?null:n,t=t.silent,t=void 0===t||t;if(!this._performingReset)return e=n2.de.page.team.Context.getInstance().teamId,e=n2.merge({teamId:e,sortAscending:n2.isNull(n)?"asc"===this._components["users-data-table"].sortBy.direction:n,userLimit:n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT},this._getFilterData()),this._limitLoads("get-available-users",{params:[e],force:!0,silent:t})}},{key:"_loadFilterData",value:function(){this._loadDataProvider("get-profiles",{silent:!1}),this._loadDataProvider("get-created-date-options",{silent:!1}),this._loadDataProvider("get-roles",{silent:!1})}},{key:"_getFilterData",value:function(){var e=this._components["filter-form"];return{name:e.components.search.value,profiles:e.components.profiles.value,roles:e.components.roles.value,createdDate:e.components["date-added"].value,standardOnly:e.components.standard.value}}},{key:"_onLoading",value:function(){this._components["filter-form"].disabled=!0,this._showDataTableSpinner()}},{key:"_onLimitedLoading",value:function(){this._showDataTableSpinner()}},{key:"_showDataTableSpinner",value:function(){this._components["users-data-table"].spinner()}},{key:"_onLoaded",value:function(e,t){var n;_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),"get-available-users"===t.id&&((n=this._components["users-data-table"]).data=e,n.spinner(!1),this._components["filter-form"].disabled=!1,this._components["user-limit-message"].hidden=e.length<n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT),"get-max-team-members-per-team"===t.id&&(this._maxTeamMemberCount=e)}},{key:"_onSaved",value:function(e,t){var n=this;_get(_getPrototypeOf(i.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){n.hide(),n._reset()},500).start()}},{key:"_onError",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onError",this).apply(this,arguments),n2.de.Error.isDE2(e)&&this._components["submit-button"].enable()}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this);var e=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("add-team-member-users").post({params:[e,this._components["create-active"].value,this._components["users-data-table"].selection]})}},{key:"_reset",value:function(){_get(_getPrototypeOf(i.prototype),"_reset",this).call(this),this._performingReset=!0,this._components["filter-form"].clear(),this._performingReset=!1,this._components["create-active"].value=!0,this._components["filter-form"].components.standard.value={value:!0,silent:!0},this._components["users-data-table"].sortBy={column:0,direction:"asc"},this._clearSelection()}},{key:"_clearSelection",value:function(){this._components["users-data-table"].forEachRow(function(e){e.selected=!1},{includeHeaderRow:!0}),this._tempSelectedIds=[]}},{key:"_resetButtons",value:function(){_get(_getPrototypeOf(i.prototype),"_resetButtons",this).call(this),this._components["submit-button"].disable()}}]),i}(),n2.de.page.team.teamMemberList.AddStandardTeamMemberWizard=function(){_inherits(i,n2.de.component.Wizard);var e,t,n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.dataProviders=["get-team-member-setup","add-team-member-users-advanced"],this.id="member-wizard",this._componentCls="".concat(this._componentCls," n2-de-member-wizard"),this._header="Add Team Members",this._currentStageId=null,this._ALL_STAGES={ADD_TEAM_MEMBERS:{id:"add-team-members",label:"Add team members"},COPY_CONFIGURATION:{id:"copy-configuration",label:"Copy configuration"},ASSIGN_TEAM_MEMBER_HOURS:{id:"assign-team-member-hours",label:"Assign team member hours"},ASSIGN_TAGS:{id:"assign-tags",label:"Assign tags"},ASSIGN_WEIGHTING:{id:"assign-weighting",label:"Assign weighting"}},this._stages=this._getStages(),this._buttons={submit:{text:"Finish"}},this._teamMembers=null,this._teamMemberSetup=null,this._hasTagCollections=null,this._useWeighting=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["addTeamMembers","copyConfiguration","assignTeamMemberHours","assignTags","assignWeighting"]})}},{key:"currentStage",get:function(){return n2.isNull(this._currentStageId)?null:this._components[this._currentStageId]}},{key:"addTeamMembers",get:function(){return this._components[this._ALL_STAGES.ADD_TEAM_MEMBERS.id]}},{key:"copyConfiguration",get:function(){return this._components[this._ALL_STAGES.COPY_CONFIGURATION.id]}},{key:"assignTeamMemberHours",get:function(){return this._components[this._ALL_STAGES.ASSIGN_TEAM_MEMBER_HOURS.id]}},{key:"assignTags",get:function(){return this._components[this._ALL_STAGES.ASSIGN_TAGS.id]}},{key:"assignWeighting",get:function(){return this._components[this._ALL_STAGES.ASSIGN_WEIGHTING.id]}},{key:"_onDefined",value:function(){var e=this;_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),n2.DataProviderManager.getInstance().listen("error",function(){return e._onServerError()},this),this._insertAddTeamMembers(),this._insertCopyConfiguration(),this._insertAssignTeamMemberHours(),this._insertAssignTags(),this._insertAssignWeighting()}},{key:"_onServerError",value:function(){this.spinner(!1)}},{key:"_insertAddTeamMembers",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.AddTeamMembers({id:this._ALL_STAGES.ADD_TEAM_MEMBERS.id,hidden:!0,listeners:{change:this._handleTeamMemberSelection,scope:this}}))}},{key:"_insertCopyConfiguration",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.CopyConfiguration({id:this._ALL_STAGES.COPY_CONFIGURATION.id,hidden:!0,listeners:{click:this._handleUserConfigurationSelection,scope:this}}))}},{key:"_insertAssignTeamMemberHours",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignTeamMemberHours({id:this._ALL_STAGES.ASSIGN_TEAM_MEMBER_HOURS.id,hidden:!0}))}},{key:"_insertAssignTags",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignTags({id:this._ALL_STAGES.ASSIGN_TAGS.id,hidden:!0}))}},{key:"_insertAssignWeighting",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignWeighting({id:this._ALL_STAGES.ASSIGN_WEIGHTING.id,hidden:!0}))}},{key:"show",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=0<n.length&&void 0!==n[0]?n[0]:{}).listeners,t=t.teamMembers,_get(_getPrototypeOf(i.prototype),"show",this).apply(this,n),this.addTeamMembers.reloadTeamMembers(),this._setProperty("teamMembers",t),this.addTeamMembers.setProperty("currentTeamMemberCount",t.length),this.copyConfiguration.setProperty("teamMembersOptions",t.map(function(e){return{label:e.name,value:e.id}})),e.next=8,this._getStagesConfig();case 8:this._stages=this._getStages(),this.footer.stages=this._stages;case 10:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_getStagesConfig",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-team-member-onboarding-settings",{params:[n2.de.page.team.Context.getInstance().teamId],silent:!0,force:!0});case 2:n=e.sent,n=n.response,t=n.hasTagCollections,n=n.weightingType,this._setProperties({hasTagCollections:t,useWeighting:"Tag"!==n});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_handleTeamMemberSelection",value:function(e){this.hidden||(e=e.data.value.newValue.length,this.header=0===e?"Add Team Members":"Add ".concat(e," Team Member").concat(1===e?"":"s"),this._validateStageOnAction())}},{key:"_handleUserConfigurationSelection",value:function(){var e=this.copyConfiguration.selectConfigCombo.value;if(n2.isEmpty(e))return this._setProperty("teamMemberSetup",null);this.copyConfiguration.spinner(),this.footer.spinner(),this._loadDataProvider("get-team-member-setup",{params:[e],silent:!1,force:!1,requestId:e}),this.spinner(!1)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),"get-team-member-setup"===t.id&&(this._setProperty("teamMemberSetup",e),this.assignTeamMemberHours.setProperty("updateValuesOnShow",!0),this.assignTags.setProperty("updateValuesOnShow",!0),this.assignWeighting.setProperty("updateValuesOnShow",!0),this.copyConfiguration.spinner(!1),this.footer.spinner(!1))}},{key:"_validateStageOnAction",value:function(){return this._validateStage()?this.footer.markCurrentStageValid():this.footer.markCurrentStageInvalid()}},{key:"_validateStage",value:function(){return n2.isFunction(this.currentStage.validate)?this.currentStage.validate():_get(_getPrototypeOf(i.prototype),"_validateStage",this).call(this)}},{key:"_getStages",value:function(){var t,e=Object.values(this._ALL_STAGES);return n2.isNull(this._hasTagCollections)||this._hasTagCollections&&this._useWeighting?e:(t=[],this._hasTagCollections||t.push(this._ALL_STAGES.ASSIGN_TAGS.id),this._useWeighting||t.push(this._ALL_STAGES.ASSIGN_WEIGHTING.id),e.filter(function(e){return!t.includes(e.id)}))}},{key:"_onStageChange",value:function(e){_get(_getPrototypeOf(i.prototype),"_onStageChange",this).call(this,e),this._currentStageId=e.target.currentStageId,this._refresh()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(i.prototype),"_onCancel",this).call(this),this._reset()}},{key:"_reset",value:function(){var t=this;this._teamMembers=null,this._teamMemberSetup=null,this._hasTagCollections=null,this._useWeighting=null,this.header="Add Team Members",this._stages.forEach(function(e){e=t._components[e.id];if(n2.isFunction(e.reset))return e.reset()})}},{key:"_onWizardSubmit",value:function(){_get(_getPrototypeOf(i.prototype),"_onWizardSubmit",this).call(this),this._postDataProvider("add-team-member-users-advanced",{params:this._getConfigParams()})}},{key:"_getConfigParams",value:function(){return[n2.de.page.team.Context.getInstance().teamId,this.copyConfiguration.createActiveCheckbox.value,this.addTeamMembers.usersDataTable.selection,this._getTeamMemberSetup()]}},{key:"_getTeamMemberSetup",value:function(){var e=this.assignTeamMemberHours.shiftCombo.value,t=n2.isEmpty(e),n={isTeamHours:t,isIndividualHours:this.assignTeamMemberHours.isIndividualHours,tagValueIds:this.assignTags.modifyAssignments.assignmentsForm.getSelectedTags(),weighting:this.assignWeighting.weightingSlider.value};return t||(n.shiftHoursId=e),n}},{key:"_onSaving",value:function(e){_get(_getPrototypeOf(i.prototype),"_onSaving",this).call(this,e),this.footer.backButton.disable()}},{key:"_onSaved",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onSaved",this).call(this,e,t),this.footer.backButton.enable(),this._reset()}},{key:"_getUserIds",value:function(){var t;return n2.isNull(this._teamMemberSetup)?[]:(t=this.copyConfiguration.selectConfigCombo.value,[this._teamMembers.find(function(e){return e.id===t}).user])}},{key:"_refreshAddTeamMembers",value:function(){this.addTeamMembers.hidden=this._currentStageId!==this._ALL_STAGES.ADD_TEAM_MEMBERS.id}},{key:"_refreshCopyConfiguration",value:function(){this.copyConfiguration.hidden=this._currentStageId!==this._ALL_STAGES.COPY_CONFIGURATION.id}},{key:"_refreshAssignTeamMemberHours",value:function(){var e,t,n;this._currentStageId!==this._ALL_STAGES.ASSIGN_TEAM_MEMBER_HOURS.id?this.assignTeamMemberHours.hide():(e=!n2.isNull(this._teamMemberSetup)&&this._teamMemberSetup.isIndividualHours,t=!!n2.isNull(this._teamMemberSetup)||this._teamMemberSetup.isTeamHours,n=n2.isNull(this._teamMemberSetup)?null:this._teamMemberSetup.shiftHoursId,this.assignTeamMemberHours.show({isTeamHours:t,shiftHoursId:n,isIndividualHours:e}))}},{key:"_refreshAssignTags",value:function(){this._currentStageId!==this._ALL_STAGES.ASSIGN_TAGS.id?this.assignTags.hide():this.assignTags.show({userIds:this._getUserIds()})}},{key:"_refreshAssignWeighting",value:function(){this._currentStageId!==this._ALL_STAGES.ASSIGN_WEIGHTING.id?this.assignWeighting.hide():this.assignWeighting.show({weighting:n2.isNull(this._teamMemberSetup)?1:this._teamMemberSetup.weighting})}}]),i}(),n2.de.page.team.teamMemberList.OutOfOfficeModal=function(){_inherits(i,n2.de.component.Modal);var e,t,n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this,arguments),this.id="out-of-office-modal",this._componentCls="n2-de-out-of-office-modal",this._user=null,this._queue=null,this._timezoneOptions=null}},{key:"form",get:function(){return this._components["out-of-office-form"]}},{key:"memberField",get:function(){return this.form.components.member}},{key:"reasonField",get:function(){return this.form.components.reason}},{key:"dateRangeField",get:function(){return this.form.components["date-range"]}},{key:"timezoneField",get:function(){return this.form.components.timezone}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e=this.dateRangeField.value,t=this.memberField.value,e={id:null,endDate:e.endDate.getTime(),endIsAllDay:e.endIsAllDay,startDate:e.startDate.getTime(),startIsAllDay:e.startIsAllDay,reason:this.reasonField.value,timezone:this.timezoneField.value};return n2.de.page.team.Context.getInstance().isQ2QTeam?e.queues=[t]:e.users=[t],e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this,arguments),this._insertForm()}},{key:"_getOKButtonConfig",value:function(){return{text:"Create Out of Office"}}},{key:"_insertForm",value:function(){return this.insert(new n2.ui.component.Form({id:"out-of-office-form",components:[{type:n2.de.component.field.TeamMemberPicker,id:"member",label:"Member",cls:"slds-m-bottom_medium",disabled:!0,required:!0},{type:n2.ui.component.field.TextBox,id:"reason",label:"Reason",cls:"slds-m-bottom_medium",required:!0},{type:n2.de.component.field.DateRangePicker,id:"date-range",label:{text:"Date range",hidden:!0},cls:"slds-m-bottom_medium",required:!0},{type:n2.ui.component.field.Combo,id:"timezone",cls:"n2_field-width slds-m-bottom_medium",label:"Timezone",required:!0,sort:!1,options:[]}]}))}},{key:"show",value:function(e){this._setTimezoneOptions(),_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments),this.form.clear();e=this._getMember(e);this.header=n2.de.page.team.Context.getInstance().isQ2QTeam?"New Queue Out of Office":"New Out of Office",this.memberField.users=[e],this.memberField.value={value:e.id,silent:!0,validate:!1},this.submitButton.reset(),this.cancelButton.enable()}},{key:"_getMember",value:function(e){return{name:e.name,id:n2.de.page.team.Context.getInstance().isQ2QTeam?e.queue:e.user}}},{key:"_setTimezoneOptions",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.timezoneField.spinner(),n2.isNull(this._timezoneOptions))return e.next=3,this._fetchDataProvider("get-timezone-options");e.next=5;break;case 3:t=e.sent,this._timezoneOptions=t.response;case 5:this.timezoneField.options=this._timezoneOptions,this.timezoneField.value=n2.de.ApplicationContext.getInstance().timeZone,this.timezoneField.spinner(!1);case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_onCancel",value:function(){_get(_getPrototypeOf(i.prototype),"_onCancel",this).call(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.form.validate()&&_get(_getPrototypeOf(i.prototype),"_onSubmit",this).call(this);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),i}(),n2.de.page.team.teamMemberList.RemoveTeamMemberMessageBox=function(){_inherits(t,n2.de.component.DeleteMessageBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getMessage",value:function(e){var t=e.names,e=e.type;return"You are trying to remove ".concat(this._getNamesMessage({names:t,type:e}),".  Are you sure you want to continue?")}}]),t}(),n2.de.page.team.teamMemberList.TeamMembers=function(){_inherits(a,n2.ui.Component);var t,e,n,i,s=_createSuper(a);function a(){return _classCallCheck(this,a),s.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{teamMembersRemoved:function(e){},teamMembersAdded:function(){}}),this.SELECTORS=n2.merge(this.SELECTORS,{filters:".n2_filters",activeFilterContainer:".n2_active-filter-container",actions:".n2_actions"}),this._mixins=[n2.mixin.DataDriven,n2.mixin.Observable],this.dataProviders=["get-team-members"],this._template='<div id="{{id}}" class="n2-component n2-de-team-members {{cls}}">\n            <div class="n2_filters n2_fixed-height slds-grid slds-grid_vertical-align-center">\n                <div class="n2_active-filter-container slds-col slds-grid"></div>\n                <div class="n2_actions slds-col"></div>\n            </div>\n        </div>',this._outOfOfficeLink=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbarComponents()}},{key:"_insertToolbarComponents",value:function(){this._insertActiveFilter(),this._insertQuickFilter(),this._insertAddTeamMemberButton(),this._insertMenu()}},{key:"_insertActiveFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.Combo({id:"active-status-filter",renderTo:this.SELECTORS.activeFilterContainer,cls:"slds-col slds-size_5-of-12 n2_active-filter",label:{text:"Filter team members",hidden:!0},placeholder:"All statuses",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],sort:!1,listeners:{change:function(e){""===e.value?t._removeFilters(["activeFilter"]):t._addFilter("activeFilter",{dataBindings:["isActiveForDistribution"],value:e.value})}}}))}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.actions,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Quick filter...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this._addFilter("quickFilter",{dataBindings:["name","hoursLabel"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this._removeFilters(["quickFilter"])}},{key:"_addFilter",value:function(e,t){this.components["team-members-data-table"].addFilter(e,t)}},{key:"_removeFilters",value:function(e){this.components["team-members-data-table"].removeFilters(e)}},{key:"_clearFilters",value:function(){this._components["active-status-filter"].clear(),this._components["quick-filter"].clear()}},{key:"_insertAddTeamMemberButton",value:function(){this.insert(new n2.ui.component.SplitButton({id:"add-team-member",renderTo:this.SELECTORS.actions,mixins:[n2.mixin.DataDriven],cls:"n2_add-team-member",buttonText:"Add Team Members",menuOptions:this._getMenuOptions(),listeners:{click:this._showAddMembersModal,select:this._showAddMembersWizard,scope:this}}))}},{key:"_getMenuOptions",value:function(){return n2.de.page.team.Context.getInstance().isQ2QTeam?[]:[{id:"advanced-add-team-member",label:"Add and Configure"}]}},{key:"_onEmptyStateClick",value:function(e){if(e.data.actions.includes("show-add-modal"))return this._showAddMembersModal();this._showAddMembersWizard()}},{key:"_showAddMembersModal",value:function(){n2.de.page.team.Context.getInstance().isQ2QTeam?this._showAddQueuesModal():this._showAddTeamMembersModal()}},{key:"_showAddMembersWizard",value:function(){var e=this,t=this._components["team-members-data-table"].data;n2.de.page.team.teamMemberList.AddStandardTeamMemberWizard.getInstance({renderTo:this._dom}).show({teamMembers:t,listeners:{saved:function(){e._loadData({force:!0}),e.fire("teamMembersAdded")}}})}},{key:"_showAddQueuesModal",value:function(){var e=this;n2.de.page.team.teamMemberList.AddQueueMemberModal.getInstance({renderTo:this._dom}).show({teamMemberCount:this._components["team-members-data-table"].data.length,listeners:{saved:function(){e._loadData({force:!0}),e.fire("teamMembersAdded")}}})}},{key:"_showAddTeamMembersModal",value:function(){var e=this;n2.de.page.team.teamMemberList.AddStandardMemberModal.getInstance({renderTo:this._dom}).show({teamMemberCount:this._components["team-members-data-table"].data.length,listeners:{saved:function(){e._loadData({force:!0}),e.fire("teamMembersAdded")}}})}},{key:"_insertMenu",value:function(){var t=this;this.insert(new n2.ui.component.Menu({id:"team-member-actions-menu",renderTo:this.SELECTORS.actions,cls:"n2_menu",options:[{id:"activate",label:"Activate",hidden:!0},{id:"deactivate",label:"Deactivate",hidden:!0},{id:"remove",label:"Remove",hidden:!0},{id:"change-history",label:"Team Members History"}],listeners:{select:function(e){t._onMenuOptionSelect(e,t._components["team-members-data-table"].selection)}}}))}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=(_get(_getPrototypeOf(a.prototype),"_loadData",this).apply(this,arguments),n2.de.page.team.Context.getInstance().teamId);n2.DataProviderManager.getInstance().get("get-is-q2q-team").get({params:[n]}),n2.DataProviderManager.getInstance().get("get-team-members").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),"get-team-members"===n.id&&(n=n2.isNull(this._model),this._model=e,(e=this._components["team-members-data-table"])&&(t=e.currentSortBy,e.destroy()),this._insertTeamsDataTable({model:this._model,sortBy:t}),n2.isEmpty(this._model.teamMembers)?this._setToolbarEmptyState(!0):(this._components["active-status-filter"].clear(),this._components["quick-filter"].clear(),this._setToolbarEmptyState(!1),n&&this._hasActiveTeamMembers()&&(this._components["active-status-filter"].value=!0)),this._updateMenu())}},{key:"_setToolbarEmptyState",value:function(e){this._components["active-status-filter"].hidden=e,this._components["quick-filter"].hidden=e,this._components["add-team-member"].hidden=e}},{key:"_hasActiveTeamMembers",value:function(){return!n2.isEmpty(this._getTeamMembersByActiveStatus(this._model.teamMembers,{activeStatus:!0}))}},{key:"_getTeamMembersByActiveStatus",value:function(e,t){var n=t.activeStatus;return e.filter(function(e){return e.isActive===n})}},{key:"_insertTeamsDataTable",value:function(e){var t=this,n=e.model,e=e.sortBy,i=n.teamMembers.length,s=1===i?"team member":"team members";this.insert(new n2.de.page.team.teamMemberList.TeamMembersDataTable({id:"team-members-data-table",objectName:n.objectName,data:n.teamMembers,showTotalLabels:!n.hasActiveStatus,sortBy:e,listeners:{selectionChange:function(e){return t._onRowSelectionChange(e)},menuOptionSelect:function(e){return t._onMenuOptionSelect(e.target,[e.data])}},emptyState:{type:n2.de.page.team.teamMemberList.teamMembersDataTable.EmptyState,listeners:{click:this._onEmptyStateClick,scope:this}},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no team members that match your filters",content:"We looked through ".concat(i," ").concat(s,", but none of them match your filters. You can change your terms, or clear them to see all team members"),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){t._clearFilters()}}}}}))}},{key:"_onRowSelectionChange",value:function(e){this._updateMenu(e.target.parent.selection)}},{key:"_updateMenu",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=!n2.isEmpty(e),n=this._components["team-member-actions-menu"];n.components.activate.hidden=!t,n.components.deactivate.hidden=!t,n.components.remove.hidden=!t,t&&(n.components.activate.label="Activate (".concat(e.length,")"),n.components.deactivate.label="Deactivate (".concat(e.length,")"),n.components.remove.label="Remove (".concat(e.length,")"))}},{key:"_onMenuOptionSelect",value:function(e,t){switch(e.id){case"activate":this._activateTeamMembers(t);break;case"deactivate":this._deactivateTeamMembers(t);break;case"remove":this._removeTeamMembers(t);break;case"change-history":this._onChangeHistoryClick();break;case"add-out-of-office":this._onOutOfOfficeClick(t)}}},{key:"_activateTeamMembers",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),n=n2.de.page.team.Context.getInstance().teamId,e.next=4,n2.DataProviderManager.getInstance().get("activate-team-members").post({params:[n,t]});case 4:this._loadData({force:!0});case 5:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_deactivateTeamMembers",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),n=n2.de.page.team.Context.getInstance().teamId,e.next=4,n2.DataProviderManager.getInstance().get("deactivate-team-members").post({params:[n,t]});case 4:this._loadData({force:!0});case 5:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_removeTeamMembers",value:function(i){var t,s=this,e=i.map(function(e){return e.name});n2.de.page.team.teamMemberList.RemoveTeamMemberMessageBox.getInstance({renderTo:this._dom,dataProviders:["remove-team-members"]}).show({names:e,type:"team members",listeners:{submit:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=n2.de.page.team.Context.getInstance().teamId,e.next=3,n2.DataProviderManager.getInstance().get("remove-team-members").post({params:[n,i]});case 3:return e.next=5,t.hide();case 5:s._loadData({force:!0}),s.fire("teamMembersRemoved",i);case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}})}},{key:"_onChangeHistoryClick",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("get-change-history").get({params:[n2.de.page.team.Context.getInstance().teamId],force:!0,silent:!1});case 2:t=e.sent,n2.de.page.team.ChangeHistoryModal.getInstance({renderTo:this._dom}).show({header:"Team Members history",model:t,showName:!0});case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onOutOfOfficeClick",value:function(e){n2.de.page.team.teamMemberList.OutOfOfficeModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,dataProviders:["save-team-member-out-of-office"],listeners:{submit:this._submitOutOfOffice,scope:this}}).show(e[0])}},{key:"_submitOutOfOffice",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n=this;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("save-team-member-out-of-office",{params:[t.data]});case 2:new n2.util.DelayedTask(function(){n._showConfirmation()},500).start();case 3:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_showConfirmation",value:function(){n2.isNull(this._outOfOfficeLink)||this._outOfOfficeLink.destroy(),n2.ui.component.Toast.getInstance().show({theme:n2.ui.enum.Theme.INFO,allowHTML:!0,delay:5e3,message:'New Out of Office event created. <span class="n2_out-of-office-link"></span>'}),this._outOfOfficeLink=this._insertOutOfOfficeLink()}},{key:"_insertOutOfOfficeLink",value:function(){return n2.ui.component.Toast.getInstance().insert(new n2.de.component.Link({id:"out-of-office-link",renderTo:".n2_out-of-office-link",text:"Open Out of Office page.",listeners:{click:this._onOpenOutOfOffice,scope:this}}))}},{key:"_onOpenOutOfOffice",value:function(e){n2.de.page.Navigation.getInstance().open("Availability_OutOfOffice"),e.event.preventDefault()}},{key:"reload",value:function(){this._loadData({force:!0})}}]),a}(),n2.de.page.team.teamMemberList.TeamMembersDataTable=function(){_inherits(n,n2.de.component.DataTable);var t,e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS||{},{menuOptionSelect:function(e){}}),this._selectable=!0,this._cls="n2-de-team-members-data-table",this._sortBy={column:1,direction:"asc"},this._objectName=null,this._showTotalLabels=!1,this._HEADERS={name:"Name",hours:"Hours",today:"Today",status:"Status",online:""}}},{key:"objectName",set:function(e){this._objectName!==e&&(this._objectName=e,this._refreshActiveAssignmentsHeader())}},{key:"showTotalLabels",set:function(e){this._showTotalLabels!==e&&(this._showTotalLabels=e,this._refreshActiveAssignmentsHeader())}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(n.prototype),"_addHeaderRow",this).apply(this,arguments);var t=[this._HEADERS.today,this._getActiveAssignmentHeaderText()];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_generateColumnDefinitions",value:function(){var i=this;return this._filterDataTableColumns([{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",cell:{cellTemplate:"",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:this._HEADERS.name,bindPath:"name",cls:"n2_name",sortable:!0,sort:{bindPath:".nameSort"}},{header:this._HEADERS.hours,cls:"n2_hours",bindPath:"hoursLabel",sortable:!0},{header:this._HEADERS.today,cls:"n2_assignments-today",bindPath:"dailyAssignmentCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._getActiveAssignmentHeaderText(),cls:"n2_active-assignments",bindPath:"activeAssignmentCount",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.status,cls:"n2_status",bindPath:"status",sortable:!0},{header:this._HEADERS.online,cls:"n2_online-toggle",cell:{id:"online-toggle-cell",cellTemplate:"",cls:"n2_online-toggle-cell",components:[{id:"online-toggle",type:n2.ui.component.field.CheckboxToggle,mixins:[n2.mixin.DataDriven],cls:"n2_small",label:{text:null,hidden:!0},listeners:{loaded:function(e,t,n){return i._onOnlineToggleLoaded(e,t,n)},change:function(e){return i._onOnlineToggleFieldChange(e)}}}]}},{cls:"n2_menu",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getTeamMemberActionMenuConfig()]}}])}},{key:"_onOnlineToggleLoaded",value:function(e,t,n){n2.isNull(n)&&(e.value={value:t.online,silent:!0})}},{key:"_onOnlineToggleFieldChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),e.next=3,n2.DataProviderManager.getInstance().get("toggle-team-member").post({params:[t.model]});case 3:n=e.sent,t.value={value:n.data.online,silent:!0},(i=t.parent.parent).data=n.data,this._refreshRow(i),t.spinner(!1);case 7:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_filterDataTableColumns",value:function(e){return this._hasVisibleOnlineToggles()||e.splice(6,1),this._hasActiveAssignments()||e.splice(4,1),e}},{key:"_getTeamMemberActionMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"team-member-actions-menu",options:this._getTeamMemberActionMenuOptions(),listeners:{select:function(e,t){n.fire("menuOptionSelect",{target:e,data:t.parent.data})}}}}},{key:"_getTeamMemberActionMenuOptions",value:function(){return[{id:"activate",label:"Activate"},{id:"deactivate",label:"Deactivate"},{id:"remove",label:"Remove"},{id:"add-out-of-office",label:"Add Out of Office"}]}},{key:"_createRow",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return this._refreshRow(t),t}},{key:"_refreshRow",value:function(e){var t=e.data.isActive,n=e.data.isActiveForDistribution,i=e.components["menu-cell"].components["team-member-actions-menu"];t?i.components.activate.hidden=!0:i.components.deactivate.hidden=!0,e.components["online-toggle-cell"]&&this._refreshCheckboxToggle(e.components["online-toggle-cell"].components["online-toggle"]),n||(e.cls="n2_inactive")}},{key:"_refreshCheckboxToggle",value:function(e){var t=e.isChecked()?"Toggle offline":"Toggle online";e.rendered?(e.element("label").text(t),e.dom.find("label").attribute("title",t)):e.label={text:t,hidden:!0}}},{key:"_refreshData",value:function(){_get(_getPrototypeOf(n.prototype),"_refreshData",this).apply(this,arguments),this._hasVisibleOnlineToggles()&&this.forEachRow(function(e){e.components["online-toggle-cell"].components["online-toggle"].hidden=!e.data.showToggle})}},{key:"_refreshActiveAssignmentsHeader",value:function(){this._hasActiveAssignments()&&(this.headerRow.components["td-4"].data=this._getActiveAssignmentHeaderText())}},{key:"_getActiveAssignmentHeaderText",value:function(){return"".concat(this._showTotalLabels?"Total":"Active"," ").concat(this._objectName,"s")}},{key:"_hasActiveAssignments",value:function(){return!n2.isEmpty(this._data)&&!n2.isUndefined(this._data[0].activeAssignmentCount)}},{key:"_hasVisibleOnlineToggles",value:function(){return!n2.isUndefined(this._data.find(function(e){return e.showToggle}))}}]),n}(),n2.de.page.team.teamPerformance.Context=function(){_inherits(t,n2.de.page.team.Context);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._selectedTagData=null}},{key:"selectedTagData",get:function(){return this._selectedTagData},set:function(e){this._selectedTagData!==e&&(this._selectedTagData=e)}}]),t}(),n2.de.page.team.teamPerformance.ModifyAssignments=function(){_inherits(a,n2.de.component.tags.AbstractModifyTagAssignments);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"context",get:function(){return n2.de.page.team.teamPerformance.Context.getInstance()}},{key:"saveDataProviderId",get:function(){return"save-tag-assignments"}},{key:"ToolbarClass",get:function(){return n2.de.page.team.teamPerformance.modifyAssignments.Toolbar}},{key:"show",value:function(e){e.userIds,e.model;_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this.load()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0===n||n,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s),i=n2.de.page.team.teamPerformance.Context.getInstance().teamId,e.next=5,this._loadDataProvider("get-performance-tag-assignments",{params:[i,this._userIds],silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{performanceTagAssignments:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.performanceTagAssignments;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._collectionTagAssignments=e.response,this.context.isDirty=!1,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),"get-performance-tag-assignments"===t.id&&(this._collectionTagAssignments=e,this.context.isDirty=!1,this._refresh())}},{key:"_refreshToolbar",value:function(){_get(_getPrototypeOf(a.prototype),"_refreshToolbar",this).apply(this,arguments),this.assignmentsToolbar.tagCollectionOptions=this._collectionTagAssignments.map(function(e){return{value:e.id,label:e.name}})}}]),a}(),n2.de.page.team.teamPerformance.ModifyAssignmentsModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this._headerTemplate='{{#header}}\n            <div class="slds-media slds-media_center slds-has-flexi-truncate">\n                <div class="slds-media__body">\n                    <h2 class="slds-text-heading_medium slds-hyphenate" id="{{id}}_heading"{{#header.title}} title="{{header.title}}"{{/header.title}}>{{header.text}}</h2>\n                </div>\n            </div>\n        {{/header}}',this.id="modify-assignments-modal",this.dataProviders=["save-tag-assignments"],this._componentCls="n2-de-modify-assignments-modal",this.header="Modify Assignments",this._userIds=null,this._userNames=null}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertModifyAssignments()}},{key:"modifyAssignments",get:function(){return this._components["n2_modify-assignments"]}},{key:"_insertModifyAssignments",value:function(){return this._insert(new n2.de.page.team.teamPerformance.ModifyAssignments({id:"n2_modify-assignments",includeFormFooter:!1}))}},{key:"show",value:function(e){var t=e.userIds,t=void 0===t?null:t,e=e.userNames,e=void 0===e?[]:e;this.submitButton.text="Save Assignments",this.submitButton.reset(),this.cancelButton.enable(),this._userIds=t,this._userNames=e,this.modifyAssignments.show({userIds:t}),_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments)}},{key:"_getHeaderData",value:function(){return 1===this._userNames.length?{text:"Edit ".concat(this._userNames[0])}:{text:"Edit ".concat(this._userNames.length," users"),title:"".concat(this._userNames.join(", "))}}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),e.next=3,this._postDataProvider("save-tag-assignments",{params:[this._userIds,this.modifyAssignments.assignmentsForm.getTagSelectionDifferences()]});case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(n.prototype),"_onCancel",this).apply(this,arguments),n2.de.page.team.teamPerformance.Context.getInstance().isDirty=!1,this.destroy()}}]),n}(),n2.de.page.team.teamPerformance.TagAssignmentSlideOutPanel=function(){_inherits(a,n2.de.page.SlideOutPanel);var e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.Observable],this._mixins),this._componentCls="n2-tag-assignment-slide-out-panel"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertModifyAssignments()}},{key:"modifyAssignments",get:function(){return this._components["n2_modify-assignments"]}},{key:"_insertModifyAssignments",value:function(){return this._insert(new n2.de.page.team.teamPerformance.ModifyAssignments({id:"n2_modify-assignments",listeners:{saved:this._handleSaved,cancel:this._handleCancel,scope:this}}))}},{key:"_handleSaved",value:function(){var e=this;this.fire.apply(this,["saved"].concat(Array.prototype.slice.call(arguments))),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_handleCancel",value:function(e){this.hide()}},{key:"show",value:function(){var e=arguments,t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.userIds,s=void 0===i?null:i;n.heading,n.includeNavButtons,n.components,n.listeners;n2.de.page.team.teamPerformance.Context.getInstance().isDirty?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({message:"Changing team members will lose any unsaved changes, are you sure you want to continue?",listeners:{submit:function(){_get(_getPrototypeOf(a.prototype),"show",t).apply(t,e),t.modifyAssignments.show({userIds:s})}}}):(_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this.modifyAssignments.show({userIds:s}))}},{key:"hide",value:function(){_get(_getPrototypeOf(a.prototype),"hide",this).apply(this,arguments),n2.de.page.team.teamPerformance.Context.getInstance().isDirty=!1,this.modifyAssignments.reset()}}]),a}(),n2.de.page.team.teamPerformance.TeamPerformanceRecordList=function(){_inherits(n,n2.de.component.AbstractRecordList);var t,e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-team-performance-metrics"],this._teamData=null,this.teamMemberList=[]}},{key:"teamData",set:function(e){this._teamData=e,this._refresh()}},{key:"_setComponents",value:function(){this._toolbar=new n2.de.page.team.teamPerformance.teamPerformanceRecordList.Toolbar({id:"team-performance-toolbar"}),this._dataTable=new n2.de.page.team.teamPerformance.teamPerformanceRecordList.DataTable({id:"team-performance-data-table",listeners:{selectionChange:this._updateMenu,click:this._handleTableClick,scope:this}}),this._footer=new n2.de.page.team.teamPerformance.teamPerformanceRecordList.Footer({id:"team-performance-footer"})}},{key:"_updateMenu",value:function(){var e=this._dataTable.selection,t=0<e.length,n=this._toolbar.menu.components["modify-assignments"];n.hidden=!t,this._toolbar.menu.disabled=!t,t&&(n.label="Modify (".concat(e.length,")"))}},{key:"_handleFilter",value:function(e){var e=e.target,t=e.value;switch(e.id){case this._toolbar.quickFilter.id:this._handleQuickFilter(t);break;case this._toolbar.dateRangeFilter.id:this._handleDateFilter(t)}_get(_getPrototypeOf(n.prototype),"_handleFilter",this).apply(this,arguments)}},{key:"_handleQuickFilter",value:function(e){var n=e.toLowerCase();this._dataTable.addFilter(this._toolbar.quickFilter.id,{fcn:function(e){var t=e.data.tags.some(function(e){return e.collectionName.toLowerCase().includes(n)||e.tagName.toLowerCase().includes(n)}),e=e.data.name.toLowerCase().includes(n);return t||e}})}},{key:"_handleDateFilter",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadDataProvider("get-team-performance-metrics",{params:[this._teamData.teamId,t],silent:!1,force:!0});case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_refreshDataTable",value:function(){this._dataTable.teamData=this._teamData,this._dataTable.selectable=this._teamData.tagWeightingEnabled||this._teamData.teamLevelCapsEnabled}},{key:"_refreshToolbar",value:function(){this._toolbar.hidden=n2.isEmpty(this._dataTable.data),this._toolbar.hidden||(this._toolbar.dateRangeFilter.value=this._teamData.performanceDateRange,this._toolbar.hasTags=this._teamData.tagWeightingEnabled||this._teamData.teamLevelCapsEnabled,this._toolbar.dateRange={startDate:this._teamData.startDate,endDate:this._teamData.endDate},this._toolbar.showLogsWarning=this._teamData.isRangeLongerThanLogDuration)}}]),n}(),n2.de.page.team.teamSettings.TeamSettingsForm=function(){_inherits(n,n2.de.component.Form);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{generalSettings:".n2_general-settings",advancedSettings:".n2_advanced-settings .n2_fields"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-team-settings","save-team-settings"],this.layout='<div>\n            <fieldset class="n2-de-field-group n2_general-settings"></fieldset>\n            <fieldset class="n2-de-field-group n2_advanced-settings">\n                <h2 class="slds-text-heading_small">Advanced</h2>\n                <div class="n2_fields n2_indent-border-left"></div>\n            </fieldset>\n        </div>',this._hasTeamNameChanged=!1}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertFormFields()}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.force,e.silent;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadTeamSettings()}},{key:"_loadTeamSettings",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).force,e=void 0!==e&&e,t=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-team-settings").get({force:e,params:[t]})}},{key:"_insertFormFields",value:function(){var i,s,a=this;this.insert(new n2.de.component.field.UniqueNameField({id:"team-name",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-names","get-team-settings"],label:"Team name",required:!0,cls:"slds-m-bottom_medium n2_field-large",helpText:{text:"Uniquely describe your team. Shorter names are easier to read and remember.",position:n2.ui.enum.Position.BELOW},renderTo:this.SELECTORS.generalSettings,nameValidationMessage:"Team names must be unique",names:{bindPath:"get-team-names"},value:{bindPath:"get-team-settings.name"},listeners:{loading:function(e,t){"get-team-settings"===t.id&&(t=n2.de.page.team.Context.getInstance().teamId,n2.DataProviderManager.getInstance().get("get-team-names").get({force:!0,params:[t]}))},change:function(){a._hasTeamNameChanged=!0}}})),this.insert(new n2.ui.component.field.TextBox({id:"distribution-object",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],label:"Distribution object",cls:"slds-m-bottom_medium n2_field-large n2_no-field",helpText:"The Salesforce object to be distributed around the team. Distribution Object is set at team creation and can't be changed after.",renderTo:this.SELECTORS.generalSettings,disabled:!0,value:{bindPath:"get-team-settings.distributionObject"},listeners:{loaded:function(e){e.disabled=!0}}})),this._insert(new n2.de.component.form.FieldFilter({id:"field-filter",heading:"Team filter",helpText:"If defined, only records matching the filter criteria will be distributed across all of your team's distributors.",maxRows:5,mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_flush-left n2_small-heading",renderTo:this.SELECTORS.generalSettings})),this.insert(new n2.ui.component.field.Combo({id:"assignment-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-assignment-field-options","get-team-settings"],label:"Assignment field",required:!0,cls:"slds-m-bottom_medium n2_field-small",helpText:"Assign record ownership using a user lookup field. Will default to Owner, if empty. Can only be set if there are no distributors.",renderTo:this.SELECTORS.advancedSettings,disabled:{bindPath:"get-team-settings.disableAssignmentField",defaultValue:!0},options:{bindPath:"get-assignment-field-options"},value:{bindPath:"get-team-settings.assignmentField"},listeners:{loaded:function(e,t,n){"get-team-settings"===n.id&&(n=t.get("objectName"),n2.DataProviderManager.getInstance().get("get-assignment-field-options").get({params:[n],force:!0}))}}})),this.insert(new n2.ui.component.field.Combo({id:"active-status-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-active-status-field-options","get-team-settings"],label:"Active status field",cls:"slds-m-bottom_medium n2_field-small",helpText:"Let us know what field your team uses to keep track of active work.",renderTo:this.SELECTORS.advancedSettings,placeholder:"None",options:{bindPath:"get-active-status-field-options"},value:{bindPath:"get-team-settings.activeStatusField",defaultValue:""},listeners:{loaded:function(e,t,n){"get-team-settings"===n.id&&(n=t.get("objectName"),n2.DataProviderManager.getInstance().get("get-active-status-field-options").get({params:[n],force:!0}))},change:function(e){var t=n2.isEmpty(e.value);a._components["active-status-values"].hidden=t,a._components["apply-active-status-to-slas"].hidden=t,a._components["active-status-values"].clear(),t||(t=a._model.get("objectName"),e=e.value,n2.DataProviderManager.getInstance().get("get-active-status-value-options").get({params:[t,e],force:!1,requestId:e})),a._refreshLoadBalancingDuration(),a._refreshCapAndBalanceBy()}}})),this.insert(new n2.ui.component.field.Combo({id:"active-status-values",mixins:[n2.mixin.DataDriven],dataProviders:["get-active-status-value-options","get-team-settings"],label:"Active status values",multiple:!0,cls:"slds-m-bottom_medium n2_field-large",helpText:"Specify the values you use to define work as active in your team.",renderTo:this.SELECTORS.advancedSettings,placeholder:"None",options:{bindPath:"get-active-status-value-options:#requestId#"},value:{bindPath:"get-team-settings.activeStatusValues",defaultValue:[]},required:!0,hidden:{bindPath:"get-team-settings.activeStatusField",defaultValue:!0,adapter:function(e){return n2.isEmpty(e)}},listeners:{loaded:function(e,t,n){"get-team-settings"===n.id&&(n=t.get("objectName"),t=t.get("activeStatusField"),n2.isUndefined(t)||n2.DataProviderManager.getInstance().get("get-active-status-value-options").get({params:[n,t],force:!1,requestId:t}))}}})),this.insert(new n2.ui.component.field.Checkbox({id:"apply-active-status-to-slas",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],label:"Apply active status to SLAs",cls:"slds-m-bottom_medium n2_field-medium",helpText:"Only include active records in SLA checks.",renderTo:this.SELECTORS.advancedSettings,value:{bindPath:"get-team-settings.slasRespectActiveStatus"},hidden:{bindPath:"get-team-settings.activeStatusField",defaultValue:!0,adapter:function(e){return n2.isEmpty(e)}}})),this.insert(new n2.de.component.field.RadioButtonGroup({id:"cap-and-balance-type",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],renderTo:this.SELECTORS.advancedSettings,cls:"slds-m-bottom_medium",label:"Active cap and balance by:",helpText:"For load balancing or active caps, use the count of records assigned, or the total value of a selected field across assigned records.",options:["Record Count","Total Value"],value:{bindPath:"get-team-settings.activeCapAndBalanceBy"},listeners:{loaded:function(e,t,n){"get-team-settings"===n.id&&a._refreshCapAndBalanceBy()},change:function(e){var e="record count"===e.value.toLowerCase(),t=a._components["total-value-field"];t.clearInvalid(),t.hidden=e}}})),this.insert(new n2.ui.component.field.Combo({id:"total-value-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings","get-active-total-value-field-options"],label:"Value Field",cls:"slds-m-bottom_medium n2_field-medium",renderTo:this.SELECTORS.advancedSettings,required:!0,hidden:{bindPath:"get-team-settings.activeCapAndBalanceBy",defaultValue:!0,adapter:function(e){return"record count"===e.toLowerCase()}},options:{bindPath:"get-active-total-value-field-options",adapter:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}},value:{bindPath:"get-team-settings.distributedRecordValueField"},listeners:{loaded:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,i){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"get-team-settings"===i.id&&n2.DataProviderManager.getInstance().get("get-active-total-value-field-options").get({params:[n.get("objectName")],force:!0});case 1:case"end":return e.stop()}},e)})),function(e,t,n){return s.apply(this,arguments)})}})),this.insert(new n2.ui.component.field.Combo({id:"load-balancing-duration",mixins:[n2.mixin.DataDriven],dataProviders:["get-load-balancing-options","get-team-settings"],label:"Load balancing type",required:!0,cls:"slds-m-bottom_medium n2_field-medium",helpText:"Time period, count or value by which the Load Balancing Algorithm levels out lead distribution.",renderTo:this.SELECTORS.advancedSettings,sort:!1,options:{bindPath:"get-load-balancing-options"},value:{bindPath:"get-team-settings.loadBalancingDuration"},listeners:{loading:function(e,t){"get-team-settings"===t.id&&n2.DataProviderManager.getInstance().get("get-load-balancing-options").get()},loaded:function(e,t,n){"get-team-settings"===n.id&&a._refreshLoadBalancingDuration()}}})),this.insert(new n2.de.component.field.RadioButtonGroup({id:"round-robin-level-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],renderTo:this.SELECTORS.advancedSettings,cls:"slds-m-bottom_medium",label:"Round robin level",helpText:"Set scope of Round Robin; rotate assignment within team members assigned to distributors, or around your whole team.",options:[{label:"Distributor",value:!1},{label:"Team",value:!0}],value:{bindPath:"get-team-settings.teamLevelRoundRobinEnabled"}})),this.insert(new n2.de.component.field.RadioButtonGroup({id:"team-manager-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],renderTo:this.SELECTORS.advancedSettings,cls:"slds-m-bottom_medium",label:"Team manager access",helpText:"Choose whether all team managers (users with the DE Team Manager permission set) can see this team, only selected team managers or none of them. Admins and system managers will continue to be able to see this team.",options:["All","Specified","None"],sort:!1,value:{bindPath:"get-team-settings.teamManagersAccess"},listeners:{change:function(e){var t=a._components["team-manager-users"],e=(t.clearInvalid(),"Specified"===e.value);t.hidden=!e,e&&a._loadTeamManagers()}}})),this.insert(new n2.de.component.field.MaxSelectMultipleCombo({id:"team-manager-users",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings","get-team-managers"],label:"Team managers",cls:"slds-m-bottom_medium n2_field-medium",renderTo:this.SELECTORS.advancedSettings,required:!0,maxItems:13,hidden:{bindPath:"get-team-settings.teamManagersAccess",defaultValue:"All",adapter:function(e){return"Specified"!==e}},options:{bindPath:"get-team-managers",adapter:function(e){return e.map(function(e){return{label:e.name,value:e.id}})}},value:{bindPath:"get-team-settings.teamManagerUsers"},listeners:{loaded:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,i){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"get-team-settings"!==i.id||t.hidden||a._loadTeamManagers();case 1:case"end":return e.stop()}},e)})),function(e,t,n){return i.apply(this,arguments)})}})),this.insert(new n2.ui.component.field.Checkbox({id:"use-person-accounts",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],label:"Use person accounts",cls:"slds-m-bottom_medium n2_field-medium",helpText:"Distribute Person Account objects.",renderTo:this.SELECTORS.advancedSettings,hidden:{bindPath:"get-team-settings.personAccountsEnabled",defaultValue:!0,adapter:function(e){return!e}},value:{bindPath:"get-team-settings.usePersonAccounts"}})),this.insert(new n2.ui.component.field.Checkbox({id:"triggers-respect-distribution-hours",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],label:"Respect Distribution hours for triggers",cls:"slds-m-bottom_medium n2_field-large",helpText:"Trigger distributors will only assign during distribution hours.",renderTo:this.SELECTORS.advancedSettings,hidden:{bindPath:"get-team-settings.triggersEnabled",defaultValue:!0,adapter:function(e){return!e||n2.de.page.team.Context.getInstance().isQ2QTeam}},value:{bindPath:"get-team-settings.triggersRespectDistributionHours"}})),this.insert(new n2.ui.component.field.Checkbox({id:"enable-logging",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-settings"],label:"Enable logging",cls:"slds-m-bottom_medium n2_field-medium",helpText:"Disable distribution logging for your team. This is always on when you have action tracking or SLAs enabled.",renderTo:this.SELECTORS.advancedSettings,disabled:{bindPath:"get-team-settings.disableLoggingField",defaultValue:!0},value:{bindPath:"get-team-settings.loggingEnabled"}}))}},{key:"_onLoading",value:function(){}},{key:"_onLoaded",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),"get-team-settings"===t.id&&(this._model=e,(t=new n2.dataProvider.Model({value:{}})).insert(this._model.getProperty("objectName"),{key:"objectName"}),t.insert(this._model.getProperty("hasFieldFilters"),{key:"hasFieldFilters"}),t.insert(this._model.getProperty("logicAndFilters"),{key:"logicAndFilters"}),t.insert(!1,{key:"isAdvancedFilter"}),t.insert(!1,{key:"advancedFiltersEnabled"}),t.insert(!1,{key:"hideLogic"}),t.insert("",{key:"advancedSoql"}),this._components["field-filter"].model=t)}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n2.DataProviderManager.getInstance().get("save-team-settings").post({params:[this._model.json]});case 2:this._hasTeamNameChanged&&(n2.DataProviderManager.getInstance().get("get-team-navigation-options").get({force:!0}),this._hasTeamNameChanged=!1),this._loadTeamSettings({force:!0});case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onCancel",value:function(){this._loadTeamSettings({force:!0})}},{key:"_refreshLoadBalancingDuration",value:function(){var e=this._components["active-status-field"].value,t=this._components["load-balancing-duration"],e=n2.isEmpty(e)?"Total Count / Value":"Active Count / Value";t.listBox.components["option-3"].label=e,t.value.includes("Count / Value")&&t.element("field").attribute("value",e)}},{key:"_refreshCapAndBalanceBy",value:function(){var e=this._components["active-status-field"].value,t=this._components["cap-and-balance-type"],e=n2.isEmpty(e)?"Total cap and balance by":"Active cap and balance by";t.dom.find("legend.slds-form-element__label").text(e)}},{key:"_loadTeamManagers",value:function(){n2.DataProviderManager.getInstance().get("get-team-managers").get({force:!1})}},{key:"_disable",value:function(e){_get(_getPrototypeOf(n.prototype),"_disable",this).apply(this,arguments)}}]),n}(),n2.de.page.team.teamSummary.DistributorsList=function(){_inherits(t,n2.de.component.Card);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{distributors:".n2_distributors"}),this._componentCls="n2-de-card n2-de-team-summary-distributors-list",this._mixins=[n2.mixin.DataDriven],this._heading={hasDistributors:!1},this._distributorsData=null,this._headingContentTemplate='<span>\n            {{#isAdminOrSystemManager}}<a href="javascript:void(0)">Distributors</a>{{/isAdminOrSystemManager}}\n            {{^isAdminOrSystemManager}}Distributors{{/isAdminOrSystemManager}}\n            {{#heading.hasDistributors}}\n                <span class="n2_distributor-types">\n                    <span>{{#heading.triggerHeading}}{{heading.triggerHeading}}{{/heading.triggerHeading}}</span>\n                    <span>{{#heading.standardHeading}}{{heading.standardHeading}}{{/heading.standardHeading}}</span>\n                    <span>{{#heading.pullHeading}}{{heading.pullHeading}}{{/heading.pullHeading}}</span>\n                    <span>{{#heading.manualHeading}}{{heading.manualHeading}}{{/heading.manualHeading}}</span>\n                </span>\n            {{/heading.hasDistributors}}\n        </span>',this._contentTemplate='<div class="n2_distributors">\n            {{#content.trigger.length}}\n                <h3>Trigger Distributors</h3>\n                <ul class="n2_trigger-distributors">\n                    {{#content.trigger}}\n                        {{>distributorTemplate}}\n                    {{/content.trigger}}\n                </ul>\n            {{/content.trigger.length}}\n            {{#content.standard.length}}\n                {{#content.trigger.length}}<h3>Standard Distributors</h3>{{/content.trigger.length}}\n                <ul class="n2_standard-distributors">\n                    {{#content.standard}}\n                        {{>distributorTemplate}}\n                    {{/content.standard}}\n                </ul>\n            {{/content.standard.length}}\n            {{#content.pull.length}}\n                <h3>Pull Distributors</h3>\n                <ul class="n2_pull-distributors">\n                    {{#content.pull}}\n                        {{>distributorTemplate}}\n                    {{/content.pull}}\n                </ul>\n            {{/content.pull.length}}\n            {{#content.manual.length}}\n                <h3>Manual Distributors</h3>\n                <ul class="n2_manual-distributors">\n                    {{#content.manual}}\n                        {{>distributorTemplate}}\n                    {{/content.manual}}\n                </ul>\n            {{/content.manual.length}}\n        </div>',this._distributorTemplate='<li id="{{domId}}" {{^isActive}}class="n2-inactive"{{/isActive}}>\n            <span class="n2-icon">{{{svg}}}</span>\n            {{#isAdminOrSystemManager}}<a href="javascript:void(0)" class="n2-distributor" data-id="{{id}}">{{name}}</a>{{/isAdminOrSystemManager}}\n            {{^isAdminOrSystemManager}}{{name}}{{/isAdminOrSystemManager}}\n        </li>'}},{key:"distributorsData",set:function(e){n2.compare(this._distributorsData,e)||(this._distributorsData=e,this._heading=this._getHeadingTemplateData(),this._content=this._getContentTemplateData(),this._refresh())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{distributorTemplate:this._distributorTemplate})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertDistributorListLink()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"n2_empty-state",renderTo:".n2_card-content",illustration:n2.de.illustration.NoTask,heading:"Your team doesn't have any distributors yet.",content:"Distributors are the rules which define what assignments will be made to team members. ",hidden:!0}))}},{key:"_insertDistributorListLink",value:function(){var t=this;return this._components["empty-state"].insert(new n2.de.component.Link({id:"distributors-link",renderTo:"p.slds-text-body_regular",text:"Add your first distributor.",listeners:{click:function(e){return t._onDistributorListLinkClick(e)}}}))}},{key:"_onDistributorListLinkClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t)),e.event.preventDefault()}},{key:"_refreshHeading",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshHeading",this).call(this),this._bindHeadingClick()}},{key:"_bindHeadingClick",value:function(){this.element("heading").listen("click",this._onHeadingClick)}},{key:"_onHeadingClick",value:function(e){var t;"A"===e.target.tagName&&(t=n2.de.page.team.Context.getInstance().teamId,n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t)),e.preventDefault())}},{key:"_refreshContent",value:function(){this.element("distributors").purgeListeners(),_get(_getPrototypeOf(t.prototype),"_refreshContent",this).apply(this,arguments),this._refreshDistributors(),this._bindDistributorClick()}},{key:"_refreshDistributors",value:function(){var e=!n2.isEmpty(this._distributorsData);this._components["empty-state"].hidden=e}},{key:"_bindDistributorClick",value:function(){var e=this.element("distributors");n2.isNull(e)||e.listen("click",this._onDistributorClick)}},{key:"_onDistributorClick",value:function(e){var t,n;e.target.classList.contains("n2-distributor")&&(t=n2.de.page.team.Context.getInstance().teamId,n=e.target.dataset.id,n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(n,"&teamId=").concat(t)),e.preventDefault())}},{key:"_getHeadingTemplateData",value:function(){var e,t,n,i,s,a,o,r=!n2.isEmpty(this._distributorsData);return r?(t=0<(e=n2.isUndefined(this._distributorsData.trigger)?0:this._distributorsData.trigger.length),i=0<(n=n2.isUndefined(this._distributorsData.distributor)?0:this._distributorsData.distributor.length),a=0<(s=n2.isUndefined(this._distributorsData.pull)?0:this._distributorsData.pull.length),o=n2.isUndefined(this._distributorsData.manual)?0:this._distributorsData.manual.length,{hasDistributors:r,triggerHeading:this._getDistributorStatsHeading("Trigger",e),standardHeading:this._getDistributorStatsHeading("Standard",n,{includeSeparator:t}),pullHeading:this._getDistributorStatsHeading("Pull",s,{includeSeparator:t||i}),manualHeading:this._getDistributorStatsHeading("Manual",o,{includeSeparator:t||i||a})}):{hasDistributors:r}}},{key:"_getDistributorStatsHeading",value:function(e,t){var n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).includeSeparator;return 0===t?"":"".concat(void 0!==n&&n?" -":""," ").concat(t," ").concat(e)}},{key:"_getContentTemplateData",value:function(){return n2.isEmpty(this._distributorsData)?{}:{standard:this._getDistributorTemplateData(this._distributorsData.distributor,"standard"),pull:this._getDistributorTemplateData(this._distributorsData.pull,"pull"),trigger:this._getDistributorTemplateData(this._distributorsData.trigger,"trigger"),manual:this._getDistributorTemplateData(this._distributorsData.manual,"manual")}}},{key:"_getDistributorTemplateData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n=1<arguments.length?arguments[1]:void 0;return n2.isNull(e)?[]:e.map(function(e,t){return{id:e.id,domId:"n2-".concat(n.toLocaleLowerCase(),"-distributor-").concat(t),name:e.name,svg:n2.de.Icon.getMethodIcon(e.method||null),isActive:e.isActive}})}}]),t}(),n2.de.page.team.teamSummary.EmptyTeamCard=function(){_inherits(t,n2.de.component.Card);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyMessage(),this._insertTeamsLink()}},{key:"_insertEmptyMessage",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-message",heading:"Your team's almost ready",content:"Teams hold the users and distributors used to assign work. They often reflect team structures in your business. "}))}},{key:"_insertTeamsLink",value:function(){return this._components["empty-message"].insert(new n2.de.component.Link({id:"teams-link",renderTo:"p.slds-text-body_regular",target:"_blank",text:"Learn more about teams.",href:"https://help.nc-squared.com/distribution-teams"}))}}]),t}(),n2.de.page.team.teamSummary.Stats=function(){_inherits(a,n2.ui.Component);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._lazyLoad=!0}},{key:"statsContainer",get:function(){return this._components["stats-container"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertStatsContainer(),this._insertAssignments(),this._insertTopDistributors(),this._insertTrackingSummary()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,_get(_getPrototypeOf(a.prototype),"_loadData",this).apply(this,s),i=n2.de.page.team.Context.getInstance().teamId,e.next=5,this._loadDataProvider("get-team-summary-analytics",{params:[i],force:t,silent:n});case 5:return e.t0=e.sent,e.abrupt("return",{teamSummaryAnalytics:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.teamSummaryAnalytics;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this.statsContainer.components["assignments-card"].assignmentsData=e.response,this.statsContainer.components["top-distributors-card"].topDistributorsData=e.response,this.statsContainer.components["tracking-summary-card"].trackingSummaryData=e.response}},{key:"_insertStatsContainer",value:function(){var e=n2.de.page.team.Context.getInstance().isQ2QTeam?"n2_2-column":"";return this._insert(new n2.ui.component.HTML({id:"stats-container",template:'<div class="n2_stats-container slds-grid '.concat(e,'"></div>')}))}},{key:"_insertAssignments",value:function(){return this.statsContainer.insert(new n2.de.page.team.teamSummary.stats.Assignments({id:"assignments-card",cls:"slds-col"}))}},{key:"_insertTopDistributors",value:function(){return this.statsContainer.insert(new n2.de.page.team.teamSummary.stats.TopDistributors({id:"top-distributors-card",cls:"slds-col"}))}},{key:"_insertTrackingSummary",value:function(){return this.statsContainer.insert(new n2.de.page.team.teamSummary.stats.TrackingSummary({id:"tracking-summary-card",cls:"slds-col",hidden:n2.de.page.team.Context.getInstance().isQ2QTeam}))}},{key:"show",value:function(){_get(_getPrototypeOf(a.prototype),"show",this).call(this),this.load({silent:!0,force:!1})}}]),a}(),n2.de.page.team.teamSummary.TeamInfo=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{status:".n2_team-status",objectName:".n2_object-name",hours:".n2_team-hours"}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-component slds-grid{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{#showStatus}}{{>statusTemplate}}{{/showStatus}}\n            {{#objectName}}{{>objectNameTemplate}}{{/objectName}}\n            {{#hours}}{{>hoursTemplate}}{{/hours}}\n        </div>',this._componentCls="n2-de-team-summary-info",this._statusTemplate='<div class="n2_team-status">\n            <h3>Status</h3>\n            <p>{{#isAdminOrSystemManager}}<a href="javascript:void(0)" class="n2_team-status-link">{{/isAdminOrSystemManager}}\n            {{#isActive}}Active{{/isActive}}{{^isActive}}Inactive{{/isActive}}\n            {{#isAdminOrSystemManager}}</a>{{/isAdminOrSystemManager}}</p>\n        </div>',this._objectNameTemplate='<div class="n2_team-object-name">\n            <h3>Distribution Object</h3>\n            <p>\n            {{#isAdminOrSystemManager}}<a href="javascript:void(0)" class="n2_team-object-name-link">{{objectName}}</a>{{/isAdminOrSystemManager}}\n            {{^isAdminOrSystemManager}}{{objectName}}{{/isAdminOrSystemManager}}\n            </p>\n        </div>',this._hoursTemplate='<div class="n2_team-hours">\n            <h3>Team Hours</h3>\n            <p><a href="javascript:void(0)" class="n2_team-hours-link">{{hours}}</a></p>\n        </div>',this._isActive=null,this._objectName=null,this._hours=null}},{key:"isActive",set:function(e){this._isActive!==e&&(this._isActive=e,this._refresh({objectName:!1,hours:!1}))}},{key:"objectName",set:function(e){this._objectName!==e&&(this._objectName=e,this._refresh({status:!1,hours:!1}))}},{key:"hours",set:function(e){this._hours!==e&&(this._hours=e,this._refresh({status:!1,objectName:!1}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{isActive:this._isActive,showStatus:!n2.isNull(this._isActive),objectName:this._objectName,hours:this._hours,isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplatePartials",this).call(this),{statusTemplate:this._statusTemplate,objectNameTemplate:this._objectNameTemplate,hoursTemplate:this._hoursTemplate})}},{key:"_bindEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).apply(this,arguments),this._dom.listen("click",function(e){return t._onClick(e)})}},{key:"_onClick",value:function(e){if("A"===e.target.tagName){var t=n2.de.page.team.Context.getInstance().teamId;switch(e.target.className){case"n2_team-status-link":case"n2_team-object-name-link":n2.de.page.Navigation.getInstance().open("Team_TeamSettings","teamId=".concat(t)),e.preventDefault();break;case"n2_team-hours-link":n2.de.page.Navigation.getInstance().open("Team_DistributionHours","teamId=".concat(t)),e.preventDefault()}}}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.objectName,n=void 0===n||n,e=e.hours,e=void 0===e||e;this._rendered&&((void 0===t||t)&&this._refreshStatus(),n&&this._refreshObjectName(),e)&&this._refreshHours()}},{key:"_refreshStatus",value:function(){var e;n2.isNull(this.element("status"))||this.element("status").remove(),n2.isNull(this._isActive)||(e=n2.ui.Template.render(this._statusTemplate,this._getTemplateData(),this._getTemplatePartials()),this._dom.insert(e,"afterbegin"),this.element("status",!0))}},{key:"_refreshObjectName",value:function(){var e;n2.isNull(this.element("objectName"))||this.element("objectName").remove(),n2.isEmpty(this._objectName)||(e=n2.ui.Template.render(this._objectNameTemplate,this._getTemplateData(),this._getTemplatePartials()),this.element("status").insert(e,"afterend"),this.element("objectName",!0))}},{key:"_refreshHours",value:function(){var e;n2.isNull(this.element("hours"))||this.element("hours").remove(),n2.isEmpty(this._hours)||(e=n2.ui.Template.render(this._hoursTemplate,this._getTemplateData(),this._getTemplatePartials()),this._dom.insert(e,"beforeend"),this.element("hours",!0))}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).call(this),this._isActive=null,this._objectName=null,this._hours=null}}]),n}(),n2.de.page.team.teamSummary.TeamMembersList=function(){_inherits(t,n2.de.component.Card);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_team-members"}),this._componentCls="n2-de-card n2-de-team-summary-members-list",this._mixins=[n2.mixin.DataDriven],this._teamMembersData=null,this._headingContentTemplate='<span><a href="javascript:void(0)">{{heading.title}}</a>{{#heading.displayOnline}}<span class="n2-online"> {{heading.onlineCount}}/{{heading.total}} available</span>{{/heading.displayOnline}}</span>',this._contentTemplate='<ul class="n2_team-members"></ul>',this._heading={title:"Team members"}}},{key:"teamMembersData",set:function(e){n2.compare(this._teamMembersData,e)||(this._teamMembersData=e,this._heading=n2.merge(this._heading,this._getCardHeadingData()),this._refresh())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState(),this._insertTeamMembersLink()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"n2_empty-state",renderTo:".n2_card-content",illustration:n2.de.illustration.Desert,heading:"Your team doesn't have any team members yet.",content:"Team members are the users who receive assignments from this team. ",hidden:!0}))}},{key:"_insertTeamMembersLink",value:function(){var t=this;return this._components["empty-state"].insert(new n2.de.component.Link({id:"teams-members-link",renderTo:"p.slds-text-body_regular",text:"Add your first team member.",listeners:{click:function(e){return t._onTeamMembersLinkClick(e)}}}))}},{key:"_onTeamMembersLinkClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t)),e.event.preventDefault()}},{key:"_bindEvents",value:function(){_get(_getPrototypeOf(t.prototype),"_bindEvents",this).apply(this,arguments),this._bindHeadingClick()}},{key:"_refreshHeading",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshHeading",this).call(this),this._bindHeadingClick()}},{key:"_bindHeadingClick",value:function(){this.element("heading").listen("click",this._onHeadingClick)}},{key:"_onHeadingClick",value:function(e){var t;"A"===e.target.tagName&&(t=n2.de.page.team.Context.getInstance().teamId,n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t)),e.preventDefault())}},{key:"_refreshContent",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshContent",this).apply(this,arguments),this._refreshTeamMembers()}},{key:"_refreshTeamMembers",value:function(){var e=!n2.isEmpty(this._teamMembersData.teamMembers);this._components["empty-state"].hidden=e,this._destroyTeamMembers(),this._insertTeamMembers()}},{key:"_destroyTeamMembers",value:function(){this.forEach({type:n2.de.page.team.teamSummary.teamMembersList.TeamMember,fcn:function(e){return e.destroy()}})}},{key:"_insertTeamMembers",value:function(){var n=this,i=[];return this._teamMembersData.teamMembers.forEach(function(e,t){i.push(n._insertTeamMember(e,t))}),i}},{key:"_insertTeamMember",value:function(e,t){return this._insert(new n2.de.page.team.teamSummary.teamMembersList.TeamMember({id:"member-".concat(t),model:e}))}},{key:"_getCardHeadingData",value:function(){var e=this._teamMembersData.teamMembers,t=e.filter(function(e){return"Available"===e.status});return{displayOnline:0!==e.length,total:e.length,onlineCount:t.length}}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).apply(this,arguments),this.element("heading").purgeListeners(),this._teamMembersData=null}}]),t}(),n2.de.page.team.trackingAndSlas.DistributorSettings=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{toolbar:".n2_toolbar"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-distributor-slas"],this._template='<div id="{{id}}" class="n2-de-tracking-and-slas-distributor-settings{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><div class="n2_toolbar"></div></div>',this._modelChanged=!1,this._cachedDistributor=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter()}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.toolbar,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Find distributor...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this._components.distributors.addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this._components.distributors.removeFilters(["quickFilter"])}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadDistributors({force:t,silent:e})}},{key:"_loadDistributors",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributor-slas").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-distributor-slas"!==t.id||this._onSlasDataLoaded(e),n2.de.page.SlideOutPanel.getInstance().hidden||this._reloadSlideOutPanel()}},{key:"_reloadSlideOutPanel",value:function(){var e;n2.isNull(this._cachedDistributor)?n2.de.page.SlideOutPanel.getInstance().hidden=!0:(e=this._getDistributorModel(this._cachedDistributor.distributorId),n2.de.page.SlideOutPanel.getInstance().components["distributor-settings-form"].model=e,this._cachedDistributor=e.json)}},{key:"_onSlasDataLoaded",value:function(e){this._modelChanged=!1,this._model=e,this._insertDistributors(),this._components["quick-filter"].hidden=n2.isEmpty(e.json),e.listen("change",this._onDistributorsChange,this)}},{key:"_insertDistributors",value:function(){var s=this,e=(n2.isUndefined(this._components.distributors)||this._components.distributors.destroy(),this._model.json.length),t=1===e?"distributor":"distributors";return this._insert(new n2.de.page.team.trackingAndSlas.distributorSettings.DistributorSettingsDataTable({id:"distributors",data:this._model,mixins:[n2.mixin.DataDriven],emptyState:{type:n2.de.page.team.trackingAndSlas.distributorSettings.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no distributors that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all distributors."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){s._components["quick-filter"].clear()}}}},listeners:{click:function(e,t,n,i){return s._onDataTableClick(e,t,n,i)}}}))}},{key:"_onDataTableClick",value:function(e,t,n,i){n2.isNull(this._cachedDistributor)||this._resetCachedDistributor();t=this._getDistributorModel(t.data.distributorId);this._cachedDistributor=t.json,this._showSlideOutPanel(t)}},{key:"_resetCachedDistributor",value:function(){var e=this._getDistributorModel(this._cachedDistributor.distributorId),e=this._model.findChild(e).key;n2.isNull(e)||(this._model.remove(e,{silent:!0}),this._model.insert(this._cachedDistributor,{key:e,silent:!0}))}},{key:"_getDistributorModel",value:function(t){return this._model.items.find(function(e){return e.get("distributorId")===t})}},{key:"_showSlideOutPanel",value:function(t){var n=this;n2.de.page.SlideOutPanel.getInstance().show({heading:t.get("name"),components:[new n2.de.page.team.trackingAndSlas.distributorSettings.DistributorSettingsForm({id:"distributor-settings-form",model:t})],listeners:{click:function(e){return n._onSlideOutPanelClick(e,t)}}})}},{key:"_onSlideOutPanelClick",value:function(e,t){switch(e.target.id){case"open-button":case"heading-button":this._onSlideOutPanelOpenButtonClick(t.get("distributorId"));break;case"close-button":this._modelChanged&&this._loadDistributors({force:!0}),this._cachedDistributor=null}}},{key:"_onSlideOutPanelOpenButtonClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_onDistributorsChange",value:function(e){this._modelChanged=!0}},{key:"reload",value:function(){this._cachedDistributor=null,this._loadData({force:!0})}}]),n}(),n2.de.page.team.trackingAndSlas.TeamSettings=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-team-tracking-and-slas"],this._slaShiftPlannerRetentionPeriodMessageTemplate='The SLA period exceeds the shift planner retention period of {{retentionPeriod}} {{weekstr}}. This will affect how SLAs are calculated. If you wish to increase the shift planner retention period, please contact <a href="mailTo:support@nc-squared.com">support@nc-squared.com</a>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertActionTracking(),this._insertSlas(),this._insertShiftPlannerRetentionPeriodMessage()}},{key:"_insertActionTracking",value:function(){return this._insert(new n2.de.page.team.trackingAndSlas.teamSettings.ActionTracking({id:"action-tracking",cls:"n2_indent-left",hidden:!0}))}},{key:"_insertSlas",value:function(){return this._insert(new n2.de.page.team.trackingAndSlas.teamSettings.Slas({id:"slas",cls:"n2_indent-left",hidden:!0}))}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadTrackingAndSlas({force:t,silent:e})}},{key:"_loadTrackingAndSlas",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-team-tracking-and-slas").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(n2.de.page.team.Context.getInstance().isDirty=!1,this._model=e,this._components["action-tracking"].model=e,this._components["action-tracking"].hidden=!e.get("supportsActionTracking"),this._components.slas.model=e,this._components.slas.hidden=!e.get("supportsSLAs"),t=e.get("hasSLAShiftPlannerRetentionWarning"),this._components["shift-planner-retention-period-message"].content=t?this._getSLAShiftPlannerRetentionMessage(e.get("shiftPlannerRetentionPeriod")):"",this._components["shift-planner-retention-period-message"].hidden=!t)}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(n.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.Context.getInstance().isDirty=!0}},{key:"_insertShiftPlannerRetentionPeriodMessage",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"shift-planner-retention-period-message",renderTo:this.SELECTORS.formBody,type:"info",content:"",hidden:!0}))}},{key:"_getSLAShiftPlannerRetentionMessage",value:function(e){return n2.ui.Template.render(this._slaShiftPlannerRetentionPeriodMessageTemplate,{retentionPeriod:e,weekstr:1===e?"week":"weeks"})}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("save-team-tracking-and-slas").post({params:[this._model.json]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadTrackingAndSlas({force:!0})}},{key:"_onCancel",value:function(){this._loadTrackingAndSlas({force:!0})}}]),n}(),n2.de.page.team.weightingAndCaps.CapCombo=function(){_inherits(t,n2.ui.component.field.Combo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._customCapPeriodsInUse=[],this._validateOnBlur=!0,this._rollbackValue=null}},{key:"customCapPeriodsInUse",set:function(e){this._customCapPeriodsInUse!==e&&(this._customCapPeriodsInUse=e)}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this._refreshOptions(),this._rollbackValue=this._value}},{key:"_setValue",value:function(e){this._rollbackValue=e.value,_get(_getPrototypeOf(t.prototype),"_setValue",this).call(this,e)}},{key:"_refreshOptions",value:function(){this.listBox.options=this._addCustomOption(this._options)}},{key:"_addCustomOption",value:function(e){return[].concat(_toConsumableArray(e),[{label:"Custom...",value:"Custom"}])}},{key:"_onListBoxChange",value:function(e){"Custom"===e.target.value?(this.listBox.selection=this._rollbackValue,this._openCustomPeriodModal()):(this._rollbackValue=e.target.value,_get(_getPrototypeOf(t.prototype),"_onListBoxChange",this).apply(this,arguments))}},{key:"customCapModal",get:function(){return n2.de.page.team.weightingAndCaps.CustomCapModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_openCustomPeriodModal",value:function(){var t=this;this._validateOnBlur=!1,this.customCapModal.show({listeners:{submit:function(e){return t._onCustomCapSubmit(e)}},customCapPeriodsInUse:this._customCapPeriodsInUse})}},{key:"_onCustomCapSubmit",value:function(e){var e=e.data,t=n2.de.data.PeriodOptions.cappingPeriodToKey(e);this._options.find(function(e){return e.value===t})||(this.options=this._options.concat([{value:t,label:n2.de.data.PeriodOptions.getPeriodLabel(e)}])),this.value={value:t,silent:!1,validate:!0}}},{key:"_getInputFieldTitle",value:function(){var e=this._getSelectedOption();return n2.isNull(e)?"":e.label}},{key:"validate",value:function(){return!this._validateOnBlur||_get(_getPrototypeOf(t.prototype),"validate",this).call(this)}},{key:"_onBlur",value:function(){_get(_getPrototypeOf(t.prototype),"_onBlur",this).call(this),this._validateOnBlur=!0}}]),t}(),n2.de.page.team.weightingAndCaps.CustomCapModal=function(){_inherits(s,n2.de.component.Modal);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{change:function(){}}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this.id="custom-caps-modal",this._customCapPeriodsInUse=[],this._cls="n2-de-custom-cap-modal"}},{key:"customCapsForm",get:function(){return this._components["custom-caps-form"]}},{key:"customCapPeriodField",get:function(){return this.customCapsForm.components["custom-cap-period"]}},{key:"customCapLengthField",get:function(){return this.customCapsForm.components["custom-cap-length"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e={};return e.period=this.customCapPeriodField.value,e.length=this.customCapLengthField.value,e.rolling=!0,e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){var e=this;this.insert(new n2.ui.component.Form({id:"custom-caps-form",cls:"n2_combos slds-grid slds-wrap slds-grid_align-spread slds-p-bottom_small",components:[{type:n2.ui.component.field.Combo,id:"custom-cap-length",cls:"slds-col slds-size_1-of-2 slds-p-right_x-small",label:"Length",lazyRender:!0,required:!0,sort:!1,options:[],listeners:{change:function(){return e._onFieldChange()}}},{type:n2.ui.component.field.Combo,id:"custom-cap-period",cls:"slds-col slds-size_1-of-2",label:"Period",required:!0,sort:!1,options:[{value:"By minute",label:"minutes"},{value:"Hourly",label:"hours"},{value:"Daily",label:"days"}],listeners:{change:function(){e._onFieldChange(),e._onPeriodChange()}}}]}))}},{key:"_onFieldChange",value:function(){this.fire("change")}},{key:"_onSubmit",value:function(){this.customCapsForm.validate()&&(_get(_getPrototypeOf(s.prototype),"_onSubmit",this).call(this),this.hide())}},{key:"show",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).header,t=void 0===t?"Custom Cap Period":t,n=n.customCapPeriodsInUse,n=void 0===n?null:n,_get(_getPrototypeOf(s.prototype),"show",this).apply(this,i),this.header=t,this.customCapsForm.clear(),this._customCapPeriodsInUse=n||[],this.customCapPeriodField.value={value:"Daily",silent:!0},this._onPeriodChange(),this.submitButton.reset(),this.cancelButton.enable();case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_getLengthOptions",value:function(){var e=this.customCapPeriodField.value;return"By minute"===e?this._generateOptions(5,180,e):"Hourly"===e?this._generateOptions(1,168,e):this._generateOptions(2,31,e)}},{key:"_onPeriodChange",value:function(){var e=this._getLengthOptions(),e=(this.customCapLengthField.options=e)[0].value;(!this.customCapLengthField.value||this.customCapLengthField.value<e)&&(this.customCapLengthField.value=e)}},{key:"_generateOptions",value:function(e,t,n){for(var i=n2.isEmpty(this._customCapPeriodsInUse)?[]:this._customCapPeriodsInUse.filter(function(e){return e.period===n}).map(function(e){return e.length}),s=[],a=e;a<=t;a++)i.includes(a)||s.push({value:a,label:a.toString()});return s}}]),s}(),n2.de.page.team.weightingAndCaps.DistributorSettings=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{toolbar:".n2_toolbar"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-distributor-settings"],this._template='<div id="{{id}}" class="n2-de-weighting-caps-distributor-settings{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><div class="n2_toolbar"></div></div>',this._modelChanged=!1,this._cachedDistributor=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter()}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.toolbar,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Find distributor...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this._components["distributor-settings"].addFilter("quickFilter",{dataBindings:["distributorName"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this._components["distributor-settings"].removeFilters(["quickFilter"])}},{key:"_onDistributorSettingsDataTableClick",value:function(e,t,n,i){n2.isNull(this._cachedDistributor)||this._resetCachedDistributor();t=this._getDistributorModel(t.data.distributorId);this._cachedDistributor=t.json,this._showSlideOutPanel(t)}},{key:"_resetCachedDistributor",value:function(){var n=this._getDistributorModel(this._cachedDistributor.distributorId);n2.forEach(this._cachedDistributor,function(e,t){n.getProperty(t).value=e})}},{key:"_getDistributorModel",value:function(t){return this._model.items.find(function(e){return e.get("distributorId")===t})}},{key:"_showSlideOutPanel",value:function(t){var n=this;n2.de.page.SlideOutPanel.getInstance().show({heading:t.get("distributorName"),components:[new n2.de.page.team.weightingAndCaps.distributorSettings.WeightingAndCapsForm({id:"weighting-and-caps-form",model:t})],listeners:{click:function(e){return n._onSlideOutPanelClick(e,t)}}})}},{key:"_onSlideOutPanelClick",value:function(e,t){switch(e.target.id){case"open-button":case"heading-button":this._onSlideOutPanelOpenButtonClick(t.get("distributorId"));break;case"close-button":this._modelChanged&&this._loadDistributorSettings({force:!0}),this._cachedDistributor=null}}},{key:"_onSlideOutPanelOpenButtonClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"reload",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0===t||t,e=e.silent,e=void 0!==e&&e;this._cachedDistributor=null,this._loadData({force:t,silent:e})}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadDistributorSettings({force:t,silent:e})}},{key:"_loadDistributorSettings",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributor-settings").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-distributor-settings"!==t.id||this._onDistributorSettingsLoaded(e)}},{key:"_onDistributorSettingsLoaded",value:function(e){this._modelChanged=!1,this._model=e,this._insertDistributorSettings(),this._components["quick-filter"].hidden=n2.isEmpty(e.json),e.listen("change",this._onDistributorSettingsChange,this),n2.de.page.SlideOutPanel.getInstance().hidden||n2.isNull(this._cachedDistributor)||(e=this._getDistributorModel(this._cachedDistributor.distributorId),n2.de.page.SlideOutPanel.getInstance().components["weighting-and-caps-form"].model=e,this._cachedDistributor=e.json)}},{key:"_insertDistributorSettings",value:function(){var s=this;n2.isUndefined(this._components["distributor-settings"])||this._components["distributor-settings"].destroy(),this._insert(new n2.de.page.team.weightingAndCaps.distributorSettings.DistributorSettingsDataTable({id:"distributor-settings",mixins:[n2.mixin.DataDriven],data:this._model,columns:this._getDistributorSettingsColumns(),emptyState:{type:n2.de.page.team.weightingAndCaps.distributorSettings.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){s._components["quick-filter"].clear()}}}},listeners:{click:function(e,t,n,i){return s._onDistributorSettingsDataTableClick(e,t,n,i)}}}))}},{key:"_getDistributorSettingsColumns",value:function(){var e=[{header:"Distributor",bindPath:"distributorName"},{header:"Type",bindPath:"distributorType"},{header:"Order",bindPath:"order",cell:{cls:"slds-text-align_right"}},{header:"Method",bindPath:"method"},{header:"Weighting",cell:{dataAdapter:function(e){return e.weightingEnabled?"Enabled":{html:'<span class="n2_text-weak">&mdash;</span>'}}}},{header:"Distributor Cap",cell:{cellTemplate:"",type:n2.ui.component.dataTable.Cell,components:[{id:"distributor-cap-label",cls:"n2-de-summary",mixins:[n2.mixin.DataDriven],type:n2.de.component.DistributorCapsLabel}]}}],t=this._model.get("0");return!n2.isUndefined(t)&&t.teamCapsEnabled&&e.push({header:"Team Caps",bindPath:"teamCapsIgnored",cell:{dataAdapter:function(e){return e?"Ignored":{html:'<span class="n2_text-weak">&mdash;</span>'}}}}),e}},{key:"_onDistributorSettingsChange",value:function(e){this._modelChanged=!0}}]),n}(),n2.de.page.team.weightingAndCaps.TeamCaps=function(){_inherits(n,n2.de.component.Form);var t,e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-team-caps","save-team-caps"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState(),this._insertActiveCapsNotification(),this._insertNoTagsNotification(),this._insertTagCollectionSelection(),this._insertTagCaps(),this._insertDisableCaps()}},{key:"_insertEmptyState",value:function(){var t=this,e=this._insert(new n2.ui.component.Illustration({id:"empty-state",renderTo:this.SELECTORS.formBody,hidden:!0,illustration:n2.ui.component.illustration.FishingDeals,heading:"Team-level caps",content:"Caps add fixed limits to the number of assignments. Team-level caps controls the total number of assignments a team member receives."}));return e.insert(new n2.ui.component.Button({id:"enable-caps",text:"Enable Team-Level Caps",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onEnableCapsButtonClick(e)}}})),e}},{key:"_insertActiveCapsNotification",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"active-caps-notification",type:"info",renderTo:this.SELECTORS.formBody,hidden:!0}))}},{key:"_refreshActiveCapsNotification",value:function(){var e=this._model.get("defaultCaps");n2.isUndefined(e.find(function(e){return"Load balanced"===e.cappingPeriod.period}))?this._hideActiveCapsNotification():this._showActiveCapsNotification()}},{key:"_showActiveCapsNotification",value:function(){this._components["active-caps-notification"].content=this._getActiveCapsNotificationContent(),this._components["active-caps-notification"].hidden=!1}},{key:"_getActiveCapsNotificationContent",value:function(){return this._model.get("isActiveCapOrLoadBalancedByValue")?"Team capping by value of ".concat(n2.htmlEncode(this._model.get("distributedRecordValueField"))):"Team capping by record count"}},{key:"_hideActiveCapsNotification",value:function(){this._components["active-caps-notification"].hidden=!0}},{key:"_insertNoTagsNotification",value:function(){var t=this;return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?this._insert(new n2.de.component.ScopedNotification({id:"no-tags-notification",type:"info",content:'You can also assign team-level caps by tags. <span class="n2__create_tag_collection"></span> to get started',renderTo:this.SELECTORS.formBody,hidden:!0,components:[new n2.de.component.Link({id:"create-tag-collection",text:"Create your first tag collection",renderTo:".n2__create_tag_collection",listeners:{click:function(e){t._onCreateTagCollectionClick()}}})]})):this._insert(new n2.de.component.ScopedNotification({id:"no-tags-notification",type:"info",content:"You can also assign team-level caps by tags.",renderTo:this.SELECTORS.formBody,hidden:!0}))}},{key:"_onCreateTagCollectionClick",value:function(){n2.de.page.Navigation.getInstance().open("Tags_TagCollectionList")}},{key:"_onEnableCapsButtonClick",value:function(e){this._model.getProperty("capsEnabled").value=!0}},{key:"_insertTagCollectionSelection",value:function(){var i=this;return this._insert(new n2.ui.component.field.Combo({id:"tag-collection",mixins:[n2.mixin.DataDriven],dataProviders:["get-tag-collection-options"],cls:"n2_tag-collection slds-m-top_medium",label:"Tag collection (optional)",placeholder:"None",options:{bindPath:"get-tag-collection-options"},value:{bindPath:"."},hidden:!0,listeners:{loaded:function(e,t,n){n2.isNull(n)||"get-tag-collection-options"!==n.id||i._onTagCollectionOptionsLoaded(t)},change:function(e){i._components["tag-caps"].clear(),i._loadTagValueOptions()}}}))}},{key:"_onTagCollectionOptionsLoaded",value:function(e){this._components["tag-collection"].hidden=!this._canShowTagCollectionField(),this._components["no-tags-notification"].hidden=!this._canShowNoTagNotification()}},{key:"_insertTagCaps",value:function(){return this._insert(new n2.de.page.team.weightingAndCaps.teamCaps.TagCaps({id:"tag-caps",hidden:!0,label:{text:"Tag caps",hidden:!0},cls:"slds-m-around_medium"}))}},{key:"_insertDisableCaps",value:function(){var t=this,e=this._insert(new n2.de.component.form.FieldGroup({id:"disable-caps",hidden:!0,heading:"Disable caps",cls:"n2_disable-caps"}));return e.insert(new n2.ui.component.Button({id:"disable-caps-button",text:"Disable Caps",theme:n2.ui.component.button.Theme.TEXT_DESTRUCTIVE,listeners:{click:function(e){return t._onDisableCapsButtonClick(e)}}})),e}},{key:"_onDisableCapsButtonClick",value:function(e){var t=this;n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom.parent}).show({message:"Are you sure you want to disable caps? You will lose all current caps.",listeners:{submit:function(e){return t._onDisableCapsConfirm(e)}}})}},{key:"_onDisableCapsConfirm",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(n=this._model.json).capsEnabled=!1,this.spinner(),this._resetFooter(),this._saveTeamCaps(n,{silent:!1});case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadTeamCaps({force:t,silent:e})}},{key:"_loadTeamCaps",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-team-caps").get({params:[n],force:t,silent:e})}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-team-caps")}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadTeamCaps({force:!0})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-team-caps"!==t.id||this._onCapsDataLoaded(e)}},{key:"_onCapsDataLoaded",value:function(e){n2.de.page.team.Context.getInstance().isDirty=!1,this._model=e,this._refreshFieldVisibility(),this._refreshActiveCapsNotification(),this._components["tag-collection"].model=e.getProperty("tagCollectionId",{defaultValue:""}),this._components["tag-caps"].model=e,n2.isUndefined(e.get("tagCollectionId"))||this._loadTagValueOptions(),e.listen("change",this._onCapsModelChange,this)}},{key:"_onCapsModelChange",value:function(e){n2.de.page.team.Context.getInstance().isDirty=!0,this._refreshFieldVisibility(),this._showFooter(),this._refreshActiveCapsNotification()}},{key:"_refreshFieldVisibility",value:function(){this._model.get("capsEnabled")?(this._showEditView(),this._showEmptyState({show:!1})):(this._showEmptyState(),this._showEditView({show:!1}))}},{key:"_showEditView",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).show,e=void 0===e||e;this._components["no-tags-notification"].hidden=!e||!this._canShowNoTagNotification(),this._components["tag-collection"].hidden=!e||!this._canShowTagCollectionField(),this._components["tag-caps"].hidden=!e,this._components["disable-caps"].hidden=!e}},{key:"_canShowTagCollectionField",value:function(){var e=n2.DataProviderManager.getInstance().get("get-tag-collection-options").model;return!n2.isEmpty(e)&&!n2.de.page.team.Context.getInstance().isQ2QTeam}},{key:"_canShowNoTagNotification",value:function(){var e=n2.DataProviderManager.getInstance().get("get-tag-collection-options").model;return n2.isEmpty(e)&&!n2.de.page.team.Context.getInstance().isQ2QTeam}},{key:"_showEmptyState",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).show;this._components["empty-state"].hidden=!(void 0===e||e)}},{key:"_loadTagValueOptions",value:function(){n2.DataProviderManager.getInstance().get("get-caps-tag-collection-value-options").get({params:[this._model.get("tagCollectionId")],force:!0})}},{key:"_onFieldChange",value:function(){_get(_getPrototypeOf(n.prototype),"_onFieldChange",this).apply(this,arguments),n2.de.page.team.Context.getInstance().isDirty=!0}},{key:"_onSubmit",value:function(){this._saveTeamCaps()}},{key:"_saveTeamCaps",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._model.json,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).silent,t=void 0!==t&&t;return n2.isEmpty(e.tagCollectionId)&&delete e.tagCollectionId,n2.DataProviderManager.getInstance().get("save-team-caps").post({params:[e],silent:t})}},{key:"_onCancel",value:function(){this._loadTeamCaps({force:!0})}},{key:"reload",value:function(){this._loadTeamCaps({force:!0}),this._components["save-footer"].hide()}}]),n}(),n2.de.page.team.weightingAndCaps.Weighting=function(){_inherits(n,n2.ui.Component);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_content",toolbar:".n2_toolbar"}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-de-weighting{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><div class="n2_content"><div class="n2_toolbar"></div></div></div>',this.dataProviders=["get-team-weighting","save-team-weighting"],this._TYPE={INDIVIDUAL:"Individual",TAG:"Tag"}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter(),this._insertWeightingViewSwitch(),this._insertIndividualWeighting(),this._insertTagWeighting(),this._insertSaveFooter()}},{key:"_insertQuickFilter",value:function(){var t=this;this.insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.toolbar,cls:"n2_quick-filter",label:{text:"Quick filter",hidden:!0},placeholder:"Quick filter...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,hidden:!0,listeners:{type:function(e){return t._onQuickFilterType(e)},change:function(e){return t._onQuickFilterChange(e)}}}))}},{key:"_onQuickFilterType",value:function(e){""!==e.value&&this._components["individual-weightings"].addFilter("quickFilter",{dataBindings:["name"],value:e.value}),this._onQuickFilterChange(e)}},{key:"_onQuickFilterChange",value:function(e){""===e.value&&this._components["individual-weightings"].removeFilters(["quickFilter"])}},{key:"_insertWeightingViewSwitch",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"weighting-view-switch",renderTo:this.SELECTORS.toolbar,text:"Switch to tag weighting",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onWeightingViewSwitchChange(e)}}}))}},{key:"_onWeightingViewSwitchChange",value:function(e){switch(this._model.get("weightingType")){case this._TYPE.TAG:this._showIndividualWeighting(),this._model.getProperty("weightingType").value=this._TYPE.INDIVIDUAL;break;case this._TYPE.INDIVIDUAL:this._showTagBasedWeighting(),this._model.getProperty("weightingType").value=this._TYPE.TAG}}},{key:"_insertIndividualWeighting",value:function(){var e=this;this._insert(new n2.de.page.team.weightingAndCaps.weighting.Individual({id:"individual-weightings",emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){e._components["quick-filter"].clear()}}}},hidden:!0}))}},{key:"_insertTagWeighting",value:function(){this._insert(new n2.de.page.team.weightingAndCaps.weighting.TagBased({id:"tag-based-weightings",hidden:!0}))}},{key:"_insertSaveFooter",value:function(){var t=this;this._insert(new n2.de.component.form.Footer({id:"save-footer",renderTo:{target:this.SELECTORS.body,position:"afterend"},hidden:!0,listeners:{cancel:function(e){return t._onCancel(e)},submit:function(e){return t._onSubmit(e)}}}))}},{key:"_onCancel",value:function(e){this._loadData({force:!0})}},{key:"_onSubmit",value:function(e){var t=this._components["tag-based-weightings"],n=this._model.get("weightingType")!==this._TYPE.TAG||t.validate();this._model.get("weightingType")===this._TYPE.INDIVIDUAL||n?n2.DataProviderManager.getInstance().get("save-team-weighting").post({params:[this._model.json]}):n||(n=t.components["tag-collection"],t.components["tag-weightings"].isValid||(n=t.components["tag-weightings"]),n2.de.component.Form.scrollInvalidComponentIntoView(n))}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),this._loadTeamMemberWeightings({force:t,silent:e})}},{key:"_loadTeamMemberWeightings",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-team-weighting").get({params:[n],force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-team-weighting"!==t.id||this._onWeightingDataLoaded(e)}},{key:"_onWeightingDataLoaded",value:function(e){if(n2.de.page.team.Context.getInstance().isDirty=!1,this._model=e,this._components["individual-weightings"].model=e,(this._components["tag-based-weightings"].model=e).get("isQ2QTeam"))this._components["weighting-view-switch"].hidden=!0,this._showIndividualWeighting();else switch(this._components["weighting-view-switch"].hidden=!1,e.get("weightingType")){case this._TYPE.INDIVIDUAL:this._showIndividualWeighting();break;case this._TYPE.TAG:this._showTagBasedWeighting()}e.listen("change",this._onWeightingModelChange,this)}},{key:"_showIndividualWeighting",value:function(){this._components["weighting-view-switch"].text="Switch to tag weighting",this._components["quick-filter"].hidden=n2.isEmpty(this._model.get("teamMemberWeightings")),this._components["individual-weightings"].hidden=!1,this._components["tag-based-weightings"].hidden=!0}},{key:"_showTagBasedWeighting",value:function(){this._components["weighting-view-switch"].text="Switch to individual weighting",this._components["quick-filter"].hidden=!0,this._components["individual-weightings"].hidden=!0,this._components["tag-based-weightings"].hidden=!1}},{key:"_onWeightingModelChange",value:function(e){e=e.change;"teamMemberWeightings"===e.bindPath&&e.type===n2.dataProvider.model.enum.Change.SET||(n2.de.page.team.Context.getInstance().isDirty=!0,this._showSaveFooter())}},{key:"_showSaveFooter",value:function(){this._components["save-footer"].message="You have unsaved changes.",this._components["save-footer"].hidden=!1}},{key:"_onSaving",value:function(){this._components["save-footer"].message="Saving...",this._components["save-footer"].spinner()}},{key:"_onSaved",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._components["save-footer"].message="Saved",e.next=3,this._components["save-footer"].showSuccess();case 3:this._components["save-footer"].hide(),this._loadData({force:!0});case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"reload",value:function(){this._loadData({force:!0}),this._components["save-footer"].hide()}}]),n}(),n2.de.component.field.tagPicker.tagPickerPopover.TagSelection=function(){_inherits(t,n2.ui.component.field.CheckboxGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-de-tag-selection",this.tagCollectionId=null}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).apply(this,arguments),this._applyVisibleIndexAttributes()}},{key:"_onChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,e=e.sync;void 0!==e&&!e||this._updateDataBinding("value",this.value),t||(e=this._createChangeEventObject([{property:"value",type:"set"}],{data:{value:{newValue:this._value}},canBubble:!0}),this.fire("change",e))}},{key:"filter",value:function(e){var t=this,n=e.tagName,i=void 0===n?"":n,n=e.tagCollectionIds,e=void 0===n?[]:n,s=0;this._forEachOptionComponent(function(e){e.hidden=!t._isTagNameMatch(e.label.text,i),s=e.hidden?s+1:s}),this.hidden=s===this._options.length||!this._isTagCollectionIdMatch(e),this._applyVisibleIndexAttributes()}},{key:"_isTagNameMatch",value:function(e,t){return n2.isEmpty(t)||e.toLowerCase().includes(t.toLowerCase())}},{key:"_isTagCollectionIdMatch",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return n2.isEmpty(e)||e.includes(this.tagCollectionId)}},{key:"_applyVisibleIndexAttributes",value:function(){var t=this,n=0;this._forEachOptionComponent(function(e){e.hidden||t.hidden?e.dom.removeAttribute("data-visible-tag-index"):(e.dom.attribute("data-visible-tag-index",n),n++)})}}]),t}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.DistributorResult=function(){_inherits(s,n2.ui.Component);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._SELECTORS=n2.merge(this._SELECTORS,{distributorResultDetails:".n2_distributor-result-details"}),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._template='<li id="{{id}}" class="{{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}{{^hasTestResults}} n2_untested{{/hasTestResults}}"{{#title}} title="{{title}}"{{/title}}>\n            {{#hasAssignmentInInitialRun}}\n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"n2_has-assignment-icon slds-icon_x-small slds-icon-text-success slds-no-flex"}),'\n            {{/hasAssignmentInInitialRun}}\n            <div class="n2_distributor-result-details">\n                <span class="slds-truncate" title="{{distributorName}}">{{distributorName}}</span>\n            </div>\n        </li>'),this._componentCls="n2-de-page-simulation-distributor-result",this.distributorResult=null,this._distributorTestResults=null}},{key:"filterResults",get:function(){return this._components["filters-result"]}},{key:"methodResults",get:function(){return this._components["method-result"]}},{key:"teamMemberResults",get:function(){return this._components["team-member-result"]}},{key:"testResultPopover",get:function(){return n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.TestResultPopover.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this),this._insertDistributorStages()}},{key:"_insertDistributorStages",value:function(){return[this._insertMethodResult(),this._insertFiltersResult(),this._insertTeamMemberResult()]}},{key:"_insertMethodResult",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.MethodStage({id:"method-result",renderTo:this._SELECTORS.distributorResultDetails,iconCls:"slds-icon_small",state:this._getStageState(this.distributorResult.allMethodResultsMatch),method:this.distributorResult.algorithm,hidden:!this.distributorResult.hasTestResults,listeners:{click:this._handleMethodResultClick,scope:this}}))}},{key:"_handleMethodResultClick",value:function(e){this.testResultPopover.show({target:e.dom,position:"top",distributorTestResults:this._distributorTestResults.testToolUIVO,resultType:"method"})}},{key:"_insertFiltersResult",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.DistributorStage({id:"filters-result",renderTo:this._SELECTORS.distributorResultDetails,icon:n2.de.enum.Icon.FILTER,iconCls:"slds-icon_small",state:this._getStageState(this.distributorResult.allFiltersMatch),hidden:!this.distributorResult.hasTestResults,listeners:{click:this._handleFilterResultClick,scope:this}}))}},{key:"_handleFilterResultClick",value:function(e){this.testResultPopover.show({target:e.dom,position:"top",distributorTestResults:this._distributorTestResults.testToolUIVO,resultType:"filter"})}},{key:"_insertTeamMemberResult",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.DistributorStage({id:"team-member-result",renderTo:this._SELECTORS.distributorResultDetails,icon:n2.de.enum.Icon.AVATAR,iconCls:"slds-icon_small",state:this._getStageState(this.distributorResult.hasAvailableAssignee),hidden:!this.distributorResult.hasTestResults,listeners:{click:this._handleTeamMemberResultClick,scope:this}}))}},{key:"_handleTeamMemberResultClick",value:function(e){this.testResultPopover.show({target:e.dom,position:"top",distributorTestResults:this._distributorTestResults.testToolUIVO,resultType:"team-member"})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(s.prototype),"_getTemplateData",this).call(this),{distributorName:this.distributorResult.distributorName,hasTestResults:this.distributorResult.hasTestResults,hasAssignmentInInitialRun:this.distributorResult.hasAssignmentInInitialRun})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t.force,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),t=n2.de.page.assignmentSimulation.Context.getInstance().simulatedDistributionId,n=this.distributorResult.distributorId,e.next=5,this._loadDataProvider("get-assignment-simulation-result-by-distributor",{params:[t,n]});case 5:return e.t0=e.sent,e.abrupt("return",{distributorTestResults:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.distributorTestResults;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("distributorTestResults",e.response)}},{key:"_getStageState",value:function(e){return this.distributorResult.hasTestResults?e?n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState.SUCCESS:n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState.FAILED:n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState.UNTESTED}}]),s}(),n2.de.page.availability.regionalHolidays.holidays.DeleteHolidaysMessageBox=function(){_inherits(t,n2.de.component.DeleteMessageBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getMessage",value:function(e){var t,n,i,e=e.names;return 1<e.length?"You are about to delete ".concat(e.length," regional holiday events, do you want to continue?"):(t=(e=e[0]).name,n=new Date(e.startDate),i=new Date(e.endDate),"You are about to delete the regional holiday ".concat(t," on ").concat(n2.de.util.Date.formatDateRange(n,i,{startIsAllDay:e.isAllDay,endIsAllDay:e.isAllDay}),", do you want to continue?"))}}]),t}(),n2.de.page.availability.regionalHolidays.holidays.HolidayList=function(){_inherits(i,n2.de.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this.columns=this._getColumns(),this._emptyState={type:n2.de.page.availability.regionalHolidays.holidays.holidayList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,this._sortBy={column:0,direction:"asc"}}},{key:"_onDefined",value:function(){var t=this,e=(_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._data.length),n=1===e?"regional holiday":"regional holidays";this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no regional holidays that match your filters",content:"We looked through ".concat(e," ").concat(n,", but none of them match your filters. You can change your terms, or clear them to see all regional holidays."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t.fire("click",{target:e,currentTarget:t})}}}}}},{key:"_getColumns",value:function(){var t=this,e=[{header:"Date",cls:"n2_date",sortable:!0,sort:{adapter:function(e){return"".concat(e.startDate," ").concat(e.endDate)}},cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}',dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",bindPath:"name",cls:"n2_name",sortable:!0},{header:"Region",bindPath:"regionName",cls:"n2_region",sortable:!0},{header:"Timezone",cls:"n2_timezone",sortable:!0,sort:{bindPath:"timezone"},cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content.timezoneLabel}}">{{content.timezone}}</div>{{/content}}'}}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.push({cls:"n2_menu",cell:{cellTemplate:"",components:[this._getHolidayRowMenuConfig()]}}),e}},{key:"_getHolidayRowMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"holiday-row-actions-menu",options:[{id:"edit",label:"Edit"},{id:"delete",label:"Delete"}],listeners:{select:function(e,t){n.fire("click",{target:e,currentTarget:n,data:{holidayData:t.parent.data}})}}}}},{key:"_formatDate",value:function(e){var t=new Date(e.startDate),n=new Date(e.endDate);return n2.de.util.Date.formatDateRange(t,n,{startIsAllDay:e.isAllDay,endIsAllDay:e.isAllDay})}}]),i}(),n2.de.page.availability.regionalHolidays.holidays.HolidayModal=function(){_inherits(o,n2.de.component.Modal);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this,arguments),this.id="holiday-modal",this._cls="n2-de-holiday-modal",this._previousStartDate=null,this._currentYear=(new Date).getFullYear()}},{key:"holidayForm",get:function(){return this._components["holiday-form"]}},{key:"holidayNameField",get:function(){return this.holidayForm.components["holiday-name"]}},{key:"regionField",get:function(){return this.holidayForm.components["holiday-region"]}},{key:"allDayField",get:function(){return this.holidayForm.components["holiday-all-day"]}},{key:"dateRangeField",get:function(){return this.holidayForm.components["date-range"]}},{key:"timezoneField",get:function(){return this.holidayForm.components["holiday-timezone"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e={},t=this.dateRangeField.value;return n2.isNull(this.model)||(e.id=this.model.id),e.name=this.holidayNameField.value,e.regionId=this.regionField.value,e.isAllDay=this.allDayField.value,e.startDate=this._getTimestamp(t.startDate),e.endDate=this._getTimestamp(t.endDate),e.timezone=this.timezoneField.value,e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).call(this,arguments),this._insertHolidayForm()}},{key:"_insertHolidayForm",value:function(){this.insert(new n2.ui.component.Form({id:"holiday-form",components:[{type:n2.ui.component.field.TextBox,id:"holiday-name",label:"Name",cls:"slds-m-bottom_medium",required:!0},{type:n2.ui.component.field.Combo,id:"holiday-region",cls:"slds-m-bottom_medium",label:"Region",required:!0,sort:!1,options:[]},{type:n2.ui.component.field.Checkbox,id:"holiday-all-day",cls:"slds-m-bottom_medium",label:"All-day",value:!0,listeners:{change:this._onAllDayChange,scope:this}},{type:n2.de.component.field.DateRangePicker,id:"date-range",label:{text:"Date range",hidden:!0},cls:"slds-m-bottom_medium",required:!0,hideAllDay:!0},{type:n2.ui.component.field.Combo,id:"holiday-timezone",cls:"n2_field-width slds-m-bottom_medium",label:"Timezone",required:!0,sort:!1,options:[]}]}))}},{key:"_onAllDayChange",value:function(e){this.dateRangeField.startDateAllDayField.value=e.value,this.dateRangeField.endDateAllDayField.value=e.value}},{key:"show",value:function(e){var t=e.header,t=void 0===t?"New Regional Holiday":t,n=e.model,n=void 0===n?null:n,i=e.regionOptions,i=void 0===i?[]:i,s=e.timezoneOptions,s=void 0===s?[]:s,a=e.defaultRegion,a=void 0===a?null:a,e=e.submitButtonText,e=void 0===e?"OK":e;_get(_getPrototypeOf(o.prototype),"show",this).apply(this,arguments),this.header=t,this.holidayForm.clear(),this.timezoneField.options=s,this.regionField.options=i,n2.isNull(n)?(this.timezoneField.value={value:n2.de.ApplicationContext.getInstance().timeZone,silent:!0,validate:!1},this.allDayField.value={value:!0,silent:!1,validate:!1},this.regionField.disabled=!1,n2.isNull(a)||(this.regionField.value=a)):(this.model=n,this._previousStartDate=new Date(n.startDate),this.regionField.disabled=!0),"OK"!==e&&(this.submitButton.text=e),this.submitButton.reset(),this.cancelButton.enable()}},{key:"_getTimestamp",value:function(e){return e.getTime()}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(o.prototype),"_onCancel",this).call(this,arguments),this.destroy()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.holidayForm.validate()&&_get(_getPrototypeOf(o.prototype),"_onSubmit",this).call(this);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this.holidayNameField.value={value:e.name,silent:!0},this.regionField.value={value:e.regionId,silent:!0},this.allDayField.value={value:e.isAllDay,silent:!0},this.dateRangeField.value=[{date:new Date(e.startDate),isAllDay:e.isAllDay},{date:new Date(e.endDate),isAllDay:e.isAllDay}],this.timezoneField.value={value:e.timezone,silent:!0})}},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.destroy()},500).start()}}]),o}(),n2.de.page.availability.regionalHolidays.regions.DeleteRegionsMessageBox=function(){_inherits(t,n2.de.component.DeleteMessageBox);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_getMessage",value:function(e){e=e.names;return 1<e.length?"You are about to delete ".concat(e.length," regions, do you want to continue?"):"You are about to delete ".concat(e[0].name,", do you want to continue?")}}]),t}(),n2.de.page.availability.regionalHolidays.regions.RegionList=function(){_inherits(i,n2.de.component.DataTable);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this.columns=this._getColumns(),this._emptyState={type:n2.de.page.availability.regionalHolidays.regions.regionList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,this._sortBy={column:0,direction:"asc"}}},{key:"_onDefined",value:function(){var t=this,e=(_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._data.length),n=1===e?"region":"regions";this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no regions that match your filter",content:"We looked through ".concat(e," ").concat(n,", but none of them match your filter. You can change your terms, or clear them to see all regions."),button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t.fire("click",{target:e,currentTarget:t})}}}}}},{key:"_getColumns",value:function(){var e=[{header:"Name",bindPath:"name",cls:"n2_name",sortable:!0},{header:"Assigned Teams",cell:{dataAdapter:this._getAssignedTeamsCellContent.bind(this)}}];return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&e.push({cls:"n2_menu",cell:{cellTemplate:"",components:[]}}),e}},{key:"_getAssignedTeamsCellContent",value:function(e){var e=e.teams.map(function(e){return e.name});return n2.isEmpty(e)?{html:"<span>&mdash;</span>"}:(e=1===e.length?{value:e}:{title:e.join(", "),value:"".concat(e.length," teams"),cls:"n2_assigned-teams"},{html:n2.ui.Template.render('<span{{#title}} title="{{title}}"{{/title}}{{#cls}} class="{{cls}}"{{/cls}}>{{value}}</span>',e)})}},{key:"_createRow",value:function(e){var t;return n2.isUndefined(this.columns[2])||(t=n2.isEmpty(e.data.teams),this.columns[2].cell.components=[this._getRegionRowMenuConfig({includeDelete:t})]),_get(_getPrototypeOf(i.prototype),"_createRow",this).call(this,e)}},{key:"_getRegionRowMenuConfig",value:function(){var n=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeDelete,t=[{id:"edit",label:"Edit"}];return(void 0===e||e)&&t.push({id:"delete",label:"Delete"}),{type:n2.ui.component.Menu,id:"region-row-actions-menu",options:t,listeners:{select:function(e,t){n.fire("click",{target:e,currentTarget:n,data:{regionData:t.parent.data}})}}}}},{key:"_sort",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_get(_getPrototypeOf(i.prototype),"_sort",this).apply(this,t);case 2:this._makeSelectable(this._selectable);case 3:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_makeSelectable",value:function(t){var n=!0;this.rows.filter(function(e){return!e.headerRow}).forEach(function(e){e.selectable=t,e.disabled=!n2.isEmpty(e.data.teams),e.disabled||(n=!1)}),this.headerRow.disabled=n}}]),i}(),n2.de.page.availability.regionalHolidays.regions.RegionModal=function(){_inherits(s,n2.de.component.Modal);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this,arguments),this.id="region-modal",this._cls="n2-de-region-modal"}},{key:"regionForm",get:function(){return this._components["region-form"]}},{key:"regionNameField",get:function(){return this.regionForm.components["region-name"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e={};return n2.isNull(this.model)||(e.id=this.model.id),e.name=this.regionNameField.value,e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this,arguments),this._insertRegionForm()}},{key:"_insertRegionForm",value:function(){this.insert(new n2.ui.component.Form({id:"region-form",components:[{type:n2.de.component.field.UniqueNameField,id:"region-name",label:"Name",cls:"slds-m-bottom_medium n2_field-width",required:!0,nameValidationMessage:"Region names must be unique"}]}))}},{key:"show",value:function(e){var t=e.header,t=void 0===t?"New Region":t,n=e.model,n=void 0===n?null:n,i=e.regionNames,i=void 0===i?[]:i,e=e.submitButtonText,e=void 0===e?"OK":e;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this.header=t,this.regionForm.clear(),this.regionNameField.names=i,n2.isNull(n)||(this.model=n,this.regionNameField.value={value:n.name,silent:!0,validate:!1}),"OK"!==e&&(this.submitButton.text=e),this.submitButton.reset(),this.cancelButton.enable()}},{key:"hide",value:function(){_get(_getPrototypeOf(s.prototype),"hide",this).call(this,arguments),this.model=null}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.regionForm.validate()&&_get(_getPrototypeOf(s.prototype),"_onSubmit",this).call(this);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}}]),s}(),n2.de.page.availability.shifts.shiftList.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any shifts yet",this._contentTemplate="<p>\n            You currently have no weekly shifts, weekly shifts allow you to manage working hours that are common across multiple team members.&nbsp;\n            Create your first weekly shift to get started.\n        </p>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertAddShiftButton()}},{key:"_insertAddShiftButton",value:function(){return this._insert(new n2.ui.component.Button({id:"add-shift",text:"Add Shift",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddShiftButtonClick,scope:this}}))}},{key:"_onAddShiftButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}}]),t}(),n2.de.page.availability.shifts.slideOutPanel.ShiftHoursUsage=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_used-by-items"}),this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <p class="slds-form-element__label">Used by</p>\n            <ul class="n2_used-by-items"></ul>\n        </div>',this._componentCls="n2-de-shifts-hour-usage",this._teamMembers=null,this._teamMemberListItems=null,this._teams=null,this._teamListItems=null}},{key:"teamMembers",set:function(e){n2.compare(e,this._teamMembers||[])||(this._teamMembers=e,this._refresh({teamMembers:!0}))}},{key:"teams",set:function(e){n2.compare(e,this._teams||[])||(this._teams=e,this._refresh({teams:!0}))}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.teamMembers,t=void 0!==t&&t,n=e.teams,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshTeamMembers(),(e||n)&&this._refreshTeams()}},{key:"_refreshTeamMembers",value:function(){var n=this;n2.isNull(this._teamMemberListItems)||this._teamMemberListItems.forEach(function(e){return e.destroy()}),n2.isNull(this._teamMembers)||(this._teamMemberListItems=this._teamMembers.map(function(e,t){return n._insertTeamMemberItem(e,{id:"team-member-".concat(t)})}))}},{key:"_insertTeamMemberItem",value:function(e,t){t=t.id,t=this._insert(new n2.ui.component.HTML({id:t,mixins:[n2.mixin.DataDriven],template:'<li id="{{id}}">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.USER,{cls:"slds-icon_x-small"}),'\n                <span>{{model}}</span>&nbsp;\n                (<span class="n2_team"></span>)\n            </li>'),model:e.name})),e=this._createUsageLink({name:e.teamName,id:e.teamId});return e.renderTo=".n2_team",t.insert(e),t}},{key:"_refreshTeams",value:function(){var n=this;n2.isNull(this._teamListItems)||this._teamListItems.forEach(function(e){return e.destroy()}),n2.isNull(this._teams)||(this._teamListItems=this._teams.map(function(e,t){return n._insertTeamItem(e,{id:"team-".concat(t)})}))}},{key:"_insertTeamItem",value:function(e,t){t=t.id;return this._insert(new n2.ui.component.HTML({id:t,template:'<li id="{{id}}">'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.GROUPS,{cls:"slds-icon_x-small"}),"</li>"),components:[this._createUsageLink(e)]}))}},{key:"_createUsageLink",value:function(e){var t=this;return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?new n2.de.component.Link({id:"team-link",cls:"n2_team-usage",text:e.name,listeners:{click:function(){return t._onUsageLinkClick(e.id)}}}):new n2.ui.component.HTML({id:"team-text",mixins:[n2.mixin.DataDriven],template:'<span class="n2_team-usage">{{model}}</span>',model:e.name})}},{key:"_onUsageLinkClick",value:function(e){n2.de.page.Navigation.getInstance().open("Team_DistributionHours","teamId=".concat(e))}}]),t}(),n2.de.page.classifier.autoConversionSettings.autoConversionRules.ReorderRulesModal=function(){_inherits(t,n2.de.component.Modal);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this.dataProviders=["reorder-rules"],this.id="reorder-auto-conversion-rules-modal",this._cls="n2-de-reorder-auto-conversion-rules",this._header="Reorder Rules"}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"rulesDatatable",get:function(){return this._components["ordered-rules-datatable"]}},{key:"_getOKButtonConfig",value:function(){return{text:"Set Order"}}},{key:"show",value:function(e){e=e.rules;this._insertReorderDataTable(void 0===e?null:e),_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this.rulesDatatable.headerRow.dom.hide(!1)}},{key:"_insertReorderDataTable",value:function(e){this.insert(new n2.ui.component.DataTable({id:"ordered-rules-datatable",columns:[{header:"Rule Name",bindPath:"name"}],data:e,reorderable:!0}))}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(t.prototype),"_onCancel",this).apply(this,arguments),this.destroy()}},{key:"_onSaving",value:function(){_get(_getPrototypeOf(t.prototype),"_onSaving",this).apply(this,arguments),this.rulesDatatable.reorderable=!1}},{key:"_onSaved",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"_onSaved",this).apply(this,arguments),new n2.util.DelayedTask(function(){e.destroy()},500).start()}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(t.prototype),"_onSubmit",this).call(this),this._postDataProvider("reorder-rules",{params:[this._getReorderedData()]})}},{key:"_getReorderedData",value:function(){var e=this.rulesDatatable.data;return e.forEach(function(e,t){e.executionOrder=t+1}),e}}]),t}(),n2.de.page.classifier.autoConversionSettings.autoConversionRules.RuleModal=function(){_inherits(l,n2.de.component.Modal);var e,t,n=_createSuper(l);function l(){return _classCallCheck(this,l),n.apply(this,arguments)}return _createClass(l,[{key:"_define",value:function(){_get(_getPrototypeOf(l.prototype),"_define",this).call(this),this.id="auto-conversion-rule-modal",this.dataProviders=["save-auto-conversion-rule-settings"],this._lazyLoad=!0,this._componentCls="n2-de-auto-conversion-rule-modal",this._ruleId=null,this._isDefaultRule=!1,this._autoConversionRuleSettings=null,this._matchFilterOptions=null,this._leadFieldOptions=null,this._autoConversionActionOptions=null,this._ruleNames=null}},{key:"autoConversionRuleForm",get:function(){return this._components["auto-conversion-rule-form"]}},{key:"ruleNameField",get:function(){return this.autoConversionRuleForm.components["rule-name"]}},{key:"matchSelectionField",get:function(){return this.autoConversionRuleForm.components["match-selection"]}},{key:"ruleFiltersField",get:function(){return this.autoConversionRuleForm.components["rule-filters"]}},{key:"autoConvertActionField",get:function(){return this.autoConversionRuleForm.components["auto-convert-action"]}},{key:"autoConvertActionFieldGroup",get:function(){return this.autoConversionRuleForm.components["auto-convert-action-settings"]}},{key:"deDuplicationWarning",get:function(){return this._components["de-duplication-warning"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(l.prototype),"_onDefined",this).apply(this,arguments),this._insertAutoConversionRuleForm(),this._insertDeDuplicationWarning()}},{key:"_insertDeDuplicationWarning",value:function(){return this._insert(new n2.de.component.ScopedNotification({id:"de-duplication-warning",type:"warning",isLightTheme:!0,renderTo:this.SELECTORS.footer,content:"Lead de-duplication will delete duplicate incoming records. This is not reversible. Please ensure your configuration is correct before enabling.",hidden:!0}))}},{key:"_insertAutoConversionRuleForm",value:function(){return this._insert(new n2.de.component.Form({id:"auto-conversion-rule-form",includeFooter:!1,components:[this._createRuleNameField(),this._createMatchSelectionField(),this._createRuleFiltersField(),this._createAutoConvertActionField(),this._createAutoConvertActionFieldGroup()]}))}},{key:"_createRuleNameField",value:function(){return new n2.de.component.field.UniqueNameField({id:"rule-name",mixins:[n2.mixin.DataDriven],label:"Name",helpText:"Identifies this rule, must be unique on the org.",cls:"slds-m-bottom_medium n2_field-medium",required:!0,maxLength:80,value:{bindPath:".name"}})}},{key:"_createMatchSelectionField",value:function(){return new n2.ui.component.field.Combo({id:"match-selection",mixins:[n2.mixin.DataDriven],label:"Match",helpText:"If selected, only rules with the selected lead matching status will be converted.",cls:"slds-m-bottom_medium n2_field-medium",hidden:!0,required:!0,options:[],sort:!1,value:{bindPath:".matchFilters"},listeners:{change:this._onMatchSelectionChange,scope:this}})}},{key:"_onMatchSelectionChange",value:function(){this._refresh({autoConvertActionField:!0,autoConvertActionFieldGroup:!0,deDuplicationWarning:!0})}},{key:"_createRuleFiltersField",value:function(){var n,t,s=this;return new n2.ui.component.field.LogicFilter({id:"rule-filters",mixins:[n2.mixin.DataDriven],label:"Filters",helpText:"This rule will only apply to records that match these filters.",cls:"slds-m-bottom_medium",max:5,hidden:!0,logicHidden:!0,loadRelatedObjectFieldOptions:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fieldSelection,i=s._leadFieldOptions.find(function(e){return e.value===n.value}),!n2.isUndefined(i)&&i.isParent)return i=i.referenceType,e.next=6,s._fetchDataProvider("get-all-field-options",{params:[i],force:!1,silent:!0,requestId:i});e.next=8;break;case 6:return i=e.sent,e.abrupt("return",n2.de.data.Adapters.classifierFilterFieldOptions(i.response));case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),e.next=3,s._fetchDataProvider("get-picklist-field-options",{params:["Lead",n.get("name")],force:!1,silent:!0,requestId:"Lead.".concat(n.get("name"))});case 3:i=e.sent,t.options=i.response,t.spinner(!1);case 5:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),value:{bindPath:".leadLogicAndFilters"}})}},{key:"_createAutoConvertActionField",value:function(){return new n2.ui.component.field.Combo({id:"auto-convert-action",mixins:[n2.mixin.DataDriven],helpText:"All records that match the criteria will have this action performed. See the help for more information on each action.",label:"Auto-convert action",cls:"slds-m-bottom_medium n2_field-medium",required:!0,options:[],sort:!1,value:{bindPath:".action"},listeners:{change:this._onAutoConvertActionChange,scope:this}})}},{key:"_onAutoConvertActionChange",value:function(){this._refresh({autoConvertActionFieldGroup:!0,deDuplicationWarning:!0})}},{key:"_createAutoConvertActionFieldGroup",value:function(){return new n2.de.page.classifier.autoConversionSettings.autoConversionRules.ruleModal.AutoConvertActionSettings({id:"auto-convert-action-settings",cls:"n2_auto-convert-action-settings",heading:"Auto-conversion action settings",hidden:!0})}},{key:"_addButton",value:function(e){"submit-button"===e.id&&(e.text="Save"),_get(_getPrototypeOf(l.prototype),"_addButton",this).apply(this,arguments)}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.rule,t=void 0===t?null:t,n=e.isDefaultRule,n=void 0!==n&&n,i=e.ruleNames,i=void 0===i?[]:i;e.listeners;_get(_getPrototypeOf(l.prototype),"show",this).apply(this,arguments),this.autoConversionRuleForm.clear(),this.header=n2.isNull(t)?"Add ".concat(n?"default":"new"," rule"):"Edit ".concat(t.name),this._ruleId=n2.isNull(t)?null:t.ruleId,this._isDefaultRule=n,this._ruleNames=i,this.load({force:n2.isNull(t)})}},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<r.length&&void 0!==r[0]?r[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(l.prototype),"_load",this).apply(this,r);case 3:return e.t0=Promise,e.next=6,this._loadAutoConversionRuleSettings({force:n,silent:t});case 6:return e.t1=e.sent,e.next=9,this._loadDataProvider("get-match-filter-options",{force:!1,silent:t});case 9:return e.t2=e.sent,e.next=12,this._loadDataProvider("get-all-field-options",{params:["Lead"],force:!1,silent:t,requestId:"Lead"});case 12:return e.t3=e.sent,e.next=15,this._loadDataProvider("get-auto-conversion-action-options",{force:!1,silent:t});case 15:return e.t4=e.sent,e.t5=[e.t1,e.t2,e.t3,e.t4],e.next=19,e.t0.all.call(e.t0,e.t5);case 19:return o=e.sent,o=_slicedToArray(o,4),i=o[0],s=o[1],a=o[2],o=o[3],e.abrupt("return",{autoConversionRuleSettings:i,matchFilterOptions:s,leadFieldOptions:a,autoConversionActionOptions:o});case 26:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_loadAutoConversionRuleSettings",value:function(e){var t=e.force,e=e.silent;return this._loadDataProvider("get-auto-conversion-rule-settings",{params:[this._ruleId,this._isDefaultRule],force:t,silent:e,requestId:this._ruleId})}},{key:"_onLoadComplete",value:function(e){var t=e.autoConversionRuleSettings,n=e.matchFilterOptions,i=e.leadFieldOptions,e=e.autoConversionActionOptions;_get(_getPrototypeOf(l.prototype),"_onLoadComplete",this).apply(this,arguments),this._autoConversionRuleSettings=this._prepareAutoConversionRuleSettingsModel(t.response),this._matchFilterOptions=n.response,this._leadFieldOptions=i.response,this._autoConversionActionOptions=e.response,this._refresh()}},{key:"_prepareAutoConversionRuleSettingsModel",value:function(e){e=new n2.dataProvider.Model({value:e});return!this._isDefaultRule&&n2.isUndefined(e.get("leadLogicAndFilters"))&&e.insert({filters:[],logic:""},{key:"leadLogicAndFilters"}),e}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(l.prototype),"_onSubmit",this).apply(this,t),e.t0=this.autoConversionRuleForm.validate(),e.t0)return e.next=5,this._postDataProvider("save-auto-conversion-rule-settings",{params:[this._autoConversionRuleSettings.json]});e.next=6;break;case 5:n2.isNull(this._ruleId)||this._loadAutoConversionRuleSettings({force:!0,silent:!0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"hide",value:function(){var e=this;return new n2.util.DelayedTask(function(){_get(_getPrototypeOf(l.prototype),"hide",e).call(e),e._reset()},500).start()}},{key:"_reset",value:function(){_get(_getPrototypeOf(l.prototype),"_reset",this).apply(this,arguments),this.deDuplicationWarning.hidden=!0}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.ruleNameField,i=e.matchSelectionField,i=void 0!==i&&i,s=e.ruleFiltersField,s=void 0!==s&&s,a=e.autoConvertActionField,a=void 0!==a&&a,o=e.autoConvertActionFieldGroup,o=void 0!==o&&o,e=e.deDuplicationWarning,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshRuleNameField(),(t||i)&&this._refreshMatchSelectionField(),(t||s)&&this._refreshRuleFiltersField(),(t||a)&&this._refreshAutoConvertActionField(),(t||o)&&this._refreshAutoConvertActionFieldGroup(),(t||e)&&this._refreshDeduplicationWarning()}},{key:"_refreshRuleNameField",value:function(){this.ruleNameField.model=this._autoConversionRuleSettings,this.ruleNameField.names=this._ruleNames}},{key:"_refreshMatchSelectionField",value:function(){this.matchSelectionField.hidden=this._isDefaultRule,this.matchSelectionField.options=this._matchFilterOptions,this.matchSelectionField.model=this._autoConversionRuleSettings}},{key:"_refreshRuleFiltersField",value:function(){this.ruleFiltersField.hidden=this._isDefaultRule,this._isDefaultRule||(this.ruleFiltersField.fieldOptions=n2.de.data.Adapters.classifierFilterFieldOptions(this._leadFieldOptions,{includeFiltersOnly:!0,includeParents:!0}),this.ruleFiltersField.model=this._autoConversionRuleSettings)}},{key:"_refreshAutoConvertActionField",value:function(){this.autoConvertActionField.options=this._getAutoConvertActionOptions(),this.autoConvertActionField.model=this._autoConversionRuleSettings}},{key:"_refreshDeduplicationWarning",value:function(){this.deDuplicationWarning.hidden="DeDuplicate"!==this.autoConvertActionField.value}},{key:"_getAutoConvertActionOptions",value:function(){return"Lead Match"===this._autoConversionRuleSettings.get("matchFilters")?this._autoConversionActionOptions.filter(function(e){return"Convert"!==e.value}):this._autoConversionActionOptions.filter(function(e){return"DeDuplicate"!==e.value})}},{key:"_refreshAutoConvertActionFieldGroup",value:function(){if("Convert"===this._autoConversionRuleSettings.get("action")&&"Lead Match"!==this._autoConversionRuleSettings.get("matchFilters"))return this.autoConvertActionFieldGroup.show({autoConversionRuleSettingsModel:this._autoConversionRuleSettings});this.autoConvertActionFieldGroup.hide()}}]),l}(),n2.de.page.classifier.backfill.backfillWizard.Summary=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{recordCount:".n2_record-count",classifications:".n2_classifications"}),this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{^hidden}} {{showCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            <p class="slds-text-body_regular">Using the criteria you have specified, <span class="n2_record-count">{{recordCount}}</span> records would be processed for <span class="n2_classifications">{{classifications}}</span>.</p>\n            <p class="slds-text-body_regular">If you are happy click Finish and a batch job will be created to perform the backfill processing.</p>\n            <div class="slds-form-element"></div>\n        </div>',this._componentCls="n2-de-backfill-wizard-summary",this._recordCount=null}},{key:"recordCount",set:function(e){this._recordCount!==e&&(this._recordCount=e,this._refresh({recordCount:!0}))}},{key:"sendEmailField",get:function(){return this._components["send-email"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertSendEmailCheckbox()}},{key:"_insertSendEmailCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"send-email",mixins:[n2.mixin.DataDriven],label:"Send email on backfill completion",value:{bindPath:".sendEmail"}}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{recordCount:this._recordCount||0,classifications:null})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onModelLoaded()}},{key:"_onModelLoaded",value:function(){this._refresh({classifications:!0,sendEmail:!0})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.recordCount,i=e.classifications,i=void 0!==i&&i,e=e.sendEmail,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshRecordCount(),(t||i)&&this._refreshClassifications(),(t||e)&&this._refreshSendEmail()}},{key:"_refreshRecordCount",value:function(){this.element("recordCount").text(this._recordCount||0)}},{key:"_refreshClassifications",value:function(){this.element("classifications").text(this._getClassificationsText())}},{key:"_refreshSendEmail",value:function(){this.sendEmailField.model=this._model}},{key:"_getClassificationsText",value:function(){var e=[];return this._model.get("territoryMatching")&&e.push("territories"),this._model.get("leadMatching")&&e.push("lead matching"),this._model.get("autoConversion")&&e.push("auto-conversion"),1<e.length?"".concat(e.slice(0,-1).join(", ")," and ").concat(e.slice(-1)):e[0]}}]),n}(),n2.de.page.console.calendar.calendarRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-calendar-record-list-toolbar"),this._filterOptionsData=null,this._hidden=!1,this._REFRESH=n2.merge({filterOptionsData:["teamFilter","teamMemberFilter","tagFilter"]})}},{key:"filterOptionsData",set:function(e){this._setProperty("filterOptionsData",e,{sync:!1})}},{key:"teamFilter",get:function(){return this._components["team-filter"]}},{key:"teamMemberFilter",get:function(){return this._components["team-member-filter"]}},{key:"tagFilter",get:function(){return this._components["tag-filter"]}},{key:"_insertComponents",value:function(){this._insertTeamFilter(),this._insertTeamMemberFilter(),this._insertTagFilter()}},{key:"_insertTeamFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"team-filter",renderTo:this.SELECTORS.left,label:{text:"Team",hidden:!0},required:!0,options:[],sort:!1,listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertTeamMemberFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"team-member-filter",renderTo:this.SELECTORS.left,label:{text:"Team member",hidden:!0},placeholder:"All team members",multiple:!0,options:[],listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertTagFilter",value:function(){return this._insert(new n2.de.component.field.TagPicker({id:"tag-filter",renderTo:this.SELECTORS.left,label:{text:"Tag",hidden:!0},listeners:{change:this._handleFilter,scope:this}}))}},{key:"_handleFilter",value:function(e){if(e instanceof n2.ui.Component)return"team-filter"===e.id&&this._refresh(["teamMemberFilter"]),_get(_getPrototypeOf(t.prototype),"_handleFilter",this).apply(this,arguments);"tag-filter"===e.target.id&&(e.data.actions=["filter"])}},{key:"_refreshTeamFilter",value:function(){n2.isEmpty(this._filterOptionsData.teams)||(this.teamFilter.options=this._filterOptionsData.teams,n2.isEmpty(this.teamFilter.value)&&(this.teamFilter.value={value:this._filterOptionsData.teams[0].value,silent:!0}))}},{key:"_refreshTeamMemberFilter",value:function(){var e=this._filterOptionsData.teamMembersMap[this.teamFilter.value]||[];this.teamMemberFilter.options=e,this.teamMemberFilter.disabled=n2.isEmpty(e)}},{key:"_refreshTagFilter",value:function(){this.tagFilter.setProperties({tagCollections:this._filterOptionsData.tagCollections,tagMap:this._filterOptionsData.tagMap}),this.tagFilter.disabled=n2.isEmpty(this._filterOptionsData.tagCollections)||n2.isEmpty(this._filterOptionsData.tagMap)}},{key:"clear",value:function(){this.teamMemberFilter.clear(),this.tagFilter.clear()}}]),t}(),n2.de.page.console.sourceList.dataTable.AvailableCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._cellTemplate='{{#content.displayContent}}\n            <span>\n                {{#content.hasFailure}}\n                    <span class="n2_error-status-icon" title="{{content.failureTitle}}">{{{content.failureIcon}}}</span>\n                {{/content.hasFailure}}\n                {{^content.hasFailure}}\n                    <span>{{content.text}}</span>\n                {{/content.hasFailure}}\n            </span>\n        {{/content.displayContent}}'}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{content:{text:"".concat(this._data.availableCount,"/").concat(this._data.totalCount),hasFailure:this._data.availableCount<0||this._data.totalCount<0||this._data.warning,failureIcon:n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small"}),failureTitle:this._getFailureTitle(),displayContent:!n2.isUndefined(this._data.availableCount)}})}},{key:"_getFailureTitle",value:function(){return-2===this._data.availableCount?"Unable to query details for this distributor.":-1===this._data.totalCount?"There is a high volume of objects waiting to be assigned which prevents reliably counting objects available for distribution.":this._data.warning?"There is a high volume of objects waiting in the queue. This may affect Distribution Engine performance. Please see help topic 'Tuning Distribution Engine' for more details.":"There is an error with this team or distributor. See team and distributor detail pages for more information."}}]),t}(),n2.de.page.console.sourceList.dataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any Teams with active Distributors yet",this._contentTemplate='<p><a href="javascript:void();">Create your first team and distributor</a> to get started.</p>'}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._dom.listen("click",function(e){"A"===e.target.tagName&&(n2.de.page.Navigation.getInstance().open("Team_TeamList"),e.preventDefault())})}}]),t}(),n2.de.page.console.sourceList.dataTable.onHoldCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._cellTemplate='{{#content.displayContent}}\n            <span>\n                {{#content.hasFailure}}\n                    <span class="n2_error-status-icon" title="{{content.failureTitle}}">{{{content.failureIcon}}}</span>\n                {{/content.hasFailure}}\n                {{^content.hasFailure}}\n                    {{#content.isLink}}<a href="#">{{content.text}}</a>{{/content.isLink}}\n                    {{^content.isLink}}<span>{{content.text}}</span>{{/content.isLink}}\n                {{/content.hasFailure}}\n            </span>\n        {{/content.displayContent}}'}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{content:{text:"".concat(this._data.onHoldCount),isLink:0<this._data.onHoldCount,hasFailure:this._data.onHoldCount<0,failureIcon:n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small"}),failureTitle:this._getFailureTitle(),displayContent:!n2.isUndefined(this._data.onHoldCount)}})}},{key:"_getFailureTitle",value:function(){if(-1===this._data.onHoldCount)return"Unable to query details for this distributor."}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),n2.isUndefined(this._data.onHoldCount)||this._bindLink()}},{key:"_bindLink",value:function(){var t=this,e=this._dom.find("a");n2.isNull(e)||e.listen("click",function(e){e.stopPropagation(),n2.de.page.Navigation.getInstance().open("Logs_DistributionLogList","teamId=".concat(t._data.teamId,"&distributorId=").concat(t._data.distributorId,"&status=onHold"))})}}]),t}(),n2.de.page.console.todaysDistributionList.dataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any Teams yet",this._contentTemplate='<p><a href="javascript:void();">Create your first team</a> to get started.</p>'}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._dom.listen("click",function(e){"A"===e.target.tagName&&(n2.de.page.Navigation.getInstance().open("Team_TeamList"),e.preventDefault())})}}]),t}(),n2.de.page.logs.component.recordList.DataTable=function(){_inherits(t,n2.de.component.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS||{},{sort:function(e){}}),this._sortBy={column:0,direction:"dsc"}}},{key:"sortOrder",get:function(){return{columnName:this._COLUMN_SORT_NAMES[this._sortBy.column],direction:this._sortBy.direction}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments)}},{key:"showEmptyFilteredState",value:function(){this._showEmptyState(this._emptyFilteredState)}},{key:"_addHeaderRow",value:function(){this.insert(new n2.ui.component.dataTable.Row({id:"th-row",headerRow:!0,columns:this.columns,renderTo:this.SELECTORS.tableHeader,selectable:this._selectable,hidden:this._hideHeaderRow,listeners:{selectionChange:this._onHeaderRowSelectionChange,sort:this._handleSort,scope:this}}))}},{key:"_handleSort",value:function(e){var t={column:this.columns.indexOf(e.target.column),direction:e.data.sortDirection};this._fireSortEvent(e,t),this._updateSortUI(e.target)}},{key:"_fireSortEvent",value:function(e,t){n2.compare(t,this._sortBy)||(this._sortBy=t,n2.merge(e.data,{sortOrder:this.sortOrder}),this.fire("sort",e))}},{key:"_updateSortUI",value:function(t){t.sortDirection=this._sortBy.direction,this.headerRow.forEachCell(function(e){e!==t&&(e.sortDirection=null)})}},{key:"_generateColumnDefinitions",value:function(){}}]),t}(),n2.de.page.logs.archiveLogList.archiveLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._selectable=!0,this._componentCls="n2-archive-logs-table",this._sortBy={column:4,direction:"dsc"},this._COLUMN_SORT_NAMES={0:"name",4:"lastArchivedDate",5:"createdDate"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no archived records currently.",content:""},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no archive records that match your filters",content:""},this._isArchivingEnabled=null,this._REFRESH={isArchivingEnabled:["emptyStateContent"]}}},{key:"isArchivingEnabled",set:function(e){this._setProperty("isArchivingEnabled",e)}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Name",sortable:!0,sort:{bindPath:"recordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:!0,text:{bindPath:".recordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Type",cls:"n2_type",bindPath:"objectName"},{header:"Status",cls:"n2_status",bindPath:"status"},{header:"Source",cls:"n2_source",bindPath:"sourceName"},{header:"Archive Date",bindPath:"lastArchivedDate",cls:"n2_last-archived-date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Created Date",bindPath:"createdDate",cls:"n2_created-date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.recordId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"archive-menu",mixins:[n2.mixin.DataDriven],options:[{id:"restore-log",label:"Restore"}],listeners:{select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_applySelection",value:function(){var n,i=this;n2.isEmpty(this._cachedRowSelection)||(n=_toConsumableArray(this._cachedRowSelection),this._cachedRowSelection=[],this.forEachRow(function(t){var e=n.find(function(e){return e.recordId===t.data.recordId});n2.isUndefined(e)?t.select(!1,{silent:!0}):(i._cachedRowSelection.push(t.data),t.select(!0,{silent:!0}))}))}},{key:"_onRowSelectionChange",value:function(t){t.target.selected?this._cachedRowSelection.push(t.target.data):this._cachedRowSelection=this._cachedRowSelection.filter(function(e){return e.recordId!==t.target.data.recordId}),this._refreshHeaderRowSelection(),this.fire("selectionChange",t)}},{key:"_getUnCachedRowSelection",value:function(){var e=this;return this._getSelectionData({includeHidden:!1}).filter(function(t){return!!n2.isUndefined(e._cachedRowSelection.find(function(e){return e.recordId===t.recordId}))})||[]}},{key:"sortLogs",value:function(){n2.isNull(this._sortBy)||this._sort(this.columns[this._sortBy.column],{direction:this.sortBy.direction}),this._refreshData()}},{key:"_refreshEmptyStateContent",value:function(){this._isArchivingEnabled?this._emptyState.content="When records are archived they will be displayed here.":this._emptyState.content="Enable archiving from the Distribution Settings page to archive older records."}},{key:"_refresh",value:function(e){if(n2.isObject(e))return _get(_getPrototypeOf(t.prototype),"_refresh",this).call(this,e);"all"===e?this._refreshAll():this._refreshParts(e)}}]),t}(),n2.de.page.logs.component.recordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{topFilterRowLeft:".n2_top_filter-row .n2_row_left",topFilterRowRight:".n2_top_filter-row .n2_row_right",bottomFilterRowLeft:".n2_bottom_filter-row .n2_row_left",bottomFilterRowRight:".n2_bottom_filter-row .n2_row_right",message:".n2_toolbar-message"}),this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2_toolbar-container">\n                <div class="n2_left">\n                    <div class="n2_filters n2_top_filter-row">\n                        <div class="n2_row_left"></div>\n                        <div class="n2_row_right"></div>\n                    </div>\n                    <div class="n2_filters n2_bottom_filter-row">\n                        <div class="n2_row_left"></div>\n                        <div class="n2_row_right"></div>\n                    </div>\n                </div>\n                <div class="n2_right"></div>\n            </div>\n            <div class="n2_toolbar-message"></div>\n        </div>',this._filterOptionsData=null,this._filterData={},this._defaultDateRange={startDate:null,endDate:null}}},{key:"filterButton",get:function(){return this._components["filter-button"]}},{key:"filterButtonSelector",get:function(){return this.SELECTORS.bottomFilterRowRight}},{key:"isFiltering",set:function(e){n2.de.page.logs.Context.getInstance().isFiltering=e,this._refresh({filterButton:!0})}},{key:"_insertComponents",value:function(){this._insertFilterButton()}},{key:"_insertFilterButton",value:function(){return this._insert(new n2.ui.component.Button({id:"filter-button",renderTo:this.filterButtonSelector,cls:"n2_filter-button",text:"Search",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._handleClick,scope:this}}))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filterButton,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshFilterButton()}},{key:"_refreshFilterButton",value:function(){this.filterButton.text=n2.de.page.logs.Context.getInstance().isFiltering?"Refresh":"Search"}},{key:"_getDateRangeFilterStartDate",value:function(){var e=0;switch(this._filterOptionsData.logDuration){case"No logging":e=0;break;case"1 week":e=7;break;case"2 weeks":e=14;break;case"1 month":e=31;break;case"2 months":e=62;break;case"3 months":e=93;break;case"6 months":e=186;break;case"1 year":e=365;break;case"Forever":e=730}var t=new Date;return t.setDate(t.getDate()-e),t.setUTCHours(0,0,0,0),t}},{key:"_getDateRangeFilterEndDate",value:function(){var e=new Date;return e.setDate(e.getDate()+1),e.setUTCHours(0,0,0,0),e}},{key:"clear",value:function(){this.isFiltering=!1}},{key:"_handleClick",value:function(e){"filter-button"===e.id&&(this.isFiltering=!0),_get(_getPrototypeOf(t.prototype),"_handleClick",this).call(this,e)}}]),t}(),n2.de.page.logs.archiveLogList.archiveLogsRecordList.Toolbar=function(){_inherits(s,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"],this._filterOptionsData=null,this._filterData={},this._REFRESH={filterOptionsData:["filterButton","statusFilter","sourceFilter"]}}},{key:"filterData",get:function(){return this._filterData}},{key:"objectFilter",get:function(){return this._components["object-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"sourceFilter",get:function(){return this._components["source-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"filterButtonSelector",get:function(){return this.SELECTORS.topFilterRowRight}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertComponents",this).call(this),this._insertObjectFilter(),this._insertStatusFilter(),this._insertSourceFilter(),this._insertRecordNameFilter(),this._insertMenu()}},{key:"_insertObjectFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"object-filter",renderTo:this.SELECTORS.topFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by object",hidden:!0},placeholder:"All objects",options:["Case","Lead"],listeners:{change:function(e){t._filterData.objectName=e.value||null,t._filterData.status=null,t._filterData.sourceId=null,t._refresh(["statusFilter"])}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.topFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[],listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertSourceFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"source-filter",renderTo:this.SELECTORS.topFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by source",hidden:!0},placeholder:"All sources",options:[],listeners:{change:function(e){t._filterData.sourceId=e.value||null}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",renderTo:this.SELECTORS.topFilterRowLeft,cls:"slds-m-right_small",label:{text:"Search name",hidden:!0},placeholder:"Search name...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordName=e.value||null}}}))}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",disabled:!0,cls:"n2_menu",options:[{id:"restore-logs",label:"Restore"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"_loadFilterOptionData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,e=e.force;return this._loadDataProvider("get-filter-option-data",{silent:void 0!==t&&t,force:void 0===e||e})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadFilterOptionData({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&this._setProperty("filterOptionsData",e)}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("filterOptionsData",e.response)}},{key:"_refreshStatusFilter",value:function(){switch(this.statusFilter.value={value:this.filterData.status,silent:!0},this.filterData.objectName?this.filterData.objectName.toLowerCase():null){case"lead":this.statusFilter.options=this._filterOptionsData.leadStatuses;break;case"case":this.statusFilter.options=this._filterOptionsData.caseStatuses;break;default:this.statusFilter.options=this._filterOptionsData.leadStatuses.concat(this._filterOptionsData.caseStatuses)}}},{key:"_refreshSourceFilter",value:function(){this.sourceFilter.value={value:this.filterData.sourceId,silent:!0},this.sourceFilter.options=this._getSourceOptions()}},{key:"_getSourceOptions",value:function(){return Object.entries(this._filterOptionsData.sources).map(function(e){e=_slicedToArray(e,2);return{value:e[0],label:e[1]}})}},{key:"_resetFilterComponents",value:function(){this.objectFilter.clear(),this.statusFilter.clear(),this.sourceFilter.clear(),this.recordNameFilter.clear()}},{key:"clear",value:function(){_get(_getPrototypeOf(s.prototype),"clear",this).call(this),this._resetFilterComponents()}},{key:"_refresh",value:function(e){if(n2.isObject(e))return _get(_getPrototypeOf(s.prototype),"_refresh",this).call(this,e);"all"===e?this._refreshAll():this._refreshParts(e)}}]),s}(),n2.de.page.logs.autoConversionLogList.autoConversionLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-auto-conversion-logs-table",this._COLUMN_SORT_NAMES={0:"date",1:"name",5:"assignee"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no auto-conversion logs to display at the moment.",content:"Auto-Conversion logs show the results of the auto-conversion process on leads, as defined in the classifier. Enable auto-conversion to get started."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no auto-conversion logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",bindPath:"lastProcessedDate",cls:"n2_last-processed-date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",sortable:!0,sort:{bindPath:"recordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isRecordDeleted",adapter:function(e){return!1===e}},text:{bindPath:".recordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Type",cls:"n2_type",cell:{dataAdapter:function(e){return t._getType(e)}}},{header:"Opportunity Created",cls:"n2_opportunity",bindPath:"opportunityCreated",cell:{cls:"n2_status-cell",dataAdapter:function(e){return e?"Yes":{html:"<span>&mdash;</span>"}}}},{header:"Status",cls:"n2_status",bindPath:"inError",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}},{header:"Assignee",cls:"n2_assignee",bindPath:"userName",sortable:!0,sort:{bindPath:"userName",adapter:function(e){return n2.isNull(e)?"00000":e}},cell:{dataAdapter:function(e){return t._getBlankPropertyName(e)}}}]}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.recordId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getStatus",value:function(e){return e?{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}:{html:"<span>&mdash;</span>"}}},{key:"_getType",value:function(e){return e.isAutoConversion?"Conversion":e.isDeduplication?"De-duplication":{html:"<span>&mdash;</span>"}}},{key:"_getBlankPropertyName",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<div class="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}}}]),t}(),n2.de.page.logs.autoConversionLogList.autoConversionLogsRecordList.Toolbar=function(){_inherits(s,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"],this._filterOptionsData=null,this._filterData={},this._defaultDateRange={startDate:null,endDate:null}}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"typeFilter",get:function(){return this._components["type-filter"]}},{key:"opportunityFilter",get:function(){return this._components["opportunity-filter"]}},{key:"filterData",get:function(){return this._filterData}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertComponents",this).call(this),this._insertDateRangeFilter(),this._insertRecordNameFilter(),this._insertStatusFilter(),this._insertTypeFilter(),this._insertOpportunityFilter()}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=n2.isNull(e.value.startDate)?null:e.value.startDate.getTime(),t._filterData.endDate=n2.isNull(e.value.endDate)?null:e.value.endDate.getTime()}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",label:{text:"Search name/id",hidden:!0},renderTo:this.SELECTORS.topFilterRowRight,placeholder:"Search name/id...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordSearch=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"Errored",value:"In Error"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertTypeFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"type-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by type",hidden:!0},placeholder:"All types",options:[{label:"Conversion",value:"Conversion"},{label:"De-duplication",value:"De-duplication"}],sort:!1,listeners:{change:function(e){t._filterData.acType=e.value||null}}}))}},{key:"_insertOpportunityFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"opportunity-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by opportunity",hidden:!0},placeholder:"All opportunities",options:[{label:"Created",value:!0}],sort:!1,listeners:{change:function(e){t._filterData.opportunityCreated=e.value||null}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-filter-option-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&(this._filterOptionsData=e,this._setDefaultDateRange(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._filterOptionsData=e.response,this._setDefaultDateRange(),this._refresh()}},{key:"_setDefaultDateRange",value:function(){var e=this._getDateRangeFilterStartDate(),t=this._getDateRangeFilterEndDate();this._defaultDateRange.startDate=e,this._defaultDateRange.endDate=t,this._filterData.startDate=e.getTime(),this._filterData.endDate=t.getTime()}},{key:"_getDateRangeFilterStartDate",value:function(){var e=0;switch(this._filterOptionsData.logDuration){case"No logging":e=0;break;case"1 week":e=7;break;case"2 weeks":e=14;break;case"1 month":e=31;break;case"2 months":e=62;break;case"3 months":e=93;break;case"6 months":e=186;break;case"1 year":e=365;break;case"Forever":e=730}var t=new Date;return t.setDate(t.getDate()-e),t.setUTCHours(0,0,0,0),t}},{key:"_getDateRangeFilterEndDate",value:function(){var e=new Date;return e.setDate(e.getDate()+1),e.setUTCHours(0,0,0,0),e}},{key:"_resetFilterComponents",value:function(){this._refreshDateRangeFilter(),this.recordNameFilter.clear(),this.statusFilter.clear(),this.typeFilter.clear(),this.opportunityFilter.clear()}},{key:"_resetFilterData",value:function(){this._filterData={startDate:this._defaultDateRange.startDate.getTime(),endDate:this._defaultDateRange.endDate.getTime()}}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments),e.dateRangeFilter),t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshDateRangeFilter()}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=this._defaultDateRange.startDate,this.dateRangeFilter.endDate=this._defaultDateRange.endDate}},{key:"clear",value:function(){_get(_getPrototypeOf(s.prototype),"clear",this).apply(this,arguments),this._resetFilterData(),this._resetFilterComponents()}}]),s}(),n2.de.page.logs.component.recordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._count={displayedLogCount:0,totalLogCount:0},this._maxLogCount=n2.de.ApplicationContext.getInstance().LOGS_DISPLAY_LIMIT}},{key:"_onDefined",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.page.logs.Context.getInstance().listen("change",function(){return e.refresh({button:!0})},this)}},{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}},{key:"_refreshComponent",value:function(){this.hidden=0===this._count.totalLogCount}},{key:"_refreshDetails",value:function(){this.element("details").clear(),this.element("details").text(this._getFooterText())}},{key:"_getFooterText",value:function(){var e=this._count,t=e.displayedLogCount,e=e.totalLogCount,n="Showing ".concat(t," ").concat(1===t?"log":"logs"," of ").concat(e);return t===this._maxLogCount&&e>this._maxLogCount&&(n+=", use the filters to find others"),n}},{key:"_refreshButton",value:function(){this.clearFiltersButton.hidden=!n2.de.page.logs.Context.getInstance().isFiltering}}]),t}(),n2.de.page.logs.distributionLogList.distributionLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._selectable=n2.de.ApplicationContext.getInstance().isAdminOrSystemManager||n2.de.ApplicationContext.getInstance().isTeamManager,this._componentCls="n2-distribution-logs-table",this._COLUMN_SORT_NAMES={0:"assignmentDate",1:"name",3:"object",4:"team",5:"distributor",7:"assignee",8:"lastActionDate"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no distribution logs to display at the moment.",content:"When records have been distributed, details about them will appear here."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no distribution logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this,e=[{header:"Assignment Date",bindPath:"assignmentDate",cls:"n2_assignment-date",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}',dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",sortable:!0,sort:{bindPath:"stampedRecordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isAssignedObjectDeleted",adapter:function(e){return!1===e}},text:{bindPath:".stampedRecordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Status",cls:"n2_status",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}},{header:"Object",cls:"n2_object",bindPath:"assignedObjectName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Team",bindPath:"teamName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Distributor",bindPath:"distributorName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Method",cls:"n2_method",cell:{dataAdapter:function(e){return t._getMethod(e)}}},{header:"Assignee",bindPath:"assignedOwnerName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}}];return n2.de.page.logs.distributionLogList.Context.getInstance().displayLastAction&&(e.push({header:"Last Action",bindPath:"lastAction",cls:"n2_last-action",cell:{dataAdapter:function(e){return t._getLastAction(e)}}}),e.push({header:"Last Action Date",bindPath:"lastActionDate",cls:"n2_last-action-date",sortable:!0,cell:{dataAdapter:function(e){return t._getLastActionDate(e)}}})),e.push({cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}),e}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"distribution-menu",mixins:[n2.mixin.DataDriven],options:[{id:"delete-log",label:"Delete",hidden:!0},{id:"retry-log",label:"Retry",hidden:!0},{id:"reject-log",label:"Reject",hidden:!0}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_onMenuLoaded",value:function(e,t){this._selectable&&(e.components["delete-log"].hidden=!1),t.isOnHold&&(e.components["retry-log"].hidden=!1),t.canRejectAssignment&&(e.components["reject-log"].hidden=!1),this._selectable||t.isOnHold||t.canRejectAssignment||(e.hidden=!0)}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.assignedObjectId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getStatus",value:function(e){return e.inAlert?"SLA Alert":e.isReassignedToQueue?"Reassigned":n2.isUndefined(e.rejectLogId)?e.isOnHold?"On Hold":e.inError?{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}:{html:"<span>&mdash;</span>"}:"Rejected"}},{key:"_getMethod",value:function(e){return e.isSticky?"Sticky":e.isSubstitute?"Substitute":n2.isUndefined(e.method)?{html:"<span>&mdash;</span>"}:{html:'<div class="slds-truncate" title="'.concat(e.method,'">').concat(e.method,"</div>")}}},{key:"_getLastAction",value:function(e){return e?{html:'<div class="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}:{html:"<span>&mdash;</span>"}}},{key:"_getLastActionDate",value:function(e){return e?(e=this._formatDate(e),{html:'<div class="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}):{html:"<span>&mdash;</span>"}}},{key:"_applySelection",value:function(){var n,i=this;n2.isEmpty(this._cachedRowSelection)||(n=_toConsumableArray(this._cachedRowSelection),this._cachedRowSelection=[],this.forEachRow(function(t){var e=n.find(function(e){return e.logId===t.data.logId});n2.isUndefined(e)?t.select(!1,{silent:!0}):(i._cachedRowSelection.push(t.data),t.select(!0,{silent:!0}))}))}},{key:"_onRowSelectionChange",value:function(t){t.target.selected?this._cachedRowSelection.push(t.target.data):this._cachedRowSelection=this._cachedRowSelection.filter(function(e){return e.logId!==t.target.data.logId}),this._refreshHeaderRowSelection(),this.fire("selectionChange",t)}}]),t}(),n2.de.page.logs.distributionLogList.distributionLogsRecordList.Footer=function(){_inherits(t,n2.de.page.logs.component.recordList.Footer);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_refreshDetails",value:function(){if(!n2.de.ApplicationContext.getInstance().isAdminOrSystemManager)return this.element("details").hide();_get(_getPrototypeOf(t.prototype),"_refreshDetails",this).apply(this,arguments)}}]),t}(),n2.de.page.logs.distributionLogList.distributionLogsRecordList.Toolbar=function(){_inherits(u,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(u);function u(){return _classCallCheck(this,u),t.apply(this,arguments)}return _createClass(u,[{key:"_define",value:function(){_get(_getPrototypeOf(u.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"],this._myLogsFilterMessageTemplate='<div id="{{id}}" class="slds-grid slds-m-left_x-small slds-hide">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p>This page is currently only displaying your user\'s logs.</p>\n            </div>\n        </div>'),this._onHoldLogCount=null}},{key:"isFiltering",set:function(e){_set(_getPrototypeOf(u.prototype),"isFiltering",e,this,!0),this._refresh({myLogsFilterMessage:!0})}},{key:"filterData",get:function(){return this._filterData},set:function(e){this._filterData!==e&&(this._filterData=n2.merge(this._defaultDateRange,e),n2.isNull(this._filterOptionsData)||this._refresh())}},{key:"onHoldLogCount",set:function(e){this._onHoldLogCount!==e&&(this._onHoldLogCount=e,this._refresh({retryAllButton:!0}))}},{key:"myLogsFilterMessage",get:function(){return this._components["my-logs-filter-message"]}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"objectFilter",get:function(){return this._components["object-filter"]}},{key:"teamFilter",get:function(){return this._components["team-filter"]}},{key:"distributorFilter",get:function(){return this._components["distributor-filter"]}},{key:"teamMemberFilter",get:function(){return this._components["team-member-filter"]}},{key:"retryAllButton",get:function(){return this.components["retry-all"]}},{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(u.prototype),"_insertComponents",this).call(this),this._insertMyLogsFilterMessage(),this._insertDateRangeFilter(),this._insertRecordNameFilter(),this._insertStatusFilter(),this._insertObjectFilter(),this._insertTeamFilter(),this._insertDistributorFilter(),this._insertTeamMemberFilter(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertRetryAllButton(),(n2.de.ApplicationContext.getInstance().isAdminOrSystemManager||n2.de.ApplicationContext.getInstance().isTeamManager)&&this._insertMenu()}},{key:"_insertMyLogsFilterMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:"my-logs-filter-message",template:this._myLogsFilterMessageTemplate,renderTo:this.SELECTORS.message,hidden:!0}))}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=e.value.startDate.getTime(),t._filterData.endDate=e.value.endDate.getTime()}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",label:{text:"Search name/id",hidden:!0},renderTo:this.SELECTORS.topFilterRowRight,placeholder:"Search name/id...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordSearch=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"New",value:"New"},{label:"SLA alert",value:"SLA Alerts"},{label:"Reassigned",value:"Reassigned"},{label:"Unactioned",value:"Unactioned"},{label:"Actioned",value:"Actioned"},{label:"Rejected",value:"Rejected"},{label:"On hold",value:"On Hold"},{label:"Errored",value:"In Error"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertObjectFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"object-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by object",hidden:!0},placeholder:"All objects",options:[],listeners:{change:function(e){t._filterData.objectName=e.value||null,t._filterData.teamId=null,t._filterData.distributorId=null,t._filterData.teamMemberOwnerId=null,t._refresh({teamFilter:!0,distributorFilter:!0,teamMemberFilter:!0})}}}))}},{key:"_insertTeamFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"team-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by team",hidden:!0},placeholder:"All teams",options:[],listeners:{change:function(e){t._filterData.teamId=e.value||null,t._filterData.distributorId=null,t._filterData.teamMemberOwnerId=null,t._refresh({distributorFilter:!0,teamMemberFilter:!0})}}}))}},{key:"_insertDistributorFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"distributor-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by distributor",hidden:!0},placeholder:"All distributors",options:[],listeners:{change:function(e){t._filterData.distributorId=e.value||null}}}))}},{key:"_insertTeamMemberFilter",value:function(){var t=this;return this._insert(new n2.ui.component.field.Combo({id:"team-member-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by team member",hidden:!0},placeholder:"All team members",options:[],sort:!1,listeners:{change:function(e){t._filterData.teamMemberOwnerId=e.value||null}}}))}},{key:"_insertRetryAllButton",value:function(){return this.insert(new n2.ui.component.Button({id:"retry-all",hidden:!0,text:"Retry all",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._handleClick,scope:this}}))}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",disabled:!0,cls:"n2_menu",options:[{id:"delete-logs",label:"Delete"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"_loadFilterOptionData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,e=e.force;return this._loadDataProvider("get-filter-option-data",{silent:void 0!==t&&t,force:void 0===e||e})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(u.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadFilterOptionData({silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(u.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&(this._filterOptionsData=e,this._setDefaultDateRange(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(u.prototype),"_onLoadComplete",this).apply(this,arguments),this._filterOptionsData=e.response,this._setDefaultDateRange(),this._refresh()}},{key:"_setDefaultDateRange",value:function(){this._defaultDateRange.startDate=this._getDateRangeFilterStartDate().getTime(),this._defaultDateRange.endDate=this._getDateRangeFilterEndDate().getTime(),this._filterData.startDate=this._defaultDateRange.startDate,this._filterData.endDate=this._defaultDateRange.endDate}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(u.prototype),"_refresh",this).apply(this,arguments),e.myLogsFilterMessage),t=void 0!==t&&t,n=e.dateRangeFilter,n=void 0!==n&&n,i=e.recordNameFilter,i=void 0!==i&&i,s=e.statusFilter,s=void 0!==s&&s,a=e.objectFilter,a=void 0!==a&&a,o=e.teamFilter,o=void 0!==o&&o,r=e.distributorFilter,r=void 0!==r&&r,l=e.teamMemberFilter,l=void 0!==l&&l,c=e.retryAllButton,c=void 0!==c&&c,e=n2.isEmpty(e);(e||t)&&this._refreshMyLogsFilterMessage(),(e||n)&&this._refreshDateRangeFilter(),(e||i)&&this._refreshRecordNameFilter(),(e||s)&&this._refreshStatusFilter(),(e||a)&&this._refreshObjectFilter(),(e||o)&&this._refreshTeamFilter(),(e||r)&&this._refreshDistributorFilter(),(e||l)&&this._refreshTeamMemberFilter(),(e||c)&&this._refreshRetryAllButton()}},{key:"_refreshMyLogsFilterMessage",value:function(){var e=n2.de.page.logs.distributionLogList.Context.getInstance().isMyLogsFilterEnabled;this.myLogsFilterMessage.hidden=!e||n2.isNull(this.filterData.teamMemberOwnerId)||n2.de.ApplicationContext.getInstance().isUser}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=new Date(this.filterData.startDate),this.dateRangeFilter.endDate=new Date(this.filterData.endDate)}},{key:"_refreshRecordNameFilter",value:function(){this.recordNameFilter.value={value:this.filterData.recordSearch,silent:!0}}},{key:"_refreshStatusFilter",value:function(){this.statusFilter.value={value:this.filterData.status,silent:!0}}},{key:"_refreshObjectFilter",value:function(){this.objectFilter.value={value:this.filterData.objectName,silent:!0},this.objectFilter.options=this._getUniqueObjectFilterOptions()}},{key:"_getUniqueObjectFilterOptions",value:function(){return n2.isNull(this._filterOptionsData)?[]:_toConsumableArray(new Set(this._filterOptionsData.teams.map(function(e){return e.objectName})))}},{key:"_refreshTeamFilter",value:function(){this.teamFilter.value={value:this.filterData.teamId,silent:!0},n2.de.ApplicationContext.getInstance().isUser?this.teamFilter.hidden=!0:this.teamFilter.options=this.filterData.objectName?this._getTeamFilterOptionsByObject():this._getAllTeamFilterOptions()}},{key:"_refreshRetryAllButton",value:function(){this.retryAllButton&&(this.retryAllButton.text="Retry All (".concat(this._onHoldLogCount,")"),this.retryAllButton.hidden=n2.isEmpty(this._onHoldLogCount))}},{key:"_getTeamFilterOptionsByObject",value:function(){var t=this;return n2.isNull(this._filterOptionsData)?[]:this._filterOptionsData.teams.filter(function(e){return e.objectName===t.filterData.objectName}).map(function(e){return{value:e.id,label:e.name}})}},{key:"_getAllTeamFilterOptions",value:function(){return n2.isNull(this._filterOptionsData)?[]:this._filterOptionsData.teams.map(function(e){return{value:e.id,label:e.name}})}},{key:"_refreshDistributorFilter",value:function(){this.distributorFilter.value={value:this.filterData.distributorId,silent:!0},this.distributorFilter.disabled=!this.filterData.teamId,this.distributorFilter.options=this.filterData.teamId?this._getDistributionFilterOptions():[],(n2.de.ApplicationContext.getInstance().isUser||n2.de.ApplicationContext.getInstance().isTeamManager)&&(this.distributorFilter.hidden=!0)}},{key:"_getDistributionFilterOptions",value:function(){var t=this;return n2.isNull(this._filterOptionsData)?[]:this._filterOptionsData.teams.find(function(e){return e.id===t.filterData.teamId}).distributors.map(function(e){return{value:e.id,label:e.name}})}},{key:"_refreshTeamMemberFilter",value:function(){this.teamMemberFilter.value={value:this.filterData.teamMemberOwnerId,silent:!0},this.teamMemberFilter.options=this._getTeamMemberFilterOptions(),n2.de.ApplicationContext.getInstance().isUser&&(this.teamMemberFilter.hidden=!0)}},{key:"_getTeamMemberFilterOptions",value:function(){var e,t=this;return n2.isNull(this._filterOptionsData)?[]:(e=this._filterOptionsData.teamMembers,e=(e=n2.isEmpty(this.filterData.teamId)?e:e.filter(function(e){return e.teams.includes(t.filterData.teamId)})).map(function(e){return{value:e.id,label:e.name}}),this._sortTeamMembersFilterOptions(e))}},{key:"_sortTeamMembersFilterOptions",value:function(e){n2.sort(e,{property:"label"});var t=n2.de.ApplicationContext.getInstance().currentUserId,n=e.find(function(e){return e.value===t});return 1e3<(e=n2.isUndefined(n)?e:[n].concat(_toConsumableArray(e.filter(function(e){return e.value!==t})))).length?e.slice(0,1e3):e}},{key:"clear",value:function(){_get(_getPrototypeOf(u.prototype),"clear",this).call(this),n2.de.page.logs.distributionLogList.Context.getInstance().isMyLogsFilterEnabled=!1,this.filterData={},this._refresh()}}]),u}(),n2.de.page.logs.leadMatchingLogList.leadMatchingLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-lead-matching-logs-table",this._COLUMN_SORT_NAMES={0:"date",1:"name"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no lead matching logs to display at the moment.",content:"Lead matching logs show whether leads were successfully matched to other records as defined in the Classifier. Enable Lead Matching to get started."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no lead matching logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",bindPath:"lastProcessedDate",cls:"n2_created-date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",sortable:!0,sort:{bindPath:"recordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isRecordDeleted",adapter:function(e){return!1===e}},text:{bindPath:".recordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Status",cls:"n2_status",bindPath:"status",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}},{header:"Matched Account",cell:{dataAdapter:function(e){return t._getMatchedAccount(e)}}},{header:"Matched Contact",bindPath:"matchedContactName",cell:{dataAdapter:function(e){return t._getBlankPropertyName(e)}}},{header:"Matched Lead",bindPath:"matchedLeadName",cell:{dataAdapter:function(e){return t._getBlankPropertyName(e)}}}]}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.recordId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getStatus",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}}},{key:"_getMatchedAccount",value:function(e){return n2.isUndefined(e.matchedAccountName)?{html:"<span>&mdash;</span>"}:(e="".concat(e.matchedAccountName," (").concat(e.matchedAccountType,")"),{html:'<div className="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")})}},{key:"_getBlankPropertyName",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<div className="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}}}]),t}(),n2.de.page.logs.leadMatchingLogList.leadMatchingLogsRecordList.Toolbar=function(){_inherits(s,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"]}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"accountFilter",get:function(){return this._components["account-filter"]}},{key:"filterData",get:function(){return this._filterData}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertComponents",this).call(this),this._insertDateRangeFilter(),this._insertRecordNameFilter(),this._insertStatusFilter(),this._insertAccountFilter()}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=n2.isNull(e.value.startDate)?null:e.value.startDate.getTime(),t._filterData.endDate=n2.isNull(e.value.endDate)?null:e.value.endDate.getTime()}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",label:{text:"Search name/id",hidden:!0},renderTo:this.SELECTORS.topFilterRowRight,placeholder:"Search name/id...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordSearch=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"Matched",value:"Matches"},{label:"Unmatched",value:"No matches"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertAccountFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"account-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by account type",hidden:!0},placeholder:"All account types",options:[],listeners:{change:function(e){t._filterData.accountType=e.value||null}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-filter-option-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&(this._filterOptionsData=e,this._setDefaultDateRange(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._filterOptionsData=e.response,this._setDefaultDateRange(),this._refresh()}},{key:"_setDefaultDateRange",value:function(){var e=this._getDateRangeFilterStartDate(),t=this._getDateRangeFilterEndDate();this._defaultDateRange.startDate=e,this._defaultDateRange.endDate=t,this._filterData.startDate=e.getTime(),this._filterData.endDate=t.getTime()}},{key:"_resetFilterComponents",value:function(){this._refreshDateRangeFilter(),this.recordNameFilter.clear(),this.statusFilter.clear(),this.accountFilter.clear()}},{key:"_resetFilterData",value:function(){this._filterData={startDate:this._defaultDateRange.startDate.getTime(),endDate:this._defaultDateRange.endDate.getTime()}}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments),e.dateRangeFilter),t=void 0!==t&&t,n=e.accountFilter,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshDateRangeFilter(),(e||n)&&this._refreshAccountFilter()}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=this._defaultDateRange.startDate,this.dateRangeFilter.endDate=this._defaultDateRange.endDate}},{key:"_refreshAccountFilter",value:function(){this.accountFilter.options=this._filterOptionsData.accountTypes}},{key:"clear",value:function(){_get(_getPrototypeOf(s.prototype),"clear",this).apply(this,arguments),this._resetFilterData(),this._resetFilterComponents()}}]),s}(),n2.de.page.logs.objectSyncLogList.objectSyncLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-object-sync-logs-table",this._COLUMN_SORT_NAMES={0:"date",1:"name",3:"object",5:"team",6:"assignee"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no object sync logs to display at the moment.",content:"Object Sync allows you to transfer related objects to the same owner when an object is assigned by Distribution Engine."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no object sync logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",bindPath:"lastProcessedDate",cls:"n2_date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",sortable:!0,sort:{bindPath:"recordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isRecordDeleted",adapter:function(e){return!1===e}},text:{bindPath:".recordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Status",cls:"n2_status",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}},{header:"Object",cls:"n2_object",bindPath:"objectName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Number of Actions",bindPath:"numberOfActions",cls:"n2_number-of-actions",cell:{cls:"slds-text-align_right"}},{header:"Team",bindPath:"teamName",sortable:!0,sort:{bindPath:"teamName",adapter:function(e){return n2.isNull(e)?"00000":e}},cell:{dataAdapter:function(e){return t._getBlankPropertyName(e)}}},{header:"Assignee",bindPath:"userName",sortable:!0,sort:{bindPath:"userName",adapter:function(e){return n2.isNull(e)?"00000":e}},cell:{dataAdapter:function(e){return t._getBlankPropertyName(e)}}}]}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.recordId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getStatus",value:function(e){return e.inError?{html:'<span class="n2_error-status-icon">\n                    '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n                </span>\n                <span class="n2_error-status-text">Error</span>')}:"Skipped"===e.status?"Skipped":{html:"<span>&mdash;</span>"}}},{key:"_getBlankPropertyName",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<div className="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}}}]),t}(),n2.de.page.logs.objectSyncLogList.objectSyncLogsRecordList.Toolbar=function(){_inherits(a,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"],this._objectOptions=[]}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"objectFilter",get:function(){return this._components["object-filter"]}},{key:"teamFilter",get:function(){return this._components["team-filter"]}},{key:"teamMemberFilter",get:function(){return this._components["team-member-filter"]}},{key:"filterData",get:function(){return this._filterData}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(a.prototype),"_insertComponents",this).call(this),this._insertDateRangeFilter(),this._insertRecordNameFilter(),this._insertStatusFilter(),this._insertObjectFilter(),this._insertTeamFilter(),this._insertTeamMemberFilter()}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=n2.isNull(e.value.startDate)?null:e.value.startDate.getTime(),t._filterData.endDate=n2.isNull(e.value.endDate)?null:e.value.endDate.getTime()}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",label:{text:"Search name/id",hidden:!0},renderTo:this.SELECTORS.topFilterRowRight,placeholder:"Search name/id...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordSearch=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"Errored",value:"In Error"},{label:"Skipped",value:"Skipped"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertObjectFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"object-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by object",hidden:!0},placeholder:"All objects",options:[],listeners:{change:function(e){t._filterData.objectName=e.value||null,t._filterData.teamId=null,t._filterData.userId=null,t._refresh({teamFilter:!0,teamMemberFilter:!0})}}}))}},{key:"_insertTeamFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"team-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by team",hidden:!0},placeholder:"All teams",options:[],listeners:{change:function(e){t._filterData.teamId=e.value||null,t._filterData.userId=null,t._refresh({teamMemberFilter:!0})}}}))}},{key:"_insertTeamMemberFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"team-member-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by team member",hidden:!0},placeholder:"All team members",options:[],listeners:{change:function(e){t._filterData.userId=e.value||null}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-filter-option-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&(this._filterOptionsData=e,this._setDefaultDateRange(),this._setObjectOptions(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).apply(this,arguments),this._filterOptionsData=e.response,this._setDefaultDateRange(),this._setObjectOptions(),this._refresh()}},{key:"_setObjectOptions",value:function(){this._objectOptions=_toConsumableArray(new Set(this._filterOptionsData.teams.map(function(e){return e.objectName})))}},{key:"_getTeamFilterConfig",value:function(){var t=this;return this.objectFilter.value?this._filterOptionsData.teams.filter(function(e){return e.objectName===t.filterData.objectName}).map(function(e){return{value:e.id,label:e.name}}):this._filterOptionsData.teams.map(function(e){return{value:e.id,label:e.name}})}},{key:"_getTeamMemberFilterConfig",value:function(){var e=this.teamFilter.value,t={options:[],disabled:!0};return e&&(t.options=this._getTeamMemberOptions(e),t.disabled=!1),t}},{key:"_getTeamMemberOptions",value:function(t){return this._filterOptionsData.teams.find(function(e){return e.id===t}).teamMembers.map(function(e){return{label:e.name,value:e.id}})}},{key:"_setDefaultDateRange",value:function(){var e=this._getDateRangeFilterStartDate(),t=this._getDateRangeFilterEndDate();this._defaultDateRange.startDate=e,this._defaultDateRange.endDate=t,this._filterData.startDate=e.getTime(),this._filterData.endDate=t.getTime()}},{key:"_resetFilterData",value:function(){this._filterData={startDate:this._defaultDateRange.startDate.getTime(),endDate:this._defaultDateRange.endDate.getTime()}}},{key:"_resetFilterComponents",value:function(){this._refreshDateRangeFilter(),this.recordNameFilter.clear(),this.statusFilter.clear(),this.objectFilter.clear(),this.teamFilter.clear(),this._resetTeamMemberFilter()}},{key:"_resetTeamMemberFilter",value:function(){this.teamMemberFilter.clear(),this.teamMemberFilter.disabled=!0}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(a.prototype),"_refresh",this).apply(this,arguments),e.dateRangeFilter),t=void 0!==t&&t,n=e.objectFilter,n=void 0!==n&&n,i=e.teamFilter,i=void 0!==i&&i,s=e.teamMemberFilter,s=void 0!==s&&s,e=n2.isEmpty(e);(e||t)&&this._refreshDateRangeFilter(),(e||n)&&this._refreshObjectFilter(),(e||i)&&this._refreshTeamFilter(),(e||s)&&this._refreshTeamMemberFilter()}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=this._defaultDateRange.startDate,this.dateRangeFilter.endDate=this._defaultDateRange.endDate}},{key:"_refreshObjectFilter",value:function(){this.objectFilter.options=this._objectOptions}},{key:"_refreshTeamFilter",value:function(){this.teamFilter.options=this._getTeamFilterConfig(),this.teamFilter.clear()}},{key:"_refreshTeamMemberFilter",value:function(){var e=this._getTeamMemberFilterConfig();this.teamMemberFilter.options=e.options,this.teamMemberFilter.disabled=e.disabled,this.teamMemberFilter.clear()}},{key:"clear",value:function(){_get(_getPrototypeOf(a.prototype),"clear",this).apply(this,arguments),this._resetFilterData(),this._resetFilterComponents()}}]),a}(),n2.de.page.logs.schedulerLogList.schedulerLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-scheduler-logs-table",this._COLUMN_SORT_NAMES={0:"startTime",2:"numberOfAssignments",3:"timeTaken"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no scheduler logs to display at the moment.",content:"When Distribution Engine runs, details can be found here."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no scheduler logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",cls:"n2_start-time",bindPath:"startTime",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Type",cls:"n2_type",bindPath:"logType"},{header:{data:"Number of Assignments",cls:"slds-text-align_right"},cls:"n2_number-of-assignments",sortable:!0,sort:{bindPath:"numberOfAssignments"},cell:{cls:"slds-text-align_right",dataAdapter:function(e){return t._getNumberOfAssignments(e)}}},{header:{data:"Time Taken (seconds)",cls:"slds-text-align_right"},cls:"n2_time-taken",sortable:!0,cell:{cls:"slds-text-align_right",dataAdapter:function(e){return t._getTimeTaken(e)}}},{header:"Status",cls:"n2_status",bindPath:"errorMessage",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}}]}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getNumberOfAssignments",value:function(e){return"health checker"!==e.logType.toLowerCase()?{html:"<span>".concat(e.numberOfAssignments,"</span>")}:{html:"<span>&mdash;</span>"}}},{key:"_getStatus",value:function(e){return e?{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}:{html:"<span>&mdash;</span>"}}},{key:"_getTimeTaken",value:function(e){return n2.isUndefined(e.timeTaken)?{html:"<span>&mdash;</span>"}:{html:"<span>".concat(e.timeTaken,"</span>")}}}]),t}(),n2.de.page.logs.schedulerLogList.schedulerLogsRecordList.Toolbar=function(){_inherits(t,n2.de.page.logs.component.recordList.Toolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._REFRESH={filterData:["dateRangeFilter","typeFilter","statusFilter"]}}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this._setDefaultDateRange()}},{key:"filterData",get:function(){return this._filterData},set:function(e){this._setProperty("filterData",n2.merge(this._defaultDateRange,e))}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"typeFilter",get:function(){return this._components["type-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(t.prototype),"_insertComponents",this).call(this),this._insertDateRangeFilter(),this._insertTypeFilter(),this._insertStatusFilter()}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.schedulerLogList.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=n2.isNull(e.value.startDate)?null:e.value.startDate.getTime(),t._filterData.endDate=n2.isNull(e.value.endDate)?null:e.value.endDate.getTime()}}}))}},{key:"_insertTypeFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"type-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by type",hidden:!0},placeholder:"All types",options:[{label:"Scheduler",value:"Scheduler"},{label:"Health checker",value:"Health Checker"},{label:"Archiver",value:"Archiver"},{label:"Assignment Simulation",value:"Assignment Simulation"}],sort:!1,listeners:{change:function(e){t._filterData.logType=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"Errored",value:"Errored"},{label:"Not errored",value:"Not Errored"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_setDefaultDateRange",value:function(){this._defaultDateRange.startDate=this._getDateRangeFilterStartDate().getTime(),this._defaultDateRange.endDate=this._getDateRangeFilterEndDate().getTime(),this._filterData.startDate=this._defaultDateRange.startDate,this._filterData.endDate=this._defaultDateRange.endDate,this._refresh(["dateRangeFilter"])}},{key:"_getDateRangeFilterStartDate",value:function(){var e=new Date;return e.setDate(e.getDate()-7),e.setUTCHours(0,0,0,0),e}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=new Date(this.filterData.startDate),this.dateRangeFilter.endDate=new Date(this.filterData.endDate)}},{key:"_refreshTypeFilter",value:function(){this.typeFilter.value={value:this.filterData.logType,silent:!0}}},{key:"_refreshStatusFilter",value:function(){this.statusFilter.value={value:this.filterData.status,silent:!0}}},{key:"_resetFilterComponents",value:function(){this._refresh(["dateRangeFilter"]),this.typeFilter.clear(),this.statusFilter.clear()}},{key:"clear",value:function(){_get(_getPrototypeOf(t.prototype),"clear",this).apply(this,arguments),this.filterData={},this._resetFilterComponents()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";if(n2.isObject(e))return _get(_getPrototypeOf(t.prototype),"_refresh",this).call(this,e);"all"===e?this._refreshAll():this._refreshParts(e)}}]),t}(),n2.de.page.logs.territoriesLogList.territoriesLogsRecordList.DataTable=function(){_inherits(t,n2.de.page.logs.component.recordList.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-territories-logs-table",this._COLUMN_SORT_NAMES={0:"date",1:"name",3:"object",4:"territory"},this._emptyState={illustration:n2.de.illustration.Desert,cls:"n2-de-data-table-empty-state",heading:"There are no territories logs to display at the moment.",content:"Territories logs show whether records were successfully matched to territories as defined in the Classifier. Enable classification to get started."},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no territories logs that match your filters",content:""}}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Date",bindPath:"lastProcessedDate",cls:"n2_created-date",sortable:!0,cell:{dataAdapter:function(e){return t._formatDate(e)}}},{header:"Name",sortable:!0,sort:{bindPath:"recordName"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"record-name",type:n2.de.component.RecordName,isLink:{bindPath:".isRecordDeleted",adapter:function(e){return!1===e}},text:{bindPath:".recordName"},listeners:{click:this._onOpenRecordLink,scope:this}}]}},{header:"Status",cls:"n2_status",bindPath:"status",cell:{cls:"n2_status-cell",dataAdapter:function(e){return t._getStatus(e)}}},{header:"Object",cls:"n2_object",bindPath:"objectName",sortable:!0,cell:{cellTemplate:'{{#content}}<div class="slds-truncate" title="{{content}}">{{content}}</div>{{/content}}'}},{header:"Territory",bindPath:"matchedTerritoryName",sortable:!0,cell:{dataAdapter:function(e){return t._getTerritoryName(e)}}}]}},{key:"_onOpenRecordLink",value:function(e){n2.de.page.Navigation.getInstance().openObject(e.target.model.recordId)}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e)}},{key:"_getStatus",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<span class="n2_error-status-icon">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon slds-icon-text-default slds-icon_x-small slds-m-right_small"}),'\n            </span>\n            <span class="n2_error-status-text">Error</span>')}}},{key:"_getTerritoryName",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:{html:'<div class="slds-truncate" title="'.concat(e,'">').concat(e,"</div>")}}}]),t}(),n2.de.page.logs.territoriesLogList.territoriesLogsRecordList.Toolbar=function(){_inherits(s,n2.de.page.logs.component.recordList.Toolbar);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-filter-option-data"]}},{key:"dateRangeFilter",get:function(){return this._components["date-range-filter"]}},{key:"recordNameFilter",get:function(){return this._components["record-name-filter"]}},{key:"statusFilter",get:function(){return this._components["status-filter"]}},{key:"objectFilter",get:function(){return this._components["object-filter"]}},{key:"filterData",get:function(){return this._filterData}},{key:"_insertComponents",value:function(){_get(_getPrototypeOf(s.prototype),"_insertComponents",this).call(this),this._insertDateRangeFilter(),this._insertRecordNameFilter(),this._insertStatusFilter(),this._insertObjectFilter()}},{key:"_insertDateRangeFilter",value:function(){var t=this;return this.insert(new n2.de.page.logs.component.DateRangePicker({id:"date-range-filter",label:{text:"Date range",hidden:!0},renderTo:this.SELECTORS.topFilterRowLeft,hideAllDay:!0,showTime:!0,startDateLabel:"From",endDateLabel:"To",maintainDuration:!1,listeners:{change:function(e){t._filterData.startDate=n2.isNull(e.value.startDate)?null:e.value.startDate.getTime(),t._filterData.endDate=n2.isNull(e.value.endDate)?null:e.value.endDate.getTime()}}}))}},{key:"_insertRecordNameFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.TextBox({id:"record-name-filter",label:{text:"Search name/id",hidden:!0},renderTo:this.SELECTORS.topFilterRowRight,placeholder:"Search name/id...",allowClear:!0,icon:n2.ui.enum.Icon.SEARCH,listeners:{change:function(e){t._filterData.recordSearch=e.value||null}}}))}},{key:"_insertStatusFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"status-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by status",hidden:!0},placeholder:"All statuses",options:[{label:"Matched",value:"Matched"},{label:"Unmatched",value:"Unmatched"},{label:"Errored",value:"Errored"}],sort:!1,listeners:{change:function(e){t._filterData.status=e.value||null}}}))}},{key:"_insertObjectFilter",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"object-filter",renderTo:this.SELECTORS.bottomFilterRowLeft,cls:"slds-m-right_small",label:{text:"Filter by object",hidden:!0},placeholder:"All objects",options:[],listeners:{change:function(e){t._filterData.objectName=e.value||null}}}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-filter-option-data",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{filterOptionData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-filter-option-data"===t.id&&(this._filterOptionsData=e,this._setDefaultDateRange(),this._refresh())}},{key:"_onLoadComplete",value:function(e){e=e.filterOptionData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._filterOptionsData=e.response,this._setDefaultDateRange(),this._refresh()}},{key:"_setDefaultDateRange",value:function(){var e=this._getDateRangeFilterStartDate(),t=this._getDateRangeFilterEndDate();this._defaultDateRange.startDate=e,this._defaultDateRange.endDate=t,this._filterData.startDate=e.getTime(),this._filterData.endDate=t.getTime()}},{key:"_resetFilterComponents",value:function(){this._refreshDateRangeFilter(),this.recordNameFilter.clear(),this.statusFilter.clear(),this.objectFilter.clear()}},{key:"_resetFilterData",value:function(){this._filterData={startDate:this._defaultDateRange.startDate.getTime(),endDate:this._defaultDateRange.endDate.getTime()}}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments),e.dateRangeFilter),t=void 0!==t&&t,n=e.objectFilter,e=n2.isEmpty(e);(e||t)&&this._refreshDateRangeFilter(),(e||n)&&this._refreshObjectFilter()}},{key:"_refreshDateRangeFilter",value:function(){this.dateRangeFilter.startDate=this._defaultDateRange.startDate,this.dateRangeFilter.endDate=this._defaultDateRange.endDate}},{key:"_refreshObjectFilter",value:function(){this.objectFilter.options=this._filterOptionsData.objectNames}},{key:"clear",value:function(){_get(_getPrototypeOf(s.prototype),"clear",this).apply(this,arguments),this._resetFilterData(),this._resetFilterComponents()}}]),s}(),n2.de.page.objectSync.objectSyncActions.actionsList.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any Object Sync actions yet",this._content="Object Sync actions allow you to update related objects to the same owner when an object is assigned by Distribution Engine.",this._contentTemplate='<div>\n            <p class="slds-text-body_regular">{{content}}</p>\n        </div>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._heading="Your org doesn't have any Object Sync actions yet",this._insertAddActionButton()}},{key:"_insertAddActionButton",value:function(){return this._insert(new n2.ui.component.Button({id:"add-object-sync-action",text:"Add Action",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddActionButtonClick,scope:this}}))}},{key:"_onAddActionButtonClick",value:function(e){this.fire("click",this._createEvent(e))}}]),t}(),n2.de.page.settings.appSettings.appSettingsForm.CalendarIntegration=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Calendar integration",this._toggleActive=!0,this._helpText="If enabled, Out of Office entries will be created in response to Events in Salesforce.",this._eventShowTimeAsOptions=null}},{key:"eventShowTimeAsCombo",get:function(){return this._components["event-show-time-as-combo"]}},{key:"_insertFields",value:function(){this._insertEventShowTimeAsCombo()}},{key:"_insertEventShowTimeAsCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"event-show-time-as-combo",label:"Event 'Show Time As' options",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:'Specify which "Show Time As" events are used to create Out of Office entries.',options:[],multiple:!0,required:!0,sort:!1,value:{bindPath:".eventShowTimeAs"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("salesforceCalendarIntegrationOn").value=e.value,this._refresh()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-event-show-as-options",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{eventShowTimeAsOptions:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.eventShowTimeAsOptions;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._eventShowTimeAsOptions=e.response}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["toggle-active"].value={value:e.get("salesforceCalendarIntegrationOn"),silent:!0},this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.eventShowTimeAs,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshEventShowTimeAsCombo()}},{key:"_refreshEventShowTimeAsCombo",value:function(){this.eventShowTimeAsCombo.model=this._model,this.eventShowTimeAsCombo.options=this._eventShowTimeAsOptions;var e=this._model.get("salesforceCalendarIntegrationOn");this.eventShowTimeAsCombo.hidden=!e,e&&this.eventShowTimeAsCombo.value&&this.eventShowTimeAsCombo.clearInvalid()}}]),s}(),n2.de.page.settings.appSettings.appSettingsForm.DistributionSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Distribution settings"}},{key:"loadBalancingSettingsFieldGroup",get:function(){return this._components["load-balancing-settings-field-group"]}},{key:"rejectionSettingsFieldGroup",get:function(){return this._components["rejection-settings-field-group"]}},{key:"userAvailabilitySettingsFieldGroup",get:function(){return this._components["user-availability-settings-field-group"]}},{key:"_insertFields",value:function(){this._insertLoadBalancingSettingsFieldGroup(),this._insertRejectionSettingsFieldGroup(),this._insertUserAvailabilitySettingsFieldGroup()}},{key:"_insertLoadBalancingSettingsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.LoadBalancingSettings({id:"load-balancing-settings-field-group",cls:"slds-m-bottom_medium"}))}},{key:"_insertRejectionSettingsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.RejectionSettings({id:"rejection-settings-field-group",cls:"slds-m-bottom_medium"}))}},{key:"_insertUserAvailabilitySettingsFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.UserAvailabilitySettings({id:"user-availability-settings-field-group",cls:"slds-m-bottom_medium"}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.loadBalancingSettings,t=void 0!==t&&t,n=e.rejectionSettings,n=void 0!==n&&n,i=e.userAvailabilitySettings,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshLoadBalancingSettingsFieldGroup(),(e||n)&&this._refreshRejectionSettingsFieldGroup(),(e||i)&&this._refreshUserAvailabilitySettingsFieldGroup()}},{key:"_refreshLoadBalancingSettingsFieldGroup",value:function(){this.loadBalancingSettingsFieldGroup.model=this._model}},{key:"_refreshRejectionSettingsFieldGroup",value:function(){this.rejectionSettingsFieldGroup.model=this._model}},{key:"_refreshUserAvailabilitySettingsFieldGroup",value:function(){this.userAvailabilitySettingsFieldGroup.model=this._model}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.LoggingAndArchiving=function(){_inherits(o,n2.de.component.form.FieldGroup);var e,t,n=_createSuper(o);function o(){return _classCallCheck(this,o),n.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="n2-de-app-settings-logging-and-archiving",this._heading="Logging and archiving",this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_logging-fields",archivingToggle:".n2_archiving-toggle",archivingCombo:".n2_archiving-combo",previousAssignmentFields:".n2_previous-assignment-fields"}),this._template='<fieldset id="{{id}}" class="n2-de-field-group{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            {{>headingTemplate}}\n            <div class="n2_fields n2_logging-fields"></div>\n            <div class="n2_fields n2_archiving-toggle"></div>\n            <div class="n2_fields n2_archiving-combo"></div>\n            <div class="n2_fields n2_previous-assignment-fields"></div>\n            {{>errorTemplate}}\n        </fieldset>',this._warningMessageTemplate='<div class="slds-grid slds-m-bottom_small">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p>\n                    One or more SLAs are currently setup for longer than Distribution Logs will be kept, this will cause SLAs to not function as expected.\n                </p>\n            </div>\n        </div>'),this._maintainDistributionLogsOptions=[{value:"No logging",valueInDays:0},{value:"1 week",valueInDays:7},{value:"2 weeks",valueInDays:14},{value:"1 month",valueInDays:31},{value:"2 months",valueInDays:62},{value:"3 months",valueInDays:93},{value:"6 months",valueInDays:186},{value:"1 year",valueInDays:365},{value:"Forever",valueInDays:1/0}],this._longestSlaDeadlineDays=null,this._licenseDetails=null}},{key:"maintainDistributionLogsCombo",get:function(){return this._components["maintain-distribution-logs-combo"]}},{key:"maintainDistributionLogsWarningHTML",get:function(){return this._components["maintain-distribution-logs-warning-html"]}},{key:"maintainClassifierLogsCombo",get:function(){return this._components["maintain-classifier-logs-combo"]}},{key:"maintainObjectSyncLogsCombo",get:function(){return this._components["maintain-object-sync-logs-combo"]}},{key:"maintainChangeHistoryLogsCombo",get:function(){return this._components["maintain-change-history-logs-combo"]}},{key:"archivingToggle",get:function(){return this._components["archiving-toggle"]}},{key:"archiveRecordsCombo",get:function(){return this._components["archive-record-combo"]}},{key:"previousAssignmentsTrackingFieldGroup",get:function(){return this._components["previous-assignments-tracking-field-group"]}},{key:"_insertFields",value:function(){this._insertMaintainDistributionLogsCombo(),this._insertMaintainDistributionLogsWarningHTML(),this._insertMaintainClassifierLogsCombo(),this._insertMaintainObjectSyncLogsCombo(),this._insertMaintainChangeHistoryLogsCombo(),this._insertArchiveRecordsCombo(),this._insertTrackPreviousAssignmentsToggle()}},{key:"_insertMaintainDistributionLogsCombo",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"maintain-distribution-logs-combo",label:"Maintain distribution logs",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Choose how long the distribution logs are stored. These are required for analytics and some distribution features.",options:[],required:!0,sort:!1,value:{bindPath:".maintainDistributionLogDuration"},listeners:{change:function(){return e._refresh({maintainDistributionLogsWarning:!0})}}}))}},{key:"_insertMaintainDistributionLogsWarningHTML",value:function(){return this.insert(new n2.ui.component.HTML({id:"maintain-distribution-logs-warning-html",template:this._warningMessageTemplate}))}},{key:"_insertMaintainClassifierLogsCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"maintain-classifier-logs-combo",label:"Maintain classifier logs",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Choose how long the classifier logs are stored.",options:["No logging","1 week","1 month","2 months","3 months","6 months","1 year","Forever"],required:!0,sort:!1,value:{bindPath:".maintainClassifierLogDuration"}}))}},{key:"_insertMaintainObjectSyncLogsCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"maintain-object-sync-logs-combo",label:"Maintain object sync logs",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Choose how long the object sync logs are stored.",options:["No logging","1 week","1 month","2 months","3 months","6 months","1 year","Forever"],required:!0,sort:!1,value:{bindPath:".maintainObjectSyncLogDuration"}}))}},{key:"_insertMaintainChangeHistoryLogsCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"maintain-change-history-logs-combo",label:"Maintain change history logs",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Choose how long audit logs for configuration changes are kept for.",options:["1 week","2 weeks","1 month","2 months","3 months","6 months","1 year"],required:!0,sort:!1,value:{bindPath:".maintainChangeHistoryLogDuration"}}))}},{key:"_insertArchivingToggle",value:function(){return this.insert(new n2.ui.component.field.CheckboxToggle({id:"archiving-toggle",label:"Archiving",renderTo:this.SELECTORS.archivingToggle,mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"Move records that have not been assigned after a length of time to an archive queue.",value:{bindPath:".archivingOn"},listeners:{change:this._onArchivingToggleChange,scope:this}}))}},{key:"_onArchivingToggleChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.spinner(!0),this.archivingToggle.value)return e.next=4,this._postDataProvider("create-archive-queue",{silent:!0});e.next=10;break;case 4:return e.next=6,this._postDataProvider("create-archive-queue-sobjects",{silent:!0});case 6:return e.next=8,this._postDataProvider("activate-archiving",{silent:!0});case 8:e.next=12;break;case 10:return e.next=12,this._postDataProvider("deactivate-archiving",{silent:!0});case 12:this.spinner(!1),this._refresh({archiveRecords:!0});case 14:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_insertArchiveRecordsCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"archive-record-combo",label:"Archive records older than",renderTo:this.SELECTORS.archivingCombo,mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",options:[{label:"1 week",value:"LAST_N_DAYS:7"},{label:"2 weeks",value:"LAST_N_DAYS:14"},{label:"1 month",value:"LAST_N_DAYS:31"},{label:"2 months",value:"LAST_N_DAYS:61"}],required:!0,sort:!1,value:{bindPath:".archiveRecordsOlderThan"}}))}},{key:"_insertTrackPreviousAssignmentsToggle",value:function(){this._insert(new n2.de.page.settings.appSettings.appSettingsForm.loggingAndArchiving.PreviousAssignmentsTracking({id:"previous-assignments-tracking-field-group",renderTo:this.SELECTORS.previousAssignmentFields,cls:"slds-m-bottom_medium",helpText:"If enabled, the previous assignees of a record are tracked."}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-longest-sla-deadline-days",{silent:t,force:n}),this._loadDataProvider("get-license-details",{silent:t,force:n})]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{longestSlaDeadlineDays:i,licenseDetails:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.longestSlaDeadlineDays,e=e.licenseDetails;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._longestSlaDeadlineDays=t.response,this._licenseDetails=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.maintainDistributionLogs,t=void 0!==t&&t,n=e.maintainDistributionLogsWarning,n=void 0!==n&&n,i=e.maintainClassifierLogs,i=void 0!==i&&i,s=e.maintainObjectSyncLogs,s=void 0!==s&&s,a=e.maintainChangeHistoryLogs,a=void 0!==a&&a,o=e.archiving,o=void 0!==o&&o,r=e.archiveRecords,r=void 0!==r&&r,l=e.previousAssignmentsTracking,l=void 0!==l&&l,e=n2.isEmpty(e);(e||t)&&this._refreshMaintainDistributionLogsCombo(),(e||n)&&this._refreshMaintainDistributionLogsWarningHTML(),(e||i)&&this._refreshMaintainClassifierLogsCombo(),(e||s)&&this._refreshMaintainObjectSyncLogsCombo(),(e||a)&&this._refreshMaintainChangeHistoryLogsCombo(),(e||o)&&this.refreshArchivingToggle(),(e||r)&&this._refreshArchiveRecordsCombo(),(e||l)&&this._refreshPreviousAssignmentsTrackingFieldGroup()}},{key:"_refreshMaintainDistributionLogsCombo",value:function(){this.maintainDistributionLogsCombo.model=this._model,this.maintainDistributionLogsCombo.options=this._maintainDistributionLogsOptions.map(function(e){return e.value})}},{key:"_refreshMaintainDistributionLogsWarningHTML",value:function(){var e,t=!1;n2.isNull(this._longestSlaDeadlineDays)||(e=this._getDistributionLogsInDays(),t=!n2.isNull(e)&&this._longestSlaDeadlineDays>e),this.maintainDistributionLogsWarningHTML.hidden=!t}},{key:"_getDistributionLogsInDays",value:function(){var t=this,e=this._maintainDistributionLogsOptions.find(function(e){return e.value===t.maintainDistributionLogsCombo.value});return e?e.valueInDays:null}},{key:"_refreshMaintainClassifierLogsCombo",value:function(){this.maintainClassifierLogsCombo.model=this._model}},{key:"_refreshMaintainObjectSyncLogsCombo",value:function(){this.maintainObjectSyncLogsCombo.model=this._model}},{key:"_refreshMaintainChangeHistoryLogsCombo",value:function(){this.maintainChangeHistoryLogsCombo.model=this._model}},{key:"refreshArchivingToggle",value:function(){n2.isUndefined(this.archivingToggle)||this.archivingToggle.destroy(),this._insertArchivingToggle(),this.archivingToggle.model=this._model,this.archivingToggle.hidden=this._isArchivingHidden(),this.archivingToggle.disabled=n2.de.page.settings.appSettings.Context.getInstance().isDirty,this.archivingToggle.disabled&&(this.archivingToggle.tooltip={text:"Save outstanding changes before enabling/disabling Archiving.",position:n2.ui.enum.Position.BELOW})}},{key:"_isArchivingHidden",value:function(){return!n2.isNull(this._licenseDetails)&&"Trial"===this._licenseDetails.licenseStatus&&!this._model.get("isArchiveQueuePopulated")}},{key:"_refreshArchiveRecordsCombo",value:function(){this.archiveRecordsCombo.model=this._model,this.archiveRecordsCombo.hidden=!this.archivingToggle.value||this._isArchivingHidden()}},{key:"_refreshPreviousAssignmentsTrackingFieldGroup",value:function(){this.previousAssignmentsTrackingFieldGroup.model=this._model}},{key:"_onFieldChange",value:function(e){this._isFieldAutoSave(e)||_get(_getPrototypeOf(o.prototype),"_onFieldChange",this).call(this,e)}},{key:"_isFieldAutoSave",value:function(e){return"archiving-toggle"===e.id}}]),o}(),n2.de.page.settings.appSettings.appSettingsForm.Notifications=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Notifications"}},{key:"publishPlatformEventsOnAssignmentCheckbox",get:function(){return this._components["publish-platform-events-on-assignment-checkbox"]}},{key:"realTimeWidgetNotificationsCheckbox",get:function(){return this._components["real-time-widget-notifications-checkbox"]}},{key:"_insertFields",value:function(){this._insertPublishPlatformEventsOnAssignmentCheckbox(),this._insertRealTimeWidgetNotificationsCheckbox()}},{key:"_insertPublishPlatformEventsOnAssignmentCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"publish-platform-events-on-assignment-checkbox",label:"Publish platform events on assignment",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"On assignment of a record a platform event is created that can be used to integrate into your own processes. Note: This will use Salesforce platform events and are therefore subject to the limits based on your agreement with Salesforce.",value:{bindPath:".publishPlatformEventsOnAssignment"}}))}},{key:"_insertRealTimeWidgetNotificationsCheckbox",value:function(){var e=this;return this._insert(new n2.ui.component.field.Checkbox({id:"real-time-widget-notifications-checkbox",label:"Real time widget notifications",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:'Allows the widget to display a red dot indicator on the "New" icon, when a new assignment occurs. Note: Real time notifications use Salesforce platform events and are therefore subject to the limits based on your agreement with Salesforce.',value:{bindPath:".realTimeNotificationsOn"},listeners:{change:function(){return e._refresh({publishPlatformEventsOnAssignmentCheckbox:!0})}}}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.publishPlatformEventsOnAssignmentCheckbox,t=void 0!==t&&t,n=e.realTimeWidgetNotificationsCheckbox,n=void 0!==n&&n,e=n2.isEmpty(e);(e||n)&&this._refreshRealTimeWidgetNotificationsCheckbox(),(e||t)&&this._refreshPublishPlatformEventsOnAssignmentCheckbox()}},{key:"_refreshPublishPlatformEventsOnAssignmentCheckbox",value:function(){this.publishPlatformEventsOnAssignmentCheckbox.model=this._model,!0===this.realTimeWidgetNotificationsCheckbox.value?(this.publishPlatformEventsOnAssignmentCheckbox.disabled=!0,this.publishPlatformEventsOnAssignmentCheckbox.value={value:!0,silent:!0}):this.publishPlatformEventsOnAssignmentCheckbox.disabled=!1}},{key:"_refreshRealTimeWidgetNotificationsCheckbox",value:function(){this.realTimeWidgetNotificationsCheckbox.model=this._model}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.Operations=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Operations"}},{key:"distributionEngineFieldGroup",get:function(){return this._components["distribution-engine-field-group"]}},{key:"healthCheckerFieldGroup",get:function(){return this._components["health-checker-field-group"]}},{key:"_insertFields",value:function(){this._insertDistributionEngineFieldGroup(),this._insertHealthCheckerFieldGroup()}},{key:"_insertDistributionEngineFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.operations.DistributionEngine({id:"distribution-engine-field-group",cls:"slds-m-bottom_medium"}))}},{key:"_insertHealthCheckerFieldGroup",value:function(){return this._insert(new n2.de.page.settings.appSettings.appSettingsForm.operations.HealthChecker({id:"health-checker-field-group",cls:"slds-m-bottom_medium"}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.distributionEngine,t=void 0!==t&&t,n=e.healthChecker,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshDistributionEngineFieldGroup(),(e||n)&&this._refreshHealthCheckerFieldGroup()}},{key:"_refreshDistributionEngineFieldGroup",value:function(){this.distributionEngineFieldGroup.model=this._model}},{key:"_refreshHealthCheckerFieldGroup",value:function(){this.healthCheckerFieldGroup.model=this._model}}]),n}(),n2.de.page.settings.exportImport.export.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="No Exports have been recorded on your org",this._contentTemplate="<p>Start by exporting a team or tags.</p>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertStartExportButton()}},{key:"_insertStartExportButton",value:function(){return this._insert(new n2.ui.component.Button({id:"start-export",text:"Start Export",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onStartExportButtonClick,scope:this}}))}},{key:"_onStartExportButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}}]),t}(),n2.de.page.settings.exportImport.export.ExportModal=function(){_inherits(n,n2.de.component.Modal);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this,arguments),this.id="export-modal",this._componentCls="n2-de-export-modal",this._DATA_TYPE={TEAM:"Team",TAG_COLLECTIONS:"Tag collection"}}},{key:"exportForm",get:function(){return this._components["export-form"]}},{key:"contentTypeField",get:function(){return this.exportForm.components["content-type"]}},{key:"teamsFieldGroup",get:function(){return this.exportForm.components["teams-field-group"]}},{key:"teamsRadioGroup",get:function(){return this.teamsFieldGroup.components.teams}},{key:"tagCollectionsFieldGroup",get:function(){return this.exportForm.components["tag-collections-field-group"]}},{key:"tagCollectionsCheckboxGroup",get:function(){return this.tagCollectionsFieldGroup.components["tag-collections"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){var e={};switch(this.contentTypeField.value){case this._DATA_TYPE.TEAM:e.contentType=this._DATA_TYPE.TEAM,e.objectIds=[this.teamsRadioGroup.value];break;case this._DATA_TYPE.TAG_COLLECTIONS:e.contentType=this._DATA_TYPE.TAG_COLLECTIONS,e.objectIds=this.tagCollectionsCheckboxGroup.value}return e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this,arguments),this._insertExportForm()}},{key:"_insertExportForm",value:function(){var t=this;return this.insert(new n2.ui.component.Form({id:"export-form",components:[{type:n2.de.component.field.RadioButtonGroup,id:"content-type",cls:"slds-m-bottom_medium",label:"Content type",required:!0,sort:!1,options:[{label:"Team",value:this._DATA_TYPE.TEAM},{label:"Tag Collections",value:this._DATA_TYPE.TAG_COLLECTIONS}],listeners:{change:this._onContentTypeChange,scope:this}},{type:n2.de.page.settings.exportImport.export.exportModal.Teams,mixins:[n2.mixin.DataDriven],id:"teams-field-group",listeners:{change:function(e){e.target===t.teamsRadioGroup&&t._refresh({submitButton:!0})}}},{type:n2.de.page.settings.exportImport.export.exportModal.TagCollections,mixins:[n2.mixin.DataDriven],id:"tag-collections-field-group",hidden:!0,listeners:{change:function(e){e.target===t.tagCollectionsCheckboxGroup&&t._refresh({submitButton:!0})}}}]}))}},{key:"_onContentTypeChange",value:function(){this.teamsFieldGroup.hidden=this.contentTypeField.value!==this._DATA_TYPE.TEAM,this.tagCollectionsFieldGroup.hidden=this.contentTypeField.value!==this._DATA_TYPE.TAG_COLLECTIONS,this._refresh({submitButton:!0})}},{key:"show",value:function(){_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this.header="Export config",this.contentTypeField.value=this._DATA_TYPE.TEAM,this.teamsFieldGroup.clear(),this.tagCollectionsFieldGroup.clear(),this._refresh(),this.submitButton.reset(),this.cancelButton.enable()}},{key:"_onSubmit",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.exportForm.validate()&&_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this);case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.submitButton,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshSubmitButton()}},{key:"_refreshSubmitButton",value:function(){this.submitButton.text=this._getButtonTextForContentType(),n2.isEmpty(this._getFieldForContentType().value)?this.submitButton.disable():this.submitButton.enable()}},{key:"_getFieldForContentType",value:function(){switch(this.contentTypeField.value){case this._DATA_TYPE.TEAM:return this.teamsRadioGroup;case this._DATA_TYPE.TAG_COLLECTIONS:return this.tagCollectionsCheckboxGroup}}},{key:"_getButtonTextForContentType",value:function(){switch(this.contentTypeField.value){case this._DATA_TYPE.TEAM:return"Export Team";case this._DATA_TYPE.TAG_COLLECTIONS:var e=this.tagCollectionsCheckboxGroup.value.length;return"Export ".concat(e," Tag ").concat(1===e?"Collection":"Collections")}}}]),n}(),n2.de.page.settings.exportImport.import.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="No Imports have been recorded on your org",this._contentTemplate="<p>Start by importing an existing export file.</p>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertStartImportButton()}},{key:"_insertStartImportButton",value:function(){return this._insert(new n2.ui.component.Button({id:"start-import",text:"Start Import",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onStartImportButtonClick,scope:this}}))}},{key:"_onStartImportButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}}]),t}(),n2.de.page.settings.exportImport.import.ImportWizard=function(){_inherits(a,n2.de.component.Wizard);var t,e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this.id="import-wizard",this.dataProviders=["start-import"],this._componentCls="n2-de-wizard n2-de-import-wizard",this._header="Import Config",this._buttons={submit:{text:"Import"}},this._stages=[{id:"import-file-selection",label:"Upload import file"},{id:"import-summary",label:"Import file summary"}],this._validateImportResponse=null}},{key:"importFileSelector",get:function(){return this._components["import-file-selector"]}},{key:"importSummary",get:function(){return this._components["import-summary"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).apply(this,arguments),this._insertImportFileSelector(),this._insertImportSummary()}},{key:"_insertImportFileSelector",value:function(){return this._insert(new n2.de.page.settings.exportImport.import.importWizard.FileSelector({id:"import-file-selector",label:"Please select the Distribution Engine configuration file you would like to Import.",accept:["application/json"],multiline:!0,required:!0,listeners:{change:this._onImportFileSelectionChange,scope:this}}))}},{key:"_onImportFileSelectionChange",value:function(e){e.isValid&&!n2.isEmpty(e.value)?this.footer.nextButton.enable():this.footer.nextButton.disable()}},{key:"_insertImportSummary",value:function(){return this._insert(new n2.de.page.settings.exportImport.import.importWizard.Summary({id:"import-summary"}))}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.currentStageId,e.listeners;_get(_getPrototypeOf(a.prototype),"show",this).apply(this,arguments),this._showStageContent({showImportFileSelection:!0}),this.importFileSelector.clear(),this.footer.nextButton.disable()}},{key:"_onNextButtonClick",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,e.prev=1,this.importFileSelector.clearInvalid(),n.spinner(!0),e.next=5,this._fetchDataProvider("validate-import",{params:[this.importFileSelector.fileContents],silent:!0});case 5:i=e.sent,this._validateImportResponse=i.response,n.spinner(!1),_get(_getPrototypeOf(a.prototype),"_onNextButtonClick",this).apply(this,s),this._validateImportResponse.isValidImportVersion?this._validateImportResponse.hasValidationErrors?this.footer.submitButton.disable():this.footer.submitButton.enable():(this.footer.submitButton.disable(),n.spinner(!1),i="Invalid DE package version for migration to this org. Exported from version: ".concat(this._validateImportResponse.exportVersion,". Current version: ").concat(this._validateImportResponse.currentVersion),this.importFileSelector.markInvalid(i)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.spinner(!1),this.importFileSelector.markInvalid("The provided file does not contain a valid Distribution Engine export, please perform your export again");case 12:case"end":return e.stop()}},e,this,[[1,9]])})),function(e){return t.apply(this,arguments)})},{key:"_onStageChange",value:function(e){switch(_get(_getPrototypeOf(a.prototype),"_onStageChange",this).call(this,e),e.target.currentStageId){case"import-file-selection":this.importFileSelector.clear(),this._showStageContent({showImportFileSelection:!0});break;case"import-summary":this._refresh({importSummary:!0}),this._showStageContent({showImportSummary:!0})}}},{key:"_showStageContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.showImportFileSelection,e=e.showImportSummary,e=void 0!==e&&e;this.importFileSelector.hidden=!(void 0!==t&&t),this.importSummary.hidden=!e}},{key:"_onWizardSubmit",value:function(){_get(_getPrototypeOf(a.prototype),"_onWizardSubmit",this).apply(this,arguments),this._postDataProvider("start-import",{params:[this.importFileSelector.fileContents]})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.importSummary,t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshImportSummary()}},{key:"_refreshImportSummary",value:function(){this.importSummary.filename=this.importFileSelector.files[0].name,this.importSummary.model=this._validateImportResponse}}]),a}(),n2.de.page.settings.licensedUsers.licensedUsersRecordList.DataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._cls="n2-licensed-users-table",this._sortBy={column:1,direction:"asc"},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no licensed users that match your filters",content:""}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",cell:{cellTemplate:"",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",sortable:!0,sort:{bindPath:".nameSort"},bindPath:"name"},{header:"Managed Package License",sortable:!0,bindPath:"isManagedPackageLicense",cell:{dataAdapter:function(e){return t._getBooleanCellContent(e)}}},{header:"Team Member",sortable:!0,bindPath:"isTeamMember",cell:{dataAdapter:function(e){return t._getBooleanCellContent(e)}}}]}},{key:"_getBooleanCellContent",value:function(e){return e?"Yes":{html:"<span>&mdash;</span>"}}},{key:"_createRow",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return t.data.userIsActive||(t.cls="n2_inactive"),t}}]),n}(),n2.de.page.settings.licensedUsers.licensedUsersRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.settings.licensedUsers.licensedUsersRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Find name"}),this._insertMenu()}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",cls:"n2_menu",options:[{id:"export-licensed-users",label:"Export"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"clear",value:function(){this.quickFilter.clear()}}]),t}(),n2.de.page.tags.component.field.TagPillList=function(){_inherits(n,n2.ui.component.field.PillList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-tag-pill-list",this.delimiter=n2.ui.enum.Key.COMMA,this._maxPillLength=80,this._max=1e3,this._existingTagNames=null}},{key:"existingTagNames",set:function(e){n2.compare(e,this._existingTagNames)||(this._existingTagNames=e,this._refresh({existingTagNames:!0}))}},{key:"_addEditablePillList",value:function(){var n=this;return this.insert(new n2.de.page.tags.component.field.tagPillList.EditableTagPillList({id:"editable-pills",cls:"slds-pill_container slds-is-relative",renderTo:{target:".slds-form-element__control",position:"afterbegin"},delimiter:this.delimiter,pills:this._value,minHeight:this.minHeight,min:0,max:this._max,maxPillLength:this._maxPillLength,disabled:this._disabled,existingTagNames:this._existingTagNames,listeners:{duplicateFilterStart:function(){n._setDuplicateMessage("")},duplicatesFound:function(e,t){n._setDuplicateMessage('The following items were not added as they already exist: "'+t.join('", "')+'"')},remove:function(e,t){n._setDuplicateMessage(""),n._onChange(),n.fire("pillRemove",n,t)},add:function(e,t){n.validate(),n._onChange(),n.fire("pillAdd",n,t)}}}))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_get(_getPrototypeOf(n.prototype),"_refresh",this).apply(this,arguments),e.existingTagNames),t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshExistingTagNames()}},{key:"_refreshExistingTagNames",value:function(){this._max=1e3-this._existingTagNames.length,this.editablePillList.max=this._max,this.editablePillList.existingTagNames=this._existingTagNames}},{key:"_setDuplicateMessage",value:function(e){this.clearInvalid(),_get(_getPrototypeOf(n.prototype),"_setDuplicateMessage",this).apply(this,arguments)}},{key:"clear",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.validate,e.silent,e.sync;_get(_getPrototypeOf(n.prototype),"clear",this).apply(this,arguments),this._setDuplicateMessage("")}}]),n}(),n2.de.page.tags.tagAssignmentList.modifyAssignments.Toolbar=function(){_inherits(t,n2.de.component.tags.modifyTagAssignments.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"TagCollectionFilterClass",get:function(){return n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TagCollectionFilterCombo}}]),t}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.DataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._selectable=!0,this._cls="n2-tag-assignment-table",this._sortBy={column:1,direction:"asc"},this._rowClass=n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.dataTable.Row,this._emptyState={type:n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.dataTable.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no team members that match your filters",content:""}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_generateColumnDefinitions",value:function(){return[{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",sort:{bindPath:".nameSort"},sortable:!0,cell:{cellTemplate:"",cls:"n2_tag-user",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",cls:"n2_user",bindPath:"name",sort:{bindPath:".nameSort"},sortable:!0},{header:"Tags",cell:{cellTemplate:"",components:[{id:"tags-pill-list",type:n2.de.component.tags.AssignedTagsPillList,mixins:[n2.mixin.DataDriven],context:n2.de.page.tags.tagAssignmentList.Context,pills:{bindPath:".tags",adapter:function(e){return e.map(function(e){return{text:"".concat(e.collectionName,"/").concat(e.tagName),value:"".concat(e.collectionId,"_").concat(e.tagId)}})}}}]}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_action-menu",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"tag-assignment-row-menu",mixins:[n2.mixin.DataDriven],options:[{id:"clone-tag-assignments",label:"Clone"}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_onMenuLoaded",value:function(e,t){n2.isEmpty(t.tags)&&(e.hidden=!0)}}]),n}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._hidden=!1}},{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"teamFilter",get:function(){return this.components["team-filter"]}},{key:"tagCollectionFilter",get:function(){return this.components["tag-collection-filter"]}},{key:"tagFilter",get:function(){return this.components["tag-filter"]}},{key:"hideTagFilter",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.tagFilter.hidden!==e&&(this.tagFilter.hidden=e)}},{key:"reloadTagFilter",value:function(e){this.tagFilter.clear(),this.hideTagFilter(!1),this.tagFilter.loadOptions(e)}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Find name"}),this._insertMenu(),this._insertTeamFilter(),this._insertTagCollectionFilter(),this._insertTagFilter()}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",cls:"n2_menu",options:[{id:"change-history",label:"Change History"},{id:"modify-assignments",label:"Modify"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"_insertTeamFilter",value:function(){return this.insert(new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TeamFilterCombo({id:"team-filter",cls:"n2_team-filter",options:[],renderTo:this.SELECTORS.left,listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertTagCollectionFilter",value:function(){return this.insert(new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TagCollectionFilterCombo({id:"tag-collection-filter",options:[],renderTo:this.SELECTORS.left,listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertTagFilter",value:function(){return this.insert(new n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TagFilterCombo({id:"tag-filter",cls:"n2_tag-filter",multiple:!0,options:[],hidden:!0,renderTo:this.SELECTORS.left,listeners:{change:this._handleFilter,scope:this}}))}},{key:"clear",value:function(){this.quickFilter.clear(),this.teamFilter.clear(),this.tagCollectionFilter.clear(),this.tagFilter.clear(),this.hideTagFilter()}},{key:"hideFilters",value:function(e){this.quickFilter.hidden=e,this.teamFilter.hidden=e,this.tagCollectionFilter.hidden=e,this.hideTagFilter(),this.menu.components["modify-assignments"].hidden=e}}]),t}(),n2.de.page.tags.tagCollectionList.tagCollectionRecordList.DataTable=function(){_inherits(i,n2.de.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._selectable=!0,this._cls="n2-tag-collections-table",this._sortBy={column:0,direction:"asc"},this._emptyState={type:n2.de.page.tags.tagCollectionList.tagCollectionRecordList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no tag collections that match your filters",content:""}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Name",sortable:!0,sort:{bindPath:".name"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"tag-link",type:n2.de.component.Link,mixins:[n2.mixin.DataDriven],text:{bindPath:".name"},title:{bindPath:".name"},listeners:{click:this._onOpenTagLink,scope:this}}]}},{header:"Users",bindPath:"assignedUsersCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"User")}}},{header:"Distributors",cell:{dataAdapter:function(e){e=e.isTerritoryCollection?null:e.distributorsCount;return t._getCellContent(e,"Distributor")}}},{header:"Caps",cell:{dataAdapter:function(e){e=e.isTerritoryCollection?null:e.teamCapsCount;return t._getCellContent(e,"Team")}}},{header:"Weighting",cell:{dataAdapter:function(e){e=e.isTerritoryCollection?null:e.teamWeightingCount;return t._getCellContent(e,"Team")}}},{header:"Tags",bindPath:"tagsCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"Tag")}}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"tag-collection-menu",mixins:[n2.mixin.DataDriven],options:[{id:"rename-tag-collection",label:"Rename"},{id:"delete-tag-collection",label:"Delete",hidden:!0}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_onMenuLoaded",value:function(e,t){this._inActiveData(t)&&(e.components["delete-tag-collection"].hidden=!1)}},{key:"_inActiveData",value:function(e){return!e.isTerritoryCollection&&0===e.distributorsCount&&0===e.teamCapsCount&&0===e.teamWeightingCount}},{key:"_createRow",value:function(e){var t=_get(_getPrototypeOf(i.prototype),"_createRow",this).call(this,e),e=(t.components["menu-cell"].hidden=e.data.isTerritoryCollection,this._inActiveData(e.data)),n=t.components["td-selectable"].components["selectable-checkbox"];return t.disabled=!e,n.disabled=!e,n.label.text=e?"Select":"Cannot select tag collections which are in use",t}},{key:"_onOpenTagLink",value:function(e){var t=e.event,e=e.target;t.stopPropagation(),n2.de.page.Navigation.getInstance().open("Tags_TagValueList","tagCollectionId=".concat(e.model.id))}},{key:"_getCellContent",value:function(e,t){return n2.isNull(e)?"":e?"".concat(e," ").concat(1===e?t:"".concat(t,"s")):{html:"<span>&mdash;</span>"}}}]),i}(),n2.de.page.tags.tagCollectionList.tagCollectionRecordList.EmptyState=function(){_inherits(t,n2.de.component.recordList.AbstractEmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._buttonText="Tag Collection",this._heading="You dont have any Tag Collections yet.",this._contentTemplate='<p class="slds-text-body_regular">\n            Distribution tags enable you to define attributes of your team members (e.g. Languages Spoken) which allow you to route incoming records accordingly. Create your first tag collection to get started.\n        </p>'}}]),t}(),n2.de.page.tags.tagCollectionList.tagCollectionRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.tags.tagCollectionList.tagCollectionRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Find name"}),this._insertAddButton({text:"Tag Collection"}),this._insertMenu()}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",disabled:!0,cls:"n2_menu",options:[{id:"delete-tag-collections",label:"Delete"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"clear",value:function(){this.quickFilter.clear()}}]),t}(),n2.de.page.tags.tagValueList.tagValueRecordList.DataTable=function(){_inherits(i,n2.de.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._cls="n2-tag-value-table",this._sortBy={column:0,direction:"asc"},this._selectable=!0,this._emptyState={type:n2.de.page.tags.tagValueList.tagValueRecordList.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no tags that match your filters",content:""}}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_generateColumnDefinitions",value:function(){var t=this;return[{header:"Name",sortable:!0,bindPath:"name",sort:{bindPath:".name"},cell:{dataAdapter:function(e){return t._getNameCellContent(e)}}},{header:"Users",bindPath:"assignedUsersCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"User")}}},{header:"Distributors",bindPath:"distributorsCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"Distributor")}}},{header:"Caps",bindPath:"teamCapsCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"Team")}}},{header:"Weighting",bindPath:"teamWeightingCount",cell:{dataAdapter:function(e){return t._getCellContent(e,"Team")}}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}]}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"tag-value-menu",mixins:[n2.mixin.DataDriven],options:[{id:"rename-tag",label:"Rename"},{id:"delete-tag",label:"Delete",hidden:!0}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_onMenuLoaded",value:function(e,t){this._selectable?this._inActiveData(t)&&(e.components["delete-tag"].hidden=!1):e.hidden=!0}},{key:"_inActiveData",value:function(e){return 0===e.distributorsCount&&0===e.teamCapsCount&&0===e.teamWeightingCount}},{key:"_createRow",value:function(e){var t,n=_get(_getPrototypeOf(i.prototype),"_createRow",this).call(this,e);return this._selectable&&(e=this._inActiveData(e.data),t=n.components["td-selectable"].components["selectable-checkbox"],n.disabled=!e,t.disabled=!e,t.label.text=e?"Select":"Cannot select tags which are in use"),n}},{key:"_getCellContent",value:function(e,t){return e?"".concat(e," ").concat(1===e?t:"".concat(t,"s")):{html:"<span>&mdash;</span>"}}},{key:"_getNameCellContent",value:function(e){return 0<e.length?"".concat(e):{html:"<i>Blank</i>"}}}]),i}(),n2.de.page.tags.tagValueList.tagValueRecordList.EmptyState=function(){_inherits(t,n2.de.component.recordList.AbstractEmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._buttonText="Tags",this._heading="You dont have any Tags in this collection yet.",this._contentTemplate='<p class="slds-text-body_regular">\n            Distribution tags enable you to define attributes of your team members (e.g. Languages Spoken) which allow you to route incoming records accordingly. Create your first tag to get started.\n        </p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddSplitButton({text:"Tags",menuOptions:this._getMenuOptions()})}},{key:"_getMenuOptions",value:function(){var e=[];return n2.de.page.tags.tagValueList.Context.getInstance().hasTeams&&e.push({id:"add-tag-from-field",label:"Add Tags From Field"}),e}},{key:"_canInsertAddButton",value:function(){return!1}}]),t}(),n2.de.page.tags.tagValueList.tagValueRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.tags.tagValueList.tagValueRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.page.tags.tagValueList.Context.getInstance().listen("change",this._handleLimitChange,this)}},{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Find name"}),this._insertAddSplitButton({text:"Tags",menuOptions:this._getMenuOptions()}),this._insertMenu()}},{key:"_getMenuOptions",value:function(){var e=[];return n2.de.page.tags.tagValueList.Context.getInstance().hasTeams&&e.push({id:"add-tag-from-field",label:"Add Tags From Field"}),e}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",disabled:!0,cls:"n2_menu",options:[{id:"delete-tags",label:"Delete"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"_handleLimitChange",value:function(e){e=e.data.tagLimitReached;this.addNewSplitButton.disabled=e,this.addNewSplitButton.title=e?"This collection contains the maximum number of tags":""}},{key:"clear",value:function(){this.quickFilter.clear()}}]),t}(),n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionDataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._cls="n2-de-assignment-rejection-data-table",this._HEADERS={distributor:"Distributor",type:"Type",order:"Order",rejectionEnabled:"Rejection",rejectTo:"Reject to",fieldToUpdate:"Fields to update"},this.columns=[{header:this._HEADERS.distributor,bindPath:"name"},{header:this._HEADERS.type,cls:"n2_type-column",bindPath:"distributorType"},{header:this._HEADERS.order,cls:"n2_order-column",bindPath:"order",cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.rejectionEnabled,cell:{dataAdapter:function(e){return e.rejectionEnabled?"Yes":{html:"<span>&mdash;</span>"}}}},{header:this._HEADERS.rejectTo,cell:{dataAdapter:function(e){return e.rejectionEnabled&&!n2.isUndefined(e.rejectToLabel)?e.rejectToLabel:{html:"<span>&mdash;</span>"}}}},{header:this._HEADERS.fieldToUpdate,cell:{cellTemplate:"",type:n2.ui.component.dataTable.Cell,components:[{id:"distributor-field-update-label",cls:"n2-de-summary",mixins:[n2.mixin.DataDriven],type:n2.de.component.MultiFieldUpdateLabel}]}}]}},{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(n.prototype),"_addHeaderRow",this).apply(this,arguments);var t=[this._HEADERS.order];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_createRow",value:function(){var e=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return e.data.isActive||(e.cls="n2_inactive"),e}}]),n}(),n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionForm=function(){_inherits(s,n2.de.component.Form);var n,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-distributor-assignment-rejection-settings"],this._componentCls="".concat(this._componentCls," n2-de-assignment-rejection-form")}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertAssignmentRejectionSettings()}},{key:"_insertAssignmentRejectionSettings",value:function(){return this._insert(new n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionSettings({id:"assignment-rejection-settings",cls:"n2-de-assignment-rejection-settings slds-p-horizontal_medium slds-p-vertical_small n2_small-heading"}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(s.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-assignment-rejection-form")}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&(this._model=t,this._components["assignment-rejection-settings"].model=t);case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_showFooter",value:function(){this._components["save-footer"].message="",this._components["save-footer"].hidden=!1}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(s.prototype),"_onSubmit",this).apply(this,arguments);var e=this._model.json;delete e.objectName,delete e.supportsQueue,delete e.isPersonAccounts,n2.DataProviderManager.getInstance().get("save-distributor-assignment-rejection-settings").post({params:[e]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(s.prototype),"_onSaved",this).apply(this,arguments),this._loadDistributorAssignmentRejection({force:!0})}},{key:"_onCancel",value:function(){this._loadDistributorAssignmentRejection({force:!0})}},{key:"_loadDistributorAssignmentRejection",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-assignment-rejection-details").get({params:[n],force:t,silent:e})}}]),s}(),n2.de.page.team.assignmentRejection.distributorLevelRejection.AssignmentRejectionSettings=function(){_inherits(s,n2.de.component.form.FieldGroup);var n,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Enable Assignment rejection",this._toggleActive=!0,this._helpText={text:"Switch assignment rejection on or off at the Distributor level",position:n2.ui.enum.Position.BELOW}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertUserOrQueueFieldGroup(),this._insertFieldToUpdate(),this._insertReplaceRejectedRecords(),this._insertReplaceRejectedRecordsDropDown(),this._insertRemoveSticky()}},{key:"_insertUserOrQueueFieldGroup",value:function(){return this._insert(new n2.de.component.field.UserOrQueueField({id:"reject-to",mixins:[n2.mixin.DataDriven],helpText:{text:"When rejected, assignments will be reassigned to a queue or a user",position:n2.ui.enum.Position.BELOW},label:"Reject to",required:!0,cls:"slds-m-vertical_medium",allowNoneOption:!1,teamId:n2.de.page.team.Context.getInstance().teamId,modalParent:".n2_container"}))}},{key:"_insertFieldToUpdate",value:function(){return this._insert(new n2.de.component.form.updateFields.UpdateFields({id:"fields-to-update",cls:"slds-p-horizontal_medium slds-p-vertical_small n2_small-heading",heading:"Update fields on Rejection",helpText:"Optionally update chosen fields with new values on rejection"}))}},{key:"_insertReplaceRejectedRecords",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"replace-rejected-records",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium slds-p-top_xx-small",label:"Replace rejected records",value:{bindPath:".replaceRejectedRecords"}}))}},{key:"_insertReplaceRejectedRecordsDropDown",value:function(){return this.insert(new n2.ui.component.field.Combo({id:"replace-rejected-records-options",mixins:[n2.mixin.DataDriven],cls:"n2_replace-rejected-records-combo slds-m-bottom_medium slds-p-top_xx-small",dataProviders:["get-replace-rejected-records-options"],label:{text:"Replace rejected records"},options:{bindPath:"get-replace-rejected-records-options"},required:!0,sort:!1,hidden:!0,value:{bindPath:".replaceRejectedRecordsOption"}}))}},{key:"_insertRemoveSticky",value:function(){return this.insert(new n2.ui.component.field.Combo({id:"remove-sticky",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium slds-p-top_xx-small",label:{text:"Remove sticky from rejected records"},options:["Always","New sticky only","Never"],required:!0,sort:!1,hidden:!0,value:{bindPath:".removeStickyFromRejected"}}))}},{key:"_getRejectedRecordReplacementOptions",value:function(){n2.DataProviderManager.getInstance().get("get-replace-rejected-records-options").get({params:[],force:!1,silent:!1})}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&(this._model=t,this._getRejectedRecordReplacementOptions(),this._components["toggle-active"].value={value:t.get("rejectionEnabled"),silent:!0},this._components["reject-to"].model=this._getUserOrQueueModel(),this._components["fields-to-update"].model=this._getUpdateFieldsModel(),this._components["replace-rejected-records"].model=t,this._components["replace-rejected-records-options"].model=t,this._components["remove-sticky"].model=t,this._showFields());case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("rejectionEnabled").value=e.value,this._showFields()}},{key:"_showFields",value:function(){var e=this._model.get("rejectionEnabled"),t=this._model.get("isRoundRobin");this._components["reject-to"].hidden=!e,this._components["fields-to-update"].hidden=!e,e?(this._components["replace-rejected-records"].hidden=t,this._components["replace-rejected-records-options"].hidden=!t):(this._components["replace-rejected-records"].hidden=!e,this._components["replace-rejected-records-options"].hidden=!e),this._components["remove-sticky"].hidden=!e||!this._model.get("isSticky")}},{key:"_getUserOrQueueModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("objectName"),{key:"objectName"}),e.insert(this._model.getProperty("supportsQueue"),{key:"supportsQueues"}),e.insert(this._model.getProperty("rejectToType",{defaultValue:this._model.get("supportsQueue")?"Queue":"User"}),{key:"selectionType"}),e.insert(this._model.getProperty("rejectTo",{defaultValue:""}),{key:"selectedId"}),e.insert(this._model.getProperty("rejectToLabel",{defaultValue:""}),{key:"selectedName"}),e}},{key:"_getUpdateFieldsModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("fieldUpdateEnabled",{defaultValue:!1}),{key:"isEnabled"}),e.insert(this._model.getProperty("fieldUpdateConfig",{defaultValue:{fields:[]}}),{key:"fieldUpdateConfig"}),e.insert(this._model.getProperty("objectName"),{key:"objectName"}),e.insert(this._model.getProperty("isPersonAccounts"),{key:"isPersonAccounts"}),e}}]),s}(),n2.de.page.team.assignmentRejection.distributorLevelRejection.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any distributors yet",this._contentTemplate='<p>Assignment rejection allows team members to reject assignments and receive replacements. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddDistributorButton()}},{key:"_insertAddDistributorButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"add-distributor",renderTo:this.SELECTORS.linkContainer,text:"Add your first distributor",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddDistributorClick(e)}}}))}},{key:"_onAddDistributorClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t))}}]),t}(),n2.de.page.team.availability.availabilityRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-availability-record-list-toolbar"),this._filterOptionsData=null,this._hidden=!1,this._REFRESH=n2.merge({filterOptionsData:["teamMemberFilter","tagFilter"]})}},{key:"filterOptionsData",set:function(e){this._setProperty("filterOptionsData",e,{sync:!1})}},{key:"teamMemberFilter",get:function(){return this._components["team-member-filter"]}},{key:"tagFilter",get:function(){return this._components["tag-filter"]}},{key:"_insertComponents",value:function(){this._insertTeamMemberFilter(),this._insertTagFilter()}},{key:"_insertTeamMemberFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"team-member-filter",renderTo:this.SELECTORS.left,label:{text:"Team member",hidden:!0},placeholder:"All team members",multiple:!0,options:[],listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertTagFilter",value:function(){return this._insert(new n2.de.component.field.TagPicker({id:"tag-filter",renderTo:this.SELECTORS.left,label:{text:"Tag",hidden:!0},listeners:{change:this._handleFilter,scope:this}}))}},{key:"_handleFilter",value:function(e){if(e instanceof n2.ui.Component)return _get(_getPrototypeOf(t.prototype),"_handleFilter",this).apply(this,arguments);"tag-filter"===e.target.id&&(e.data.actions=["filter"])}},{key:"_refreshTeamMemberFilter",value:function(){var e=this._filterOptionsData.teamMembers;this.teamMemberFilter.options=e,this.teamMemberFilter.disabled=n2.isEmpty(e)}},{key:"_refreshTagFilter",value:function(){this.tagFilter.setProperties({tagCollections:this._filterOptionsData.tagCollections,tagMap:this._filterOptionsData.tagMap}),this.tagFilter.disabled=n2.isEmpty(this._filterOptionsData.tagCollections)||n2.isEmpty(this._filterOptionsData.tagMap)}},{key:"clear",value:function(){this.teamMemberFilter.clear(),this.tagFilter.clear()}}]),t}(),n2.de.page.team.distributionHours.teamHolidayRegion.EmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="You don't have any holiday regions setup yet.",this._contentTemplate='<p>{{content}}{{#isAdminOrSystemManager}} Go to the <span class="n2_link-container"></span> page to set these up.</p>{{/isAdminOrSystemManager}}',this._content="Your team can opt into a regional holiday calendar to shut the team down on certain days that you choose e.g. Christmas, public holidays etc."}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertDistributionHolidaysButton()}},{key:"_insertDistributionHolidaysButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"distribution-holidays",renderTo:this.SELECTORS.linkContainer,text:"Distribution Holidays",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onDistributionHolidaysClick(e)}}}))}},{key:"_onDistributionHolidaysClick",value:function(e){n2.de.page.Navigation.getInstance().open("Availability_Holidays")}}]),t}(),n2.de.page.team.distributionHours.teamMemberHours.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any team members yet",this._contentTemplate='<p>Team member hours allow you to set working hours for each team member individually. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddTeamMemberButton()}},{key:"_insertAddTeamMemberButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-team-member",renderTo:this.SELECTORS.linkContainer,text:"Add team members",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTeamMemberClick(e)}}}))}},{key:"_onAddTeamMemberClick",value:function(e){var t=n2.de.page.team.distributionHours.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t))}}]),t}(),n2.de.page.team.distributionHours.teamMemberHours.MemberHours=function(){_inherits(s,n2.ui.Component);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-team-member-hours"],this._cachedTeamMember=null,this._lazyLoad=!0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this),this._insertTeamMembersTable()}},{key:"show",value:function(){_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),this.reload()}},{key:"hide",value:function(){_get(_getPrototypeOf(s.prototype),"hide",this).apply(this,arguments),n2.de.page.SlideOutPanel.getInstance().hide()}},{key:"reload",value:function(){this._load({force:!0})}},{key:"_load",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=(_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,arguments),n2.de.page.team.distributionHours.Context.getInstance().teamId);n2.DataProviderManager.getInstance().get("get-team-member-hours").get({params:[n],force:t,silent:e})}},{key:"_insertTeamMembersTable",value:function(){var i=this;return this._insert(new n2.de.component.DataTable({id:"team-members",columns:this._buildColumns(),emptyState:{type:n2.de.page.team.distributionHours.teamMemberHours.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){i.fire("click",{target:i,data:{types:["clearFilters"]}})}}}},listeners:{click:function(e,t,n){return i._onTeamMemberClick(t.data)}}}))}},{key:"_onTeamMemberClick",value:function(e){this._cachedTeamMember=e,this._showSlideOutPanel(e)}},{key:"_buildColumns",value:function(){return[{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",cell:{cellTemplate:"",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",bindPath:".name"},{header:"Hours",bindPath:".shiftHoursLabel"}]}},{key:"_showSlideOutPanel",value:function(e){var i=this,e=new n2.dataProvider.Model({value:e});n2.de.page.SlideOutPanel.getInstance().show({heading:e.get("name"),components:[new n2.de.page.team.distributionHours.teamMemberHours.memberHours.MemberHoursForm({id:"member-hours-form",model:e,listeners:{saved:function(e,t,n){return i._onTeamMemberSaved()}}})]})}},{key:"_onTeamMemberSaved",value:function(){this._load({force:!0})}},{key:"_onLoaded",value:function(e,t){var n,i;_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)||"get-team-member-hours"!==t.id||(n=1===(e=(t=(this._model=e).get("teamMembers")).length)?"team member":"team members",(i=this._components["team-members"]).emptyFilteredState=n2.merge(i.emptyFilteredState,{heading:"There are no team members that match your filters",content:"We looked through ".concat(e," ").concat(n,", but none of them match your filters. You can change your terms, or clear them to see all team members.")}),i.data=t,this._styleInactiveRows(),n2.de.page.SlideOutPanel.getInstance().hidden)||(n2.de.page.SlideOutPanel.getInstance().components["member-hours-form"].model=this._getTeamMemberModel(this._cachedTeamMember.id))}},{key:"_styleInactiveRows",value:function(){this._components["team-members"].forEachRow(function(e){e.data.isActiveForDistribution||(e.cls="n2_inactive")})}},{key:"_getTeamMemberModel",value:function(t){var e=this._model.get("teamMembers").find(function(e){return e.id===t});return new n2.dataProvider.Model({value:e})}},{key:"filter",value:function(e,t){n2.isNull(t)?this._components["team-members"].removeFilters([e]):("activeFilter"===e&&(t.dataBindings=["isActiveForDistribution"]),this._components["team-members"].addFilter(e,t))}}]),s}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftDataManager={_characters:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","-"],_shiftNames:null,_teamShiftName:"Team hours",_shiftColours:null,_startDate:null,_endDate:null,_currentDate:null,getShiftData:function(e,t){var n=this;return this._reset(t),e.map(function(e){var t=n2.merge({dirty:!1},e),e=n._getShifts(e.shifts);return t.shifts=e.map(function(e,t){return e.shiftIndex=t,e}),t})},_getShifts:function(e){var n=this,t=[];return this._prefillShifts(e[0],t),e.reduce(function(e,t){t=n._getShiftsFromShiftBlock(t);return[].concat(_toConsumableArray(e),_toConsumableArray(t))},t)},_prefillShifts:function(e,t){for(var n=new Date(e.startDate),i=this._startDate,s=0;n2.isLaterThan(n,i)&&s<4;)t.push({id:null,deleteBlock:null,shiftId:"unusedId",shiftName:"N/A",shiftColour:"#fcfcfc",isActive:!1,dirty:!1}),i=n2.modifyDate(i,7),s+=1;return t},_getShiftsFromShiftBlock:function(e){var t=e.shiftId||null,n=this._getShiftName(t),i=n2.de.util.Date.getDateAsUTC(new Date(e.startDate)),i=n2.isLaterThan(i,this._startDate)?i:this._startDate,t={shiftId:t,id:e.id,dirty:!1,initialEndDate:e.endDate||null,initialStartDate:e.startDate,shiftName:n,shiftColour:this._getShiftColour(n),deleteBlock:null};return this._expandShiftBlock(e,t,i)},_expandShiftBlock:function(e,t,n){var i=n2.isNull(t.initialEndDate)?this._endDate:t.initialEndDate,i=new Date(i);return this._fillShifts(t,n,i)},_fillShifts:function(e,t,n){for(var i=[],s=t;n2.isEarlierThan(s,n);){var a=n2.isLaterThan(s,this._currentDate)||n2.isDateEqual(s,this._currentDate);i.push(n2.merge({},e,{isActive:a})),s=n2.modifyDate(s,7)}return i},_getShiftColour:function(e){var t,n;return this._shiftColours[e]||(t=0,this._getShiftCharacters(e).forEach(function(e){t=e.toLowerCase().charCodeAt(0)+((t<<5)-t)}),n="hsl(".concat(t%=360,", 60%, 60%)"),this._shiftColours[e]=n)},_getShiftCharacters:function(e){for(var t=e.split(""),n=_toConsumableArray(t);t.length<24;)t=[].concat(_toConsumableArray(n=this._getNewCharacters(n)),_toConsumableArray(t));return t},_getNewCharacters:function(e){var t=this,n=e.length;return e.map(function(e){e=t._characters.indexOf(e.toLowerCase()),e=36<(e=0<=e?e:n)+1?0:e+1;return t._characters[e]})},_getShiftNames:function(e){var t={};return e.forEach(function(e){t[e.value]=e.label}),t},_getShiftName:function(e){return n2.isNull(e)?this._teamShiftName:this._shiftNames[e]||"Individual hours"},_reset:function(e){this._shiftNames=this._getShiftNames(e.shiftNameList),this._teamShiftName=e.teamShiftName,this._shiftColours={},this._startDate=e.startDate,this._endDate=e.endDate,this._currentDate=e.currentDate},updateMemberShifts:function(e,t){var n=e.shifts,e=(delete e.shifts,n2.merge(e,{dirty:!0}));return e.shifts=this._updateShifts(n,t),e},_updateShifts:function(e,t){var n=this._updatePreviousShifts(e,t),e=this._updateNextShifts(e,t);return[].concat(_toConsumableArray(n),_toConsumableArray(e))},_updatePreviousShifts:function(e,t){for(var n=t.shiftId,i=t.position,t=t.previousShiftId,s=i-1,a=!0,o=[],r=e[s],l=r.shiftId===n?n:t;0<=s;)(a=a&&r.shiftId===l)&&(r=n2.merge(r,{dirty:!0})),o.unshift(r),r=e[--s];return o},_updateNextShifts:function(e,t){for(var n=t.shiftId,i=t.position,s=t.previousShiftId,a=e.length,o=i,r=e[i-1],l=r.shiftId===s,c=r.shiftId===n,u=this._getUpdatedShiftValue(n),d=[],h=!0;o<a;){if((m=e[o]).shiftId===s&&h)var p=m.id,p=(i===o&&c&&(p=r.id,m.deleteBlock=this._getDeleteBlock(m)),l?null:p),m=n2.merge(m,u,{id:p});else{if(m.shiftId!==n)break;h=!1,e[o-1].shiftId===s&&(m.deleteBlock=this._getDeleteBlock(m)),m=n2.merge(m,{dirty:!0,id:r.id})}d.push(m),o+=1}t=e.slice(o);return[].concat(d,_toConsumableArray(t))},_getDeleteBlock:function(e){return{id:e.id,shiftId:e.shiftId,deleteBlock:!0,startDate:e.initialStartDate,endDate:e.initialEndDate}},_getUpdatedShiftValue:function(e){var t=this._getShiftName(e);return{shiftId:e,shiftName:t,shiftColour:this._getShiftColour(t),dirty:!0}},getShiftBlocks:function(e){e=e.filter(function(e){return e.dirty});return this._getMemberShiftBlocks(e)},_getMemberShiftBlocks:function(e){var t=this;return e.map(function(e){return{user:n2.isUndefined(e.user)?null:e.user,queue:n2.isUndefined(e.queue)?null:e.queue,name:e.name,id:e.id,isActive:e.isActive,shifts:t._getShiftBlocks(e.shifts)}})},_getShiftBlocks:function(e){var n=this,i=[],s=null,a=null,o=null;return e.forEach(function(e,t){e.dirty?(n2.isNull(s)?(s=n._updateStartDate(e,t),a=e.shiftId,o=e.id,15===t&&i.push(n._getEndShiftBlock(s,a,t,o))):a===e.shiftId&&15!==t||(a!==e.shiftId&&(i.push(n._getEndShiftBlock(s,a,t-1,o)),a=e.shiftId,o=e.id,s=n2.modifyDate(n._startDate,7*t),s=n2.de.util.Date.getIsoDateString(s)),15===t&&i.push(n._getEndShiftBlock(s,a,t,o))),n2.isNull(e.deleteBlock)||i.push(e.deleteBlock)):n2.isNull(s)||(i.push(n._getEndShiftBlock(s,a,t-1,o)),s=o=a=null)}),i},_updateStartDate:function(e,t){return t<4?e.initialStartDate:(e=n2.modifyDate(this._startDate,7*t),n2.de.util.Date.getIsoDateString(e))},_getEndShiftBlock:function(e,t,n,i){if(n<2)throw new Error("Cannot update end position (".concat(n,") as it is in the past."));var s=null;return n<15&&(n=n2.modifyDate(this._startDate,7*n+6),s=n2.de.util.Date.getIsoDateString(n)),{id:i,shiftId:t,startDate:e,endDate:s,deleteBlock:!1}}},n2.de.page.team.distributionHours.teamMemberHours.ShiftPlanner=function(){_inherits(r,n2.ui.Component);var t,e,n=_createSuper(r);function r(){return _classCallCheck(this,r),n.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this.SELECTORS=n2.merge(this.SELECTORS,{container:".n2_shift-planner-container"}),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-shift-planner-for-team","get-shift-names"],this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2_shift-planner-container"></div>\n        </div>',this._componentCls="n2-de-shift-planner",this._lazyLoad=!0,this._shiftNames=null,this._shiftDataManager=n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftDataManager,this._currentDate=this._getCurrentDate(),this._startDate=this._getStartDate(),this._endDate=n2.modifyDate(this._currentDate,83),this._updateCount=0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(r.prototype),"_onDefined",this).call(this),this._insertShiftTable(),this._insertSaveFooter()}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(r.prototype),"_prepareDOM",this).call(this),window.addEventListener("resize",this._setHeight.bind(this))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(r.prototype),"_afterRender",this).apply(this,arguments),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftSelector.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root,scrollableDOM:this.element("container"),listeners:{change:this._onShiftChange,scope:this}})}},{key:"_setHeight",value:function(){var e,t;this.hidden||(e=n2.ui.dom.Scope.getInstance().root.rawDOM.getBoundingClientRect(),t=this.element("container").rawDOM.getBoundingClientRect().top,this._dom.style({height:"".concat(e.height+e.top-t-25,"px")}))}},{key:"_onShiftChange",value:function(e){this._components.shifts.changeShift(e.data),this._components["save-footer"].hidden=!1,this._components["save-footer"].message="You have unsaved changes.",n2.de.page.team.distributionHours.Context.getInstance().isDirty=!0,this._updateCount+=1,150<this._updateCount&&this._updateCount%50==0&&n2.ui.component.Toast.getInstance().show({message:"Please save frequently to avoid losing your changes.",theme:n2.ui.enum.Theme.INFO,delay:5e3})}},{key:"show",value:function(){_get(_getPrototypeOf(r.prototype),"show",this).apply(this,arguments),this.reload()}},{key:"reload",value:function(){this.load({force:!0}),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftSelector.getInstance().components["shift-selection"].load()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return this._scrollTo(0),this.spinner(),i=n2.de.page.team.distributionHours.Context.getInstance().teamId,e.next=8,Promise.all([n2.DataProviderManager.getInstance().get("get-shift-names").get({force:t,silent:n}),n2.DataProviderManager.getInstance().get("get-shift-planner-for-team").get({params:[i],force:t,silent:n})]);case 8:return i=e.sent,a=_slicedToArray(i,2),s=a[0],a=a[1],e.abrupt("return",{shiftNames:s,model:a});case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._model=e.model,n2.isEmpty(this._model)||this._setHeight(),this._shiftNames=e.shiftNames,this._onShiftBlocksLoaded()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(r.prototype),"_onLoaded",this).apply(this,arguments),"get-shift-planner-for-team"===t.id&&(this._model=e,this._onShiftBlocksLoaded())}},{key:"_onShiftBlocksLoaded",value:function(){this._model.isCloneInProgress?(this._components.shifts.isCloneInProgress=!0,this._components.shifts.data=[]):(this._components.shifts.isCloneInProgress=!1,this._components.shifts.data=this._shiftDataManager.getShiftData(this._model.teamMemberShifts,{shiftNameList:this._shiftNames,teamShiftName:this._model.teamShiftName,startDate:this._startDate,endDate:this._endDate,currentDate:this._currentDate}),this._scrollTo(480),this.spinner(!1),this._resetState())}},{key:"_resetState",value:function(){this._components["save-footer"].hidden=!0,n2.de.page.team.distributionHours.Context.getInstance().isDirty=!1,this._updateCount=0}},{key:"_insertSaveFooter",value:function(){var t=this;this._insert(new n2.de.component.form.Footer({id:"save-footer",hidden:!0,listeners:{cancel:function(e){return t._onCancel(e)},submit:function(e){return t._onSubmit(e)}}}))}},{key:"_insertShiftTable",value:function(){var e=this;return this._insert(new n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.DataTable({id:"shifts",cls:"n2-shift-planner-table",columns:this._buildColumns(),renderTo:this.SELECTORS.container,emptyState:{type:n2.de.page.team.distributionHours.teamMemberHours.EmptyState},emptyFilteredState:{illustration:n2.ui.component.illustration.FishingDeals,button:{id:"clear-filters",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){e.fire("click",{target:e,data:{types:["clearFilters"]}})}}}},mergeCells:!0}))}},{key:"_buildColumns",value:function(){for(var e=[{header:{data:"Member",hidden:!0},cls:"n2_member",sort:{bindPath:".nameSort"},cell:{cellTemplate:"",cls:"n2_shift-member",type:n2.ui.component.dataTable.Cell,components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}},{id:"name",mixins:[n2.mixin.DataDriven],type:n2.ui.component.HTML,template:'<span class="n2_member-name slds-truncate" title="{{model.name}}">{{model.name}}</span>'}]}}],t=this._startDate,n=0;t<this._endDate;){var i=n2.isDateEqual(t,this._currentDate),s=n2.isEarlierThan(t,this._currentDate),s="".concat(i?"n2_highlight":"").concat(s?"n2_inactive-date":""),i="".concat(i?"n2_cell-current-date":"");e.push({header:{cellTemplate:'<div class="n2_shift-date">\n                        <div class="slds-text-title_bold">'.concat(n2.getMonth(t,{short:!0})," ").concat(t.getDate(),'</div>\n                        <div class="n2_shift-day">').concat(n2.getDay(t,{short:!0}),"</div>\n                    </div>"),cls:s},cls:n2.isDateEqual(t,this._currentDate)?"n2_current-date":"",bindPath:".shifts[".concat(n,"]"),cell:{type:n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.Cell,cls:i}}),t=n2.modifyDate(t,7),n+=1}return e}},{key:"_getCurrentDate",value:function(){var e=new Date,t=e.getDay(),t=t?-1*(t-1):-6;return n2.modifyDate(e,t)}},{key:"_getStartDate",value:function(){return n2.modifyDate(this._currentDate,-28)}},{key:"_scrollTo",value:function(e){this.element("container").rawDOM.scrollTo({left:e})}},{key:"filter",value:function(e,t){n2.isNull(t)?this._components.shifts.removeFilters([e]):(t.dataBindings="activeFilter"===e?["isActive"]:["name"],this._components.shifts.addFilter(e,t)),this._components.shifts.activeCell=null}},{key:"_onCancel",value:function(e){this._loadShiftPlanner()}},{key:"_onSubmit",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(),n=this._components.shifts.data,n=this._shiftDataManager.getShiftBlocks(n),n={teamId:this._model.teamId,teamMemberShifts:n,teamShiftPlanId:this._model.teamShiftPlanId},e.next=4,this._postDataProvider("save-shift-planner",{params:[n]});case 4:this._loadShiftPlanner();case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_loadShiftPlanner",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0===t||t,e=e.force,e=void 0===e||e,n=(this.spinner(),this._scrollTo(0),n2.de.page.team.distributionHours.Context.getInstance().teamId);this._loadDataProvider("get-shift-planner-for-team",{params:[n],silent:t,force:e})}}]),r}(),n2.de.page.team.distributorList.distributorRecordList.DataTable=function(){_inherits(s,n2.de.component.DataTable);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){var t=this;_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._selectable=!0,this._componentCls="n2-distributors-data-table",this._COLUMN_DEFINITIONS=[{header:"Order",bindPath:"order",cls:"n2_order-column",sortable:!0,cell:{cls:"slds-text-align_right"}},{header:"Name",sortable:!0,sort:{bindPath:".name"},cell:{cellTemplate:"",cls:"slds-truncate",components:[{id:"distributor-link",type:n2.de.component.Link,mixins:[n2.mixin.DataDriven],text:{bindPath:".name"},title:{bindPath:".name"},listeners:{click:this._onOpenDistributorLink,scope:this}}]}},{header:"Method",sortable:!0,bindPath:"method"},{header:"Member Filter",cls:"n2_member-filter-column",sortable:!0,bindPath:"isMemberFilter",sort:{bindPath:".isMemberFilter"},cell:{dataAdapter:function(e){return t._getEmptyCellContent(e,{displayValue:"Yes"})}}},{header:"Sticky",cls:"n2_sticky-column",sortable:!0,bindPath:"isSticky",sort:{bindPath:".isSticky"},cell:{dataAdapter:function(e){return t._getEmptyCellContent(e,{displayValue:"Yes"})}}},{header:"Weighting",cls:"n2_weighting-column",sortable:!0,bindPath:"isWeighting",sort:{bindPath:".isWeighting"},cell:{dataAdapter:function(e){return t._getEmptyCellContent(e,{displayValue:"Enabled"})}}},{header:"Cap",cls:"n2_cap-column",cell:{cellTemplate:"",type:n2.ui.component.dataTable.Cell,components:[{id:"distributor-cap-label",cls:"n2-de-summary",mixins:[n2.mixin.DataDriven],type:n2.de.component.DistributorCapsLabel}]}},{header:"Status",cls:"n2_status-column",sortable:!0,bindPath:"isActive",sort:{bindPath:".isActive",adapter:function(e){return e?"Active":"Inactive"}},cell:{dataAdapter:function(e){return t._getEmptyCellContent(e,{displayValue:"Active",emptyValue:"Inactive"})}}},{cls:"n2_menu-column",cell:{id:"menu-cell",cls:"n2_menu-cell",cellTemplate:"",components:[this._getMenuConfig()]}}],this.columns=this._COLUMN_DEFINITIONS,this._sortBy={column:0,direction:"asc"},this._emptyState={type:n2.de.page.team.distributorList.distributorRecordList.distributorDataTable.EmptyState,listeners:{click:function(e){(e.currentTarget=t).fire("click",e)}}},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no distributors that match your filters",content:""},this._distributorType=null,this._distributorsData=null}},{key:"distributorType",set:function(e){n2.compare(e,this._distributorType)||(this._distributorType=e,this.columns=this._generateColumnDefinitions(),this._refresh({headerRow:!0}))}},{key:"distributorsData",get:function(){return this._distributorsData},set:function(e){this._distributorsData=e,this.columns=this._generateColumnDefinitions(),this._refresh({headerRow:!0}),this.data=e}},{key:"_generateColumnDefinitions",value:function(){return this._filterDataTableColumns(n2.clone(this._COLUMN_DEFINITIONS))}},{key:"_filterDataTableColumns",value:function(e){return n2.isNull(this._distributorsData)||(e=e,this._distributorType===n2.de.enum.distributor.Type.PULL?(e.splice(5,1),e.splice(4,1)):this._distributorsData.some(function(e){return e.isSticky})||e.splice(4,1)),e}},{key:"_getMenuConfig",value:function(){var n=this;return{type:n2.ui.component.Menu,id:"distributor-actions-menu",mixins:[n2.mixin.DataDriven],options:[{id:"activate",label:"Activate",hidden:!0},{id:"deactivate",label:"Deactivate",hidden:!0},{id:"clone",label:"Clone"},{id:"test",label:"Test"},{id:"recent",label:"Recent"},{id:"preview",label:"Preview"},{id:"delete",label:"Delete"}],listeners:{loaded:function(e,t){return n._onMenuLoaded(e,t)},select:function(e,t){n.fire("click",n._createEvent(e,{data:t.parent.data}))}}}}},{key:"_onMenuLoaded",value:function(e,t){t=this._isActiveData(t);e.components.activate.hidden=!t,e.components.deactivate.hidden=t}},{key:"_onOpenDistributorLink",value:function(e){var t=e.event,e=e.target,t=(t.stopPropagation(),n2.de.page.team.Context.getInstance().teamId);n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e.model.id,"&teamId=").concat(t))}},{key:"_isActiveData",value:function(e){return!e.isActive}},{key:"_createRow",value:function(e){var t=_get(_getPrototypeOf(s.prototype),"_createRow",this).apply(this,arguments),n=t.data.isActive,i=t.components["menu-cell"].components["distributor-actions-menu"];return n?i.components.activate.hidden=!0:(t.cls="n2_inactive",i.components.deactivate.hidden=!0),this._distributorType===n2.de.enum.distributor.Type.TRIGGER&&(i.components.preview.hidden=!0),this._distributorType===n2.de.enum.distributor.Type.MANUAL&&(i.components.clone.hidden=!0,i.components.preview.hidden=!0,i.components.test.hidden=!0),t}},{key:"_getEmptyCellContent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.displayValue,n=void 0===n?null:n,t=t.emptyValue,t=void 0===t?null:t;return n2.isEmpty(e)?n2.isEmpty(e)?n2.isNull(t)?{html:"<span>&mdash;</span>"}:t:void 0:n2.isNull(n)?e:n}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),e=e.headerRow;(t||void 0!==e&&e)&&this._refreshHeaderRow(),_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments)}},{key:"_refreshHeaderRow",value:function(){this._rendered&&(this._refreshColgroup(),this.headerRow.destroy(),this._addHeaderRow(),this._applySortBy(this._sortBy))}}]),s}(),n2.de.page.team.distributorList.distributorRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.team.distributorList.distributorRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._MENU_OPTION_DISTRIBUTOR_TYPE={distributor:n2.de.enum.distributor.Type.STANDARD,pull:n2.de.enum.distributor.Type.PULL,trigger:n2.de.enum.distributor.Type.TRIGGER,manual:n2.de.enum.distributor.Type.MANUAL},this._distributorType=null,this._hasManualDistributor=!1,this._recordSelectionCount=null,this._showAssignmentSimulationMenuOption=!1}},{key:"distributorType",set:function(e){n2.compare(e,this._distributorType)||(this._distributorType=e,this._refresh())}},{key:"hasManualDistributor",set:function(e){n2.compare(e,this._hasManualDistributor)||(this._hasManualDistributor=e,this._refresh({addNewSplitButton:!0}))}},{key:"recordSelectionCount",set:function(e){n2.compare(e,this._recordSelectionCount)||(this._recordSelectionCount=e,this._refresh({menu:!0}))}},{key:"showAssignmentSimulationMenuOption",set:function(e){n2.compare(e,this._showAssignmentSimulationMenuOption)||(this._showAssignmentSimulationMenuOption=e,this._refresh({menu:!0}))}},{key:"activeStatusFilter",get:function(){return this._components["active-status-filter"]}},{key:"menu",get:function(){return this.components["distributor-actions-menu"]}},{key:"_insertComponents",value:function(){this._insertActiveStatusFilter(),this._insertQuickFilter({text:"Find distributor"}),this._insertAddSplitButton({text:"Distributor",menuOptions:[{id:"distributor",label:"Add Distributor"},{id:"pull",label:"Add Pull Distributor"},{id:"trigger",label:"Add Trigger Distributor"},{id:"manual",label:"Add Manual Distributor"}]}),this._insertMenu()}},{key:"_insertActiveStatusFilter",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"active-status-filter",renderTo:this.SELECTORS.left,cls:"n2_active-filter",label:{text:"Filter distributors",hidden:!0},placeholder:"All statuses",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],sort:!1,listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"distributor-actions-menu",cls:"n2_menu",options:[{id:"activate",label:"Activate",hidden:!0},{id:"deactivate",label:"Deactivate",hidden:!0},{id:"delete",label:"Delete",hidden:!0},{id:"reorder-distributors",label:"Reorder Distributors"},{id:"assignment-simulation",label:"Assignment Simulation"}],listeners:{select:this._handleClick,scope:this}}))}},{key:"_handleSplitButtonClick",value:function(e){var t=e.target;e.event;this.fire("click",this._createEvent(t,{data:{actions:["add-new"],distributorType:this._distributorType}}))}},{key:"_handleSelection",value:function(e){var e=e.target,t=this._MENU_OPTION_DISTRIBUTOR_TYPE[e.id];this.fire("click",this._createEvent(e,{data:{actions:["add-new"],distributorType:t}}))}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.addNewSplitButton,e=e.menu,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshAddNewSplitButton(),(t||e)&&this._refreshMenu()}},{key:"_refreshAddNewSplitButton",value:function(){this.addNewSplitButton.button.text=this._getAddNewSplitButtonText(),this.addNewSplitButton.menu.components.distributor.hidden=this._isStandardDistributorType(),this.addNewSplitButton.menu.components.pull.hidden=this._isQ2QTeam()||this._isPullDistributorType(),this.addNewSplitButton.menu.components.trigger.hidden=!this._isTriggersEnabled()||this._isTriggerDistributorType(),this.addNewSplitButton.menu.components.manual.hidden=this._isQ2QTeam()||this._hasManualDistributor||this._isManualDistributorType(),this._isManualDistributorType()&&this._hasManualDistributor?this.addNewSplitButton.button.disable():this.addNewSplitButton.button.enable()}},{key:"_refreshMenu",value:function(){var e=!n2.isEmpty(this._recordSelectionCount);this.menu.components.activate.hidden=!e,this.menu.components.deactivate.hidden=!e,this.menu.components.delete.hidden=!e,this.menu.components["reorder-distributors"].hidden=e||this._isManualDistributorType(),this.menu.components["assignment-simulation"].hidden=!this._showAssignmentSimulationMenuOption,e&&(this.menu.components.activate.label="Activate (".concat(this._recordSelectionCount,")"),this.menu.components.deactivate.label="Deactivate (".concat(this._recordSelectionCount,")"),this.menu.components.delete.label="Delete (".concat(this._recordSelectionCount,")")),this._handleMenuEnablement()}},{key:"_handleMenuEnablement",value:function(){this.menu.disabled=!Object.entries(this.menu.components).filter(function(e){return"menu-button"!==e[0]}).some(function(e){return!1===e[1].hidden})}},{key:"clear",value:function(){this.quickFilter.clear(),this.activeStatusFilter.clear()}},{key:"_getAddNewSplitButtonText",value:function(){return this._isStandardDistributorType()?"Add Distributor":this._isPullDistributorType()?"Add Pull Distributor":this._isTriggerDistributorType()?"Add Trigger Distributor":this._isManualDistributorType()?"Add Manual Distributor":void 0}},{key:"_isQ2QTeam",value:function(){return n2.de.page.team.Context.getInstance().isQ2QTeam}},{key:"_isTriggersEnabled",value:function(){return n2.de.page.team.Context.getInstance().isTriggersEnabled}},{key:"_isStandardDistributorType",value:function(){return this._distributorType===n2.de.enum.distributor.Type.STANDARD}},{key:"_isPullDistributorType",value:function(){return this._distributorType===n2.de.enum.distributor.Type.PULL}},{key:"_isTriggerDistributorType",value:function(){return this._distributorType===n2.de.enum.distributor.Type.TRIGGER}},{key:"_isManualDistributorType",value:function(){return this._distributorType===n2.de.enum.distributor.Type.MANUAL}}]),t}(),n2.de.page.team.distributorList.distributorSlideOutPanel.DistributorSummary=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._cls="n2-de-distributor-summary slds-is-relative"}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._insertMethodSummary(),this._insertSourceSummary(),this._insertFieldFiltersSummary(),this._insertCampaignFilterSummary(),this._insertTeamMembersFilterSummary())}},{key:"_insertMethodSummary",value:function(){var e=this._components.method;n2.isUndefined(e)||e.destroy(),this._insert(new n2.de.component.team.summary.MethodSummary({id:"method",label:"Method",cls:"slds-p-horizontal_medium slds-p-vertical_small",model:this._model}))}},{key:"_insertSourceSummary",value:function(){var e=this._components.source;n2.isUndefined(e)||e.destroy(),this._model.type!==n2.de.enum.distributor.Type.TRIGGER&&this._model.type!==n2.de.enum.distributor.Type.MANUAL&&this._insert(new n2.de.component.team.summary.SourceSummary({id:"source",label:"Source",mixins:[n2.mixin.DataDriven],cls:"slds-p-horizontal_medium slds-p-vertical_small",sourceType:this._model.sourceType,sourceName:this._model.sourceName}))}},{key:"_insertFieldFiltersSummary",value:function(){var e=this._components["field-filters"];n2.isUndefined(e)||e.destroy(),this._model.hasFieldFilters&&(e=this._model.isAdvancedFilter,this._insert(new n2.de.component.summary.LogicFiltersSummary({id:"field-filters",label:"Field Filter",cls:"slds-p-horizontal_medium slds-p-vertical_small",isAdvanced:e,logic:e?"":this._model.logicAndFilters.logic,filters:e?this._model.advancedFilter:this._model.logicAndFilters.filters})))}},{key:"_insertCampaignFilterSummary",value:function(){var e=this._components["campaign-filters"];n2.isUndefined(e)||e.destroy(),this._model.hasCampaignFilters&&this._insert(new n2.de.component.summary.ListSummary({id:"campaign-filters",cls:"slds-p-horizontal_medium slds-p-vertical_small",label:"Campaign Filter",items:this._model.campaigns}))}},{key:"_insertTeamMembersFilterSummary",value:function(){var e=this._components["team-member-filters"];n2.isUndefined(e)||e.destroy(),this._model.hasMemberFilters&&("TEAM MEMBERS"===this._model.memberFilterType.toUpperCase()?this._insertTeamMembersFilter():this._insertTagFilters())}},{key:"_insertTeamMembersFilter",value:function(){var e=this._model.teamMemberFilters.map(function(e){return e.name});this._insert(new n2.de.component.summary.ListSummary({id:"team-member-filters",label:"Team Member Filters",cls:"slds-p-horizontal_medium slds-p-vertical_small",items:e}))}},{key:"_insertTagFilters",value:function(){this._insert(new n2.de.component.team.summary.TagFiltersSummary({id:"team-member-filters",label:"Assignment",cls:"slds-p-horizontal_medium slds-p-vertical_small",filters:this._model.tagFilters}))}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.GeneralSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._distributorNames=null}},{key:"distributorNames",set:function(e){n2.compare(e,this._distributorNames)||(this._distributorNames=e,this._refresh({distributorName:!0}))}},{key:"distributorNameField",get:function(){return this._components["distributor-name"]}},{key:"distributorObjectField",get:function(){return this._components["distributor-object"]}},{key:"assignmentField",get:function(){return this._components["assignment-field"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertDistributorNameField(),this._insertDistributorObjectField(),this._insertAssignmentField()}},{key:"_insertDistributorNameField",value:function(){return this._insert(new n2.de.component.field.UniqueNameField({id:"distributor-name",mixins:[n2.mixin.DataDriven],label:"Distributor name",required:!0,cls:"slds-m-bottom_medium n2_field-large",helpText:{text:"Uniquely describe your distributor. Shorter names are easier to read and remember.",position:n2.ui.enum.Position.BELOW},nameValidationMessage:"Distributor names must be unique within a team",value:{bindPath:".name"}}))}},{key:"_insertDistributorObjectField",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"distributor-object",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_field-large n2_no-field",label:"Object",value:{bindPath:".objectLabel"}}))}},{key:"_insertAssignmentField",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"assignment-field",mixins:[n2.mixin.DataDriven],label:"Assignment field",cls:"slds-m-bottom_medium n2_field-large n2_no-field",helpText:"The field which Distribution Engine will update with the chosen team member when assigning records.",value:{bindPath:".assignToField"},hidden:{bindPath:".assignToFieldName",defaultValue:!0,adapter:function(e){return"ownerid"===e.toLowerCase()}}}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.distributorNameField,i=e.distributorObjectField,i=void 0!==i&&i,e=e.assignmentField,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshDistributorNameField(),(t||i)&&this._refreshDistributorObjectField(),(t||e)&&this._refreshAssignmentField()}},{key:"_refreshDistributorNameField",value:function(){this.distributorNameField.names=this._distributorNames,this.distributorNameField.model=this._model}},{key:"_refreshDistributorObjectField",value:function(){this.distributorObjectField.model=this._model}},{key:"_refreshAssignmentField",value:function(){this.assignmentField.model=this._model}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.MethodSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{methodTypeChange:function(e){}}),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Method",this._teamObjectFieldOptions=null}},{key:"teamObjectFieldOptions",set:function(e){n2.compare(this._teamObjectFieldOptions,e)||(this._teamObjectFieldOptions=e,this._refreshFormulaFieldOptions())}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&((t=e.get("distributorType"))===n2.de.enum.distributor.Type.PULL?(n2.isUndefined(this._components["method-type"])&&n2.isUndefined(this._components["respect-distribution-hours"])&&this._insertPullDistributorFields(),this._refreshPullDistributorFields()):t===n2.de.enum.distributor.Type.MANUAL?(n2.isUndefined(this._components["method-type"])&&n2.isUndefined(this._components["treat-as-rejection"])&&this._insertManualDistributorFields(),this._refreshManualDistributorFields()):(n2.isUndefined(this._components["method-type-selection"])&&this._insertMethodTypeSelection(),this._refreshMethodTypeSelection(),this._hideAllDistributionMethodSettings(),this._showDistributionMethodSettings()))}},{key:"_insertPullDistributorFields",value:function(){this._insert(new n2.ui.component.field.TextBox({id:"method-type",mixins:[n2.mixin.DataDriven],label:"Method",cls:"slds-m-bottom_medium n2_field-large n2_no-field",value:{bindPath:".distributorType"}})),this._insert(new n2.ui.component.field.Checkbox({id:"respect-distribution-hours",mixins:[n2.mixin.DataDriven],label:"Respect distribution hours",cls:"slds-m-bottom_medium",value:{bindPath:".respectDistributionHours"}}))}},{key:"_refreshPullDistributorFields",value:function(){this._components["method-type"].model=this._model,this._components["respect-distribution-hours"].model=this._model}},{key:"_insertManualDistributorFields",value:function(){this._insert(new n2.ui.component.field.TextBox({id:"method-type",mixins:[n2.mixin.DataDriven],label:"Method",cls:"slds-m-bottom_medium n2_field-large n2_no-field",value:{bindPath:".distributorType"}})),this._insert(new n2.ui.component.field.Checkbox({id:"treat-as-rejection",mixins:[n2.mixin.DataDriven],label:"Treat manual assignment as rejection",cls:"slds-m-bottom_medium",helpText:{text:"If enabled, and the record has been previously assigned by a DE distributor with rejection enabled, the previous assignment will be rejected using the rejection rules for that distributor.",position:n2.ui.enum.Position.BELOW},value:{bindPath:".isTreatManualAssignmentAsRejection"}}))}},{key:"_refreshManualDistributorFields",value:function(){this._components["method-type"].model=this._model,this._components["treat-as-rejection"].model=this._model}},{key:"_insertMethodTypeSelection",value:function(){var t=this,e=n2.de.enum.distributor.Method,n=this._model.get("distributorType"),i=[e.ROUND_ROBIN,e.LOAD_BALANCING],s=[e.LOOKUP_OWNER,e.RELATED_OWNER],e=[e.DYNAMIC_OWNER,e.CURRENT_OWNER];this._insert(new n2.de.component.field.RadioButtonGroup({id:"method-type-selection",mixins:[n2.mixin.DataDriven],label:"Method",required:!0,cls:"slds-m-bottom_medium",helpText:"The method for determining which user will get assigned a record.",options:n2.merge(i,n===n2.de.enum.distributor.Type.TRIGGER?e:s),value:{bindPath:".method"},sort:!1,listeners:{change:function(e){t._hideAllDistributionMethodSettings(),t._showDistributionMethodSettings(),t.fire("methodTypeChange",{target:e})}}}))}},{key:"_refreshMethodTypeSelection",value:function(){this._components["method-type-selection"].model=this._model}},{key:"_showDistributionMethodSettings",value:function(){var e=n2.de.enum.distributor.Method;switch(this._model.get("method")){case e.ROUND_ROBIN:this._showRoundRobinFields(),this._showDefaultOwner(),this._showStickyAssignment(),this._showAvailabilityFields();break;case e.LOAD_BALANCING:this._showLoadBalancingFields(),this._showDefaultOwner(),this._model.get("distributorType")!==n2.de.enum.distributor.Type.TRIGGER&&this._showStickyAssignment(),this._showAvailabilityFields();break;case e.LOOKUP_OWNER:this._showLookupOwner(),this._showAvailabilityFields();break;case e.RELATED_OWNER:this._showRelatedOwnerFields(),this._showAvailabilityFields();break;case e.DYNAMIC_OWNER:this._showFormulaSelection(),this._showDefaultOwner(),this._showAvailabilityFields();break;case e.CURRENT_OWNER:this._showCurrentOwnerMessage()}}},{key:"_showRoundRobinFields",value:function(){n2.isUndefined(this._components["round-robin-fields"])&&this._insertRoundRobinFields(),this._refreshRoundRobinFields(),this._components["round-robin-fields"].hidden=!1}},{key:"_insertRoundRobinFields",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RoundRobinFields({id:"round-robin-fields",cls:"n2_flush-left n2_round-robin-scope slds-m-bottom_medium",hidden:!0}),this._getInsertPosition())}},{key:"_refreshRoundRobinFields",value:function(){var e=this._components["round-robin-fields"];e.components["round-robin-level"].model=this._model,e.components["round-robin-level-button"].model=this._model}},{key:"_getInsertPosition",value:function(){var e=this._components["default-owner"],t=this._components["sticky-assignment"];return n2.isUndefined(e)?n2.isUndefined(t)?void 0:this.getComponentIndex(t.id):this.getComponentIndex(e.id)}},{key:"_showAvailabilityFields",value:function(){n2.isUndefined(this._components["availability-fields"])||this._components["availability-fields"].destroy(),this._insertAvailabilityFields(),this._refreshAvailabilityFields(),this._components["availability-fields"].hidden=!1}},{key:"_insertAvailabilityFields",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.AvailabilityAssignmentField({id:"availability-fields",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",label:"Respect availability",helpText:"Determine whether to assign when the team member is unavailable or toggled offline.",sort:!1,hidden:!0,options:[{label:"Assign if user is unavailable",value:"assignOnOutOfOffice"},{label:"Assign if user is toggled off in widget",value:"assignOnWidgetOff"}]}))}},{key:"_refreshAvailabilityFields",value:function(){this._components["availability-fields"].model=this._model}},{key:"_showDefaultOwner",value:function(){this._model.get("distributorType")===n2.de.enum.distributor.Type.TRIGGER&&(n2.isUndefined(this._components["default-owner"])&&this._insertDefaultOwner(),this._refreshDefaultOwner(),this._components["default-owner"].hidden=!1)}},{key:"_insertDefaultOwner",value:function(){this._insert(new n2.de.component.field.UserOrQueueField({id:"default-owner",mixins:[n2.mixin.DataDriven],label:"Default owner",helpText:"If the distributor cannot find the assigned owner in the team it will set the owner to this default.",cls:"slds-m-bottom_medium",required:!0,teamId:n2.de.page.team.distributorSettings.Context.getInstance().teamId}))}},{key:"_refreshDefaultOwner",value:function(){var e=this._model.getProperty("defaultOwnerSettings"),t=new n2.dataProvider.Model({value:{}});t.insert(this._model.getProperty("objectName"),{key:"objectName"}),t.insert(this._model.getProperty("supportsQueues"),{key:"supportsQueues"}),t.insert(e.getProperty("defaultOwnerType",{defaultValue:"None"}),{key:"selectionType"}),t.insert(e.getProperty("defaultOwnerId",{defaultValue:""}),{key:"selectedId"}),t.insert(e.getProperty("defaultOwnerName",{defaultValue:""}),{key:"selectedName"}),this._components["default-owner"].model=t}},{key:"_showStickyAssignment",value:function(){n2.isUndefined(this._components["sticky-assignment"])&&this._insertStickyAssignment(),this._refreshStickyAssignment(),this._components["sticky-assignment"].hidden=!1}},{key:"_insertStickyAssignment",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.StickyAssignment({id:"sticky-assignment",hidden:!0,cls:"slds-m-bottom_medium",helpText:"Sticky allows for assignment of related records assigned within a set time period to the same team member.",teamObjectFieldOptions:this._teamObjectFieldOptions}))}},{key:"_refreshStickyAssignment",value:function(){this._components["sticky-assignment"].model=this._model}},{key:"_showLoadBalancingFields",value:function(){n2.isUndefined(this._components["load-balancing-fields"])&&this._insertLoadBalancingFields(),this._refreshLoadBalancingFields(),this._components["load-balancing-fields"].hidden=!1}},{key:"_insertLoadBalancingFields",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LoadBalancingFields({id:"load-balancing-fields",cls:"n2_flush-left n2_load-balancing-scope slds-m-bottom_medium",hidden:!0}),this._getInsertPosition())}},{key:"_refreshLoadBalancingFields",value:function(){this._model.get("loadBalancingLevel",{defaultValue:"Team"}),this._components["load-balancing-fields"].model=this.model}},{key:"_showLookupOwner",value:function(){n2.isUndefined(this._components["lookup-owner"])&&this._insertLookupOwner(),this._refreshLookupOwner(),this._components["lookup-owner"].hidden=!1}},{key:"_insertLookupOwner",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwner({id:"lookup-owner",cls:"n2_flush-left",hidden:!0}))}},{key:"_refreshLookupOwner",value:function(){this._components["lookup-owner"].model=this._model}},{key:"_showRelatedOwnerFields",value:function(){n2.isUndefined(this._components["related-owner-fields"])&&this._insertRelatedOwnerFields(),this._refreshRelatedOwnerFields(),this._components["related-owner-fields"].hidden=!1}},{key:"_insertRelatedOwnerFields",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RelatedOwner({id:"related-owner-fields",cls:"n2_flush-left",hidden:!0}))}},{key:"_refreshRelatedOwnerFields",value:function(){this._components["related-owner-fields"].model=this._model}},{key:"_showFormulaSelection",value:function(){n2.isUndefined(this._components["formula-selection"])&&this._insertFormulaSelection(),this._refreshFormulaSelection(),this._components["formula-selection"].hidden=!1}},{key:"_insertFormulaSelection",value:function(){var e=this._components["default-owner"],t=null;n2.isUndefined(e)||(t=this.getComponentIndex(e.id)),this._insert(new n2.ui.component.field.Combo({id:"formula-selection",mixins:[n2.mixin.DataDriven],label:"Dynamic owner formula",cls:"slds-m-bottom_medium n2_field-medium",helpText:"Select a formula field which has a value containing the appropriate assignee.",required:!0,hidden:!0,options:n2.de.data.Adapters.formulaFieldOptions(this._teamObjectFieldOptions),value:{bindPath:".dynamicOwnerField"}}),t)}},{key:"_refreshFormulaFieldOptions",value:function(){n2.isUndefined(this._components["formula-selection"])||(this._components["formula-selection"].options=n2.de.data.Adapters.formulaFieldOptions(this._teamObjectFieldOptions))}},{key:"_refreshFormulaSelection",value:function(){this._components["formula-selection"].model=this._model}},{key:"_showCurrentOwnerMessage",value:function(){n2.isUndefined(this._components["current-owner-message"])&&this._insertCurrentOwnerMessage(),this._components["current-owner-message"].hidden=!1}},{key:"_insertCurrentOwnerMessage",value:function(){this._insert(new n2.ui.component.HTML({id:"current-owner-message",template:'<div id="{{id}}" class="slds-grid slds-m-bottom_small">'+n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"})+'<div class="slds-col"><p>Current owner will always log, regardless of availability</p></div></div>',hidden:!0}))}},{key:"_hideAllDistributionMethodSettings",value:function(){this.forEach(function(e){"method-type"!==e.id&&"method-type-selection"!==e.id&&(e.hidden=!0)})}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.SourceSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Source",this._teamObjectFieldOptions=null}},{key:"teamObjectFieldOptions",set:function(e){n2.compare(this._teamObjectFieldOptions,e)||(this._teamObjectFieldOptions=e)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),n2.isNull(t)&&this._insertSourceSettingsFields()}},{key:"_insertSourceSettingsFields",value:function(){var e=this._model.get("distributorType")===n2.de.enum.distributor.Type.TRIGGER,t=new n2.dataProvider.Model({value:{}}),t=(t.insert(this._model.getProperty("objectName"),{key:"objectName"}),t.insert(this._model.getProperty("supportsQueues"),{key:"supportsQueues"}),t.insert(this._model.getProperty("sourceType",{defaultValue:"None"}),{key:"selectionType"}),t.insert(this._model.getProperty("sourceId",{defaultValue:""}),{key:"selectedId"}),t.insert(this._model.getProperty("sourceName",{defaultValue:""}),{key:"selectedName"}),t.insert(this._model.getProperty("sourceStatusField",{defaultValue:""}),{key:"selectedStatusField"}),t.insert(this._model.getProperty("sourceReadyStatus",{defaultValue:""}),{key:"selectedReadyStatus"}),t.insert(this._model.getProperty("sourceAssignedStatus",{defaultValue:""}),{key:"selectedAssignedStatus"}),e||(n2.isUndefined(this._components.source)&&this._insertSourceSelection(),this._components.source.model=t),this._model.get("hasTeamFilters")&&n2.isUndefined(this._components["team-filter-fields"])&&this._insertTeamFiltersSummary(),n2.isUndefined(this._components["field-filter"])&&this._insertSourceFilter(e),new n2.dataProvider.Model({value:{}})),t=(t.insert(this._model.getProperty("objectName"),{key:"objectName"}),t.insert(this._model.getProperty("hasFieldFilters"),{key:"hasFieldFilters"}),t.insert(this._model.getProperty("isAdvancedFilter",{defaultValue:"false"}),{key:"isAdvancedFilter"}),t.insert(this._model.get("advancedFiltersEnabled")&&!e,{key:"advancedFiltersEnabled"}),t.insert(!1,{key:"hideLogic"}),t.insert(this._model.getProperty("logicAndFilters"),{key:"logicAndFilters"}),t.insert(this._model.getProperty("filterSoqlString",{defaultValue:""}),{key:"advancedSoql"}),this._components["field-filter"].model=t,this._model.get("objectName"));"Lead"!==t&&"Contact"!==t||(n2.isUndefined(this._components["campaign-selection"])&&this._insertCampaignSelection(),this._components["campaign-selection"].model=this._model),e||(n2.isUndefined(this._components["custom-sort-order"])&&this._insertCustomSortOrders(),this._components["custom-sort-order"].model=this._model)}},{key:"_insertSourceSelection",value:function(){this._insert(new n2.de.component.field.SourceSelection({id:"source",mixins:[n2.mixin.DataDriven],label:"Source",helpText:"Whether this distributor assigns records from a user, a queue or using a record status.",required:!0,cls:"slds-m-bottom_medium n2_restrict-width",allowNoneOption:!1,teamId:n2.de.page.team.distributorSettings.Context.getInstance().teamId}))}},{key:"_insertTeamFiltersSummary",value:function(){var e,t=this._components["team-filter-fields"];n2.isUndefined(t)||t.destroy(),this._model.get("hasTeamFilters")&&(t=this._insert(new n2.de.component.form.FieldGroup({id:"team-filter-fields",heading:"Team-level field-based filter",cls:"slds-m-bottom_medium n2_flush-left n2_small-heading",helpText:"Only records matching the filter criteria will be distributed, this is set at the Team settings level."})),e=this._model.get("teamFilters").logic,t.insert(new n2.de.component.summary.LogicFiltersSummary({id:"team-filters",isAdvanced:!1,logic:!n2.isEmpty(e)&&e.toUpperCase().includes("OR")?e:"",filters:this._model.get("teamFilters").filters})))}},{key:"_insertSourceFilter",value:function(e){this._insert(new n2.de.component.form.FieldFilter({id:"field-filter",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_flush-left n2_small-heading",maxRows:e?5:20}))}},{key:"_insertCampaignSelection",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelection({id:"campaign-selection",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_flush-left n2_small-heading"}))}},{key:"_insertCustomSortOrders",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CustomSortOrders({id:"custom-sort-order",renderTo:this.SELECTORS.sourceSettings,mixins:[n2.mixin.DataDriven],label:"Custom sort order",cls:"slds-m-bottom_medium n2_field-x-large",helpText:"Select which fields should be used for determining the order records are distributed from the queue.",fieldOptions:n2.de.data.Adapters.objectFieldOptions(this._teamObjectFieldOptions,{includeSortable:!0}),value:{bindPath:".sortOrders"}}))}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.TeamMemberFilter=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t,n,i=_createSuper(s);function s(){return _classCallCheck(this,s),i.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Team member filter",this._helpText="Limit the team members who can receive assignments from this Distributor.",this._lazyLoad=!0,this._teamMemberOptions=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertFilterSelection(),this._insertTeamMemberSelection(),this._insertTagFilters(),this._insertTeamMemberExclusionFieldGroup()}},{key:"_insertFilterSelection",value:function(){var t=this;this._insert(new n2.ui.component.field.RadioButtonGroup({id:"filter-type",cls:"slds-m-bottom_large",sort:!1,label:"Assign to",listeners:{change:function(e){return t._onFilterTypeChange(e)}}}))}},{key:"_insertTeamMemberSelection",value:function(){var i=this;return this._insert(new n2.ui.component.field.Combo({id:"team-member-selection",mixins:[n2.mixin.DataDriven],multiple:!0,hidden:!0,required:!0,label:"Selected members",cls:"n2_field-large slds-m-bottom_large",helpText:"Select the team members who can receive assignments from this Distributor. Selecting all Team Members is the same as disabling the Team Member Filter.",options:[],value:{bindPath:".teamMemberFilters"},listeners:{loaded:function(e,t,n){i.isLoading()||i._checkAllTeamMembersSelected()},change:function(e){i._checkAllTeamMembersSelected()}}}))}},{key:"_insertTeamMemberExclusionFieldGroup",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.TeamMemberExclusionFieldGroup({id:"team-member-exclusion",hidden:!1,cls:"n2-de-field-group slds-m-bottom_medium n2_flush-left n2_small-heading",helpText:{text:"Select a field on the distributed object that contains a user or a list of comma separated user Ids for Team members who should not be assigned this object.",position:n2.ui.enum.Position.ABOVE}}))}},{key:"_onFilterTypeChange",value:function(e){var t="All team"===e.value;this._model.getProperty("hasTeamMemberFilter").value=!t,this._model.getProperty("memberFilterType",{defaultValue:""}).value=t?null:e.value,this._refreshTeamMemberSelectionField(),this._refreshTagFiltersField(),this.refreshTeamMemberExclusion()}},{key:"_checkAllTeamMembersSelected",value:function(){var t=this._components["team-member-selection"];if(n2.isEmpty(t.value))return this._hideAllTeamMembersSelectedMessage();this._teamMemberOptions.some(function(e){return!t.value.includes(e.value)})?this._hideAllTeamMembersSelectedMessage():this._showAllTeamMembersSelectedMessage()}},{key:"_hideAllTeamMembersSelectedMessage",value:function(){var e=this._components["team-member-selection"].components["all-members-selected-message"];n2.isUndefined(e)||(e.hidden=!0)}},{key:"_showAllTeamMembersSelectedMessage",value:function(){var e=this._components["team-member-selection"].components["all-members-selected-message"];(e=n2.isUndefined(e)?this._insertAllTeamMembersSelectedMessage():e).hidden=!1}},{key:"_insertAllTeamMembersSelectedMessage",value:function(){var t=this;return this._components["team-member-selection"].insert(new n2.ui.component.HTML({id:"all-members-selected-message",hidden:!0,template:'<div id="{{id}}" class="slds-grid {{#hidden}} {{hideCls}}{{/hidden}}"> \n                '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-m-top_x-small slds-col slds-no-flex slds-icon-text-default"}),'\n                <div class="slds-col">\n                    <p>Looks like youve selected everyone, would you like to use <span class="n2_all-team-button"></span> instead?</p>\n                </div>\n            </div>'),components:[new n2.ui.component.Button({id:"select-all-team",text:"All team",renderTo:".n2_all-team-button",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){t._components["filter-type"].value="All team"}}})]}))}},{key:"_insertTagFilters",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.TagFilter({id:"tag-filters",hidden:!0,required:!0,label:"Selected tags",cls:"slds-m-bottom_large",helpText:"Select which tags the team member must have to receive assignments from this Distributor.",value:{bindPath:".tagFilters"}}))}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),e.t0=n2.isNull(n),e.t0)return e.next=5,this.load();e.next=9;break;case 5:this._refreshFilterSelectionField({silent:!0}),this._refreshTeamMemberSelectionField(),this._refreshTagFiltersField(),this.refreshTeamMemberExclusion();case 9:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_load",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._fetchTeamMemberOptions({silent:t,force:n});case 4:return e.t0=e.sent,e.abrupt("return",{teamMemberOptions:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_fetchTeamMemberOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,t=void 0!==t&&t,n=e.force,n=void 0===n||n,i=e.newSourceType,i=void 0===i?null:i,e=e.newSourceId,e=void 0===e?null:e,s=n2.de.page.team.distributorSettings.Context.getInstance().teamId,a=n2.de.page.team.distributorSettings.Context.getInstance().distributorId;return this._fetchDataProvider("get-team-member-options",{params:[s,a,i,e],force:n,silent:t,requestId:"".concat(s,"-").concat(a,"-").concat(i,"-").concat(e)})}},{key:"_onLoadComplete",value:function(e){e=e.teamMemberOptions;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._teamMemberOptions=e.response}},{key:"_refreshFilterSelectionField",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,e=void 0!==e&&e,t=this._model.get("hasTeamMemberFilter"),n=this._model.get("memberFilterType"),i=this._model.get("supportsTagFilters"),s=this._components["filter-type"],a=["All team",{label:"Selected members",value:"Team members"}];i&&a.push({label:"By tags",value:"Tags"}),s.hidden=!1,s.options=a,s.value={value:t?n:"All team",silent:e}}},{key:"_refreshTeamMemberSelectionField",value:function(){var e=this._model.get("memberFilterType"),t=this._components["team-member-selection"];t.hidden="Team members"!==e,t.options=this._teamMemberOptions||[],t.model=this._model}},{key:"_refreshTagFiltersField",value:function(){var e=this._model.get("memberFilterType"),t=this._components["tag-filters"],e=(this._model.get("tagFilters",{defaultValue:[]}),t.model=this._model,"Tags"===e);t.hidden=!e,e&&n2.isEmpty(this._model.get("tagFilters"))&&t.components["data-table"].addRow({})}},{key:"refreshTeamMemberSelection",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(i=0<o.length&&void 0!==o[0]?o[0]:{}).silent,s=void 0!==s&&s,a=i.force,a=void 0===a||a,t=i.newSourceType,t=void 0===t?null:t,n=i.newSourceId,n=void 0===n?null:n,i=i.refreshTeamMemberOptionsOnly,i=void 0!==i&&i,e.next=3,this._fetchTeamMemberOptions({silent:s,force:a,newSourceType:t,newSourceId:n});case 3:s=e.sent,this._teamMemberOptions=s.response,i||(a=this._components["team-member-selection"].value,this._components["team-member-selection"].clear({silent:!0}),this._components["team-member-selection"].options=this._teamMemberOptions||[],this._components["team-member-selection"].value={value:a,silent:!0});case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"refreshTeamMemberExclusion",value:function(){var e=n2.de.enum.distributor.Method,e=[e.ROUND_ROBIN,e.LOAD_BALANCING,"Pull"],t=this._model.get("method"),n=this._model.get("isDistributeToQueue"),i=this._components["team-member-exclusion"];i.model=this._model,i.hidden=n||!e.includes(t)}}]),s}(),n2.de.page.team.postAssignment.postAssignmentDataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any distributors yet",this._contentTemplate='<p>Post assignment allows you to update a field after an assignment. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddDistributorButton()}},{key:"_insertAddDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-distributor",renderTo:this.SELECTORS.linkContainer,text:"Add your first distributor",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddDistributorClick(e)}}}))}},{key:"_onAddDistributorClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t))}}]),t}(),n2.de.page.team.postAssignment.postAssignmentObjectSync.EmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="You don't have any Object Sync Actions",this._contentTemplate='<p>{{content}} <span class="n2_link-container"></span> to get started.</p>',this._content="Object Sync actions allow you to update related objects to the same owner when an object is assigned.",this._objectName=null}},{key:"objectName",set:function(e){this._objectName=e}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{objectName:this._objectName})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._heading="You don't have any Object Sync Actions for "+this._objectName,this._insertAddActionButton()}},{key:"_insertAddActionButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-object-sync-action",renderTo:this.SELECTORS.linkContainer,text:"Add an Object Sync action",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddActionClick(e)}}}))}},{key:"_onAddActionClick",value:function(e){n2.de.page.Navigation.getInstance().open("ObjectSync_Actions")}}]),t}(),n2.de.page.team.teamList.apv.APVSummary=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.isNull(this._model)||this._insertComponents()}},{key:"_insertComponents",value:function(){}},{key:"_insertEmptyState",value:function(){return this.insert(new n2.ui.component.Illustration({id:"no-summary-data",illustration:n2.de.illustration.OpenRoad,cls:"slds-p-vertical_small",content:"There is currently no relevant configuration for this distributor."}))}}]),t}(),n2.de.page.team.teamList.apv.APVDistributorFilterSummary=function(){_inherits(t,n2.de.page.team.teamList.apv.APVSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){var e=this._insertFieldFilter(),t=this._insertCampaignFilter();n2.isUndefined(e)&&n2.isUndefined(t)&&this._insertEmptyState()}},{key:"_insertFieldFilter",value:function(){var e;if(this._model.hasFieldFilters)return e=this._model.isAdvancedFilter,this.insert(new n2.de.component.summary.LogicFiltersSummary({id:"field-filters",cls:"slds-p-vertical_small",label:"Field Filter",isAdvanced:e,logic:e?"":this._model.logicAndFilters.logic,filters:e?this._model.advancedFilter:this._model.logicAndFilters.filters}))}},{key:"_insertCampaignFilter",value:function(){if(this._model.hasCampaignFilters)return this.insert(new n2.de.component.summary.ListSummary({id:"campaign-filters",cls:"slds-p-vertical_small",label:"Campaign Filter",items:this._model.campaigns}))}}]),t}(),n2.de.page.team.teamList.apv.APVDistributorMemberFilterSummary=function(){_inherits(t,n2.de.page.team.teamList.apv.APVSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertTeamLevelCaps(),this._insertDistributorCaps(),this._insertMemberFilter()}},{key:"_insertTeamLevelCaps",value:function(){if(this._model.teamCapsEnabled)return this.insert(new n2.de.component.summary.FiltersSummary({id:"team-caps",label:"Team caps",cls:"slds-p-vertical_small",filters:[{val:this._model.teamCapsIgnored?"Ignored":this._model.teamCaps}]}))}},{key:"_insertDistributorCaps",value:function(){if(this._model.hasCap)return this.insert(new n2.de.component.summary.FiltersSummary({id:"distributor-caps",label:"Distributor caps",cls:"slds-p-vertical_small",filters:[{val:"".concat(this._model.capValue," ").concat(this._model.capType)}]}))}},{key:"_insertMemberFilter",value:function(){var e,t,n;return this._model.hasMemberFilters?"TEAM MEMBERS"===this._model.memberFilterType.toUpperCase()?(e=this._model.teamMemberFilters.map(function(e){return e.name}),t=this._model.teamMemberCount,n=200<=e.length&&200<t?"200+":e.length,this.insert(new n2.de.component.summary.ListSummary({id:"team-member-filters",label:"Assign by name (".concat(n,"/").concat(t,")"),cls:"slds-p-vertical_small",items:e}))):this.insert(new n2.de.component.team.summary.TagFiltersSummary({id:"tag-filters",label:"Assign by tag",cls:"slds-p-vertical_small",filters:this._model.tagFilters})):this.insert(new n2.de.component.summary.Summary({id:"all-member-filters",label:"Assign to any",cls:"slds-p-vertical_small"}))}}]),t}(),n2.de.page.team.teamList.apv.APVDistributorMethodSummary=function(){_inherits(t,n2.de.page.team.teamList.apv.APVSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertMethodSummary()}},{key:"_insertMethodSummary",value:function(){return this.insert(new n2.de.component.team.summary.ExtendedMethodSummary({id:"method",cls:"slds-p-vertical_small",label:"Method",model:this._model}))}}]),t}(),n2.de.page.team.teamList.apv.APVDistributorPostAssignmentSummary=function(){_inherits(t,n2.de.page.team.teamList.apv.APVSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){var e=this._insertUpdateField(),t=this._insertStatusField();n2.isUndefined(e)&&n2.isUndefined(t)&&this._insertEmptyState()}},{key:"_insertUpdateField",value:function(){if(this._model.fieldUpdateEnabled)return this.insert(new n2.de.page.team.teamList.apv.APVFieldsUpdateSummary({id:"update-field-summary",label:"Update fields",cls:"slds-p-vertical_small n2-de-summary",model:this._model}))}},{key:"_insertStatusField",value:function(){if(!n2.isUndefined(this._model.sourceType)&&"STATUS"===this._model.sourceType.toUpperCase())return this.insert(new n2.de.component.summary.FiltersSummary({id:"status-update-field",label:"Assign by Status assignment",cls:"slds-p-vertical_small",filters:[{name:this._model.assignStatusField,val:this._model.assignStatusAssignValue}]}))}}]),t}(),n2.de.page.team.teamList.apv.APVFieldsUpdateSummary=function(){_inherits(t,n2.de.component.summary.Summary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertUpdateLabel()}},{key:"_insertUpdateLabel",value:function(){return this.insert(new n2.de.component.MultiFieldUpdateLabel({id:"update-field-label",cls:"slds-m-top_xx-small n2-de-summary",model:this._model}))}}]),t}(),n2.de.page.team.teamList.apv.APVSidePanel=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{title:"h2"}),this._mixins=[n2.mixin.DataDriven],this._template='<div id="{{id}}" class="n2-component{{#componentCls}} {{componentCls}}{{/componentCls}}{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}"><h2>{{title}}</h2></div>',this._cls="n2-de-apv-side-panel slds-is-relative slds-p-horizontal_medium",this._title=null}},{key:"title",set:function(e){this._title!==e&&(this._title=e,this._refreshTitle())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{title:this._title})}},{key:"displayType",value:function(e){var t=e.type,e=e.section;if(this.destroyComponents(),"team"===t)this._insertTeamSummary();else if("distributor"!==t)return;"filter"===e?this._insertDistributorFilterSummary():"algorithm"===e?this._insertDistributorMethodSummary():"assignment"===e?this._insertDistributorMemberFilterSummary():"outcome"===e&&this._insertDistributorPostAssignmentSummary()}},{key:"_insertTeamSummary",value:function(){return this.insert(new n2.de.page.team.teamList.apv.APVTeamSummary({id:"apv-team-summary",model:this._model}))}},{key:"_insertDistributorFilterSummary",value:function(){return this.insert(new n2.de.page.team.teamList.apv.APVDistributorFilterSummary({id:"apv-distributor-filter-summary",model:this._model}))}},{key:"_insertDistributorMethodSummary",value:function(){return this.insert(new n2.de.page.team.teamList.apv.APVDistributorMethodSummary({id:"apv-distributor-method-summary",model:this._model}))}},{key:"_insertDistributorMemberFilterSummary",value:function(){return this.insert(new n2.de.page.team.teamList.apv.APVDistributorMemberFilterSummary({id:"apv-distributor-member-filter-summary",model:this._model}))}},{key:"_insertDistributorPostAssignmentSummary",value:function(){return this.insert(new n2.de.page.team.teamList.apv.APVDistributorPostAssignmentSummary({id:"apv-distributor-post-assignment-summary",model:this._model}))}},{key:"_refreshTitle",value:function(){this.element("title").text(this._title)}}]),t}(),n2.de.page.team.teamList.apv.APVTeamSummary=function(){_inherits(t,n2.de.page.team.teamList.apv.APVSummary);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertTeamFilter(),this._insertTeamMembers()}},{key:"_insertTeamFilter",value:function(){if(this._model.hasFieldFilters)return this.insert(new n2.de.component.summary.LogicFiltersSummary({id:"team-filters",cls:"slds-p-vertical_small",label:"Team Filter",isAdvanced:!1,logic:this._model.logicAndFilters.logic,filters:this._model.logicAndFilters.filters}))}},{key:"_insertTeamMembers",value:function(){var e=this._model.teamMembers;return n2.isEmpty(e)?this.insert(new n2.de.page.team.teamList.apv.TeamMemberEmptyState({id:"empty-state",cls:"slds-p-vertical_small",teamId:this._model.id})):(n2.sort(e,{property:"nameSort"}),this.insert(new n2.de.page.team.teamList.apv.UserListSummary({id:"team-member-list",cls:"slds-p-vertical_small",label:"Team Members",users:e})))}}]),t}(),n2.de.page.team.teamList.apv.TeamMemberEmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.REQUIRED_MEMBERS=n2.merge(this.REQUIRED_MEMBERS,["teamId"]),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any team members yet",this._contentTemplate='<p>{{content}} <span class="n2_link-container"></span> to get started.</p>',this._content="Team members are the users who receive assignments from this team.",this._teamId=null}},{key:"teamId",set:function(e){this._teamId=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddTeamMembersButton()}},{key:"_insertAddTeamMembersButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-team-members",renderTo:this.SELECTORS.linkContainer,text:"Add team members",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTeamMemberClick(e)}}}))}},{key:"_onAddTeamMemberClick",value:function(e){n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(this._teamId))}}]),t}(),n2.de.page.team.teamList.newTeamModal.DistributionObjectCombo=function(){_inherits(t,n2.ui.component.field.Combo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._sort=!1,this.listBoxCls="n2_distribution-object-list-box"}},{key:"options",set:function(e){var n,i,s;n2.compare(this._options,e)||(n=[],i=[],s=["Account","Case","Contact","Lead","Opportunity"],e.forEach(function(t){(s.findIndex(function(e){return e===t.value})<0?i:n).push(t)}),n2.isEmpty(n)||(n[n.length-1].cls="n2_last-standard-object"),this._options=[].concat(n,i),this._refreshOptions(),this._refreshInputFieldValue(),this._refreshPills())}}]),t}(),n2.de.page.team.teamList.newTeamModal.DistributionObjectComponent=function(){_inherits(t,n2.de.page.team.teamList.newTeamModal.DistributionObjectCombo);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._cls="n2-distribution-object-combo slds-m-bottom_x-small"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertLoadAllObjectsButton()}},{key:"_insertLoadAllObjectsButton",value:function(){this.insert(new n2.ui.component.HTML({id:"load-all-objects-text",template:"<p id={{id}} class=\"slds-m-top_x-small\">Can't find the object you're looking for?</p>"})),this.insert(new n2.ui.component.Button({id:"load-all-objects-button",theme:n2.ui.component.button.Theme.LINK,cls:"n2_load-all-objects",text:"Show all objects"}))}},{key:"hideAllObjectsButton",value:function(){this._components["load-all-objects-text"].hidden=!0,this._components["load-all-objects-button"].hidden=!0}},{key:"showAllObjectsButton",value:function(){this._components["load-all-objects-text"].hidden=!1,this._components["load-all-objects-button"].hidden=!1}}]),t}(),n2.de.page.team.teamList.teamsDataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{q2qContent:".n2_q2q-content"}),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this._template='<tr id="{{id}}" class="n2-data-table-empty-state{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><td id="n2_empty-state-container" colspan="{{colspan}}"><div class="n2-illustration slds-illustration{{#sizeCls}} {{sizeCls}}{{/sizeCls}}">'+n2.de.illustration.OpenRoad+'<div class="slds-text-longform slds-m-bottom_x-large">{{#heading}}{{>headingTemplate}}{{/heading}}{{#content}}{{>contentTemplate}}{{/content}}</div><div class="n2_q2q-content slds-p-top_x-large slds-border_top">{{>q2qContentTemplate}}</div></div></td></tr>',this._heading="Your org doesn't have any teams yet",this._content="Distribution Engine groups users into teams. These normally reflect your business structures. We use teams to distribute work among team members",this._q2qContentTemplate='<h2 class="slds-text-heading_small slds-p-bottom_xx-small">Not what you\'re looking for?</h2><p>Q2Q teams allow for distributing from a queue to a number of other queues.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this._insertAddStandardTeamButton(),this._insertAddQ2QTeamButton())}},{key:"_insertAddStandardTeamButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-standard-team",text:"Add Team",cls:"slds-m-top_large",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onAddStandardTeamClick(e)}}}))}},{key:"_onAddStandardTeamClick",value:function(e){this.fire("click",{target:e})}},{key:"_insertAddQ2QTeamButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-q2q-team",text:"Add Q2Q Team",cls:"slds-m-top_large",renderTo:this.SELECTORS.q2qContent,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddQ2QTeamClick(e)}}}))}},{key:"_onAddQ2QTeamClick",value:function(e){this.fire("click",{target:e})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{q2qContentTemplate:this._q2qContentTemplate})}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberModal.AddStandardMemberModalDataTable=function(){_inherits(t,n2.de.component.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_applySelection",value:function(){var n=this;n2.isEmpty(this._cachedRowSelection)||this.forEachRow(function(t){var e=n._cachedRowSelection.find(function(e){return e.id===t.data.id});t.select(!n2.isUndefined(e),{silent:!0})})}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.AddTeamMembers=function(){_inherits(s,n2.ui.Component);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CHANGE]),this._mixins=n2.merge(this._mixins,[n2.mixin.DataDriven,n2.mixin.Observable,n2.de.mixins.LimitLoads]),this.dataProviders=["get-max-team-members-per-team"],this._componentCls="n2_de-add-standard-member-stage",this._maxTeamMemberCount=null,this.currentTeamMemberCount=0,this._informationMessageTemplate='<div id="{{id}}" class="n2_user-limit-message slds-grid slds-m-bottom_small slds-hide">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),"\n            <div class=\"slds-col\">\n                <p>Displaying ' + n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT + ' users, use the filters to find others.</p>\n            </div>\n        </div>"),this._validationMessageTemplate='<div id="{{id}}" class="n2_max-selection-warning slds-hide"">\n            '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_xx-small slds-m-right_xx-small slds-icon-text-error"}),"\n            You must select between 1 and {{model}} team members.\n        </div>"),this._cannotAddMembersMessageTemplate='<div id="{{id}}" class="n2_max-selection-warning slds-hide""> \n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.ERROR,{cls:"slds-icon_xx-small slds-m-right_xx-small slds-icon-text-error"}),"\n            Cannot add more than {{model}} team members.\n        </div>"),this._performingReset=!1,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["validationMessage"],maxTeamMemberCount:["validationMessage"],currentTeamMemberCount:["validationMessage"]})}},{key:"filterForm",get:function(){return this._components["filter-form"]}},{key:"usersDataTable",get:function(){return this._components["users-data-table"]}},{key:"validationMessage",get:function(){return this._components["validation-message"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this.insert(new n2.ui.component.HTML({id:"user-limit-message",template:this._informationMessageTemplate,hidden:!0})),this._insertFilters(),this._insertUsersDataTable()}},{key:"_insertFilters",value:function(){var e=this,t=this.insert(new n2.ui.component.Form({id:"filter-form",cls:"n2_filters slds-grid slds-wrap slds-p-bottom_small"}));t.insert(new n2.ui.component.field.TextBox({id:"search",label:{text:"Search users",hidden:!0},cls:"slds-col slds-size_1-of-1 slds-p-bottom_xx-small",placeholder:"Find users...",icon:n2.ui.enum.Icon.SEARCH,listeners:{type:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.de.component.field.ChangeOnCloseCombo({id:"profiles",label:"Profiles",placeholder:"All profiles",cls:"slds-col slds-size_1-of-3 slds-p-right_x-small",mixins:[n2.mixin.DataDriven],dataProviders:["get-profiles"],options:{bindPath:"get-profiles"},multiple:!0,listeners:{change:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.ui.component.field.Combo({id:"date-added",label:"Date Added",placeholder:"All Time",cls:"slds-col slds-size_1-of-3 slds-p-right_x-small",mixins:[n2.mixin.DataDriven],dataProviders:["get-created-date-options"],options:{bindPath:"get-created-date-options"},listeners:{change:function(){return e._loadTeamMemberData()}},sort:!1})),t.insert(new n2.de.component.field.ChangeOnCloseCombo({id:"roles",label:"Roles",placeholder:"All roles",cls:"slds-col slds-size_1-of-3",mixins:[n2.mixin.DataDriven],dataProviders:["get-roles"],options:{bindPath:"get-roles"},multiple:!0,listeners:{change:function(){return e._loadTeamMemberData()}}})),t.insert(new n2.ui.component.field.Checkbox({id:"standard",label:"Standard users only",helpText:"Filter to only users with the Standard user type. User type is the category of user license linked to their assigned Salesforce profile",cls:"slds-p-top_small",value:!0,listeners:{change:function(){return e._loadTeamMemberData()}}}))}},{key:"_insertUsersDataTable",value:function(){var n=this;this.insert(new n2.de.page.team.teamMemberList.addStandardMemberModal.AddStandardMemberModalDataTable({id:"users-data-table",columns:[{header:"Name",bindPath:"name",sortable:!0},{header:"Username",bindPath:"username"}],selectable:!0,sortBy:{column:0,direction:"asc"},cls:"slds-is-relative n2_users-data-table",sortFunction:function(e,t){t=t.direction,t=void 0===t?"asc":t;if(n.usersDataTable&&n.usersDataTable.sortBy.direction!==t)return n._loadTeamMemberData({sortAscending:"asc"===t})},listeners:{selectionChange:function(e){return n._onUserSelectionChange(e)}}}))}},{key:"_onUserSelectionChange",value:function(e){e=this._createChangeEventObject([{property:"value",type:"select"}],{data:{value:{newValue:e.target.parent.selection}}});this.fire(n2.event.EventType.CHANGE,e)}},{key:"validate",value:function(){var e=this.usersDataTable.selection.length,e=0<e&&e+this.currentTeamMemberCount<=this._maxTeamMemberCount;return this.validationMessage.hidden=e}},{key:"reloadTeamMembers",value:function(){this._loadTeamMemberData({sortAscending:!0,silent:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return this._loadFilterData(),e.next=6,this._loadDataProvider("get-max-team-members-per-team",{silent:t,force:n});case 6:return e.t0=e.sent,e.abrupt("return",{maxTeamMembers:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadTeamMemberData",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.sortAscending,n=void 0===n?null:n,t=t.silent,t=void 0===t||t;if(!this._performingReset)return e=n2.de.page.team.Context.getInstance().teamId,e=n2.merge({teamId:e,sortAscending:n2.isNull(n)?"asc"===this.usersDataTable.sortBy.direction:n,userLimit:n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT},this._getFilterData()),this._limitLoads("get-available-users",{params:[e],force:!0,silent:t})}},{key:"_loadFilterData",value:function(){this._loadDataProvider("get-profiles",{silent:!1}),this._loadDataProvider("get-created-date-options",{silent:!1}),this._loadDataProvider("get-roles",{silent:!1})}},{key:"_getFilterData",value:function(){return{name:this.filterForm.components.search.value,profiles:this.filterForm.components.profiles.value,roles:this.filterForm.components.roles.value,createdDate:this.filterForm.components["date-added"].value,standardOnly:this.filterForm.components.standard.value}}},{key:"_onLoading",value:function(){this.filterForm.disabled=!0,this._showDataTableSpinner()}},{key:"_onLimitedLoading",value:function(){this._showDataTableSpinner()}},{key:"_showDataTableSpinner",value:function(){this._components["users-data-table"].spinner()}},{key:"reset",value:function(){this._performingReset=!0,this.filterForm.clear(),this._performingReset=!1,this.filterForm.components.standard.value={value:!0,silent:!0},this.usersDataTable.sortBy={column:0,direction:"asc"},this._clearSelection(),this.validationMessage.hidden=!0}},{key:"_clearSelection",value:function(){this.usersDataTable.forEachRow(function(e){e.selected=!1},{includeHeaderRow:!0})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-available-users"===t.id&&(this.usersDataTable.data=e,this.usersDataTable.spinner(!1),this.filterForm.disabled=!1,this._components["user-limit-message"].hidden=e.length<n2.de.ApplicationContext.getInstance().USER_DISPLAY_LIMIT)}},{key:"_onLoadComplete",value:function(e){e=e.maxTeamMembers;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._setProperty("maxTeamMemberCount",e.response)}},{key:"_refreshValidationMessage",value:function(){var e;n2.isUndefined(this.validationMessage)||this.validationMessage.destroy(),n2.isNull(this._maxTeamMemberCount)||(e=Math.min(50,this._maxTeamMemberCount-this.currentTeamMemberCount),this.insert(new n2.ui.component.HTML({id:"validation-message",template:e<=0?this._cannotAddMembersMessageTemplate:this._validationMessageTemplate,hidden:!0,mixins:[n2.mixin.DataDriven],model:e<=0?this._maxTeamMemberCount:e,renderTo:{target:".n2_users-data-table",position:"beforebegin"}})))}}]),s}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignTags=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this._componentCls="n2-assign-tags",this.updateValuesOnShow=!0}},{key:"modifyAssignments",get:function(){return this._components["modify-assignments"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertModifyAssignments()}},{key:"show",value:function(e){e=e.userIds;_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this.modifyAssignments.show({userIds:e,updateValuesOnShow:this.updateValuesOnShow}),this._setProperty("updateValuesOnShow",!1)}},{key:"_insertModifyAssignments",value:function(){return this._insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.ModifyAssignments({id:"modify-assignments",includeFormFooter:!1}))}},{key:"reset",value:function(){this.modifyAssignments.reset()}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignTeamMemberHours=function(){_inherits(o,n2.ui.Component);var e,t,n=_createSuper(o);function o(){return _classCallCheck(this,o),n.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).call(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-shift-hours","get-team-hours"],this._lazyLoad=!0,this._componentCls="n2_assign-team-member-hours",this._shiftHoursId=null,this._isTeamHours=!0,this._isIndividualHours=!1,this._shiftHours=null,this._timezones=null,this.updateValuesOnShow=!0,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["shiftHours"],isIndividualHours:["shiftComboOptions"],shiftHours:["shiftHours","localeText"],shiftHoursId:["shiftCombo"]})}},{key:"shiftCombo",get:function(){return this._components["shift-combo"]}},{key:"shiftHours",get:function(){return this._components["shift-hours"]}},{key:"timezoneSummary",get:function(){return this._components["timezone-summary"]}},{key:"isIndividualHours",get:function(){return this._isIndividualHours}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertShiftCombo(),this._insertShiftHours(),this._insertTimezoneSummary()}},{key:"_insertShiftCombo",value:function(){return this.insert(new n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTeamMemberHours.ShiftCombo({id:"shift-combo",label:"Team member hours",cls:"slds-col slds-size_1-of-2 slds-p-right_x-small",options:[],listeners:{change:this._handleShiftIdChange,scope:this}}))}},{key:"_insertShiftHours",value:function(){return this._insert(new n2.de.component.hours.ShiftHours({id:"shift-hours",mixins:[n2.mixin.DataDriven],shiftDays:{bindPath:".days"}}))}},{key:"_insertTimezoneSummary",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"timezone-summary",label:"Timezone",disabled:!0}))}},{key:"show",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(i=0<s.length&&void 0!==s[0]?s[0]:{}).isTeamHours,n=i.shiftHoursId,i=i.isIndividualHours,_get(_getPrototypeOf(o.prototype),"show",this).apply(this,s),this.updateValuesOnShow&&(this._setProperties({isTeamHours:t,isIndividualHours:i,shiftHoursId:n}),this.load(),this._setProperty("updateValuesOnShow",!1));case 2:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.next=5,Promise.all([this._loadDataProvider("get-timezone-options",{silent:t,force:n}),this._getHoursData()]);case 5:return s=e.sent,s=_slicedToArray(s,2),i=s[0],s=s[1],e.abrupt("return",{timezones:i,hoursData:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getHoursData",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.force,n=void 0!==n&&n,t=t.silent,t=void 0===t||t;return this._isTeamHours?(e=n2.de.page.team.Context.getInstance().teamId,this._loadDataProvider("get-team-hours",{params:[e],silent:t,force:n,requestId:e})):this._loadDataProvider("get-shift-hours",{params:[this._shiftHoursId],silent:t,force:n,requestId:this._shiftHoursId})}},{key:"_handleShiftIdChange",value:function(e){this._setProperties({isTeamHours:n2.isEmpty(e.value),isIndividualHours:!1,shiftHoursId:n2.isEmpty(e.value)?null:e.value}),this._getHoursData({silent:!1})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),"get-team-hours"===t.id&&this._setProperty("shiftHours",e.shiftHours),"get-shift-hours"===t.id&&this._setProperty("shiftHours",e)}},{key:"_onLoadComplete",value:function(e){var t=e.timezones,e=e.hoursData,e=(_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),n2.isUndefined(e.response.shiftHours)?e.response:e.response.shiftHours);this._setProperty("timezones",t.response),this._setProperty("shiftHours",e)}},{key:"reset",value:function(){this.shiftCombo.value={value:null,silent:!0},this.shiftCombo.setProperty("individualShiftId",null),this.shiftHours.model=null}},{key:"_getTimezoneLabel",value:function(t){return this._timezones.find(function(e){return e.value===t}).label}},{key:"_refreshShiftComboOptions",value:function(){this.shiftCombo.setProperty("individualShiftId",this.isIndividualHours?this._shiftHoursId:null)}},{key:"_refreshShiftHours",value:function(){this.shiftHours.model=this._shiftHours}},{key:"_refreshShiftCombo",value:function(){this.shiftCombo.value={value:this._shiftHoursId,silent:!0}}},{key:"_refreshLocaleText",value:function(){this.timezoneSummary.value={value:this._getTimezoneLabel(this._shiftHours.timezone),silent:!0}}}]),o}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.AssignWeighting=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this._componentCls="n2-weighting",this._defaultWeighting=null,this.updateValuesOnShow=!0,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["slider"],defaultWeighting:["slider"]})}},{key:"weightingSlider",get:function(){return this._components["weighting-slider"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertWeightingSlider()}},{key:"_insertWeightingSlider",value:function(){return this.insert(new n2.ui.component.field.Slider({id:"weighting-slider",cls:"slds-col slds-size_1-of-2 slds-m-bottom_x-small",label:"Weighting for all users",max:4,min:.25,step:.25,showNumberInput:!0,required:!1}))}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).weighting;_get(_getPrototypeOf(t.prototype),"show",this).apply(this,arguments),this.updateValuesOnShow&&(this._setProperty("defaultWeighting",e),this._setProperty("updateValuesOnShow",!1))}},{key:"reset",value:function(){this.weightingSlider.value={value:1,silent:!0},this._defaultWeighting=null}},{key:"_refreshSlider",value:function(){this.weightingSlider.value={value:this._defaultWeighting,silent:!0}}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.CopyConfiguration=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this._componentCls="n2-copy-configuration",this.teamMembersOptions=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["teamMembersCombo"],teamMembersOptions:["teamMembersCombo"]})}},{key:"createActiveCheckbox",get:function(){return this._components["create-active"]}},{key:"selectConfigCombo",get:function(){return this._components["select-config-combo"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertCreateActiveCheckbox(),this._insertSelectConfigCombo()}},{key:"_insertCreateActiveCheckbox",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"create-active",cls:"slds-m-bottom_x-small",label:"Create all users as active",value:!0}))}},{key:"_insertSelectConfigCombo",value:function(){return this.insert(new n2.ui.component.field.Combo({id:"select-config-combo",label:"Use existing config",placeholder:"No config",cls:"slds-col slds-size_1-of-2 slds-p-right_x-small",options:[],listeners:{change:this._loadTeamMemberConfig,scope:this},sort:!1}))}},{key:"_loadTeamMemberConfig",value:function(e){this.fire(n2.event.EventType.CLICK,this._createEventObject())}},{key:"reset",value:function(){this.createActiveCheckbox.value={value:!0,silent:!0},this.selectConfigCombo.value={value:null,silent:!0}}},{key:"_refreshTeamMembersCombo",value:function(){this.selectConfigCombo.options=this.teamMembersOptions}}]),t}(),n2.de.page.team.teamMemberList.teamMembersDataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=[n2.mixin.Observable],this._template='<tr id="{{id}}" class="n2-data-table-empty-state{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><td id="n2_empty-state-container" colspan="{{colspan}}"><div class="slds-illustration n2-illustration{{#sizeCls}} {{sizeCls}}{{/sizeCls}}">'+n2.de.illustration.OpenRoad+'<div class="slds-text-longform slds-m-bottom_x-large">{{#heading}}{{>headingTemplate}}{{/heading}}{{#content}}{{>contentTemplate}}{{/content}}</div></div></td></tr>',this._heading="Your team doesn't have any team members yet",this._content="Team members are the users who receive assignments from this team."}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddTeamMemberButton()}},{key:"_insertAddTeamMemberButton",value:function(){this._insert(new n2.ui.component.SplitButton({id:"add-team-member",buttonText:"Add Team Members",cls:"slds-m-top_large n2_add-members",menuOptions:this._getMenuOptions(),listeners:{click:this._handleAddTeamMember,select:this._handleAddTeamMember,scope:this}}))}},{key:"_getMenuOptions",value:function(){return n2.de.page.team.Context.getInstance().isQ2QTeam?[]:[{id:"add-and-configure",label:"Add and Configure"}]}},{key:"_handleAddTeamMember",value:function(e){e="add-and-configure"===e.target.id?"show-add-wizard":"show-add-modal",e=this._createEventObject({data:{actions:[e]}});this.fire(n2.event.EventType.CLICK,e)}}]),t}(),n2.de.page.team.teamPerformance.modifyAssignments.Toolbar=function(){_inherits(t,n2.de.component.tags.modifyTagAssignments.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._tagCollectionOptions=[]}},{key:"tagCollectionOptions",set:function(e){this._tagCollectionOptions=e,this._refreshCollectionsFilter()}},{key:"tagCollectionFilterConfig",get:function(){return{id:this.tagCollectionsFilterId,cls:"n2_collections-filter slds-m-right_small",placeholder:"All collections",label:{text:"Tag collection filter",hidden:!0},multiple:!0,options:[],renderTo:this.SELECTORS.left,listeners:{change:this._handleFilter,scope:this}}}},{key:"_refreshCollectionsFilter",value:function(){this.collectionsFilter.options=this._tagCollectionOptions,this.collectionsFilter.disabled||this.collectionsFilter._enable()}}]),t}(),n2.de.page.team.teamPerformance.teamPerformanceRecordList.DataTable=function(){_inherits(s,n2.de.component.DataTable);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{colgroup:"colgroup"}),this._selectable=!0,this._cls="n2-de-team-performance-data-table",this._sortBy={column:2,direction:"dsc"},this._rowClass=n2.de.page.team.teamPerformance.teamPerformanceRecordList.dataTable.Row,this._emptyState={type:n2.de.page.team.teamPerformance.teamPerformanceRecordList.dataTable.EmptyState},this._emptyFilteredState={illustration:n2.ui.component.illustration.FishingDeals,heading:"There are no team members that match your filters",content:""},this._teamData=null}},{key:"teamData",set:function(e){this._teamData=e,this.columns=this._generateColumnDefinitions(),this._refresh()}},{key:"selectable",set:function(e){this._selectable!==e&&(this._selectable=e,this._refresh())}},{key:"_onDefined",value:function(){this.columns=this._generateColumnDefinitions(),_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.header,i=e.emptyState,i=void 0!==i&&i,e=e.data,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshDataTableHeader(),(t||i)&&this._refreshEmptyStateComponent(),(t||e)&&this._refreshDataTableData(),_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments)}},{key:"_refreshDataTableHeader",value:function(){this._refreshColgroup(),this.headerRow.destroy(),this._addHeaderRow(),this._applySortBy(this._sortBy)}},{key:"_refreshColgroup",value:function(){var t=this;this.element("colgroup").clear(),this._getTotalColumns().forEach(function(e){return t.element("colgroup").insert('<col class="'.concat(e.cls||"",'"/>'))})}},{key:"_refreshEmptyStateComponent",value:function(){this._emptyState.hasPerformanceMetrics=this._teamData.hasPerformanceMetrics,this._emptyState.hasTeamMembers=!n2.isEmpty(this._teamData.teamMembers)}},{key:"_refreshDataTableData",value:function(){this.data=!this._teamData.hasPerformanceMetrics||n2.de.page.team.teamPerformance.Context.getInstance().isQ2QTeam?[]:this._teamData.teamMembers}},{key:"_generateColumnDefinitions",value:function(){var e,t=this,n=[{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",sort:{bindPath:".nameSort"},sortable:!0,cell:{cellTemplate:"",cls:"n2_avatar",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",cls:"n2_team-member",bindPath:"name",sort:{bindPath:".nameSort"},sortable:!0}];return n2.isNull(this._teamData)||(e=this._getObjectMetricColumnName(),n2.isUndefined(e))||n.push({header:e,cls:"n2_rate",bindPath:"sobjectMetricString",sortable:!0,sort:{bindPath:".sobjectMetric",adapter:function(e){return n2.isNull(e)?"dsc"===t._sortBy.direction?-1:110:e}},cell:{cls:"slds-text-align_right",dataAdapter:function(e){return t._getCellContent(e)}}}),!n2.isNull(this._teamData)&&this._teamData.isActionTracking&&n.push({header:"Avg Time to Action",bindPath:"avgTimeToAction",cls:"n2_avg-time-to-action",sortable:!0,sort:{bindPath:".avgTimeToActionHours"},cell:{cls:"slds-text-align_right",dataAdapter:function(e){return t._getCellContent(e)}}}),n.push({header:"Hours worked",cls:"n2_hours-worked",bindPath:"hoursWorked",sortable:!0,cell:{cls:"slds-text-align_right",dataAdapter:function(e){return t._getCellContent(e)}}}),n2.isNull(this._teamData)||!this._teamData.tagWeightingEnabled&&!this._teamData.teamLevelCapsEnabled||n.push({header:"Tags",cls:"n2_tags",cell:{cellTemplate:"",components:[{id:"tags-pill-list",type:n2.de.component.tags.AssignedTagsPillList,context:n2.de.page.team.teamPerformance.Context,mixins:[n2.mixin.DataDriven],pills:{bindPath:".tags",adapter:function(e){return e.map(function(e){return{text:"".concat(e.collectionName,"/").concat(e.tagName),value:"".concat(e.collectionId,"_").concat(e.tagId)}})}}}]}}),n}},{key:"_addHeaderRow",value:function(){var n=this;this.insert(new n2.ui.component.dataTable.Row({id:"th-row",headerRow:!0,columns:this.columns,renderTo:this.SELECTORS.tableHeader,selectable:this._selectable,hidden:this._hideHeaderRow,listeners:{selectionChange:function(e){return n._onHeaderRowSelectionChange(e)},sort:function(e){var t=e.target;n.headerRow.forEachCell(function(e){e!==t&&(e.sortDirection=null)}),n._sortBy={column:n.columns.indexOf(e.target.column),direction:e.data.sortDirection},n._sort(e.target.column,{direction:e.data.sortDirection}),n._refreshData()}}}))}},{key:"_getCellContent",value:function(e){return n2.isNull(e)?{html:"<span>&mdash;</span>"}:e}},{key:"_getObjectMetricColumnName",value:function(){switch(this._teamData.objectName){case"Lead":return"Conversion %";case"Case":case"Opportunity":return"Close %"}}}]),s}(),n2.de.page.team.teamPerformance.teamPerformanceRecordList.Footer=function(){_inherits(t,n2.de.component.recordList.AbstractFooter);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_insertComponents",value:function(){this._insertClearFiltersButton()}}]),t}(),n2.de.page.team.teamPerformance.teamPerformanceRecordList.Toolbar=function(){_inherits(t,n2.de.component.recordList.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._showLogsWarning=!1,this.SELECTORS=n2.merge(this.SELECTORS,{infoMessageContainer:".n2-de-performance-date-range-container",warningMessageContainer:".n2-de-toolbar-msg-container"}),this._cls="n2-de-team-performance-toolbar",this._infoMessage="You have selected a date range that is longer than your org saves Distribution logs for. As a result the data displayed will be incomplete.",this._adminMessage="To record data for longer, update the Maintain Distribution Logs field on Distribution Settings.",this._template='<div id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2-de-performance-toolbar-filters n2-de-record-list-toolbar">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>\n            <div class="n2-de-performance-date-range-container slds-m-left_small slds-m-top_xx-small"></div>\n            <div class="n2-de-toolbar-msg-container slds-m-around_small"></div>\n        </div>',this._performanceDateRangeTemplate='<div id="{{id}}" class="n2_performance-date-range-detail slds-grid slds-grid_vertical-align-center">\n            <div class="slds-col">\n                <p>Showing data from {{model.startDate}} to {{model.endDate}}</p>\n            </div>\n        </div>',this._logsMessageTemplate='<div id="{{id}}" class="n2_logs-duration-info-message slds-grid slds-grid_vertical-align-center">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p>{{model.infoMessage}}</p>\n                {{#model.showAdminMessage}}\n                <p>{{model.adminMessage}}</p>\n                {{/model.showAdminMessage}}\n            </div>\n        </div>'),this._dateRange=null,this._hasTags=!1}},{key:"hasTags",set:function(e){this._hasTags!==e&&(this._hasTags=e,this._refreshMenu())}},{key:"showLogsWarning",set:function(e){this._showLogsWarning!==e&&(this._showLogsWarning=e,this._refreshLogsWarningMessage())}},{key:"dateRange",set:function(e){var t=e.startDate,e=e.endDate;this._dateRange={startDate:this._formatDate(t),endDate:this._formatDate(e)},this._refreshDateRangeMessage()}},{key:"menu",get:function(){return this.components["toolbar-menu"]}},{key:"dateRangeFilter",get:function(){return this.components["performance-date-range-filter"]}},{key:"_insertComponents",value:function(){this._insertQuickFilter({text:"Find name"}),this._insertDateRangeFilter()}},{key:"_insertMenu",value:function(){return this.insert(new n2.ui.component.Menu({id:"toolbar-menu",cls:"n2_menu",options:[{id:"modify-assignments",label:"Modify",hidden:!0}],disabled:!0,listeners:{select:this._handleClick,scope:this}}))}},{key:"_refreshMenu",value:function(){n2.isUndefined(this.menu)||this.menu.destroy(),this._hasTags&&this._insertMenu()}},{key:"_refreshDateRangeMessage",value:function(){n2.isUndefined(this.components["performance-start-end-date-msg"])||this.components["performance-start-end-date-msg"].destroy(),n2.isNull(this._dateRange)||this._insertDateRangeInfoMessage()}},{key:"_refreshLogsWarningMessage",value:function(){n2.isUndefined(this.components["logs-duration-warning"])||this.components["logs-duration-warning"].destroy(),this._showLogsWarning&&this._insertLogsDurationWarning()}},{key:"_insertDateRangeFilter",value:function(){return this.insert(new n2.ui.component.field.Combo({id:"performance-date-range-filter",cls:"n2-de-performance-date-filter",renderTo:this.SELECTORS.left,label:{text:"Date range filter",hidden:!0},required:!0,sort:!1,options:[{label:"Last week",value:"LAST_WEEK"},{label:"Last month",value:"LAST_MONTH"},{label:"Last 3 months",value:"LAST_N_MONTHS:3"},{label:"Last year",value:"LAST_YEAR"}],listeners:{change:this._handleFilter,scope:this}}))}},{key:"_insertDateRangeInfoMessage",value:function(){return this.insert(new n2.ui.component.HTML({id:"performance-start-end-date-msg",mixins:[n2.mixin.DataDriven],model:this._dateRange,template:this._performanceDateRangeTemplate,renderTo:this.SELECTORS.infoMessageContainer}))}},{key:"_insertLogsDurationWarning",value:function(){return this.insert(new n2.ui.component.HTML({id:"logs-duration-warning",mixins:[n2.mixin.DataDriven],model:{infoMessage:this._infoMessage,showAdminMessage:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager,adminMessage:this._adminMessage},template:this._logsMessageTemplate,renderTo:this.SELECTORS.warningMessageContainer}))}},{key:"_formatDate",value:function(e){return n2.de.util.Date.formatTimestamp(e,{dateOnly:!0})}},{key:"clear",value:function(){this.quickFilter.clear()}}]),t}(),n2.de.page.team.teamSummary.stats.Assignments=function(){_inherits(n,n2.de.component.Card);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{chart:".n2_assignments-chart",averageAssignments:".n2_de-average-assignments"}),this._componentCls="n2-de-card n2-de-assignment-stats",this._assignmentsData=null,this._headingContentTemplate='<span>\n            <span>{{heading}}</span>\n            <span class="n2-past-7-days">Past 7 days</span>\n        </span>',this._contentTemplate='<div class="n2_de-average-assignments"></div><div class="n2_assignments-chart{{#isAdminOrSystemManager}} n2_pointer{{/isAdminOrSystemManager}}"></div>',this._heading="Assignments",this._chart=null}},{key:"assignmentsData",set:function(e){n2.compare(this._assignmentsData,e)||(this._assignmentsData=e,this._refreshAssignments())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"n2_empty-state slds-m-top_xx-large",renderTo:this.SELECTORS.cardContent,content:"We didn't find any assignments for the past 7 days.",hidden:!0}))}},{key:"_refreshAssignments",value:function(){n2.isUndefined(this._components["average-assignments"])||this._components["average-assignments"].destroy(),n2.isNull(this._chart)||this._destroyChart();var e=!n2.isEmpty(this._assignmentsData.assignmentCounts.assignmentsPerDay);(this._components["empty-state"].hidden=e)&&(this._insertAverageAssignments(),this._chart=this._insertChart())}},{key:"_insertAverageAssignments",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"average-assignments",renderTo:this.SELECTORS.averageAssignments,label:"Average assignments per hour",cls:"n2_field-medium slds-m-bottom_x-small",disabled:!0,value:this._assignmentsData.assignmentCounts.averageAssignmentsPerHour}))}},{key:"_insertChart",value:function(){n2.isNull(this._chart)||(this._chart=this._chart.destroy());var e=c3.generate({bindto:this.SELECTORS.chart,size:{height:150},point:{show:!1},data:{columns:[],colors:{Assignments:"#1FD7FF"},labels:!1},axis:{y:{show:!1},x:{show:!1}}}),t=this._getAssignmentsPerDay();return e.load({columns:[["Assignments"].concat(_toConsumableArray(t))],legend:{show:!1}}),e}},{key:"_getAssignmentsPerDay",value:function(){var e,t=[],n=this._assignmentsData.assignmentCounts.assignmentsPerDay,i=_createForOfIteratorHelper(Object.entries(n).sort(function(e,t){return e[0]-t[0]}));try{for(i.s();!(e=i.n()).done;){var s=_slicedToArray(e.value,2)[1];t.push(s)}}catch(e){i.e(e)}finally{i.f()}return t}},{key:"_bindEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this.element("chart").listen("click",function(e){t._navigateToAnalyticsPage()})}},{key:"_navigateToAnalyticsPage",value:function(){var e=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Analytics_Distribution","teamId=".concat(e))}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).apply(this,arguments),this.element("chart").purgeListeners(),this._assignmentsData=null,this._destroyChart()}},{key:"_destroyChart",value:function(){this._chart.destroy(),this._chart=null}}]),n}(),n2.de.page.team.teamSummary.stats.TopDistributors=function(){_inherits(n,n2.de.component.Card);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{chart:".n2_top-distributor-chart"}),this._componentCls="n2-de-card n2-de-top-distributor-stats",this._topDistributorsData=null,this._headingContentTemplate='<span>\n            {{#isAdminOrSystemManager}}<a href="javascript:void(0)">{{heading}}</a>{{/isAdminOrSystemManager}}\n            {{^isAdminOrSystemManager}}{{heading}}{{/isAdminOrSystemManager}}\n            <span class="n2-past-7-days">Past 7 days</span>\n        </span>',this._contentTemplate='<div class="n2_top-distributor-chart{{#isAdminOrSystemManager}} n2_pointer{{/isAdminOrSystemManager}}"></div>',this._heading="Top distributors",this._chart=null}},{key:"topDistributorsData",set:function(e){n2.compare(this._topDistributorsData,e)||(this._topDistributorsData=e,this._refreshTopDistributors())}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"n2_empty-state slds-m-top_xx-large",renderTo:this.SELECTORS.cardContent,content:"We didn't find any assignments for the past 7 days.",hidden:!0}))}},{key:"_refreshTopDistributors",value:function(){n2.isNull(this._chart)||this._destroyChart();var e=!n2.isEmpty(this._topDistributorsData.topDistributors);(this._components["empty-state"].hidden=e)&&(this._chart=this._insertChart())}},{key:"_insertChart",value:function(){var e=this._topDistributorsData.topDistributors.map(function(e){return e.distributorName}),t=this._topDistributorsData.topDistributors.map(function(e){return e.assignmentCount}),n=c3.generate({bindto:this.SELECTORS.chart,size:{height:150},data:{x:"Distributors",columns:[],type:"bar",colors:{Assignments:"#1FD7FF"},labels:!0},axis:{rotated:!0,x:{type:"category",height:5,padding:{top:100}},y:{show:!1}},legend:{show:!1}});return n.load({columns:[["Distributors"].concat(_toConsumableArray(e)),["Assignments"].concat(_toConsumableArray(t))]}),this._refreshAllDistributorTickText(),n}},{key:"_refreshAllDistributorTickText",value:function(){var t=this;this.element("chart").findAll(".c3-axis-x .tick text").forEach(function(e){t._refreshDistributorTickText(e)})}},{key:"_refreshDistributorTickText",value:function(e){var t=this._extractDistributorTitle(e),n=(e.parent.insert("<title>".concat(t,"</title>"),"afterbegin"),this._truncateDistributorTickText(t));e.clear(),e.attribute("data-full-name",t),e.insert("<tspan>".concat(n,"</tspan>"))}},{key:"_extractDistributorTitle",value:function(e){var t;return n2.isUndefined(e.rawDOM.dataset.fullName)?(t="",e.findAll("tspan").forEach(function(e){t+=0===t.length?e.text():" ".concat(e.text())}),t):e.rawDOM.dataset.fullName}},{key:"_truncateDistributorTickText",value:function(e){return 17<e.length?"".concat(e.substring(0,15),"..."):e}},{key:"_bindEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindEvents",this).call(this),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&(this.element("chart").listen("mousedown",function(e){"tspan"===e.target.tagName&&t._navigateToDistributorSettings(t._getDistributorIdByName(e.target.parentNode.dataset.fullName))}),this._bindHeadingClick()),n2.ui.dom.Scope.getInstance().root.listen("click",this._onScopedRootClick,{scope:this})}},{key:"_onScopedRootClick",value:function(e){this._refreshAllDistributorTickText()}},{key:"_getDistributorIdByName",value:function(t){return this._topDistributorsData.topDistributors.filter(function(e){return e.distributorName===t})[0].distributorId}},{key:"_navigateToDistributorSettings",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorSettings","distributorId=".concat(e,"&teamId=").concat(t))}},{key:"_refreshHeading",value:function(){_get(_getPrototypeOf(n.prototype),"_refreshHeading",this).call(this),this._bindHeadingClick()}},{key:"_bindHeadingClick",value:function(){this.element("heading").listen("click",this._onHeadingClick)}},{key:"_onHeadingClick",value:function(e){var t;"A"===e.target.tagName&&(t=n2.de.page.team.Context.getInstance().teamId,n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t)),e.preventDefault())}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).apply(this,arguments),this._topDistributorsData=null,this._destroyChart()}},{key:"_destroyChart",value:function(){this._chart.destroy(),this._chart=null}}]),n}(),n2.de.page.team.teamSummary.stats.TrackingSummary=function(){_inherits(t,n2.de.component.Card);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-card n2-de-tracking-summary-stats",this._trackingSummaryData=null,this._headingContentTemplate='<span>\n            <span>{{heading}}</span>\n            <span class="n2-past-7-days">Past 7 days</span>\n        </span>',this._heading="Tracking summary"}},{key:"trackingSummaryData",set:function(e){n2.compare(this._trackingSummaryData,e)||(this._trackingSummaryData=e,this._refresh())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState(),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertSetupTrackingLink()}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.ui.component.Illustration({id:"empty-state",cls:"n2_empty-state",renderTo:this.SELECTORS.cardContent,heading:"Action tracking not enabled",content:"Action tracking allows you to monitor the time taken from assignment to your chosen milestone. E.g. Time to contact on a lead or time to resolve on a case. ",hidden:!0}))}},{key:"_insertSetupTrackingLink",value:function(){var t=this;return this._components["empty-state"].insert(new n2.de.component.Link({id:"setup-tracking-link",renderTo:"p.slds-text-body_regular",text:"Set up tracking.",listeners:{click:function(e){return t._onSetupTrackingLinkClick(e)}}}))}},{key:"_onSetupTrackingLinkClick",value:function(e){this._navigateToTrackingAndSLAs(),e.event.preventDefault()}},{key:"_refreshContent",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshContent",this).apply(this,arguments),this._refreshTrackingSummary()}},{key:"_refreshTrackingSummary",value:function(){var e=!n2.isEmpty(this._trackingSummaryData.trackingEnabled);this._components["empty-state"].hidden=e,this._destroyTrackingAnalytics(),e&&this._insertTrackingAnalytics()}},{key:"_destroyTrackingAnalytics",value:function(){n2.isUndefined(this._components["time-to-action"])||this._components["time-to-action"].destroy(),n2.isUndefined(this._components["failed-slas"])||this._components["failed-slas"].destroy(),n2.isUndefined(this._components["auto-reassignments"])||this._components["auto-reassignments"].destroy()}},{key:"_insertTrackingAnalytics",value:function(){this._insertTimeToAction(),this._insertFailedSLAs(),this._insertAutoReassignments()}},{key:"_insertTimeToAction",value:function(){return this._insert(new n2.ui.component.Field({id:"time-to-action",label:"Time to action (avg)",cls:"slds-m-bottom_x-small",components:[this._createSummaryValueComponent(this._trackingSummaryData.trackingAnalytics.averageTimeToAction||"0")]}))}},{key:"_insertFailedSLAs",value:function(){return this._insert(new n2.ui.component.Field({id:"failed-slas",label:"Failed SLAs",cls:"slds-m-bottom_x-small",components:[this._createSummaryValueComponent(this._trackingSummaryData.trackingAnalytics.slasBreached)]}))}},{key:"_insertAutoReassignments",value:function(){return this._insert(new n2.ui.component.Field({id:"auto-reassignments",label:"Auto-reassignments",cls:"slds-m-bottom_x-small",components:[this._createSummaryValueComponent(this._trackingSummaryData.trackingAnalytics.reassignmentCount)]}))}},{key:"_createSummaryValueComponent",value:function(e){var t=this;return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager?new n2.de.component.Link({id:"link",text:e,cls:"n2_summary-value",listeners:{click:function(){return t._navigateToTrackingAndSLAs()}}}):new n2.ui.component.HTML({id:"text",mixins:[n2.mixin.DataDriven],template:'<span class="n2_summary-value">{{model}}</span>',model:e})}},{key:"_navigateToTrackingAndSLAs",value:function(){var e=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TrackingAndSlas","teamId=".concat(e))}},{key:"destroy",value:function(){_get(_getPrototypeOf(t.prototype),"destroy",this).apply(this,arguments),this._trackingSummaryData=null}}]),t}(),n2.de.page.team.teamSummary.teamMembersList.TeamMember=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{avatar:".n2_avatar-container"}),this._componentCls="n2-de-team-summary-member",this._mixins=[n2.mixin.DataDriven],this._template='<li id="{{id}}" class="{{#componentCls}}{{componentCls}}{{/componentCls}}{{#cls}} {{cls}}{{/cls}}">\n            <div class="n2_avatar-container"></div>\n            <div class="n2_details">\n                <p class="n2-name">{{name}}</p>\n                <p class="n2-status"><span class="n2-status-symbol{{#isOnline}} n2-available{{/isOnline}}"></span> <span class="n2-status-text">{{status}}</span></p>\n            </div>\n        </li>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAvatar()}},{key:"_insertAvatar",value:function(){return this._insert(new n2.ui.component.Avatar({id:"avatar",avatar:this._model.avatarUrl,displayName:this._model.name,renderTo:this.SELECTORS.avatar}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{name:this._model.name,isOnline:"Available"===this._model.status,status:this._model.status})}}]),t}(),n2.de.page.team.trackingAndSlas.distributorSettings.DistributorSettingsDataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._cls="n2-de-tracking-and-slas-data-table",this._HEADERS={distributor:"Distributor",type:"Type",order:"Order",slaEnabled:"SLA Enabled",autoReassignEnabled:"Auto Reassign Enabled"},this.columns=[{header:this._HEADERS.distributor,bindPath:"name"},{header:this._HEADERS.type,cls:"n2_type-column",bindPath:"distributorType"},{header:this._HEADERS.order,cls:"n2_order-column",bindPath:"order",cell:{cls:"slds-text-align_right"}},{header:this._HEADERS.slaEnabled,cell:{dataAdapter:function(e){return e.slasEnabled?"Yes":{html:"<span>&mdash;</span>"}}}},{header:this._HEADERS.autoReassignEnabled,cell:{dataAdapter:function(e){return e.autoReassign?"Yes":{html:"<span>&mdash;</span>"}}}}]}},{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(n.prototype),"_addHeaderRow",this).apply(this,arguments);var t=[this._HEADERS.order];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_createRow",value:function(){var e=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return e.data.isActive||(e.cls="n2_inactive"),e}}]),n}(),n2.de.page.team.trackingAndSlas.distributorSettings.DistributorSettingsForm=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-distributor-tracking-and-slas"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertSlasFieldGroup()}},{key:"_insertSlasFieldGroup",value:function(){this._insert(new n2.de.page.team.trackingAndSlas.distributorSettings.distributorSettingsForm.SlasFieldGroup({id:"slas-field-group",mixins:[n2.mixin.DataDriven],cls:"slds-m-top_medium"}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-tracking-and-slas-form")}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["slas-field-group"].model=e)}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("save-distributor-tracking-and-slas").post({params:[this._model.json]})}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadDistributorSettings({force:!0})}},{key:"_onCancel",value:function(){this._loadDistributorSettings({force:!0})}},{key:"_loadDistributorSettings",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributor-slas").get({params:[n],force:t,silent:e})}},{key:"_showFooter",value:function(){this._components["save-footer"].message="",this._components["save-footer"].hidden=!1}}]),n}(),n2.de.page.team.trackingAndSlas.distributorSettings.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any distributors yet",this._contentTemplate='<p>Distributors are the rules which define what assignments will be made to team members. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddDistributorButton()}},{key:"_insertAddDistributorButton",value:function(){var t=this;return this._insert(new n2.ui.component.Button({id:"add-distributor",renderTo:this.SELECTORS.linkContainer,text:"Add your first distributor",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddDistributorClick(e)}}}))}},{key:"_onAddDistributorClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t))}}]),t}(),n2.de.page.team.trackingAndSlas.teamSettings.ActionTracking=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Action tracking",this._toggleActive=!0,this._helpText={text:"Enable Distribution Engine to record how long it takes between a record being assigned and a specified action being performed.",position:n2.ui.enum.Position.BELOW}}},{key:"_insertFields",value:function(){this._insertRespectDistributionHours(),this._insertActionField(),this._insertActionsToTrack(),this._insertTrackActionsFromAnyUser(),this._insertAutoAction()}},{key:"_insertRespectDistributionHours",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"respect-distribution-hours",label:"Respect distribution hours",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:{text:"Only record time that the user was available. This can cover both team and individual hours, team hours only or not respect distribution hours at all.",position:n2.ui.enum.Position.BELOW},options:["None","Team only","Team and member"],sort:!1,required:!0,value:{bindPath:".trackingRespectsHours"}}))}},{key:"_insertActionField",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"action-field",label:"Action field",mixins:[n2.mixin.DataDriven],dataProviders:["get-action-field-options"],cls:"n2_field-medium slds-m-bottom_medium",options:{bindPath:"get-action-field-options"},required:!0,value:{bindPath:".actionTrackingField"},listeners:{change:function(){return e._refreshActionsToTrackOptions()}}}))}},{key:"_refreshActionsToTrackOptions",value:function(){this._loadActionsToTrackOptions(),this._model.getProperty("trackedActions").value=[],this._components["actions-to-track"].model=this._model}},{key:"_loadActionsToTrackOptions",value:function(){n2.DataProviderManager.getInstance().get("get-picklist-field-select-options").get({params:[this._model.get("objectName"),this._model.get("actionTrackingField")],requestId:"actions-to-track",force:!0})}},{key:"_insertActionsToTrack",value:function(){var n=this;return this._insert(new n2.ui.component.field.Combo({id:"actions-to-track",label:"Actions to track",mixins:[n2.mixin.DataDriven],dataProviders:["get-picklist-field-select-options"],cls:"n2_field-medium slds-m-bottom_medium",required:!0,multiple:!0,options:{bindPath:"get-picklist-field-select-options:actions-to-track"},value:{bindPath:".trackedActions"},listeners:{change:function(){n._components["auto-action"].model=n._model},loaded:function(e){var t=n._model.get("trackedActions");n2.isArray(t)&&t.length&&e.clearInvalid()}}}))}},{key:"_insertTrackActionsFromAnyUser",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"track-actions-from-any-user",mixins:[n2.mixin.DataDriven],label:"Track actions from any user",cls:"slds-m-bottom_medium",helpText:"If disabled, only actions from the owner will be tracked.",value:{bindPath:".trackActionsFromAnyUser"}}))}},{key:"_insertAutoAction",value:function(){return this._insert(new n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.AutoAction({id:"auto-action"}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("trackingEnabled").value=e.value,this._refreshFieldVisibility()}},{key:"_refreshFieldVisibility",value:function(){var t=this;this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t._model.get("trackingEnabled"))})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["toggle-active"].value={value:e.get("trackingEnabled"),silent:!0},this._components["respect-distribution-hours"].model=e,this._components["action-field"].model=e,this._components["actions-to-track"].model=e,this._components["auto-action"].model=e,this._components["track-actions-from-any-user"].model=e,this._refreshFieldVisibility(),n2.DataProviderManager.getInstance().get("get-action-field-options").get({params:[this._model.get("objectName")]}),this._model.get("actionTrackingField"))&&this._loadActionsToTrackOptions()}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.Slas=function(){_inherits(o,n2.de.component.form.FieldGroup);var n,e=_createSuper(o);function o(){return _classCallCheck(this,o),e.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="SLAs",this._toggleActive=!0,this._slaFiltersModel=null,this._helpText="Set time based targets for actions to be completed."}},{key:"filtersFieldGroup",get:function(){return this._components["sla-filters-field-group"]}},{key:"filters",get:function(){return this.filtersFieldGroup.components["sla-filters"]}},{key:"_insertFields",value:function(){this._insertRespectDistributionHours(),this._insertSlaType(),this._insertSlaFilters()}},{key:"_insertRespectDistributionHours",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"respect-distribution-hours",label:"Respect distribution hours",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Only counts time that the user was available. This can cover both team and individual hours, team hours only or not respect distribution hours at all.",options:["None","Team only","Team and member"],required:!0,sort:!1,value:{bindPath:".slasRespectHours"}}))}},{key:"_insertSlaType",value:function(){var t=this;return this._insert(new n2.ui.component.field.Combo({id:"sla-type",label:"Alert type",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",options:[],sort:!1,required:!0,value:{bindPath:".slaType"},listeners:{change:function(e){return t._onSlaTypeChange(e)},loaded:function(e){return t._setDefaultSlaType(e)}}}))}},{key:"_onSlaTypeChange",value:function(e){this._model.getProperty("slas").value=[""],this._slaFiltersModel.getProperty("slaType").value=e.value,this._slaFiltersModel.getProperty("filters").value=[],this.filters.model=this._slaFiltersModel,this.filters.max=this._getMaxSlas()}},{key:"_getMaxSlas",value:function(){return this._model.get("slaType")===n2.de.enum.team.AlertType.CONTINUOUS_ALERT?1:3}},{key:"_setDefaultSlaType",value:function(e){this._model.get("slaType")||(e.value={value:n2.de.enum.team.AlertType.TIME_PERIOD_ALERT,silent:!0})}},{key:"_getSlaTypeOptions",value:function(){var e=[{label:"Time Checkpoint SLAs",value:n2.de.enum.team.AlertType.TIME_PERIOD_ALERT},{label:"Continuous Field Monitoring SLAs",value:n2.de.enum.team.AlertType.CONTINUOUS_ALERT}];return this._model.get("customDateTimeSlaEnabled")&&e.push({label:"Custom Date/Time SLAs",value:n2.de.enum.team.AlertType.CUSTOM_DT_ALERT}),e}},{key:"_insertSlaFilters",value:function(){var n,s=this,e=this._insert(new n2.de.component.form.FieldGroup({id:"sla-filters-field-group",heading:"SLAs",cls:"slds-m-bottom_medium n2_flush-left n2_small-heading",helpText:"Time checkpoint SLAs check the SLA criteria once at a predefined time after assignment. Continuous field monitoring SLAs check whether the SLA has failed every time Distribution Engine runs during the defined time period."}));return e.insert(new n2.de.page.team.trackingAndSlas.teamSettings.slas.LogicFilter({id:"sla-filters",mixins:[n2.mixin.DataDriven],required:!0,label:{hidden:!0},hidden:!1,loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.getProperty("slaCondition").get("name"),t.spinner(),e.next=4,n2.DataProviderManager.getInstance().get("get-sla-picklist-field-select-options").get({params:[s._model.get("objectName"),i],force:!0});case 4:i=e.sent,t.options=i,t.spinner(!1);case 6:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),value:{bindPath:"."}})),e}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("slasEnabled").value=e.value,this._refreshFieldVisibility()}},{key:"_refreshFieldVisibility",value:function(){var t=this;this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t._model.get("slasEnabled"))})}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i,s=this,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,a),n2.isNull(n)&&(this._model=t,this._components["toggle-active"].value={value:t.get("slasEnabled"),silent:!0},this._components["respect-distribution-hours"].model=t,this._components["sla-type"].model=t,this._components["sla-type"].options=this._getSlaTypeOptions(),this._setupSlaFiltersModel(),(i=this._components["sla-filters-field-group"]).components["sla-filters"].model=this._slaFiltersModel,i.components["sla-filters"].max=this._getMaxSlas(),this._model.getProperty("slas").listen("change",function(e){s._onFieldChange(i.components["sla-filters"])},this),this._refreshFieldVisibility());case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_setupSlaFiltersModel",value:function(){var e=this._model.getProperty("slas",{defaultValue:[]});this._slaFiltersModel=new n2.dataProvider.Model({value:{}}),this._slaFiltersModel.insert(e,{key:"filters"}),this._slaFiltersModel.insert(this._model.getProperty("slaType"),{key:"slaType"}),this._slaFiltersModel.insert(this._model.getProperty("objectName"),{key:"objectName"}),this._slaFiltersModel.insert(this._model.getProperty("isPersonAccounts"),{key:"isPersonAccounts"})}}]),o}(),n2.de.page.team.weightingAndCaps.distributorSettings.DistributorSettingsDataTable=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_addHeaderRow",value:function(){_get(_getPrototypeOf(n.prototype),"_addHeaderRow",this).apply(this,arguments);var t=["Order"];this.headerRow.forEach(function(e){t.includes(e.column.header)&&(e.cls="slds-text-align_right")})}},{key:"_createRow",value:function(){var e=_get(_getPrototypeOf(n.prototype),"_createRow",this).apply(this,arguments);return e.data.isActive||(e.cls="n2_inactive"),e}},{key:"_refreshData",value:function(){var e,t;n2.isNull(this._data)||(t=1===(e=(n2.dataProvider.Model.isModeled(this._data)?this._data.json:this._data).length)?"distributor":"distributors",this.emptyFilteredState=n2.merge(this._emptyFilteredState,{heading:"There are no distributors that match your filter",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filter. You can change your terms, or clear them to see all distributors.")})),_get(_getPrototypeOf(n.prototype),"_refreshData",this).apply(this,arguments)}}]),n}(),n2.de.page.team.weightingAndCaps.distributorSettings.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any distributors yet",this._contentTemplate='<p>Distributor weighting and caps allows for balancing and limiting of assignment at a Distributor level. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddDistributorButton()}},{key:"_insertAddDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-distributor",renderTo:this.SELECTORS.linkContainer,text:"Add your first distributor",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddDistributorClick(e)}}}))}},{key:"_onAddDistributorClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_DistributorList","teamId=".concat(t))}}]),t}(),n2.de.page.team.weightingAndCaps.distributorSettings.WeightingAndCapsForm=function(){_inherits(n,n2.de.component.Form);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["save-distributor-settings"],this._capTypeProperty=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertActiveCapNotification(),this._insertDistributorEnabledField(),this._insertDistributorCapFieldGroup(),this._insertTeamCapsField()}},{key:"_insertActiveCapNotification",value:function(){var t=this,e=(this._capTypeProperty=this._model.getProperty("cappingPeriod",{defaultValue:{period:""}}),"Load balanced"===this._capTypeProperty.json.period);return this._capTypeProperty.listen("change",function(e){return t._onCapTypeChange(e)},this),this._insert(new n2.de.component.ScopedNotification({id:"active-caps-notification",renderTo:{target:this.SELECTORS.formBody,position:"beforebegin"},type:"info",hidden:!e,content:this._getNotificationContent()}))}},{key:"_onCapTypeChange",value:function(e){e="Load balanced"===e.target.json.period;this._components["active-caps-notification"].hidden=!e,this._components["active-caps-notification"].content=this._getNotificationContent()}},{key:"_getNotificationContent",value:function(){return this._model.get("teamIsActiveCapOrLoadBalancedByValue")?"Team capping by value of ".concat(n2.htmlEncode(this._model.get("teamDistributedRecordValueField"))):"Team capping by record count"}},{key:"_insertDistributorEnabledField",value:function(){this._insert(new n2.de.component.field.RadioButtonGroup({id:"weighting-enabled",mixins:[n2.mixin.DataDriven],cls:"slds-m-horizontal_medium slds-m-top_medium",hidden:{bindPath:".",adapter:function(e){var t=e.method===n2.de.enum.distributor.Method.LOAD_BALANCING,e=e.method===n2.de.enum.distributor.Method.ROUND_ROBIN&&!e.roundRobinDisabled;return!(t||e)}},label:"Distributor weighting",sort:!1,options:[{label:"Disabled",value:!1},{label:"Enabled",value:!0}],value:{bindPath:".weightingEnabled"}}))}},{key:"_insertDistributorCapFieldGroup",value:function(){this._insert(new n2.de.page.team.weightingAndCaps.distributorSettings.weightingAndCapsForm.DistributorCaps({id:"distributor-caps",mixins:[n2.mixin.DataDriven],cls:"slds-m-top_medium",hidden:{bindPath:".",adapter:function(e){var t=e.distributorType===n2.de.enum.distributor.Type.TRIGGER;return e.distributorType===n2.de.enum.distributor.Type.MANUAL||t&&(e.method===n2.de.enum.distributor.Method.LOAD_BALANCING||e.method===n2.de.enum.distributor.Method.CURRENT_OWNER)}}}))}},{key:"_insertTeamCapsField",value:function(){this._insert(new n2.de.component.field.RadioButtonGroup({id:"team-caps",mixins:[n2.mixin.DataDriven],cls:"slds-m-horizontal_medium slds-m-top_medium",hidden:{bindPath:".teamCapsEnabled",adapter:function(e){return!e}},disabled:{bindPath:".distributorType",adapter:function(e){return e===n2.de.enum.distributor.Type.MANUAL}},label:"Team caps",helpText:"Allows distributors to override and exceed the team level caps",sort:!1,options:[{label:"Respect team caps",value:!1},{label:"Ignore team caps",value:!0}],value:{bindPath:".teamCapsIgnored"}}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-weighting-and-caps-form")}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["weighting-enabled"].model=e,this._components["distributor-caps"].model=e,this._components["team-caps"].model=e,this._allFieldsHidden()?this._showEmptyMessage():this._hideEmptyMessage())}},{key:"_allFieldsHidden",value:function(){return this._components["weighting-enabled"].hidden&&this._components["distributor-caps"].hidden&&this._components["team-caps"].hidden}},{key:"_showEmptyMessage",value:function(){var e=this._components["empty-message"];(e=n2.isUndefined(this._components["empty-message"])?this._insertEmptyMessage():e).hidden=!1}},{key:"_insertEmptyMessage",value:function(){return this._insert(new n2.ui.component.HTML({id:"empty-message",renderTo:this.SELECTORS.formBody,template:'<p id="{{id}}" class="slds-m-around_medium">Distributor weighting or caps are not available for this Distribution Method</p>'}))}},{key:"_hideEmptyMessage",value:function(){n2.isUndefined(this._components["empty-message"])||(this._components["empty-message"].hidden=!0)}},{key:"_onSaved",value:function(){_get(_getPrototypeOf(n.prototype),"_onSaved",this).apply(this,arguments),this._loadDistributorSettings({force:!0})}},{key:"_showFooter",value:function(){this._components["save-footer"].message="",this._components["save-footer"].hidden=!1}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("save-distributor-settings").post({params:[this._model.json]})}},{key:"_onCancel",value:function(){this._loadDistributorSettings({force:!0})}},{key:"_loadDistributorSettings",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=n2.de.page.team.Context.getInstance().teamId;n2.DataProviderManager.getInstance().get("get-distributor-settings").get({params:[n],force:t,silent:e})}},{key:"destroy",value:function(){_get(_getPrototypeOf(n.prototype),"destroy",this).apply(this,arguments),n2.isNull(this._capTypeProperty)||(this._capTypeProperty.removeListeners("change",{caller:this}),this._capTypeProperty=null)}}]),n}(),n2.de.page.team.weightingAndCaps.teamCaps.TagCaps=function(){_inherits(n,n2.ui.component.Field);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-caps-tag-collection-value-options"],this._showErrorMessage=!0}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)?this._onTagCappingModelLoaded():"get-caps-tag-collection-value-options"===t.id&&this._onTagCollectionValuesLoaded(e)}},{key:"_onTagCappingModelLoaded",value:function(){var t=this,e=this._components["tag-caps-data-table"];n2.isUndefined(e)&&this._insertDataTable(),this._model.getProperty("defaultCaps").listen("change",function(e){return t._onDefaultCapsModelChange(e)},this),this._setFieldValue(this._model)}},{key:"_onDefaultCapsModelChange",value:function(e){e.change.type===n2.dataProvider.model.enum.Change.INSERT&&this.clearInvalid()}},{key:"_insertDataTable",value:function(){return this._insert(new n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.DataTable({id:"tag-caps-data-table",columns:[],renderTo:this.SELECTORS.fieldContainer}))}},{key:"_onTagCollectionValuesLoaded",value:function(e){this._components["tag-caps-data-table"].tagValueOptions=e}},{key:"_setFieldValue",value:function(e){n2.isUndefined(this._components["tag-caps-data-table"])||(this._components["tag-caps-data-table"].data=e)}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).call(this),this._dom.addClass("n2-tag-caps")}},{key:"clear",value:function(){this._components["tag-caps-data-table"].clear()}},{key:"_validateCustom",value:function(){var e=this._components["tag-caps-data-table"].validate();return this._showErrorMessage=n2.isString(e),e}},{key:"_hasValidation",value:function(){return!0}},{key:"_showError",value:function(){this._showErrorMessage&&_get(_getPrototypeOf(n.prototype),"_showError",this).apply(this,arguments)}}]),n}(),n2.de.page.team.weightingAndCaps.weighting.Individual=function(){_inherits(n,n2.de.component.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.columns=[{header:{data:"Avatar",hidden:!0},cls:"n2_avatar",cell:{cellTemplate:"",components:[{id:"avatar",type:n2.ui.component.Avatar,mixins:[n2.mixin.DataDriven],avatar:{bindPath:".avatarUrl"},displayName:{bindPath:".name"}}]}},{header:"Name",cls:"n2_name",bindPath:"name",sortable:!0,sort:{bindPath:".nameSort"}},{header:"Weighting",bindPath:".weighting",editField:{type:n2.ui.component.field.Slider,cls:"n2_weighting",max:4,min:.25,step:.25,showNumberInput:!0},cell:{editable:!0}},{header:"Percentage",cls:"n2_percentage"}],this._mixins=[n2.mixin.DataDriven],this._emptyState={type:n2.de.page.team.weightingAndCaps.weighting.individual.EmptyState}}},{key:"_refreshData",value:function(){var e,t;n2.isNull(this._data)||(t=1===(e=(n2.dataProvider.Model.isModeled(this._data)?this._data.json:this._data).length)?"team member":"team members",this.emptyFilteredState=n2.merge(this._emptyFilteredState,{heading:"There are no team members that match your filter",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filter. You can change your terms, or clear them to see all team members.")})),_get(_getPrototypeOf(n.prototype),"_refreshData",this).apply(this,arguments),this._refreshPercentages()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onWeightingDataLoaded(e)}},{key:"_onWeightingDataLoaded",value:function(e){var t=this._sortBy;this.sortBy={column:1,direction:"asc"},this.data=e.getProperty("teamMemberWeightings"),n2.isNull(t)||(this.sortBy=t),e.listen("change",this._onWeightingModelChange,this)}},{key:"_onWeightingModelChange",value:function(e){e.change.bindPathMatch("teamMemberWeightings[*].weighting")&&this._refreshPercentages()}},{key:"_refreshPercentages",value:function(){var n=this._getTotalWeightingValue();this.forEachRow(function(e){var t=e.data.weighting/n*100;e.components["td-3"].dom.text("".concat(Math.round(t),"%"))})}},{key:"_getTotalWeightingValue",value:function(){return this._model.get("teamMemberWeightings").reduce(function(e,t){return{weighting:e.weighting+t.weighting}},{weighting:0}).weighting}}]),n}(),n2.de.page.team.weightingAndCaps.weighting.TagBased=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertDefaultWeighting(),this._insertTagCollectionSelection(),this._insertTagWeightings(),this._insertEmptyState()}},{key:"_insertDefaultWeighting",value:function(){this._insert(new n2.ui.component.field.Slider({id:"default-weighting",mixins:[n2.mixin.DataDriven],cls:"n2_default-weighting",label:"Default weighting",max:4,min:.25,step:.25,showNumberInput:!0,value:{bindPath:"."}}))}},{key:"_insertTagCollectionSelection",value:function(){var i=this;this._insert(new n2.ui.component.field.Combo({id:"tag-collection",mixins:[n2.mixin.DataDriven],dataProviders:["get-tag-collection-options"],cls:"n2_tag-collection slds-m-top_medium",required:!0,label:"Tag collection",options:{bindPath:"get-tag-collection-options"},value:{bindPath:"."},listeners:{loaded:function(e,t,n){n2.isNull(n)||"get-tag-collection-options"!==n.id||i._onTagCollectionOptionsLoaded(t)},change:function(e){i._components["tag-weightings"].disabled=n2.isEmpty(i._model.get("tagCollectionId")),i._components["tag-weightings"].clear(),i._loadTagValueOptions()}}}))}},{key:"_onTagCollectionOptionsLoaded",value:function(e){e=!n2.isEmpty(e);this._components["default-weighting"].hidden=!e,this._components["tag-collection"].hidden=!e,this._components["tag-weightings"].hidden=!e,this._components["empty-state"].hidden=e}},{key:"_insertTagWeightings",value:function(){this._insert(new n2.de.page.team.weightingAndCaps.weighting.tagBased.TagWeighting({id:"tag-weightings",mixins:[n2.mixin.DataDriven],dataProviders:["get-tag-collection-value-options"],cls:"slds-m-top_medium",disabled:!0,tagFieldOptions:{bindPath:"get-tag-collection-value-options"},required:!0,label:{text:"Tag weightings",hidden:!0},value:{bindPath:"."}}))}},{key:"_insertEmptyState",value:function(){return this._insert(new n2.de.page.team.weightingAndCaps.weighting.tagBased.EmptyState({id:"empty-state",cls:"n2_empty-state",hidden:!0}))}},{key:"_loadData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e;_get(_getPrototypeOf(n.prototype),"_loadData",this).apply(this,arguments),n2.DataProviderManager.getInstance().get("get-tag-collection-options").get({force:t,silent:e})}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-tag-based")}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onWeightingDataLoaded(e)}},{key:"_onWeightingDataLoaded",value:function(e){this._components["default-weighting"].model=e.getProperty("defaultWeighting",{defaultValue:1}),this._components["tag-collection"].model=e.getProperty("tagCollectionId",{defaultValue:""}),this._components["tag-weightings"].disabled=n2.isEmpty(e.get("tagCollectionId")),this._components["tag-weightings"].model=e.getProperty("tagWeightings",{defaultValue:[]}),this._loadTagValueOptions()}},{key:"_loadTagValueOptions",value:function(){n2.DataProviderManager.getInstance().get("get-tag-collection-value-options").get({params:[this._model.get("tagCollectionId")],force:!0})}},{key:"validate",value:function(){return this._components["tag-collection"].validate()&&this._components["tag-weightings"].validate()}}]),n}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.DistributorStage=function(){_inherits(t,n2.ui.component.Button);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{currentState:".n2_current-state"}),this._componentCls="n2-de-distributor-result-stage",this._state=null,this._successStateTemplate='<div class="n2_current-state n2_success">'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success"}),"</div>"),this._errorStateTemplate='<div class="n2_current-state n2_error">'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error"}),"</div>"),this._REFRESH=n2.merge(this._REFRESH,{state:["state"]})}},{key:"state",set:function(e){this._setProperty("state",e,{sync:!1})}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._refresh(["state"])}},{key:"_refresh",value:function(e){if(n2.isArray(e))return this._refreshParts.apply(this,arguments);_get(_getPrototypeOf(t.prototype),"_refresh",this).apply(this,arguments)}},{key:"_refreshState",value:function(){n2.isNull(this.element("currentState"))||this.element("currentState").destroy(),this.dom.insert(this._getCurrentStateTemplate())}},{key:"_getCurrentStateTemplate",value:function(){return this._isSuccess()?this._successStateTemplate:this._isFailed()?this._errorStateTemplate:""}},{key:"_isSuccess",value:function(){return this._state===n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState.SUCCESS}},{key:"_isFailed",value:function(){return this._state===n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState.FAILED}}]),t}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.MethodStage=function(){_inherits(t,n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.DistributorStage);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="".concat(this._componentCls," n2-de-distributor-method-stage"),this._method=null,this._REFRESH=n2.merge(this._REFRESH,{method:["methodIcon"]})}},{key:"method",set:function(e){this._setProperty("method",e,{sync:!1})}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._refresh(["methodIcon"])}},{key:"_refreshMethodIcon",value:function(){this._dom.insert(n2.de.Icon.getMethodIcon(this._method),"afterbegin"),this._dom.find(".slds-icon").attribute("class","slds-button__icon slds-icon_small n2")}}]),t}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.StageState={SUCCESS:"success",FAILED:"failed",UNTESTED:"untested"},n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.TestResultPopover=function(){_inherits(i,n2.de.component.AbstractPopover);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{body:".n2_popover-body > .n2_scroll"}),this.id="test-result-popover",this._componentCls="".concat(this._componentCls," n2-de-test-result-popover"),this._bodyTemplate='<div class="n2_popover-body"><div class="n2_scroll"></div></div>',this._noTeamMembersMessageTemplate='<p class="slds-m-bottom_small slds-text-align_center">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-right_x-small slds-no-flex"}),"\n            No Team Members have been added to this team yet.\n        </p>"),this._teamMemberMatchedTemplate='{{#teamMemberMatch}}\n            <div class="n2_matched-member">\n                {{#matchedMember}}\n                    {{#isLookup}}\n                        <p><span class="n2_filter-text">Found matching </span><span class="n2_field-name">{{lookupObjectName}} </span><a href="/{{lookedUpRecordId}}" target="_blank">{{lookedUpRecordName}}</a></p>\n                        <div class="n2_filter">\n                            <span class="n2_filter-condition">Where&nbsp;</span>\n                            <span class="n2_field-name">{{lookupObjectName}}.{{matchedField}} </span>\n                            <span class="n2_filter-operator">equals </span>\n                            <span class="n2_filter-value">{{matchedValue}}</span>\n                        </div>\n                    {{/isLookup}}\n                    {{#isRelatedOwner}}<p><span class="n2_filter-text">Found matching </span><span class="n2_field-name">{{lookupObjectName}} </span><a href="/{{lookedUpRecordId}}" target="_blank">{{lookedUpRecordName}}</a><span class="n2_filter-text"> for relationship </span><span class="n2_field-name">{{matchedRelationship}}</span></p>{{/isRelatedOwner}}\n                {{/matchedMember}}\n                {{^matchedMember}}\n                    <p class="slds-m-bottom_small slds-text-align_center">\n                        '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-right_x-small slds-no-flex"}),"\n                        {{#isLookup}}No matching {{lookupDetails.lookupObjectName}} owned by an available member of this team{{/isLookup}}\n                        {{#isRelatedOwner}}No related owner found that is an available member of this team{{/isRelatedOwner}}\n                    </p>\n                {{/matchedMember}}\n            </div>\n        {{/teamMemberMatch}}"),this._distributorTestResults=null,this._resultType=null,this._currentResultComponent=null,this._REFRESH=n2.merge(this._REFRESH,{distributorTestResults:["popoverBody"],resultType:["popoverBody"]})}},{key:"distributorTestResults",set:function(e){this._setProperty("distributorTestResults",e,{sync:!1})}},{key:"resultType",set:function(e){this._setProperty("resultType",e,{sync:!1})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).call(this),this._insertCloseButton()}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.distributorTestResults,e.resultType,e.target,e.position,e.cls,e.listeners;_get(_getPrototypeOf(i.prototype),"show",this).apply(this,arguments)}},{key:"_onShow",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.distributorTestResults,n=e.resultType;e.target,e.position;this._setProperties({distributorTestResults:void 0===t?null:t,resultType:void 0===n?null:n}),_get(_getPrototypeOf(i.prototype),"_onShow",this).apply(this,arguments)}},{key:"_hasPropertyChanged",value:function(e,t){return"distributorTestResults"===e?!!n2.isNull(this._distributorTestResults)||!n2.compare(this._distributorTestResults.distributorObject.Id,t.distributorObject.Id):_get(_getPrototypeOf(i.prototype),"_hasPropertyChanged",this).apply(this,arguments)}},{key:"_refreshPopoverBody",value:function(){switch(this.element("body").clear(),n2.isNull(this._currentResultComponent)||this._currentResultComponent.destroy(),this._resultType){case"method":return void(this._currentResultComponent=this._insertMethodResult());case"filter":return void(this._currentResultComponent=this._insertFilterResult());case"team-member":this._insertTeamMemberResult()}}},{key:"_insertMethodResult",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.MethodResult({id:"method-result",classifierFilterResult:this._distributorTestResults.filtersWrapper.classifierFilter,sourceFilterResult:this._distributorTestResults.filtersWrapper.sourceFilter,stickyResult:this._distributorTestResults.stickyDetails,lookupOwnerResult:this._distributorTestResults.lookupDetails,relatedOwnerResult:this._distributorTestResults.relatedOwnerDetails}))}},{key:"_insertFilterResult",value:function(){return this._insert(new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.FilterResult({id:"filter-result",teamFilterData:{filters:this._distributorTestResults.filtersWrapper.teamFilters,filterLogic:this._distributorTestResults.filtersWrapper.teamFilterLogic},distributorFilterData:{filters:this._distributorTestResults.filtersWrapper.distributorFilters,filterLogic:this._distributorTestResults.filtersWrapper.filterLogic},campaignFilter:this._distributorTestResults.filtersWrapper.campaignFilter}))}},{key:"_insertTeamMemberResult",value:function(){return this._insertTeamMemberMatchedDetails(),!n2.isEmpty(this._distributorTestResults.teamMembers)||this._hasMatchedTeamMember()?this._insertTeamMemberResultAccordion():this._insertNoTeamMembersMessage()||null}},{key:"_insertTeamMemberResultAccordion",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._distributorTestResults.teamMembers,n="slds-m-top_medium",!this._hasTeamMemberMatch()){e.next=5;break}if(this._hasMatchedTeamMember()){e.next=4;break}return e.abrupt("return",null);case 4:t=[this._distributorTestResults.teamMemberMatch.matchedMember],n+=" n2_separator";case 5:if(250<t.length)return this.spinner(!0),i=new n2.util.DelayedTask(function(){},0),e.next=10,i.start();e.next=10;break;case 10:this._currentResultComponent=this._insert(new n2.de.component.Accordion({id:"team-member-result-accordion",cls:n,components:t.map(function(e,t){return new n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.TeamMemberResult({id:"team-member-result-".concat(t),teamMemberData:e})})})),this.spinner(!1);case 11:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_insertTeamMemberMatchedDetails",value:function(){this.element("body").insert(n2.ui.Template.render(this._teamMemberMatchedTemplate,this._distributorTestResults))}},{key:"_insertNoTeamMembersMessage",value:function(){this.element("body").insert(n2.ui.Template.render(this._noTeamMembersMessageTemplate))}},{key:"_hasTeamMemberMatch",value:function(){return!n2.isUndefined(this._distributorTestResults.teamMemberMatch)}},{key:"_hasMatchedTeamMember",value:function(){return!n2.isUndefined(this._distributorTestResults.teamMemberMatch)&&!n2.isUndefined(this._distributorTestResults.teamMemberMatch.matchedMember)}}]),i}(),n2.de.page.availability.regionalHolidays.holidays.holidayList.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="You dont have any Regional Holidays yet.",this._contentTemplate="<p>Regional Holidays allow you to pause distributions for multiple teams for public holidays and other events.</p>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertAddHolidayButton()}},{key:"_insertAddHolidayButton",value:function(){return this._insert(new n2.ui.component.Button({id:"add-holiday",text:"Add Regional Holiday",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddHolidayButtonClick,scope:this}}))}},{key:"_onAddHolidayButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}}]),t}(),n2.de.page.availability.regionalHolidays.regions.regionList.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=n2.merge(this._mixins||[],[n2.mixin.Observable]),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any regions yet",this._contentTemplate="<p>Regions allow you to group teams in the same area so that they can share regional holidays.</p>"}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertAddRegionButton()}},{key:"_insertAddRegionButton",value:function(){return this._insert(new n2.ui.component.Button({id:"add-region",text:"Add Region",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:this._onAddRegionButtonClick,scope:this}}))}},{key:"_onAddRegionButtonClick",value:function(e){this.fire("click",{target:e,currentTarget:this})}}]),t}(),n2.de.page.classifier.autoConversionSettings.autoConversionRules.ruleModal.AutoConvertActionSettings=function(){_inherits(o,n2.de.component.form.FieldGroup);var e,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._lazyLoad=!0,this._autoConversionRuleSettingsModel=null,this._createOpportunityOptions=null,this._leadConvertStatusOptions=null}},{key:"createOpportunityFieldGroup",get:function(){return this._components["create-opportunity-field-group"]}},{key:"createOpportunityOptionSelection",get:function(){return this.createOpportunityFieldGroup.components["opportunity-options"]}},{key:"defaultUserSelectionField",get:function(){return this._components["default-user-selection"]}},{key:"inheritOwnerField",get:function(){return this._components["inherit-owner"]}},{key:"postConversionSettings",get:function(){return this._components["post-conversion-settings"]}},{key:"convertedLeadStatusField",get:function(){return this._components["converted-lead-status"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).call(this),this._insertCreateOpportunityFieldGroup(),this._insertDefaultUserSelectionField(),this._insertInheritOwnerField(),this._insertPostConversionFieldUpdateSettings(),this._insertConvertedLeadStatusField()}},{key:"_insertCreateOpportunityFieldGroup",value:function(){return this._insert(new n2.de.component.form.FieldGroup({id:"create-opportunity-field-group",heading:"Create opportunity",helpText:"If selected, on conversion an Opportunity will be created under the Account.",lazyRender:!0,toggleActive:!0,cls:"slds-m-bottom_medium",components:[this._createOpportunityOptionSelection()],listeners:{change:this._onCreateOpportunityChange,scope:this}}))}},{key:"_onCreateOpportunityChange",value:function(e,t){"toggle-active"===t.id&&this._onCreateOpportunityToggleChange(t)}},{key:"_onCreateOpportunityToggleChange",value:function(e){this._autoConversionRuleSettingsModel.set(e.value,{key:"isCreateOpportunity"}),e.value&&""===this._autoConversionRuleSettingsModel.get("createOpportunity")&&this._autoConversionRuleSettingsModel.set("Always",{key:"createOpportunity"}),this._refresh({createOpportunityFieldGroup:!0,postConversionSettings:!0})}},{key:"_createOpportunityOptionSelection",value:function(){return new n2.ui.component.field.RadioGroup({id:"opportunity-options",mixins:[n2.mixin.DataDriven],label:{text:"Select when to create an opportunity",hidden:!0},value:{bindPath:".createOpportunity"}})}},{key:"_insertDefaultUserSelectionField",value:function(){return this._insert(new n2.de.component.field.userOrQueueField.TextBoxButton({id:"default-user-selection",mixins:[n2.mixin.DataDriven],cls:"n2_default-user-selection slds-m-bottom_medium n2_field-medium",label:"Default user",helpText:"The user who will be assigned any converted records if Inherit is disabled/unavailable.",required:!0,value:{bindPath:".defaultOwnerName"},listeners:{click:this._handleDefaultUserClick,scope:this}}))}},{key:"_handleDefaultUserClick",value:function(){n2.de.component.UserSelectionModal.getInstance({renderTo:this._dom}).show({listeners:{submit:this._onDefaultUserSelection,scope:this}})}},{key:"_onDefaultUserSelection",value:function(e){e=e.selectedUser;this._autoConversionRuleSettingsModel.getProperty("defaultOwnerId",{defaultValue:null}).value=e.id,this._autoConversionRuleSettingsModel.getProperty("defaultOwnerName",{defaultValue:null}).value=e.name,this._refresh({defaultUserSelectionField:!0}),this.defaultUserSelectionField.validate()}},{key:"_insertInheritOwnerField",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"inherit-owner",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",label:"Inherit owner where possible",helpText:"If possible, the newly created records will be assigned to the owner of the matched account or contact. If not possible, the default user will be used.",value:{bindPath:".isInheritOwner"}}))}},{key:"_insertPostConversionFieldUpdateSettings",value:function(){return this._insert(new n2.de.page.classifier.autoConversionSettings.autoConversionRules.ruleModal.autoConvertActionSettings.PostConversionSettings({id:"post-conversion-settings",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",heading:"Post conversion field update",helpText:"Optionally update a field on the account, contact or opportunity on conversion."}))}},{key:"_insertConvertedLeadStatusField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"converted-lead-status",mixins:[n2.mixin.DataDriven],label:"Converted lead status",helpText:"The status that the converted lead is transitioned to after conversion.",cls:"slds-m-bottom_medium n2_field-medium",options:[],required:!0,value:{bindPath:".leadConvertStatus"}}))}},{key:"show",value:function(e){e=e.autoConversionRuleSettingsModel;_get(_getPrototypeOf(o.prototype),"show",this).apply(this,arguments),this._autoConversionRuleSettingsModel=e,this.load({force:!1})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n.force,e.next=3,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a);case 3:return e.t0=Promise,e.next=6,this._loadDataProvider("get-create-opportunity-options",{force:!1,silent:t});case 6:return e.t1=e.sent,e.next=9,this._loadDataProvider("get-lead-convert-status-options",{force:!1,silent:t});case 9:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=13,e.t0.all.call(e.t0,e.t3);case 13:return n=e.sent,s=_slicedToArray(n,2),i=s[0],s=s[1],e.abrupt("return",{createOpportunityOptions:i,leadConvertStatusOptions:s});case 18:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.createOpportunityOptions,e=e.leadConvertStatusOptions;_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),this._createOpportunityOptions=t.response,this._leadConvertStatusOptions=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.createOpportunityFieldGroup,i=e.defaultUserSelectionField,i=void 0!==i&&i,s=e.inheritOwnerField,s=void 0!==s&&s,a=e.postConversionSettings,a=void 0!==a&&a,e=e.convertedLeadStatusField,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshCreateOpportunityFieldGroup(),(t||i)&&this._refreshDefaultUserSelectionField(),(t||s)&&this._refreshInheritOwnerField(),(t||a)&&this._refreshPostConversionSettings(),(t||e)&&this._refreshConvertedLeadStatusField()}},{key:"_refreshCreateOpportunityFieldGroup",value:function(){var e=this._autoConversionRuleSettingsModel.get("isCreateOpportunity");this.createOpportunityFieldGroup.components["toggle-active"].value={value:e,silent:!0},this.createOpportunityOptionSelection.hidden=!e,this.createOpportunityOptionSelection.options=this._createOpportunityOptions,this.createOpportunityOptionSelection.model=this._autoConversionRuleSettingsModel}},{key:"_refreshDefaultUserSelectionField",value:function(){this.defaultUserSelectionField.model=this._autoConversionRuleSettingsModel}},{key:"_refreshInheritOwnerField",value:function(){this.inheritOwnerField.model=this._autoConversionRuleSettingsModel}},{key:"_refreshPostConversionSettings",value:function(){this.postConversionSettings.model=this._autoConversionRuleSettingsModel}},{key:"_refreshConvertedLeadStatusField",value:function(){this.convertedLeadStatusField.options=this._leadConvertStatusOptions,this.convertedLeadStatusField.model=this._autoConversionRuleSettingsModel,1===this._leadConvertStatusOptions.length&&(this.convertedLeadStatusField.value={value:this._leadConvertStatusOptions[0].value,silent:!0})}}]),o}(),n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.LoadBalancingSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Load balancing count",this._helpText="If selected, the record counts used for load balancing will include the selected distribution types."}},{key:"pullDistributorsCheckbox",get:function(){return this._components["pull-distributors-checkbox"]}},{key:"stickyAssignmentsCheckbox",get:function(){return this._components["sticky-assignments-checkbox"]}},{key:"lookupOrRelatedOwnerAssignmentsCheckbox",get:function(){return this._components["lookup-or-related-owner-assignments-checkbox"]}},{key:"_insertFields",value:function(){this._insertPullDistributorsCheckbox(),this._insertStickyAssignmentsCheckbox(),this._insertLookupOrRelatedOwnerAssignmentsCheckbox()}},{key:"_insertPullDistributorsCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"pull-distributors-checkbox",label:"Pull distributors",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",value:{bindPath:".loadBalancingPullIncluded"}}))}},{key:"_insertStickyAssignmentsCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"sticky-assignments-checkbox",label:"Sticky assignments",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",value:{bindPath:".loadBalancingStickyIncluded"}}))}},{key:"_insertLookupOrRelatedOwnerAssignmentsCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"lookup-or-related-owner-assignments-checkbox",label:"Lookup or related owner assignments",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",value:{bindPath:".loadBalancingLOROIncluded"}}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.pullDistributorsCheckbox,t=void 0!==t&&t,n=e.stickyAssignmentsCheckbox,n=void 0!==n&&n,i=e.lookupOrRelatedOwnerAssignmentsCheckbox,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshPullDistributorsCheckbox(),(e||n)&&this._refreshStickyAssignmentsCheckbox(),(e||i)&&this._refreshLookupOrRelatedOwnerAssignmentsCheckbox()}},{key:"_refreshPullDistributorsCheckbox",value:function(){this.pullDistributorsCheckbox.model=this._model}},{key:"_refreshStickyAssignmentsCheckbox",value:function(){this.stickyAssignmentsCheckbox.model=this._model}},{key:"_refreshLookupOrRelatedOwnerAssignmentsCheckbox",value:function(){this.lookupOrRelatedOwnerAssignmentsCheckbox.model=this._model}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.RejectionSettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Rejection settings"}},{key:"rejectionReasonsPillList",get:function(){return this._components["rejection-reasons-pill-list"]}},{key:"allowCustomRejectionReasonsCheckbox",get:function(){return this._components["allow-custom-rejection-reasons-checkbox"]}},{key:"_insertFields",value:function(){this._insertRejectionReasonsPillList(),this._insertAllowCustomRejectionReasonsCheckbox()}},{key:"_insertRejectionReasonsPillList",value:function(){return this._insert(new n2.ui.component.field.PillList({id:"rejection-reasons-pill-list",label:"Rejection reasons",mixins:[n2.mixin.DataDriven],cls:"n2_field-large slds-m-bottom_medium",helpText:"The list of reasons available to reject a record. Separate entries with commas.",delimiter:",",maxLength:255,value:{bindPath:".rejectionReasons"}}))}},{key:"_insertAllowCustomRejectionReasonsCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"allow-custom-rejection-reasons-checkbox",label:"Allow custom reject reasons",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",value:{bindPath:".customRejectionReasonsAllowed"}}))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.rejectionReasonsPillList,t=void 0!==t&&t,n=e.allowCustomRejectionReasonsCheckbox,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshRejectionReasonsPillList(),(e||n)&&this._refreshAllowCustomRejectionReasonsCheckbox()}},{key:"_refreshRejectionReasonsPillList",value:function(){this.rejectionReasonsPillList.model=this._model}},{key:"_refreshAllowCustomRejectionReasonsCheckbox",value:function(){this.allowCustomRejectionReasonsCheckbox.model=this._model}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.UserAvailabilitySettings=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="User availability toggles",this._helpText="If enabled, users can toggle their availability on and off during working hours using the widget.",this._toggleActive=!0}},{key:"requireToggleOffReasonFieldGroup",get:function(){return this._components["require-toggle-off-reason-field-group"]}},{key:"maintainToggleHistoryCombo",get:function(){return this._components["maintain-toggle-history-combo"]}},{key:"_insertFields",value:function(){this._insertRequireToggleOffReasonFieldGroup(),this._insertMaintainToggleHistoryCombo()}},{key:"_insertRequireToggleOffReasonFieldGroup",value:function(){this._insert(new n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.userAvailabilitySettings.RequireToggleOffReason({id:"require-toggle-off-reason-field-group",cls:"n2_small-heading slds-m-bottom_medium"}))}},{key:"_insertMaintainToggleHistoryCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"maintain-toggle-history-combo",label:"Maintain toggle history for",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"Allows reporting on users' toggle online / offline activity from DE and determines how long to store the records.",options:["No logging","1 week","2 weeks","1 month","2 months","3 months"],required:!0,sort:!1,value:{bindPath:".maintainToggleHistoryDuration"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("userAvailabilityTogglingOn").value=e.value,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["toggle-active"].value={value:e.get("userAvailabilityTogglingOn"),silent:!0},this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.requireToggleOffReasonFieldGroup,t=void 0!==t&&t,n=e.maintainToggleHistoryCombo,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshRequireToggleOffReasonFieldGroup(),(e||n)&&this._refreshMaintainToggleHistoryCombo()}},{key:"_refreshRequireToggleOffReasonFieldGroup",value:function(){this.requireToggleOffReasonFieldGroup.model=this._model,this.requireToggleOffReasonFieldGroup.hidden=!this._model.get("userAvailabilityTogglingOn")}},{key:"_refreshMaintainToggleHistoryCombo",value:function(){this.maintainToggleHistoryCombo.model=this._model,this.maintainToggleHistoryCombo.hidden=!this._model.get("userAvailabilityTogglingOn")}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.loggingAndArchiving.PreviousAssignmentsTracking=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=[n2.mixin.DataDriven],this._heading="Track previous assignments",this._toggleActive=!0}},{key:"previousAssignmentsTrackedNumber",get:function(){return this._components["previous-assignments-tracked"]}},{key:"_insertFields",value:function(){this._insertPreviousAssignmentsTrackedNumber()}},{key:"_insertPreviousAssignmentsTrackedNumber",value:function(){return this._insert(new n2.ui.component.field.Number({id:"previous-assignments-tracked",mixins:[n2.mixin.DataDriven],cls:"n2_number-field slds-m-bottom_medium",required:!0,min:1,max:50,label:"Number of previous assignments tracked",value:{bindPath:".previousAssignmentsTrackingCount"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("previousAssignmentsTrackingOn").value=e.value,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["toggle-active"].value={value:e.get("previousAssignmentsTrackingOn"),silent:!0},this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.previousAssignmentsTrackedNumber,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshPreviousAssignmentsTrackedNumber()}},{key:"_refreshPreviousAssignmentsTrackedNumber",value:function(){this.previousAssignmentsTrackedNumber.model=this._model;var e=this._model.get("previousAssignmentsTrackingOn");this.previousAssignmentsTrackedNumber.hidden=!e,e&&0===this._model.get("previousAssignmentsTrackingCount")&&(this.previousAssignmentsTrackedNumber.value={value:1,silent:!0})}}]),n}(),n2.de.page.settings.appSettings.appSettingsForm.operations.DistributionEngine=function(){_inherits(o,n2.de.component.form.FieldGroup);var e,t,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CLICK]),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._componentCls="n2-de-app-settings-distribution-engine",this._heading="Distribution Engine",this._helpText="Starts and stops Distribution Engine from running.",this.SELECTORS=n2.merge(this.SELECTORS,{schedulerStatusMessage:".n2_scheduler-status-message",schedulerErrorMessage:".n2_scheduler-error-message",schedulerErrorMessageText:".n2_scheduler-error-message p",authorApexPermissionMessage:".n2_author-apex-permission-message",schedulerConfigurationMessage:".n2_scheduler-configuration-message"}),this._template='<fieldset id="{{id}}" class="n2-de-field-group{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            {{>headingTemplate}}\n            <div class="n2_fields">\n                <span class="n2_scheduler-status-message slds-m-left_small slds-hide"></span>\n                {{>schedulerErrorMessageTemplate}}\n                <div class="n2_author-apex-permission-message slds-m-left_small slds-hide">Unable to enable/disable Distribution Engine as you do not have the Author Apex permission.</div>\n            </div>\n            {{>schedulerConfigurationMessageTemplate}}\n        </fieldset>',this._schedulerErrorMessageTemplate='<div id="{{id}}" class="n2_scheduler-error-message slds-grid slds-m-left_small slds-hide">\n            '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p></p>\n            </div>\n        </div>'),this._schedulerConfigurationMessageTemplate='<div id="{{id}}" class="slds-grid slds-m-top_x-small slds-m-left_large">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                <p class="n2_scheduler-configuration-message"></p>\n            </div>\n        </div>')}},{key:"distributionEngineToggle",get:function(){return this._components["distribution-engine-toggle"]}},{key:"_insertDistributionEngineToggle",value:function(){return this.insert(new n2.ui.component.field.CheckboxToggle({id:"distribution-engine-toggle",label:{hidden:!0,text:"Distribution Engine"},renderTo:{target:this.SELECTORS.body,position:"afterBegin"},mixins:[n2.mixin.DataDriven],value:{bindPath:".schedulerOn"},listeners:{change:this._onDistributionEngineToggleChange,scope:this}}))}},{key:"_onDistributionEngineToggleChange",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.spinner(!0),this.element("schedulerStatusMessage").hide(),this.element("schedulerErrorMessage").hide(),this.distributionEngineToggle.value)return e.next=6,this._handleDistributionEngineToggledOn();e.next=8;break;case 6:e.next=10;break;case 8:return e.next=10,this._handleDistributionEngineToggledOff();case 10:this.fire(n2.event.EventType.CLICK,this._createEventObject({canBubble:!0})),this.spinner(!1);case 12:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"_handleDistributionEngineToggledOn",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startScheduler();case 2:n=e.sent,i=n.schedulerStarted,t=n.healthCheckerStarted,n=n.errorMessage,n2.isEmpty(n)?(i=this._getSchedulerStartedMessage(i,t),this._setSchedulerStatusMessage(i)):(this.distributionEngineToggle.value={value:!1,silent:!0},this._setSchedulerErrorMessage(n));case 7:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_startScheduler",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("start-scheduler",{});case 2:return i=e.sent,i=i.data,t=i.schedulerStarted,n=i.healthCheckerStarted,i=i.errorMessage,e.abrupt("return",{schedulerStarted:t,healthCheckerStarted:n,errorMessage:i});case 8:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_getSchedulerStartedMessage",value:function(e,t){return e&&t?"Distribution Engine and Health checker started.":e?"Distribution Engine started.":void 0}},{key:"_setSchedulerStatusMessage",value:function(e){this.rendered&&(this.element("schedulerStatusMessage").text(e),n2.isEmpty(e)?this.element("schedulerStatusMessage").hide():this.element("schedulerStatusMessage").show())}},{key:"_setSchedulerErrorMessage",value:function(e){this.rendered&&(this.element("schedulerErrorMessageText").text(e),n2.isEmpty(e)?this.element("schedulerErrorMessage").hide():this.element("schedulerErrorMessage").show())}},{key:"_handleDistributionEngineToggledOff",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._stopScheduler();case 2:n=e.sent,t=n.schedulerStopped,i=n.schedulerStopping,n=n.errorMessage,t||i?(i=this._getSchedulerStoppedMessage(t),this._setSchedulerStatusMessage(i)):(this.distributionEngineToggle.value={value:!0,silent:!0},this._setSchedulerErrorMessage(n));case 7:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_stopScheduler",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postDataProvider("stop-scheduler",{});case 2:return i=e.sent,i=i.data,t=i.schedulerStopped,n=i.schedulerStopping,i=i.errorMessage,i=void 0===i?null:i,e.abrupt("return",{schedulerStopped:t,schedulerStopping:n,errorMessage:i});case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_getSchedulerStoppedMessage",value:function(e){return e?"Distribution Engine stopped.":"Distribution Engine job is currently in progress. It will be stopped after the job is complete."}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.distributionEngineToggle,t=void 0!==t&&t,n=e.authorApexPermissionMessage,n=void 0!==n&&n,i=e.schedulerConfigurationMessage,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this.refreshDistributionEngineToggle(),(e||n)&&this._refreshAuthorApexPermissionMessage(),(e||i)&&this._refreshSchedulerConfigurationMessage()}},{key:"refreshDistributionEngineToggle",value:function(){n2.isUndefined(this.distributionEngineToggle)||this.distributionEngineToggle.destroy(),this._insertDistributionEngineToggle(),this.distributionEngineToggle.model=this._model,this.distributionEngineToggle.disabled=this._isDistributionEngineToggleDisabled(),this.distributionEngineToggle.disabled&&(this.distributionEngineToggle.tooltip={text:"Save outstanding changes before enabling/disabling Distribution Engine.",position:n2.ui.enum.Position.BELOW})}},{key:"_isDistributionEngineToggleDisabled",value:function(){var e=this._model.get("userHasAuthorApexPermission"),t=n2.de.page.settings.appSettings.Context.getInstance().isDirty;return!e||t}},{key:"_refreshAuthorApexPermissionMessage",value:function(){this.rendered&&(this._model.get("userHasAuthorApexPermission")?this.element("authorApexPermissionMessage").hide():this.element("authorApexPermissionMessage").show())}},{key:"_refreshSchedulerConfigurationMessage",value:function(){this.rendered&&this.element("schedulerConfigurationMessage").text(this._getSchedulerConfigurationMessage())}},{key:"_getSchedulerConfigurationMessage",value:function(){var e=this._model.get("schedulerProcessingMode"),t=this._getSchedulerFrequency(),n=t.frequency,t=t.unit;return"Distribution Engine is configured to run in ".concat(e," processing mode ").concat(0===n?"as fast as possible":"every ".concat(n," ").concat(t),".")}},{key:"_getSchedulerFrequency",value:function(){var e=Number(this._model.get("schedulerFrequency"));return{frequency:60===e?1:60<e?e/60:e,unit:60===e?"hour":60<e?"hours":"minutes"}}},{key:"_onFieldChange",value:function(e){this._isFieldAutoSave(e)||_get(_getPrototypeOf(o.prototype),"_onFieldChange",this).call(this,e)}},{key:"_isFieldAutoSave",value:function(e){return"distribution-engine-toggle"===e.id}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(o.prototype),"_getTemplatePartials",this).call(this),{schedulerConfigurationMessageTemplate:this._schedulerConfigurationMessageTemplate,schedulerErrorMessageTemplate:this._schedulerErrorMessageTemplate})}}]),o}(),n2.de.page.settings.appSettings.appSettingsForm.operations.HealthChecker=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Health Checker",this._notifiableUsers=[]}},{key:"notifyUsersOnDeIssuesCombo",get:function(){return this._components["notify-users-on-de-issues-combo"]}},{key:"usersToNotifyUserSelection",get:function(){return this._components["users-to-notify-user-selection"]}},{key:"notifyAdminOnDeIssuesCheckbox",get:function(){return this._components["notify-admin-on-de-issues-checkbox"]}},{key:"_insertFields",value:function(){this._insertNotifyUsersOnDeIssuesCombo(),this._insertUsersToNotifyUserSelection(),this._insertNotifyAdminOnDeIssuesCheckbox()}},{key:"_insertNotifyUsersOnDeIssuesCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"notify-users-on-de-issues-combo",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_field-large",helpText:"Determines who will receive notifications of issues found by the health checker.",label:"Notify users on DE issues",options:[{label:"All DE Admins",value:"Admins"},{label:"All DE Admins and System Managers",value:"Admins and managers"},{label:"Select Users",value:"Select"}],value:{bindPath:".notifyUsersOnDEIssues"},required:!0,listeners:{change:this._onNotifyUsersOnDeIssuesChange,scope:this}}))}},{key:"_onNotifyUsersOnDeIssuesChange",value:function(){this.usersToNotifyUserSelection.hidden=this.notifyUsersOnDeIssuesCombo.value!==this._model.get("SELECT_USERS")}},{key:"_insertUsersToNotifyUserSelection",value:function(){return this._insert(new n2.de.component.field.UserPicker({id:"users-to-notify-user-selection",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_field-large",helpText:{template:'<p>Choose from a list of users assigned the Distribution Engine Admin or Distribution Engine System Manager <a class="n2_help-text-link" href="https://help.nc-squared.com/permissions">permission set</a>.</p>'},label:"Select users to notify",max:13,value:{bindPath:".usersToNotifyOnDEIssues"},required:!0}))}},{key:"_insertNotifyAdminOnDeIssuesCheckbox",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"notify-admin-on-de-issues-checkbox",label:"Notify admin on DE issues",cls:"slds-m-bottom_medium",helpText:"If enabled, notifications will be sent when issues are found by the health checker.",listeners:{change:this._onNotifyAdminOnDeIssuesChange,scope:this}}))}},{key:"_onNotifyAdminOnDeIssuesChange",value:function(){this.notifyAdminOnDeIssuesCheckbox.value?this._model.getProperty("notifyUsersOnDEIssues").value=this._model.get("ADMINS_ONLY"):this._model.getProperty("notifyUsersOnDEIssues").value="None"}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-notifiable-users",{silent:t,force:n});case 5:return e.t0=e.sent,e.abrupt("return",{notifiableUsersData:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.notifiableUsersData;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._notifiableUsers=e.response}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)?this._model=e:"get-notifiable-users"===t.id&&(this._notifiableUsers=e),this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.notifyUsersOnDeIssues,t=void 0!==t&&t,n=e.usersToNotify,n=void 0!==n&&n,i=e.notifyAdminOnDeIssues,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshNotifyUsersOnDeIssues(),(e||n)&&this._refreshUsersToNotify(),(e||i)&&this._refreshNotifyAdminOnDeIssues()}},{key:"_refreshNotifyUsersOnDeIssues",value:function(){this.notifyUsersOnDeIssuesCombo.model=this._model,this.notifyUsersOnDeIssuesCombo.hidden=n2.de.ApplicationContext.getInstance().isSandbox}},{key:"_refreshUsersToNotify",value:function(){this.usersToNotifyUserSelection.users=this._notifiableUsers,this.usersToNotifyUserSelection.model=this._model,this.usersToNotifyUserSelection.hidden=this._getUsersToNotifyHidden()}},{key:"_getUsersToNotifyHidden",value:function(){return this._model.get("notifyUsersOnDEIssues")!==this._model.get("SELECT_USERS")||n2.de.ApplicationContext.getInstance().isSandbox}},{key:"_refreshNotifyAdminOnDeIssues",value:function(){var e=this._model.get("notifyUsersOnDEIssues")===this._model.get("ADMINS_ONLY");this.notifyAdminOnDeIssuesCheckbox.value={value:e,silent:!0},this.notifyAdminOnDeIssuesCheckbox.hidden=!n2.de.ApplicationContext.getInstance().isSandbox}}]),s}(),n2.de.page.settings.exportImport.export.exportModal.TagCollections=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.id="export-modal-tag-collections",this._componentCls="n2-de-export-modal-tag-collection",this.SELECTORS=n2.merge(this.SELECTORS,{filter:".n2_quick-filter",message:".n2_message",emptyState:".n2_empty-state",emptyFilteredState:".n2_empty-filtered-state"}),this._template='<fieldset id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2_quick-filter"></div>\n            <div class="n2_fields"></div>\n            <span class="n2_message">This could take a few minutes, you\'ll be emailed when complete.</span>\n            <span class="n2_empty-state slds-hide">No tag collections could be found on your org.</span>\n            <div class="n2_empty-filtered-state slds-hide">\n                <span>There are no tag collections that match your filter</span>\n            </div>\n        </fieldset>',this._tagCollectionOptions=[]}},{key:"quickFilter",get:function(){return this._components["quick-filter"]}},{key:"tagCollectionsField",get:function(){return this._components["tag-collections"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter(),this._insertTagCollectionsCheckboxGroup(),this._insertClearFilterButton()}},{key:"_insertQuickFilter",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.filter,cls:"n2_quick-filter slds-m-bottom_medium",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find tag collections...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}}))}},{key:"_insertTagCollectionsCheckboxGroup",value:function(){return this._insert(new n2.ui.component.field.CheckboxGroup({id:"tag-collections",renderTo:this.SELECTORS.body,cls:"slds-m-bottom_medium",label:"Tag Collections",sort:!1,options:[],listeners:{change:this._onTagCollectionsSelectionChange,scope:this}}))}},{key:"_onTagCollectionsSelectionChange",value:function(){10===this.tagCollectionsField.value.length?this._disableUnselectedTagCollectionOptions():this._enableAllTagCollectionOptions()}},{key:"_disableUnselectedTagCollectionOptions",value:function(){var t=this;this.tagCollectionsField.componentList.forEach(function(e){-1===t.tagCollectionsField.value.indexOf(e.value)&&(e.disabled=!0)})}},{key:"_enableAllTagCollectionOptions",value:function(){this.tagCollectionsField.componentList.forEach(function(e){e.disabled=!1})}},{key:"_insertClearFilterButton",value:function(){var e=this;return this._insert(new n2.ui.component.Button({id:"clear-filters",renderTo:this.SELECTORS.emptyFilteredState,cls:"n2_clear-filters-button",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){e.quickFilter.clear()}}}))}},{key:"_onQuickFilterType",value:function(){var t;""!==this.quickFilter.value&&(t=this.quickFilter.value.toLowerCase(),this.tagCollectionsField.componentList.forEach(function(e){e.hidden=!e.label.text.toLowerCase().includes(t)})),this._onQuickFilterChange()}},{key:"_onQuickFilterChange",value:function(){""===this.quickFilter.value?(this.tagCollectionsField.componentList.forEach(function(e){e.hidden=!1}),this._hideEmptyFilteredState()):this.tagCollectionsField.componentList.find(function(e){return!1===e.hidden})?this._hideEmptyFilteredState():this._showEmptyFilteredState()}},{key:"_showEmptyFilteredState",value:function(){this.element("body").hide(),this.element("message").hide(),this.element("emptyFilteredState").show()}},{key:"_hideEmptyFilteredState",value:function(){this.element("emptyFilteredState").hide(),this.element("body").show(),this.element("message").show()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-objects-available-for-migration",{params:["Tag collection"],silent:t,force:n,requestId:"tag collections"});case 5:return e.t0=e.sent,e.abrupt("return",{tagCollections:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.tagCollections;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollectionOptions=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.tagCollectionOptions,t=void 0!==t&&t,n=e.emptyState,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshTagCollectionOptions(),(e||n)&&this._refreshEmptyState()}},{key:"_refreshTagCollectionOptions",value:function(){this.tagCollectionsField.options=this._tagCollectionOptions}},{key:"_refreshEmptyState",value:function(){n2.isEmpty(this._tagCollectionOptions)?this._showEmptyState():this._hideEmptyState()}},{key:"_showEmptyState",value:function(){this.element("filter").hide(),this.element("body").hide(),this.element("message").hide(),this.element("emptyState").show()}},{key:"_hideEmptyState",value:function(){this.element("emptyState").hide(),this.element("filter").show(),this.element("body").show(),this.element("message").show()}},{key:"hide",value:function(){_get(_getPrototypeOf(s.prototype),"hide",this).apply(this,arguments),this.tagCollectionsField.value=null,this.quickFilter.clear()}},{key:"_onFieldChange",value:function(e){this.fire("change",this._createEvent(e))}}]),s}(),n2.de.page.settings.exportImport.export.exportModal.Teams=function(){_inherits(s,n2.de.component.form.FieldGroup);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this.id="export-modal-teams",this._componentCls="n2-de-export-modal-teams",this.SELECTORS=n2.merge(this.SELECTORS,{filter:".n2_quick-filter",message:".n2_message",emptyState:".n2_empty-state",emptyFilteredState:".n2_empty-filtered-state"}),this._template='<fieldset id="{{id}}" class="{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="n2_quick-filter"></div>\n            <div class="n2_fields"></div>\n            <span class="n2_message">This could take a few minutes, you\'ll be emailed when complete.</span>\n            <span class="n2_empty-state slds-hide">No teams could be found on your org.</span>\n            <div class="n2_empty-filtered-state slds-hide">\n                <span>There are no teams that match your filter</span>\n            </div>\n        </fieldset>',this._teamOptions=[]}},{key:"quickFilter",get:function(){return this._components["quick-filter"]}},{key:"teamsField",get:function(){return this._components.teams}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).apply(this,arguments),this._insertQuickFilter(),this._insertTeamsRadioGroup(),this._insertClearFilterButton()}},{key:"_insertQuickFilter",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"quick-filter",renderTo:this.SELECTORS.filter,cls:"n2_quick-filter slds-m-bottom_medium",label:{text:"Quick filter",hidden:!0},icon:n2.ui.enum.Icon.SEARCH,placeholder:"Find teams...",allowClear:!0,listeners:{type:this._onQuickFilterType,change:this._onQuickFilterChange,scope:this}}))}},{key:"_insertTeamsRadioGroup",value:function(){return this._insert(new n2.ui.component.field.RadioGroup({id:"teams",renderTo:this.SELECTORS.body,cls:"slds-m-bottom_medium",label:"Team",sort:!1,options:[]}))}},{key:"_insertClearFilterButton",value:function(){var e=this;return this._insert(new n2.ui.component.Button({id:"clear-filters",renderTo:this.SELECTORS.emptyFilteredState,cls:"n2_clear-filters-button",text:"Clear Filters",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(){e.quickFilter.clear()}}}))}},{key:"_onQuickFilterType",value:function(){var t;""!==this.quickFilter.value&&(t=this.quickFilter.value.toLowerCase(),this.teamsField.componentList.forEach(function(e){e.hidden=!e.label.text.toLowerCase().includes(t)})),this._onQuickFilterChange()}},{key:"_onQuickFilterChange",value:function(){""===this.quickFilter.value?(this.teamsField.componentList.forEach(function(e){e.hidden=!1}),this._hideEmptyFilteredState()):this.teamsField.componentList.find(function(e){return!1===e.hidden})?this._hideEmptyFilteredState():this._showEmptyFilteredState()}},{key:"_showEmptyFilteredState",value:function(){this.element("body").hide(),this.element("message").hide(),this.element("emptyFilteredState").show()}},{key:"_hideEmptyFilteredState",value:function(){this.element("emptyFilteredState").hide(),this.element("body").show(),this.element("message").show()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-objects-available-for-migration",{params:["Team"],silent:t,force:n,requestId:"teams"});case 5:return e.t0=e.sent,e.abrupt("return",{teams:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.teams;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._teamOptions=e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.teamOptions,t=void 0!==t&&t,n=e.emptyState,n=void 0!==n&&n,e=n2.isEmpty(e);(e||t)&&this._refreshTeamOptions(),(e||n)&&this._refreshEmptyState()}},{key:"_refreshTeamOptions",value:function(){this.teamsField.options=this._teamOptions}},{key:"_refreshEmptyState",value:function(){n2.isEmpty(this._teamOptions)?this._showEmptyState():this._hideEmptyState()}},{key:"_showEmptyState",value:function(){this.element("filter").hide(),this.element("body").hide(),this.element("message").hide(),this.element("emptyState").show()}},{key:"_hideEmptyState",value:function(){this.element("emptyState").hide(),this.element("filter").show(),this.element("body").show(),this.element("message").show()}},{key:"hide",value:function(){_get(_getPrototypeOf(s.prototype),"hide",this).apply(this,arguments),this.teamsField.value=null,this.quickFilter.clear()}},{key:"_onFieldChange",value:function(e){this.fire("change",this._createEvent(e))}}]),s}(),n2.de.page.settings.exportImport.import.importWizard.FileSelector=function(){_inherits(s,n2.ui.component.field.FileSelector);var t,n,i,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._fileContents=null,this._fileContentsAsJSON=null}},{key:"fileContents",get:function(){return this._fileContents}},{key:"fileContentsAsJSON",get:function(){return this._fileContentsAsJSON}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this),this._insertFileNameField()}},{key:"_insertFileNameField",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"filename",label:{text:"Filename",hidden:!0},renderTo:this.SELECTORS.fieldContainer,hidden:!0,allowClear:!0,listeners:{change:this._onFileNameFieldChange,scope:this}}))}},{key:"_onFileNameFieldChange",value:function(e){this.clear()}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(s.prototype),"_prepareDOM",this).apply(this,arguments),this._components.filename.element("field").attribute("readonly",!0)}},{key:"_handleFileInputChange",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readFileContents(this.element("field").attribute("files")[0]);case 2:_get(_getPrototypeOf(s.prototype),"_handleFileInputChange",this).apply(this,n);case 3:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_handleDrop",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),t.preventDefault(),this._files=t.dataTransfer.files,e.next=5,this._readFileContents(this._files[0]);case 5:_get(_getPrototypeOf(s.prototype),"_handleDrop",this).call(this,{preventDefault:function(){},stopPropagation:function(){},dataTransfer:{files:this._files}});case 6:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_onChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.silent,e.sync;_get(_getPrototypeOf(s.prototype),"_onChange",this).apply(this,arguments),this._refresh({filename:!0})}},{key:"_readFileContents",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.spinner(!0),e.next=3,this._readFile(t);case 3:n=e.sent,this._fileContents=n.result,this.spinner(!1);case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_readFile",value:function(i){return new Promise(function(t,n){var e=new FileReader;e.onload=function(e){return t(e.target)},e.onerror=function(e){return n(e.target)},e.readAsText(i)})}},{key:"_validateCustom",value:function(){var e=_get(_getPrototypeOf(s.prototype),"_validateCustom",this).call(this);return!0===e?this._validateJSON(this._fileContents):e}},{key:"_validateJSON",value:function(e){try{return this._parseJSON(e),!0}catch(e){return"JSON parse error: ".concat(e.message)}}},{key:"_parseJSON",value:function(e){this._fileContentsAsJSON=JSON.parse(e)}},{key:"_refresh",value:function(e){_get(_getPrototypeOf(s.prototype),"_refresh",this).apply(this,arguments);var t=e.filename,t=void 0!==t&&t,e=n2.isEmpty(e);(t||e)&&this._refreshFilename()}},{key:"_refreshFilename",value:function(){var e=!n2.isEmpty(this._files)&&this._isValid;e?this.element("fileSelectorContainer").hide():this.element("fileSelectorContainer").show(),this._components.filename.value={value:this.value,silent:!0},this._components.filename.hidden=!e}},{key:"clear",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent;_get(_getPrototypeOf(s.prototype),"clear",this).apply(this,arguments),this._fileContents="",this.element("fileSelectorContainer").show(),this._components.filename.value={value:"",silent:!0},this._components.filename.hidden=!0}}]),s}(),n2.de.page.settings.exportImport.import.importWizard.Summary=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filename:".n2_filename"}),this._mixins=[n2.mixin.DataDriven],this._componentCls="n2-de-import-wizard-summary",this._filename=null,this._model=null,this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}}{{#componentCls}} {{componentCls}}{{/componentCls}} {{cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{> importSummaryTemplate }}\n        </div>',this._teamImportSummaryTemplate='<div class="n2_import-summary">\n            {{> fileSummaryTemplate }}\n            <div class="n2_team-summary">\n                <span class="slds-form-element__label n2_weak">Team</span>\n                <p class="n2_large n2_team-name">{{summary.teamSummary.teamName}}</p>\n                <div class="slds-grid">\n                    <div class="slds-col">\n                        <span class="slds-form-element__label">Distributors</span>\n                        <p class="n2_large n2_distributor-count">{{summary.teamSummary.distributorCount}}</p>\n                    </div>\n                    <div class="slds-col">\n                        <span class="slds-form-element__label">Team members</span>\n                        <p class="n2_large n2_team-member-count">{{summary.teamSummary.teamMemberCount}}</p>\n                    </div>\n                </div>\n            </div>\n            {{#showMergeConflictMessage}}{{> teamConflictMessageTemplate }}{{/showMergeConflictMessage}}\n            {{#summary.hasValidationErrors}}{{> errorSummaryTemplate }}{{/summary.hasValidationErrors}}\n            {{^summary.hasValidationErrors}}{{> importWarningTemplate }}{{/summary.hasValidationErrors}}\n        </div>',this._tagCollectionImportSummaryTemplate='<div class="n2_import-summary">\n            {{> fileSummaryTemplate }}\n            <div class="n2_tags-summaries">\n                <table>\n                    <thead><tr><th class="n2_tag-collection">Tag Collection</th><th class="n2_tag-count">Tag Count</th><th class="n2_is-merge">Is Merge</th></tr></thead>\n                    <tbody>\n                        {{#summary.tagsSummaries}}\n                            <tr>\n                                <td class="n2_tag-collection">{{tagCollectionName}}</td>\n                                <td class="n2_tag-count">{{tagValueCount}}</td>\n                                <td class="n2_is-merge">{{#isMerge}}Yes{{/isMerge}}{{^isMerge}}&mdash;{{/isMerge}}</td>\n                            </tr>\n                        {{/summary.tagsSummaries}}\n                    </tbody>\n                </table>\n            </div>\n            {{#showMergeConflictMessage}}{{> tagCollectionConflictMessageTemplate }}{{/showMergeConflictMessage}}\n            {{#summary.hasValidationErrors}}{{> errorSummaryTemplate }}{{/summary.hasValidationErrors}}\n            {{^summary.hasValidationErrors}}{{> importWarningTemplate }}{{/summary.hasValidationErrors}}\n        </div>',this._fileSummaryTemplate='<div class="n2_file-summary">\n            <span class="slds-form-element__label">File:</span>\n            <p class="n2_filename">{{filename}}</p>\n            <span class="slds-form-element__label">Exported on:</span>\n            <p class="n2_file-export-date">{{summary.exportDate}}</p>\n        </div>',this._teamConflictMessageTemplate='<div class="n2_conflict-message">\n            '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon-text-warning slds-icon_x-small"}),"\n            <p>This team already exists in your org. If you continue with the import, this team will be updated with the settings, distributors and team members from the import package. \n            Any distributors or team members that currently exist in your team that are not in the import package will be deactivated</p>\n        </div>"),this._tagCollectionConflictMessageTemplate='<div class="n2_conflict-message">\n            '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon-text-warning slds-icon_x-small"}),"\n            <p>One or more tag collections in this import already exist in your org. If you continue with the import, these tag collections will be updated with any new tags that exist in the import package.</p>\n        </div>"),this._errorSummaryTemplate='<div class="n2_validation-errors">\n            <div class="n2_header">\n                '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon-text-error slds-icon_x-small"}),'\n                <h2 class="n2_large">Errors</h2>\n                <span class="n2_weak n2_validation-error-count">{{validationErrorCount}} issues stopping import</span>\n            </div>\n            <div class="n2_validation-errors-list">\n                <ol class="slds-list_ordered">\n                    {{#summary.validationErrors}}\n                        <li>\n                            <span class="n2_heading">{{errorType}}</span>\n                            <p class="n2_weak">{{errorMessage}}</p>\n                            <ul>{{#dataInError}}<li>{{.}}</li>{{/dataInError}}</ul>\n                        </li>\n                    {{/summary.validationErrors}}\n                </ol>\n                <p class="slds-m-top_medium"><a class="n2_validation-error-link" href="https://help.nc-squared.com/import-export">Learn more about import validation errors.</a></p>\n            </div>\n        </div>'),this._importWarningTemplate='<div class="n2_import-message">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon-text-light slds-icon_x-small"}),"\n            <p>This could take a few minutes, youll be emailed when complete</p>\n        </div>")}},{key:"filename",set:function(e){this._filename!==e&&(this._filename=e,this._refresh({filename:!0}))}},{key:"_getTemplateData",value:function(){return n2.isNull(this._model)?_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this):n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{filename:this._filename,summary:n2.merge(this._model,{exportDate:this._getExportDate()}),validationErrorCount:this._getValidationErrorCount(),showMergeConflictMessage:this._containsMergeConflict()})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplatePartials",this).call(this),{importSummaryTemplate:this._getImportSummaryTemplate(),fileSummaryTemplate:this._fileSummaryTemplate,teamConflictMessageTemplate:this._teamConflictMessageTemplate,tagCollectionConflictMessageTemplate:this._tagCollectionConflictMessageTemplate,errorSummaryTemplate:this._errorSummaryTemplate,importWarningTemplate:this._importWarningTemplate})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._refresh({importSummary:!0})}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filename,t=void 0!==t&&t,n=e.importSummary,n=void 0!==n&&n,e=n2.isEmpty(e);(t||e)&&this._refreshFilename(),(n||e)&&this._refreshImportSummary()}},{key:"_refreshFilename",value:function(){n2.isNull(this.element("filename",!0))||this.element("filename").text(this._filename)}},{key:"_refreshImportSummary",value:function(){this._dom.clear();var e=this._createOutputDOM(this._createTemplateOutput(this._getImportSummaryTemplate()));this._dom.insert(e)}},{key:"_createTemplateOutput",value:function(e){return n2.ui.Template.render(e,this._getTemplateData(),this._getTemplatePartials())}},{key:"_createOutputDOM",value:function(e){return new n2.ui.DOM(e)}},{key:"_getImportSummaryTemplate",value:function(){return n2.isNull(this._model)?"":this._isTeamImport()?this._teamImportSummaryTemplate:this._tagCollectionImportSummaryTemplate}},{key:"_containsMergeConflict",value:function(){return this._isTeamImport()?this._model.teamSummary.isMerge:this._model.tagsSummaries.some(function(e){return e.isMerge})}},{key:"_getExportDate",value:function(){return n2.de.util.Date.formatTimestamp(this._model.exportDatetime)}},{key:"_getValidationErrorCount",value:function(){return this._model.hasValidationErrors?this._model.validationErrors.length:0}},{key:"_isTeamImport",value:function(){return"team"===this._model.contentType.toLowerCase()}},{key:"_isTagCollectionImport",value:function(){return"tag collection"===this._model.contentType.toLowerCase()}}]),n}(),n2.de.page.tags.component.field.tagPillList.EditableTagPillList=function(){_inherits(n,n2.ui.component.field.pillList.EditablePillList);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._existingTagNames=null}},{key:"existingTagNames",set:function(e){n2.compare(e,this._existingTagNames)||(this._existingTagNames=e)}},{key:"_findDuplicate",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_findDuplicate",this).apply(this,arguments);return t||n2.isNull(this._existingTagNames)?t:(t=n2.isString(e)?{text:e,value:e}:e,this._findExistingTagDuplicate(t))}},{key:"_findExistingTagDuplicate",value:function(t){var n=this,e=this._existingTagNames.find(function(e){return n._getDuplicateComparisonValue(n._getTagNameAsClientValue(e))===n._getDuplicateComparisonValue(t.value)});return n2.isUndefined(e)?null:e===n2.de.page.tags.Enum.BLANK_SERVER_VALUE?n2.de.page.tags.Enum.BLANK_CLIENT_TEXT:e}},{key:"_getTagNameAsClientValue",value:function(e){return e===n2.de.page.tags.Enum.BLANK_SERVER_VALUE?n2.de.page.tags.Enum.BLANK_CLIENT_VALUE:e}}]),n}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.dataTable.EmptyState=function(){_inherits(t,n2.de.component.recordList.AbstractEmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._heading=this._getHeading(),this._contentTemplate='<p class="slds-text-body_regular">'.concat(this._getContentTemplate(),"</p>")}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertTagCollectionsLink(),this._insertTeamsLink()}},{key:"_insertTagCollectionsLink",value:function(){return this._hasTagCollections()||!this._canAddTagCollections()?null:this._insert(new n2.ui.component.Button({id:"open-tag-collections",renderTo:".n2_empty-state-link",text:"Tag Collections page",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._handleButtonClick,scope:this}}))}},{key:"_insertTeamsLink",value:function(){return this._hasTagCollections()?this._insert(new n2.ui.component.Button({id:"open-teams",renderTo:".n2_empty-state-link",text:"Distribution Teams pages",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._handleButtonClick,scope:this}})):null}},{key:"_canInsertAddButton",value:function(){return!1}},{key:"_getHeading",value:function(){return this._hasTagCollections()?"You dont have any Team Members.":"No Tag Collections currently exist on your org."}},{key:"_getContentTemplate",value:function(){return this._hasTagCollections()?'<span>When you have team members, you will be able to assign them tags from this screen. Use the </span><span class="n2_empty-state-link"></span><span> to get started.</span>':this._canAddTagCollections()?'<span>Create one from the </span><span class="n2_empty-state-link"></span><span> to get started.</span>':""}},{key:"_hasTagCollections",value:function(){return n2.de.page.tags.tagAssignmentList.Context.getInstance().hasCollections}},{key:"_canAddTagCollections",value:function(){return n2.de.ApplicationContext.getInstance().isAdminOrSystemManager}},{key:"_handleButtonClick",value:function(e){this.fire("click",this._createEvent(e))}}]),t}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.dataTable.Row=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._template='<tr id="{{id}}" class="n2-data-table-row{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}{{#inactiveCls}} {{inactiveCls}}{{/inactiveCls}}"{{#title}} title="{{title}}"{{/title}}></tr>'}},{key:"_getTemplateData",value:function(){var e="";return n2.isNull(this._data)||this._data.isActive||(e=" n2-user-inactive"),n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{inactiveCls:e})}}]),t}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TagCollectionFilterCombo=function(){_inherits(s,n2.ui.component.field.Combo);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-tag-collections"],this._componentCls="n2-tag-collection-filter",this.label={text:"Tag collection filter",hidden:!0},this._placeholder="All collections"}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-tag-collections",{silent:n,force:t});case 5:return e.t0=e.sent,e.abrupt("return",{tagCollections:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.tagCollections;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.options=e.response,this.disabled||this._enable()}}]),s}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TagFilterCombo=function(){_inherits(i,n2.ui.component.field.Combo);var e,t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._lazyLoad=!0,this.dataProviders=["get-tags"],this._componentCls="n2-de-tag-filter-combo",this.label={text:"Tag filter",hidden:!0},this._placeholder="All tags"}},{key:"loadOptions",value:function(e){this._loadOptions({collectionId:e})}},{key:"_loadOptions",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(i=0<s.length&&void 0!==s[0]?s[0]:{}).silent,t=void 0!==t&&t,n=i.force,n=void 0===n||n,i=i.collectionId,e.abrupt("return",this._loadDataProvider("get-tags",{params:[i],silent:t,force:n,requestId:i}));case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t,n){_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),"get-tags"===t.id&&(this.options=e)}}]),i}(),n2.de.page.tags.tagAssignmentList.tagAssignmentRecordList.toolbar.TeamFilterCombo=function(){_inherits(s,n2.ui.component.field.Combo);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-teams"],this._componentCls="n2-de-team-filter-combo",this.label={text:"Team filter",hidden:!0},this._placeholder="All teams"}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-teams",{silent:n,force:t});case 5:return e.t0=e.sent,e.abrupt("return",{teamOptions:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.teamOptions;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.options=e.response,this.disabled||this._enable()}}]),s}(),n2.de.page.team.distributionHours.teamMemberHours.memberHours.MemberHoursForm=function(){_inherits(o,n2.de.component.Form);var e,t,n,i,s,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven,n2.mixin.Observable],this.dataProviders=["save-team-member-hours"],this._template='<div id="{{id}}" class="n2-de-member-hours n2-de-form{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            <div class="slds-form-element n2-de-field-group">\n            </div>\n        </div>',this._teamMemberData=null,this._lastShiftSelectionValue=null,this._shiftHoursCache={}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(o.prototype),"_onDefined",this).apply(this,arguments),this._insertShiftSelection(),this._insertShiftSummary()}},{key:"_insertShiftSelection",value:function(){var t=this,e=n2.de.enum.distributionHours.HoursType,n=e.TEAM,i=e.SHIFT,e=e.INDIVIDUAL;return this._insert(new n2.ui.component.field.RadioButtonGroup({id:"availability-type",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.formBody,sort:!1,model:this._model,label:"Availability",helpText:{text:"Whether the team member follows the team hours, an existing shift pattern or has their own individual hours.",position:n2.ui.enum.Position.BELOW},options:[{label:"Team hours",value:n},i,e],value:{bindPath:".hoursType"},listeners:{change:function(e){return t._onAvailabilityChange(e)}}}))}},{key:"_onAvailabilityChange",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s,a,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=n2.de.enum.distributionHours.HoursType,n=i.TEAM,i=i.SHIFT,s=t.value,a=this._shiftHoursCache[s],(this._cacheShiftHours(),this._model.getProperty("shiftHoursId").set(null),n2.isUndefined(a))?s!==i?e.next=6:(o={isShiftHours:!0},e.next=9):e.next=14;break;case 6:return e.next=8,this._loadHoursByType({hoursType:n,force:!0,silent:!1});case 8:(o=e.sent).isShiftHours=!1;case 9:this._model.getProperty("shiftHours").set(o),this._refreshShiftSummary(),this._components["shift-summary"].dirty=!o.isShiftHours,e.next=15;break;case 14:this._applyShiftHourCache(a),this._refreshShiftSummary(),this._components["shift-summary"].dirty=a.dirty;case 15:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_cacheShiftHours",value:function(){this._shiftHoursCache[this._lastShiftSelectionValue]={shiftHoursId:this._model.get("shiftHoursId"),shiftHours:this._model.get("shiftHours"),dirty:this._components["shift-summary"].dirty}}},{key:"_applyShiftHourCache",value:function(e){this._model.getProperty("shiftHoursId").set(e.shiftHoursId),this._model.getProperty("shiftHours").set(e.shiftHours)}},{key:"_insertShiftSummary",value:function(){return this._insert(new n2.de.page.team.distributionHours.ShiftSummary({id:"shift-summary",renderTo:this.SELECTORS.formBody}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(o.prototype),"_afterRender",this).apply(this,arguments),this._components["save-footer"].message=""}},{key:"_bindEvents",value:function(){_get(_getPrototypeOf(o.prototype),"_bindEvents",this).apply(this,arguments),this._components["availability-type"].dom.listen("mousedown",this._onShiftSelectionMouseDown,{scope:this})}},{key:"_onShiftSelectionMouseDown",value:function(e){this._lastShiftSelectionValue=this._components["availability-type"].value}},{key:"_onLoaded",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&(this._teamMemberData=n2.merge({},t.json),this._loadRowData(),this._model.listen("change",this._showFooter,this));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"_loadHoursToModel",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._model.get("hoursType"),e.next=3,this._loadHoursByType({hoursType:t,silent:!0,force:!0});case 3:return t=e.sent,e.abrupt("return",(this._model.insert(t,{key:"shiftHours",silent:!0}),t));case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_loadHoursByType",value:function(e){var t=e.hoursType,n=e.force,n=void 0!==n&&n,e=e.silent,e=void 0!==e&&e,i=n2.de.page.team.distributionHours.Context.getInstance().teamShiftHoursId,t=t===n2.de.enum.distributionHours.HoursType.TEAM?i:this._model.get("shiftHoursId");return this._loadShiftHours({shiftHoursId:t,force:n,silent:e})}},{key:"_loadShiftHours",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(n=0<s.length&&void 0!==s[0]?s[0]:{}).shiftHoursId,t=n.force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,this.spinner(!0),e.next=4,n2.DataProviderManager.getInstance().get("get-shift-hours").get({params:[i],force:t,silent:n});case 4:return i=e.sent,e.abrupt("return",(this.spinner(!1),i));case 6:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_showFooter",value:function(){this._components["save-footer"].message="",this._components["save-footer"].hidden=!1}},{key:"_onCancel",value:function(){_get(_getPrototypeOf(o.prototype),"_onCancel",this).apply(this,arguments),this._components["shift-summary"].loadShiftNames({force:!0}),this._loadRowData(),this._shiftHoursCache={}}},{key:"_loadRowData",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._model=new n2.dataProvider.Model({value:this._teamMemberData}),e.next=3,this._loadHoursToModel();case 3:this._components["availability-type"].model=this._model,this._refreshShiftSummary();case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(o.prototype),"_onSubmit",this).apply(this,arguments);var e=this._model.get("id"),t=this._model.get("hoursType"),n=this._getShiftHoursIdForSave(),i=t===n2.de.enum.distributionHours.HoursType.TEAM,s=null;this._components["shift-summary"].dirty&&!i&&(s=this._model.get("shiftHours")),n2.DataProviderManager.getInstance().get("save-team-member-hours").post({params:[e,t,n,s]})}},{key:"_getShiftHoursIdForSave",value:function(){var e=this._model.get("hoursType")===n2.de.enum.distributionHours.HoursType.TEAM,t=this._model.get("shiftHoursId");return"new-shift"===t?null:e?n2.de.page.team.distributionHours.Context.getInstance().teamShiftHoursId:t}},{key:"_onSaved",value:function(){this._components["shift-summary"].loadShiftNames({force:!0}),_get(_getPrototypeOf(o.prototype),"_onSaved",this).apply(this,arguments),this._shiftHoursCache={}}},{key:"_refreshShiftSummary",value:function(){var e=n2.de.enum.distributionHours.HoursType,t=e.SHIFT,e=e.INDIVIDUAL,n=this._components["shift-summary"];switch(n.model=this._model,this._components["availability-type"].value){case t:n.editMode=n.EDIT_MODE.SHIFT;break;case e:n.editMode=n.EDIT_MODE.HOURS;break;default:n.editMode=n.EDIT_MODE.NONE}}}]),o}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.Cell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._template='<td id="{{id}}" class="n2-shift-planner-shift{{#hidden}} {{hiddenCls}}{{/hidden}}{{#content.isActive}} n2_active-cell{{/content.isActive}} {{cls}}" title="{{content.shiftName}}">\n            {{> cellTemplate}}\n        </td>',this._cellTemplate='<div class="slds-truncate n2_shift-content" style="background-color: {{content.shiftColour}};">{{content.shiftName}}</div>',this._active=!1}},{key:"active",set:function(e){e!==this._active&&this.rendered&&this.data.isActive&&((this._active=e)?this._dom.addClass("active"):this._dom.removeClass("active"))}},{key:"_onClick",value:function(e){this.data.isActive&&(this.active=!0,n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftSelector.getInstance().show({currentShiftId:this.data.shiftId,dom:this._dom}))}}]),t}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.CloningState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._illustration=n2.de.illustration.Desert,this._heading="The shift planner is being prepared.",this._contentTemplate='<p>If you are concerned that this is taking too long please contact <a id="support-link" href="mailto:support@nc-squared.com">support@nc-squared.com</a><p>'}}]),t}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.DataTable=function(){_inherits(i,n2.de.component.DataTable);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).call(this),this._template='<table id="{{id}}" class="n2-data-table slds-table slds-table_header-fixed slds-table_fixed-layout slds-no-row-hover{{#cls}} {{cls}}{{/cls}}{{#hidden}} {{hideCls}}{{/hidden}}">\n            <colgroup>\n                {{#columns}}<col {{#cls}}class="{{cls}}"{{/cls}}/>{{/columns}}\n            </colgroup>\n            <thead></thead>\n            <tbody class="slds-no-row-hover"></tbody>\n            </table>',this._rowClass=n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.Row,this._activeCell=null,this._sortBy={column:0,direction:"asc"},this._isCloneInProgress=!1}},{key:"isCloneInProgress",set:function(e){this._isCloneInProgress=e;e=this._isCloneInProgress?n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.CloningState:n2.de.page.team.distributionHours.teamMemberHours.EmptyState;this.emptyState={type:e}}},{key:"changeShift",value:function(e){var e=e.shiftId,t=n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftDataManager,n=this._activeCell.parent,i=this._activeCell.data,s=i.shiftIndex;n.data=t.updateMemberShifts(n.data,{shiftId:e,position:s,previousShiftId:i.shiftId}),this._activeCell=n.componentList.find(function(e){return e.data.shiftIndex===s})}},{key:"activeCell",set:function(e){n2.compare(e,this._activeCell)||(n2.isNull(this._activeCell)||(this._activeCell.active=!1),n2.isNull(e)||!e.data.isActive?this._activeCell=null:this._activeCell=e)}},{key:"_onRowClick",value:function(e,t,n){_get(_getPrototypeOf(i.prototype),"_onRowClick",this).apply(this,arguments),this.activeCell=t}},{key:"_addHeaderRow",value:function(){var n=this;this.insert(new this._rowClass({id:"th-row",headerRow:!0,columns:this.columns,renderTo:this.SELECTORS.tableHeader,selectable:this._selectable,listeners:{selectionChange:function(e){return n._onHeaderRowSelectionChange(e)},sort:function(e){var t=e.target;n.headerRow.forEachCell(function(e){e!==t&&(e.sortDirection=null)}),n._sort(e.target.column,{direction:e.data.sortDirection}),n._sortBy={column:n.columns.indexOf(e.target.column),direction:e.data.sortDirection}}}}))}},{key:"_refreshData",value:function(){var e,t;n2.isNull(this._data)||(t=1===(e=(n2.dataProvider.Model.isModeled(this._data)?this._data.json:this._data).length)?"team member":"team members",this.emptyFilteredState=n2.merge(this._emptyFilteredState,{heading:"There are no team members that match your filters",content:"We looked through ".concat(e," ").concat(t,", but none of them match your filters. You can change your terms, or clear them to see all team members.")})),_get(_getPrototypeOf(i.prototype),"_refreshData",this).apply(this,arguments)}}]),i}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.Row=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._template='<tr id="{{id}}" class="n2-data-table-row{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}{{#inactiveCls}} {{inactiveCls}}{{/inactiveCls}}"{{#title}} title="{{title}}"{{/title}}></tr>'}},{key:"_getTemplateData",value:function(){var e="";return n2.isNull(this._data)||this._data.isActive||(e=" n2-member-inactive"),n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{inactiveCls:e})}},{key:"_updatePreviousCell",value:function(e,t){n2.isNull(t)||(t.removeCls("n2_merge-right"),e.removeCls("n2_merge-left"),e.data.shiftName===t.data.shiftName&&(t.addCls("n2_merge-right"),e.addCls("n2_merge-left")))}},{key:"_updateNextCell",value:function(e,t){n2.isNull(t)||(t.removeCls("n2_merge-left"),e.removeCls("n2_merge-right"),e.data.shiftName===t.data.shiftName&&(t.addCls("n2_merge-left"),e.addCls("n2_merge-right")))}}]),t}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.ShiftSelector=function(){_inherits(a,n2.ui.Component);var t,n,e,i=_createSuper(a);function a(){return _classCallCheck(this,a),i.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Singleton],this._mixins),this.SELECTORS=n2.merge(this.SELECTORS,{shiftSelection:".n2_shift-selection"}),this.id="n2-de-shift-selector",this._componentCls="n2-de-shift-selector",this._template='<div id="{{id}}" class="n2-component{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"{{#title}} title="{{title}}"{{/title}} style="position:absolute;" tabindex="0">\n            <div class="n2_shift-selection"></div>\n        </div>',this._lazyLoad=!0,this._shiftId=null,this.scrollableDOM=null,this._windowClickHandler=null,this._windowScrollHandler=null,this._windowResizeHandler=null}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).call(this),this._insertShiftCombo(),this._insertClose(),this._insertShiftHours(),this._insertTimezoneSummary()}},{key:"_prepareDOM",value:function(){var t=this;_get(_getPrototypeOf(a.prototype),"_prepareDOM",this).apply(this,arguments),this._dom.listen("keydown",function(e){n2.ui.Key.get(e.key)===n2.ui.enum.Key.ESCAPE&&(t.hidden=!0)})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<s.length&&void 0!==s[0]?s[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(a.prototype),"_load",this).apply(this,s);case 3:return i=n2.de.page.team.distributionHours.Context.getInstance().teamShiftHoursId,i=n2.isNull(this._shiftId)?i:this._shiftId,e.next=6,this._loadDataProvider("get-shift-hours",{params:[i],requestId:i,force:t,silent:n});case 6:return e.t0=e.sent.response,e.abrupt("return",{shiftHours:e.t0});case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(a.prototype),"_onLoadComplete",this).call(this,e),this._model=e.shiftHours}},{key:"show",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentShiftId,i=t.dom,this.rendered||this.render(),this.spinner(),_get(_getPrototypeOf(a.prototype),"show",this).apply(this,s),this._addPopoverListeners(),this._setPosition(i),this.focus({silent:!0}),this._shiftId=n,e.next=10,this.load({force:!1});case 10:this._refresh(),this.spinner(!1);case 12:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_addPopoverListeners",value:function(){var t=this;this._windowClickHandler=function(e){return t._onWindowClick(e)},window.addEventListener("click",this._windowClickHandler,!0),this._windowScrollHandler=function(e){return t._onWindowScroll(e)},window.addEventListener("scroll",this._windowScrollHandler,!0),this._windowResizeHandler=function(e){return t._onWindowResize(e)},window.addEventListener("resize",this._windowResizeHandler)}},{key:"_onWindowClick",value:function(e){var t=this._dom.rawDOM.contains(e.target),e=this._components["shift-selection"].listBox.dom.rawDOM.contains(e.target);t||e||this.hide()}},{key:"_onWindowScroll",value:function(e){this._components["shift-selection"].listBox.dom.find(".slds-listbox").rawDOM!==e.target&&this.hide()}},{key:"_onWindowResize",value:function(e){this.hide()}},{key:"hide",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).reserveSpace;_get(_getPrototypeOf(a.prototype),"hide",this).apply(this,arguments),this._removePopoverListeners();var e=this._components["shift-selection"];e&&e.close()}},{key:"_removePopoverListeners",value:function(){window.removeEventListener("resize",this._windowResizeHandler),window.removeEventListener("scroll",this._windowScrollHandler,!0),window.removeEventListener("click",this._windowClickHandler,!0)}},{key:"_insertShiftHours",value:function(){return this._insert(new n2.de.component.hours.ShiftHours({id:"shifts-hours",mixins:[n2.mixin.DataDriven],shiftDays:{bindPath:".days"}}))}},{key:"_insertTimezoneSummary",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"timezone-summary",label:{text:"Timezone",hidden:!0},disabled:!0}))}},{key:"_insertClose",value:function(){return this._insert(new n2.ui.component.Button({id:"close-shift-selector",cls:"n2_close",icon:n2.ui.enum.Icon.CLOSE,renderTo:this.SELECTORS.shiftSelection,listeners:{click:this._onClose,scope:this}}))}},{key:"_insertShiftCombo",value:function(){return this._insert(new n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.shiftSelector.ShiftCombo({id:"shift-selection",cls:"slds-m-top_medium n2_field-medium",renderTo:this.SELECTORS.shiftSelection,required:!0,options:[],listeners:{change:this._onShiftIdChange,scope:this}}))}},{key:"_onShiftIdChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._shiftId=t.value,e.next=3,this.load();case 3:this._refresh({shiftSelection:!1}),this.fire("change",{target:this,data:{shiftId:this._shiftId}});case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.shiftHours,n=e.shiftSelection,n=void 0===n||n,e=e.timezoneSummary,e=void 0===e||e;void 0!==t&&!t||this._refreshShiftHours(),n&&this._refreshShiftSelection(),e&&this._refreshTimezoneSummary()}},{key:"_refreshShiftHours",value:function(){this._components["shifts-hours"].model=this._model}},{key:"_refreshShiftSelection",value:function(){this._components["shift-selection"].value={value:this._shiftId,silent:!0}}},{key:"_refreshTimezoneSummary",value:function(){this._components["timezone-summary"].value={value:this._getTimezoneLabel(),silent:!0}}},{key:"_getTimezoneLabel",value:function(){var t=this._model.timezone;return n2.DataProviderManager.getInstance().get("get-timezones").model.find(function(e){return e.value===t}).label}},{key:"_onClose",value:function(){this.hidden=!0}},{key:"_setPosition",value:function(e){e=this._getPosition(e);this._dom.style(e)}},{key:"_getPosition",value:function(e){var t=n2.ui.dom.Scope.getInstance().root.rawDOM.getBoundingClientRect(),n=this.scrollableDOM.rawDOM.getBoundingClientRect(),i=this._dom.rawDOM.getBoundingClientRect(),e=e.rawDOM.getBoundingClientRect(),s={},a=n.width-200,o=a/2,r=e.left-n.left-200,l=t.height+t.top-n.top-i.height-50,c=e.bottom-n.top;return i.height>l+n.top+t.top?(s.top="".concat(n.top-t.top,"px"),s.left="".concat(n.left,"px")):(r<o&&a>r+i.width?s.left="".concat(e.left,"px"):s.left="".concat(e.right-i.width,"px"),s.top="".concat(l<c?e.top-t.top-i.height:e.bottom-t.top,"px")),s}}]),a}(),n2.de.page.team.distributorList.distributorRecordList.distributorDataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{additionalContent:".n2_additional-content",pullDistributor:".n2_pull-distributor",manualDistributor:".n2_manual-distributor",triggerDistributor:".n2_trigger-distributor"}),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){}}),this._mixins=[n2.mixin.Observable],this._template='<tr id="{{id}}" class="n2-data-table-empty-state{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}"><td id="n2_empty-state-container" colspan="{{colspan}}"><div class="slds-illustration n2-illustration{{#sizeCls}} {{sizeCls}}{{/sizeCls}}">'+n2.de.illustration.OpenRoad+'<div class="slds-text-longform slds-m-bottom_x-large">{{#heading}}{{>headingTemplate}}{{/heading}}{{#content}}{{>contentTemplate}}{{/content}}</div><div class="n2_additional-content slds-p-top_x-large slds-border_top{{^showPullContent}}{{^showManualContent}}{{^showTriggerContent}} slds-hide{{/showTriggerContent}}{{/showManualContent}}{{/showPullContent}}"><h2 class="slds-text-heading_small slds-p-bottom_xx-small">Not what you\'re looking for?</h2><div class="slds-grid">{{>additionalContentTemplate}}</div></div></div></td></tr>',this._heading="Your team doesn't have any distributors yet",this._content="Distributors are the rules which define what assignments will be made to team members.",this._additionalContentTemplate="{{>pullDistributorTemplate}}{{>manualDistributorTemplate}}{{>triggerDistributorTemplate}}",this._pullDistributorTemplate='<div class="n2_pull-distributor slds-col {{#showTriggerContent}}slds-size_1-of-3{{/showTriggerContent}}{{^showTriggerContent}}slds-size_1-of-2{{/showTriggerContent}} slds-p-top_x-small{{^showPullContent}} slds-hide{{/showPullContent}}"><p class="slds-p-horizontal_medium">Pull distributors allow team members to request their own records via the widget.</p></div>',this._manualDistributorTemplate='<div class="n2_manual-distributor slds-col {{#showTriggerContent}}slds-size_1-of-3{{/showTriggerContent}}{{^showTriggerContent}}slds-size_1-of-2{{/showTriggerContent}} slds-p-top_x-small{{#showPullContent}} slds-border_left{{/showPullContent}}{{^showManualContent}} slds-hide{{/showManualContent}}"><p class="slds-p-horizontal_medium">Manual distributors assign to a manually selected team member in real-time.</p></div>',this._triggerDistributorTemplate='<div class="n2_trigger-distributor slds-col slds-size_1-of-3 slds-p-top_x-small{{#showManualContent}} slds-border_left{{/showManualContent}}{{^showTriggerContent}} slds-hide{{/showTriggerContent}}"><p class="slds-p-horizontal_medium">Trigger distributors assign in real-time, but with restricted functionality.</p></div>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddDistributorButton(),this._insertAddPullDistributorButton(),this._insertAddManualDistributorButton(),this._insertAddTriggerDistributorButton()}},{key:"_insertAddDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-distributor",text:"Add Distributor",cls:"slds-m-top_medium",theme:n2.ui.component.button.Theme.BRAND,listeners:{click:function(e){return t._onAddDistributorClick(e)}}}))}},{key:"_onAddDistributorClick",value:function(e){this.fire("click",this._createEvent(e,{data:{actions:["add-new"],distributorType:n2.de.enum.distributor.Type.STANDARD}}))}},{key:"_insertAddPullDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-pull-distributor",text:"Add Pull Distributor",cls:"slds-m-top_x-small",renderTo:this.SELECTORS.pullDistributor,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddPullDistributorClick(e)}}}))}},{key:"_onAddPullDistributorClick",value:function(e){this.fire("click",this._createEvent(e,{data:{actions:["add-new"],distributorType:n2.de.enum.distributor.Type.PULL}}))}},{key:"_insertAddManualDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-manual-distributor",text:"Add Manual Distributor",cls:"slds-m-top_x-small",renderTo:this.SELECTORS.manualDistributor,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddManualDistributorClick(e)}}}))}},{key:"_onAddManualDistributorClick",value:function(e){this.fire("click",this._createEvent(e,{data:{actions:["add-new"],distributorType:n2.de.enum.distributor.Type.MANUAL}}))}},{key:"_insertAddTriggerDistributorButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-trigger-distributor",text:"Add Trigger Distributor",cls:"slds-m-top_x-small",renderTo:this.SELECTORS.triggerDistributor,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTriggerDistributorClick(e)}}}))}},{key:"_onAddTriggerDistributorClick",value:function(e){this.fire("click",this._createEvent(e,{data:{actions:["add-new"],distributorType:n2.de.enum.distributor.Type.TRIGGER}}))}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{showPullContent:!n2.de.page.team.Context.getInstance().isQ2QTeam,showManualContent:!n2.de.page.team.Context.getInstance().isQ2QTeam,showTriggerContent:n2.de.page.team.Context.getInstance().isTriggersEnabled})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{additionalContentTemplate:this._additionalContentTemplate,pullDistributorTemplate:this._pullDistributorTemplate,manualDistributorTemplate:this._manualDistributorTemplate,triggerDistributorTemplate:this._triggerDistributorTemplate})}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.AvailabilityAssignmentField=function(){_inherits(n,n2.ui.component.field.CheckboxGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_bindEvents",value:function(){_get(_getPrototypeOf(n.prototype),"_bindEvents",this).apply(this,arguments),this._components["option-0"].listen("change",this._onAssignIfUnavailableChange,this),this._components["option-1"].listen("change",this._onAssignIfToggleOffChange,this)}},{key:"_onAssignIfUnavailableChange",value:function(e){this._model.getProperty("assignOnOutOfOffice").value=e.isChecked(),!e.isChecked()&&this._model.get("userTogglesEnabled")||(this._model.getProperty("assignOnWidgetOff").value=e.isChecked()),this._refreshAssignIfToggleOffField()}},{key:"_onAssignIfToggleOffChange",value:function(e){this._model.getProperty("assignOnWidgetOff").value=e.isChecked()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._refreshAssignIfUserUnavailableField({silent:!0}),this._refreshAssignIfToggleOffField({silent:!0}))}},{key:"_refreshAssignIfUserUnavailableField",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,e=void 0!==e&&e,t=this._model.get("assignOnOutOfOffice");this.components["option-0"].value={value:t,silent:e}}},{key:"_refreshAssignIfToggleOffField",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).silent,e=void 0!==e&&e,t=this.components["option-1"];t.hidden=!this._model.get("userTogglesEnabled")||n2.de.page.team.distributorSettings.Context.getInstance().isQ2QTeam,t.disabled=this._model.get("assignOnOutOfOffice"),t.value={value:this._model.get("assignOnWidgetOff"),silent:e}}},{key:"_enableChildren",value:function(){_get(_getPrototypeOf(n.prototype),"_enableChildren",this).apply(this,arguments),this.components["option-1"].disabled=this._model.get("assignIfUserUnavailable")}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LoadBalancingFields=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._loadBalancingDurationMessageTemplate='<div id="{{id}}" class="slds-grid slds-m-left_small slds-m-bottom_small{{#hidden}} {{hideCls}}{{/hidden}}">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-m-top_xxx-small slds-col slds-no-flex slds-icon-text-default"}),' \n            <div class="slds-col">\n                <p>{{model.loadBalancingDurationMessage}}</p>\n            </div>\n        </div>')}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertDurationField(),this._insertTeamLevelField(),this._insertLevelField()}},{key:"_insertDurationField",value:function(){var e=this,t=this.insert(new n2.ui.component.field.TextBox({id:"team-load-balancing-duration",mixins:[n2.mixin.DataDriven],label:"Load balancing type",cls:"n2_field-large n2_no-field n2_duration-field",helpText:"Time period, count or value by which the Distributor will aim to ensure balanced distributions.",value:{bindPath:".loadBalancingDuration"}}));return t._insert(new n2.ui.component.Button({id:"load-balancing-level-button",mixins:[n2.mixin.DataDriven],text:"Change in team settings",theme:n2.ui.component.button.Theme.LINK,renderTo:t.SELECTORS.fieldContainer,hidden:{bindPath:".distributorType",adapter:function(e){return"trigger"===e.toLowerCase()},defaultValue:!1},listeners:{click:function(){return e._onChangeLoadBalancingScheduleClick()}}})),t.insert(new n2.ui.component.HTML({id:"team-load-balancing-duration-message",mixins:[n2.mixin.DataDriven],model:this._model,template:this._loadBalancingDurationMessageTemplate,hidden:{bindPath:".loadBalancingDurationMessage",adapter:function(e){return n2.isNull(e)},defaultValue:!0}})),t}},{key:"_insertTeamLevelField",value:function(){return this._insert(new n2.ui.component.field.TextBox({id:"load-balancing-level-team",mixins:[n2.mixin.DataDriven],label:"Load balancing level",cls:"n2_field-large n2_no-field",helpText:"Whether the Distributor considers the workloads of just this team or all teams when determining the target load to balance to. When duration is set to Active/Total then load balancing level will always be at the team level.",value:{bindPath:".loadBalancingLevel"},hidden:{bindPath:".loadBalancingDurationIsActive",adapter:function(e){return!0!==e},defaultValue:!0}}))}},{key:"_insertLevelField",value:function(){return this.insert(new n2.de.component.field.RadioButtonGroup({id:"load-balancing-level",mixins:[n2.mixin.DataDriven],label:"Load balancing level",cls:"slds-m-bottom_medium",helpText:"Whether the Distributor considers the workloads of just this team or all teams when determining the target load to balance to.",required:!0,options:["Team","Distributor"],sort:!1,value:{bindPath:".loadBalancingLevel"},hidden:{bindPath:".loadBalancingDurationIsActive",adapter:function(e){return!0===e},defaultValue:!1}}))}},{key:"_onChangeLoadBalancingScheduleClick",value:function(){var e,t=this;n2.de.page.team.distributorSettings.Context.getInstance().isDirty?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom.parent}).show({message:"You will lose all unsaved changes to your distributor, do you want to continue?",listeners:{submit:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t._navigateToTeamSettingsPage();case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}}):this._navigateToTeamSettingsPage()}},{key:"_navigateToTeamSettingsPage",value:function(){var e=n2.de.page.team.distributorSettings.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamSettings","teamId=".concat(e))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.duration,t=void 0!==t&&t,n=e.teamLevel,n=void 0!==n&&n,i=e.level,i=void 0!==i&&i,e=n2.isEmpty(e);(e||t)&&this._refreshDuration(),(e||n)&&this._refreshTeamLevel(),(e||i)&&this._refreshLevel()}},{key:"_refreshDuration",value:function(){var e=this.components["team-load-balancing-duration"];e.components["team-load-balancing-duration-message"].model=this._model,e.model=this._model}},{key:"_refreshTeamLevel",value:function(){this.components["load-balancing-level-team"].model=this._model}},{key:"_refreshLevel",value:function(){this.components["load-balancing-level"].model=this._model}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwner=function(){_inherits(h,n2.de.component.form.FieldGroup);var e,t,n,i=_createSuper(h);function h(){return _classCallCheck(this,h),i.apply(this,arguments)}return _createClass(h,[{key:"_define",value:function(){_get(_getPrototypeOf(h.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._componentCls="n2-de-lookup-owner",this._lazyLoad=!0,this._lookupOwnerModel=null,this._teamObjectFieldOptions=null,this._lookupObjectOptions=null,this._lookupObjectFieldOptions=null,this._assignToOptions=null,this._assignToParentOptions=null}},{key:"lookupObjectSelection",get:function(){return this._components["lookup-owner-object"]}},{key:"lookupFields",get:function(){return this._components["lookup-owner-fields"]}},{key:"lookupFilter",get:function(){return this._components["lookup-owner-filter"]}},{key:"assignToFieldSelection",get:function(){return this._components["assign-to-field"]}},{key:"assignToParentFieldSelection",get:function(){return this._components["assign-to-parent-field"]}},{key:"_insertFields",value:function(){_get(_getPrototypeOf(h.prototype),"_insertFields",this).apply(this,arguments),this._insertObjectSelection(),this._insertFilterFields(),this._insertFilterCondition(),this._insertAssignToField(),this._insertAssignToParentField()}},{key:"_insertObjectSelection",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"lookup-owner-object",mixins:[n2.mixin.DataDriven],label:"Lookup to",cls:"n2_field-medium slds-m-bottom_medium",required:!0,options:[],value:{bindPath:".lookupObjectName"},listeners:{change:this._onLookupOwnerObjectChange,scope:this}}))}},{key:"_onLookupOwnerObjectChange",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.lookupFields.show(),this.lookupFilter.show(),this.assignToFieldSelection.show(),this._lookupOwnerModel=this._insertNewLookupOwnerModel({lookupObjectName:t.value}),n=t.value,e.next=4,Promise.all([this._fetchDataProvider("get-team-object-field-options",{params:[n],force:!1,silent:!1,requestId:n}),this._fetchDataProvider("get-lookup-owner-assign-to-options",{params:[n],force:!1,silent:!1,requestId:n})]);case 4:n=e.sent,s=_slicedToArray(n,2),i=s[0],s=s[1],this._lookupObjectFieldOptions=i.response,this._assignToOptions=s.response,this._refresh({lookupFields:!0,lookupFilters:!0,assignToField:!0,assignToParentField:!0});case 9:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_insertFilterFields",value:function(){var e=this.getComponentIndex("lookup-owner-fields"),e=-1<e?e:null;return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwnerFields({id:"lookup-owner-fields",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-object-field-options"],label:"Lookup field",hidden:!0,value:{bindPath:"."}}),e)}},{key:"_insertFilterCondition",value:function(){var n,a=this;return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwnerFilter({id:"lookup-owner-filter",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-object-field-options"],cls:"slds-m-bottom_small",label:"Where",helpText:"Only match on records that fulfill this condition (optional).",hidden:!0,loadComboOptions:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner(),s=a._model.get("lookupOwnerSettings").lookupObjectName,i=n.get("name"),e.next=5,a._fetchDataProvider("get-pick-list-field-select-options",{params:[s,i],force:!1,silent:!0,requestId:"".concat(s,".").concat(i)});case 5:s=e.sent,t.options=s.response,t.spinner(!1);case 7:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),value:{bindPath:"."}}))}},{key:"_insertAssignToField",value:function(){var t=this;return this._insert(new n2.ui.component.field.Combo({id:"assign-to-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-lookup-owner-assign-to-options"],label:"Assign to field",cls:"n2_assign-to-field n2_field-medium slds-m-bottom_medium",helpText:"If a match is found, the value of this user field is used as the owner of the new record.",hidden:!0,options:[],required:!0,value:{bindPath:".assignToField"},listeners:{change:function(e){return t._onAssignToFieldChange(e)}}}))}},{key:"_insertAssignToParentField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"assign-to-parent-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-lookup-owner-assign-to-parent-field-options"],label:{text:"Assign to parent field",hidden:!0},cls:"n2_assign-to-field n2_field-medium slds-m-bottom_medium",hidden:!0,options:[],required:!0,value:{bindPath:".assignToParentField"}}))}},{key:"_onAssignToFieldChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._lookupOwnerModel.getProperty("assignToParentField",{defaultValue:""}).set("",{silent:!0}),n=this._getAssignToOptionData(t.value),this._isAssignToParentOption(n))return this.assignToParentFieldSelection.show(),e.next=6,this._fetchDataProvider("get-lookup-owner-assign-to-parent-field-options",{params:[n.type],force:!1,silent:!1,requestId:n.type});e.next=8;break;case 6:n=e.sent,this._assignToParentOptions=n.response;case 8:this._refresh({assignToParentField:!0});case 9:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_onLoading",value:function(e){this.lookupObjectSelection.spinner(!0)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(h.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._lookupOwnerModel=this._model.getProperty("lookupOwnerSettings"),n2.isUndefined(this._lookupOwnerModel)&&(this._lookupOwnerModel=this._insertNewLookupOwnerModel()),this.load({force:!1}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r,l,c,u,d=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<d.length&&void 0!==d[0]?d[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(h.prototype),"_load",this).apply(this,d);case 3:return s=this._model.get("objectName"),s=[this._loadDataProvider("get-lookup-owner-object-options",{force:n,silent:t}),this._loadDataProvider("get-team-object-field-options",{params:[s],force:n,silent:t,requestId:s})],i=this._lookupOwnerModel.get("lookupObjectName"),n2.isEmpty(i)||(s=s.concat([this._loadDataProvider("get-team-object-field-options",{params:[i],force:n,silent:t,requestId:i}),this._loadDataProvider("get-lookup-owner-assign-to-options",{params:[i],force:n,silent:t,requestId:i})])),e.next=9,Promise.all(s);case 9:if(i=e.sent,s=_slicedToArray(i,4),a=s[0],o=s[1],r=s[2],l=s[3],u=this._lookupOwnerModel.get("assignToField"),n2.isEmpty(u));else if(u=this._getAssignToOptionData(u,{assignToOptions:l.response}),e.t0=this._isAssignToParentOption(u),e.t0)return e.next=22,this._loadDataProvider("get-lookup-owner-assign-to-parent-field-options",{params:[u.type],force:n,silent:t,requestId:u.type});e.next=23;break;case 22:c=e.sent;case 23:return e.abrupt("return",{lookupObjectOptions:a,teamObjectFieldOptions:o,lookupObjectFieldOptions:r,assignToOptions:l,assignToParentOptions:c});case 24:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.lookupObjectOptions,n=e.teamObjectFieldOptions,i=e.lookupObjectFieldOptions,i=void 0===i?null:i,s=e.assignToOptions,s=void 0===s?null:s,e=e.assignToParentOptions,e=void 0===e?null:e;_get(_getPrototypeOf(h.prototype),"_onLoadComplete",this).apply(this,arguments),this.lookupObjectSelection.spinner(!1),this._lookupObjectOptions=t.response,this._teamObjectFieldOptions=n.response,this._lookupObjectFieldOptions=n2.isNull(i)?[]:i.response,this._assignToOptions=n2.isNull(s)?[]:s.response,this._assignToParentOptions=n2.isNull(e)?[]:e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.lookupObjectSelection,i=e.lookupFields,i=void 0!==i&&i,s=e.lookupFilters,s=void 0!==s&&s,a=e.assignToField,a=void 0!==a&&a,e=e.assignToParentField,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshLookupObjectSelection(),(t||i)&&this._refreshLookupFields(),(t||s)&&this._refreshLookupFilters(),(t||a)&&this._refreshAssignToField(),(t||e)&&this._refreshAssignToParentField()}},{key:"_refreshLookupObjectSelection",value:function(){this.lookupObjectSelection.options=this._lookupObjectOptions.map(function(e){return{label:e.label,value:e.value}}),this.lookupObjectSelection.model=this._lookupOwnerModel}},{key:"_refreshLookupFields",value:function(){var e=[n2.de.data.FieldType.STRING,n2.de.data.FieldType.EMAIL,n2.de.data.FieldType.URL,n2.de.data.FieldType.ID,n2.de.data.FieldType.REFERENCE];this.lookupFields.objectFieldOptions=n2.de.data.Adapters.objectFieldOptions(this._teamObjectFieldOptions,{includeSortable:!0,includeFilterable:!0,validTypes:e}),this.lookupFields.lookupObjectFieldOptions=n2.de.data.Adapters.objectFieldOptions(this._lookupObjectFieldOptions,{includeSortable:!0,includeFilterable:!0,validTypes:e}),this.lookupFields.model=this._lookupOwnerModel.getProperty("lookupFields"),this.lookupFields.objectName=this._model.get("objectLabel"),this.lookupFields.lookupOwnerObjectName=this._getLookupOwnerObjectLabel(),this.lookupFields.hidden=!this._hasLookupName()&&!this._hasLookupFields()}},{key:"_refreshLookupFilters",value:function(){var e=[n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.INTEGER,n2.de.data.FieldType.CURRENCY,n2.de.data.FieldType.TEXTAREA,n2.de.data.FieldType.BOOLEAN];this.lookupFilter.fieldOptions=n2.de.data.Adapters.objectFieldOptionsWithType(this._lookupObjectFieldOptions,{includeFilterable:!0,includeRecordTypeId:!0,validTypes:e}),this.lookupFilter.lookupOwnerModel=this._lookupOwnerModel,this.lookupFilter.hidden=!this._hasLookupName()}},{key:"_refreshAssignToField",value:function(){this.assignToFieldSelection.options=n2.de.data.Adapters.objectFieldOptions(this._assignToOptions),this.assignToFieldSelection.model=this._lookupOwnerModel,this.assignToFieldSelection.clearInvalid(),this.assignToFieldSelection.hidden=!this._hasLookupName()}},{key:"_refreshAssignToParentField",value:function(){this.assignToParentFieldSelection.options=this._assignToParentOptions,this.assignToParentFieldSelection.model=this._lookupOwnerModel,this.assignToParentFieldSelection.clearInvalid(),this.assignToParentFieldSelection.hidden=!this._hasLookupName()||!this._isAssignToParentOption(this._getAssignToOptionData(this.assignToFieldSelection.value))}},{key:"_insertNewLookupOwnerModel",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).lookupObjectName;return this._model.insert({lookupObjectName:void 0===e?"":e,hasFilter:!1,lookupFields:[{uniqueIdField:"",matchField:""}]},{key:"lookupOwnerSettings"})}},{key:"_getAssignToOptionData",value:function(t){var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).assignToOptions;return(void 0===e?this._assignToOptions:e).find(function(e){return e.value===t})||{}}},{key:"_getLookupOwnerObjectLabel",value:function(){var t=this.lookupObjectSelection.value,e=this._lookupObjectOptions.find(function(e){return e.value===t});return e?e.label:t}},{key:"_hasLookupName",value:function(){return!n2.isEmpty(this._lookupOwnerModel.get("lookupObjectName"))}},{key:"_hasLookupFields",value:function(){var e=this._lookupOwnerModel.getProperty("lookupFields").json[0]||{};return!n2.isEmpty(e.uniqueIdField)&&!n2.isEmpty(e.matchField)}},{key:"_isAssignToParentOption",value:function(e){return!n2.isUndefined(e.type)}}]),h}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwnerFields=function(){_inherits(t,n2.de.component.field.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-lookup-owner-fields",this._columns=[{header:{data:"",hidden:!0},cell:{type:n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.lookupOwnerFields.OrCell,cls:"n2_or-cell"}},{header:"Originating field",bindPath:"uniqueIdField",editField:{type:n2.ui.component.field.Combo,required:!0,options:[]}},{header:{data:"",hidden:!0},cell:{type:n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.lookupOwnerFields.EqualsCell,cls:"n2_equals-cell"}},{header:"Lookup field",bindPath:"matchField",editField:{type:n2.ui.component.field.Combo,required:!0,options:[]}}],this._newRowData={type:n2.dataProvider.Model,value:{uniqueIdField:"",matchField:""}},this._objectFieldOptions=null,this._lookupObjectFieldOptions=null,this._min=1,this._max=3,this.required=!0,this._addRowButtonConfig={text:"Add OR clause"},this._objectName=null,this._lookupOwnerObjectName=null}},{key:"dataTable",get:function(){return this._components["data-table"]}},{key:"objectColumn",get:function(){return this._columns[1]}},{key:"lookUpObjectColumn",get:function(){return this._columns[3]}},{key:"objectColumnHeader",get:function(){return this.dataTable.headerRow.components["th-1"]}},{key:"lookupObjectColumnHeader",get:function(){return this.dataTable.headerRow.components["th-3"]}},{key:"objectFieldOptions",get:function(){return this._objectFieldOptions},set:function(e){n2.compare(e,this._objectFieldOptions||[])||(this._objectFieldOptions=e,this._refresh({objectFieldOptions:!0}),this.objectColumn.editField.options=this._objectFieldOptions)}},{key:"lookupObjectFieldOptions",get:function(){return this._lookupObjectFieldOptions},set:function(e){n2.compare(e,this._lookupObjectFieldOptions||[])||(this._lookupObjectFieldOptions=e,this._refresh({lookupObjectFieldOptions:!0}),this.lookUpObjectColumn.editField.options=this._lookupObjectFieldOptions)}},{key:"objectName",set:function(e){this._objectName!==e&&(this._objectName=e,this._refresh({objectName:!0}))}},{key:"lookupOwnerObjectName",set:function(e){this._lookupOwnerObjectName!==e&&(this._lookupOwnerObjectName=e,this._refresh({lookupOwnerObjectName:!0}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this.dataTable.dom.addClass("slds-no-row-hover")}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.objectName,t=void 0!==t&&t,n=e.lookupOwnerObjectName,n=void 0!==n&&n,i=e.objectFieldOptions,i=void 0!==i&&i,s=e.lookupObjectFieldOptions,s=void 0!==s&&s,e=n2.isEmpty(e);(e||t)&&this._refreshObjectName(),(e||n)&&this._refreshLookupOwnerObjectName(),(e||i)&&this._refreshObjectFieldOptions(),(e||s)&&this._refreshLookupObjectFieldOptions()}},{key:"_refreshObjectName",value:function(){this.objectColumnHeader.data="".concat(this._objectName," field")}},{key:"_refreshLookupOwnerObjectName",value:function(){this.lookupObjectColumnHeader.data="".concat(this._lookupOwnerObjectName," field")}},{key:"_refreshObjectFieldOptions",value:function(){var t=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).row,e=void 0===e?null:e;n2.isNull(e)?this.dataTable.forEachRow(function(e){return t._refreshObjectFieldOptions({row:e})}):e.components["td-1"].components["edit-field"].options=this._objectFieldOptions}},{key:"_refreshLookupObjectFieldOptions",value:function(){var t=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).row,e=void 0===e?null:e;n2.isNull(e)?this.dataTable.forEachRow(function(e){return t._refreshLookupObjectFieldOptions({row:e})}):e.components["td-3"].components["edit-field"].options=this._lookupObjectFieldOptions}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.LookupOwnerFilter=function(){_inherits(i,n2.ui.component.field.LogicFilter);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this._min=1,this._max=1,this._addRowButtonConfig={hidden:!0},this._logicHidden=!0,this._lookupOwnerModel=null}},{key:"lookupOwnerModel",set:function(e){this._lookupOwnerModel=e,this._loadModel()}},{key:"_getDataTableConfig",value:function(){var n=this;return n2.merge(_get(_getPrototypeOf(i.prototype),"_getDataTableConfig",this).apply(this,arguments),{columns:[{header:"Field",bindPath:".name",cell:{cls:"n2_name"},editField:{id:"field-options",type:n2.ui.component.field.logicFilter.filters.FieldSelection,required:this._required}},{header:"Operator",bindPath:".op",cell:{cls:"n2_operator"},editField:{id:"operator-options",type:n2.ui.component.field.Combo,required:!0,sort:!1,options:[]}},{header:"Value",cell:{type:n2.ui.component.field.logicFilter.filters.ValueCell,cls:"n2_value",loadComboOptions:function(e,t){return n._loadComboOptions(e,t)}}}],reorderable:!1})}},{key:"_getDataTableDataDrivenConfig",value:function(){return n2.merge(_get(_getPrototypeOf(i.prototype),"_getDataTableDataDrivenConfig",this).apply(this,arguments),{data:{bindPath:"."},logic:""})}},{key:"_loadModel",value:function(){var e,t,n=this;n2.isNull(this._lookupOwnerModel)||(n2.isNull(this._model)||(this._model.value=[],this._model.destroy()),e=new n2.dataProvider.model.Collection({value:[]}),t=e.insert(this._lookupOwnerModel.getProperty("filter",{defaultValue:{name:"",op:"",val:"",type:""}}),{key:0}),this._model=e,this._handleLoaded(this._model),t.listen("change",function(){n2.isEmpty(t.get("name"))&&n._disableOperatorAndValue(),n.fire("change",n)},this))}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(this._lookupOwnerModel)||(this._lookupOwnerModel.get("hasFilter")||this._disableOperatorAndValue(),this._components["data-table"].forEachRow(function(e){e.components["td-0"].editField.fieldSelection.placeholder="None"}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(i.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-lookup-owner-filter"),this._components["data-table"].dom.addClass("slds-no-row-hover")}},{key:"_setFieldValue",value:function(e){this._components["data-table"].data=e}},{key:"_getValue",value:function(){return this._components["data-table"].data}},{key:"clear",value:function(){_get(_getPrototypeOf(i.prototype),"clear",this).call(this),this._lookupOwnerModel.getProperty("hasFilter",{defaultValue:!1}).value=!1}},{key:"_disableOperatorAndValue",value:function(){this._components["data-table"].components["tr-0"].components["td-1"].editField.disabled=!0,this._components["data-table"].components["tr-0"].components["td-2"].editField.disabled=!0}},{key:"validate",value:function(){return n2.isEmpty(this._lookupOwnerModel.get("filter").name)?this._isValid=!0:_get(_getPrototypeOf(i.prototype),"validate",this).apply(this,arguments)}}]),i}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RelatedOwner=function(){_inherits(s,n2.de.component.form.FieldGroup);var e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_insertFields",value:function(){_get(_getPrototypeOf(s.prototype),"_insertFields",this).apply(this,arguments),this._insertRelatedOwnerFields()}},{key:"_insertRelatedOwnerFields",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RelatedOwnerFields({id:"related-owner-fields",cls:"n2_flush-left slds-m-bottom_medium"})),this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RelatedOwnerFields({id:"related-owner-fallback-fields",cls:"n2_flush-left slds-m-bottom_medium",required:!1,relatedObjectHelpText:"Optionally use this object if the related owner lookup fails.",relatedObjectLabel:"Otherwise use related object",usingFieldHelpText:"Optionally use this field if the related owner lookup fails."}))}},{key:"_onLoaded",value:function(e,t){var n,i=this;_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(t=this._getRelatedOwnerModel(),this._components["related-owner-fields"].model=t,(n=this._components["related-owner-fallback-fields"]).model=this._getFallbackRelatedOwnerModel(),n.hidden=n2.isEmpty(t.get("relatedOwnerObject")),t.getProperty("relatedOwnerObject").listen("change",function(e){return i._onOwnerObjectChange(e)},this),this._getRelatedOwnerSettingsModel().listen("change",function(e){return i._onRelatedOwnerSettingsChange(e)},this))}},{key:"_onOwnerObjectChange",value:function(e){this._components["related-owner-fallback-fields"].hidden=n2.isEmpty(e.currentTarget.json)}},{key:"_onRelatedOwnerSettingsChange",value:function(e){this.validate()}},{key:"_getRelatedOwnerModel",value:function(){var e=this._getRelatedOwnerSettingsModel(),t=new n2.dataProvider.Model({value:{}});return t.insert(this._model.get("objectName"),{key:"objectName"}),t.insert(e.getProperty("relatedOwnerObject1",{defaultValue:""}),{key:"relatedOwnerObject"}),t.insert(e.getProperty("relatedOwnerObjectType1",{defaultValue:""}),{key:"relatedOwnerObjectType"}),t.insert(e.getProperty("relatedOwnerField1",{defaultValue:""}),{key:"relatedOwnerField"}),t.insert(e.getProperty("relatedOwnerParentField1",{defaultValue:""}),{key:"relatedOwnerParentField"}),t.insert(e.getProperty("relatedOwnerRole1",{defaultValue:""}),{key:"relatedOwnerRole"}),t}},{key:"_getFallbackRelatedOwnerModel",value:function(){var e=this._getRelatedOwnerSettingsModel(),t=new n2.dataProvider.Model({value:{}});return t.insert(this._model.get("objectName"),{key:"objectName"}),t.insert(e.getProperty("relatedOwnerObject2",{defaultValue:""}),{key:"relatedOwnerObject"}),t.insert(e.getProperty("relatedOwnerObjectType2",{defaultValue:""}),{key:"relatedOwnerObjectType"}),t.insert(e.getProperty("relatedOwnerField2",{defaultValue:""}),{key:"relatedOwnerField"}),t.insert(e.getProperty("relatedOwnerParentField2",{defaultValue:""}),{key:"relatedOwnerParentField"}),t.insert(e.getProperty("relatedOwnerRole2",{defaultValue:""}),{key:"relatedOwnerRole"}),t}},{key:"_getRelatedOwnerSettingsModel",value:function(){return this._model.getProperty("relatedOwnerSettings",{defaultValue:{}})}},{key:"validate",value:function(){var e,t,n,i;return!!_get(_getPrototypeOf(s.prototype),"validate",this).apply(this,arguments)&&(e=(i=this._getRelatedOwnerSettingsModel()).get("relatedOwnerObject1")===i.get("relatedOwnerObject2"),t=i.get("relatedOwnerField1")===i.get("relatedOwnerField2"),n=i.get("relatedOwnerParentField1")===i.get("relatedOwnerParentField2"),i=i.get("relatedOwnerRole1")===i.get("relatedOwnerRole2"),e&&t&&n&&i?(this.markInvalid("The related owner configuration must use different relationships or fields."),!1):(this.clearInvalid(),!0))}}]),s}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RelatedOwnerFields=function(){_inherits(d,n2.de.component.form.FieldGroup);var e,n,t,i,s=_createSuper(d);function d(){return _classCallCheck(this,d),s.apply(this,arguments)}return _createClass(d,[{key:"_define",value:function(){_get(_getPrototypeOf(d.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-related-owner-fields",this._mixins=[n2.mixin.DataDriven],this._lazyLoad=!0,this._relatedObjectLabel="Assign using related object",this._relatedObjectHelpText="The related object you want a new record to be checked against.",this._usingFieldHelpText="The field used to determine the owner of the new record.",this._required=!0,this._objectOptionsData=null,this._objectFieldOptionsData=null,this._roleOptionsData=null,this._parentFieldOptionsData=null}},{key:"relatedObjectLabel",set:function(e){this._relatedObjectLabel!==e&&(this._relatedObjectLabel=e,this._refresh({objectSelectionFieldLabel:!0}))}},{key:"relatedObjectHelpText",set:function(e){this._relatedObjectHelpText!==e&&(this._relatedObjectHelpText=e)}},{key:"usingFieldHelpText",set:function(e){this._usingFieldHelpText!==e&&(this._usingFieldHelpText=e)}},{key:"required",set:function(e){this._required!==e&&(this._required=e)}},{key:"objectSelectionField",get:function(){return this._components["related-owner-object"]}},{key:"objectFieldSelectionField",get:function(){return this._components["related-owner-field"]}},{key:"roleSelectionField",get:function(){return this._components["related-owner-role-field"]}},{key:"parentFieldSelectionField",get:function(){return this._components["related-owner-parent-field"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(d.prototype),"_onDefined",this).apply(this,arguments),this._insertObjectSelectionField(),this._insertObjectFieldSelectionField(),this._insertRoleSelectionField(),this._insertParentFieldSelectionField()}},{key:"_insertObjectSelectionField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"related-owner-object",mixins:[n2.mixin.DataDriven],dataProviders:["get-related-owner-object-options"],label:this._relatedObjectLabel,cls:"n2_field-medium",helpText:this._relatedObjectHelpText,placeholder:"Select a relationship",required:this._required,options:[],value:{bindPath:".relatedOwnerObject"},listeners:{change:this._onObjectSelectionFieldChange,scope:this}}))}},{key:"_onObjectSelectionFieldChange",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._getOptionDataByOptionValue(this._objectOptionsData,t.value),n=n2.isNull(n)?"":n.type,this._model.set(n,{key:"relatedOwnerObjectType",silent:!0}),this._model.set("",{key:"relatedOwnerField",silent:!0}),this._model.set("",{key:"relatedOwnerRole",silent:!0}),this._model.set("",{key:"relatedOwnerParentField",silent:!0}),n2.isEmpty(n)){e.next=7;break}return this.objectFieldSelectionField.hidden=!1,this.objectFieldSelectionField.spinner(),e.next=5,this._loadObjectFieldOptionsData(n);case 5:n=e.sent,this._objectFieldOptionsData=n.response,this.objectFieldSelectionField.spinner(!1);case 7:this._refresh({objectFieldSelectionFieldLabel:!0,objectFieldSelectionField:!0,roleSelectionField:!0,parentFieldSelectionField:!0});case 8:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_insertObjectFieldSelectionField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"related-owner-field",mixins:[n2.mixin.DataDriven],label:"Using field",cls:"n2_field-medium",helpText:this._usingFieldHelpText,hidden:!0,options:[],required:!0,value:{bindPath:".relatedOwnerField"},listeners:{change:this._onObjectFieldSelectionFieldChange,scope:this}}))}},{key:"_onObjectFieldSelectionFieldChange",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._model.set("",{key:"relatedOwnerRole",silent:!0}),this._model.set("",{key:"relatedOwnerParentField",silent:!0}),"[TeamMember]"===t.value)return n=this._model.get("relatedOwnerObjectType"),this.roleSelectionField.hidden=!1,e.next=5,this._loadRoleOptionsData(n);e.next=9;break;case 5:n=e.sent,this._roleOptionsData=n.response,e.next=16;break;case 9:if(i=this._getOptionDataByOptionValue(this._objectFieldOptionsData,this._model.get("relatedOwnerField")).type,this.parentFieldSelectionField.hidden=!1,n2.isUndefined(i)){e.next=16;break}return this.parentFieldSelectionField.spinner(),e.next=14,this._loadParentFieldOptionsData(i);case 14:i=e.sent,this._parentFieldOptionsData=i.response,this.parentFieldSelectionField.spinner(!1);case 16:this._refresh({roleSelectionField:!0,parentFieldSelectionField:!0});case 17:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"_insertRoleSelectionField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"related-owner-role-field",mixins:[n2.mixin.DataDriven],dataProviders:["get-related-owner-role-options"],label:{text:"Select related owner role field",hidden:!0},cls:"n2_field-medium n2_align-bottom",required:!0,hidden:!0,options:[],value:{bindPath:".relatedOwnerRole"}}))}},{key:"_insertParentFieldSelectionField",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"related-owner-parent-field",mixins:[n2.mixin.DataDriven],label:{text:"Select related owner field",hidden:!0},cls:"n2_field-medium n2_align-bottom",required:!0,hidden:!0,options:[],value:{bindPath:".relatedOwnerParentField"}}))}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(d.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)&&this.load({force:!1});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o,r,l,c,u=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<u.length&&void 0!==u[0]?u[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(d.prototype),"_load",this).apply(this,u);case 3:return s=this._model.get("objectName"),s=[this._loadDataProvider("get-related-owner-object-options",{params:[s],force:n,silent:t,requestId:s})],i=this._model.get("relatedOwnerObjectType"),n2.isEmpty(this._model.get("relatedOwnerField"))||s.push(this._loadObjectFieldOptionsData(i,{force:n,silent:t})),n2.isEmpty(this._model.get("relatedOwnerRole"))||s.push(this._loadRoleOptionsData(i,{force:n,silent:t})),e.next=7,Promise.all(s);case 7:if(i=e.sent,s=_slicedToArray(i,3),a=s[0],o=s[1],r=s[2],n2.isEmpty(this._model.get("relatedOwnerParentField"))){e.next=17;break}return c=this._getOptionDataByOptionValue(o.response,this._model.get("relatedOwnerField")).type,e.next=16,this._loadParentFieldOptionsData(c,{force:n,silent:t});case 16:l=e.sent;case 17:return e.abrupt("return",{objectOptions:a,objectFieldOptions:o,roleOptions:r,parentFieldOptions:l});case 18:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_loadObjectFieldOptionsData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,t=t.force;return this._loadDataProvider("get-related-owner-relationship-field-options",{params:[e,!0],force:void 0!==t&&t,silent:void 0!==n&&n,requestId:"".concat(e,".true")})}},{key:"_loadRoleOptionsData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,t=t.force;return this._loadDataProvider("get-related-owner-role-options",{params:[e],force:void 0!==t&&t,silent:void 0!==n&&n,requestId:"".concat(e,".true")})}},{key:"_loadParentFieldOptionsData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.silent,t=t.force;return this._loadDataProvider("get-related-owner-relationship-field-options",{params:[e,!1],force:void 0!==t&&t,silent:void 0!==n&&n,requestId:"".concat(e,".false")})}},{key:"_onLoadComplete",value:function(e){var t=e.objectOptions,n=e.objectFieldOptions,n=void 0===n?null:n,i=e.roleOptions,i=void 0===i?null:i,e=e.parentFieldOptions,e=void 0===e?null:e;_get(_getPrototypeOf(d.prototype),"_onLoadComplete",this).apply(this,arguments),this._objectOptionsData=t.response,this._objectFieldOptionsData=n2.isNull(n)?[]:n.response,this._roleOptionsData=n2.isNull(i)?[]:i.response,this._parentFieldOptionsData=n2.isNull(e)?[]:e.response,this._refresh()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.objectSelectionFieldLabel,i=e.objectSelectionField,i=void 0!==i&&i,s=e.objectFieldSelectionFieldLabel,s=void 0!==s&&s,a=e.objectFieldSelectionField,a=void 0!==a&&a,o=e.roleSelectionField,o=void 0!==o&&o,e=e.parentFieldSelectionField,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshObjectSelectionFieldLabel(),(t||i)&&this._refreshObjectSelectionField(),(t||s)&&this._refreshObjectFieldSelectionFieldLabel(),(t||a)&&this._refreshObjectFieldSelectionField(),(t||o)&&this._refreshRoleSelectionField(),(t||e)&&this._refreshParentFieldSelectionField()}},{key:"_refreshObjectSelectionFieldLabel",value:function(){var e,t;this.objectSelectionField.rendered&&((e=this.objectSelectionField.dom.find("label")).clear(),t=this._relatedObjectLabel,this._required&&(t='<abbr title="Required" class="slds-required">*</abbr> '.concat(t)),e.insert(t))}},{key:"_refreshObjectSelectionField",value:function(){this.objectSelectionField.model=this._model,this.objectSelectionField.options=this._getOptionDataAsComboOptions(this._objectOptionsData)}},{key:"_refreshObjectFieldSelectionFieldLabel",value:function(){var e,t=this._model.get("relatedOwnerObject");this.objectFieldSelectionField.rendered&&!n2.isEmpty(t)&&(t=this._getOptionDataByOptionValue(this._objectOptionsData,t),(e=this.objectFieldSelectionField.dom.find("label")).clear(),e.insert('<abbr title="Required" class="slds-required">*</abbr> Using '.concat(t.type," field")))}},{key:"_refreshObjectFieldSelectionField",value:function(){this.objectFieldSelectionField.model=this._model,this.objectFieldSelectionField.options=this._getOptionDataAsComboOptions(this._objectFieldOptionsData),this.objectFieldSelectionField.hidden=n2.isEmpty(this._model.get("relatedOwnerObject"))}},{key:"_refreshRoleSelectionField",value:function(){this.roleSelectionField.model=this._model,this.roleSelectionField.options=this._getOptionDataAsComboOptions(this._roleOptionsData),this.roleSelectionField.hidden=n2.isEmpty(this._model.get("relatedOwnerField"))||"[TeamMember]"!==this._model.get("relatedOwnerField")}},{key:"_refreshParentFieldSelectionField",value:function(){this.parentFieldSelectionField.model=this._model,this.parentFieldSelectionField.options=this._getOptionDataAsComboOptions(this._parentFieldOptionsData);var e=this._model.get("relatedOwnerField");this.parentFieldSelectionField.hidden=n2.isEmpty(e)||"[TeamMember]"===e||!e.endsWith(".")}},{key:"_getOptionDataByOptionValue",value:function(e,t){return e.find(function(e){return e.value===t})||null}},{key:"_getOptionDataAsComboOptions",value:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}}]),d}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.RoundRobinFields=function(){_inherits(t,n2.de.component.form.FieldGroup);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertRoundRobinFields()}},{key:"_insertRoundRobinFields",value:function(){var e=this;this._insert(new n2.ui.component.field.TextBox({id:"round-robin-level",mixins:[n2.mixin.DataDriven],label:"Round robin scope",cls:"n2_field-large n2_no-field",value:{bindPath:".isTeamLevelRoundRobin",adapter:function(e){return e?"Team level round robin":"Distributor level round robin"}}})),this._insert(new n2.ui.component.Button({id:"round-robin-level-button",mixins:[n2.mixin.DataDriven],text:"Change in team settings",theme:n2.ui.component.button.Theme.LINK,hidden:{bindPath:".distributorType",adapter:function(e){return"trigger"===e.toLowerCase()},defaultValue:!1},listeners:{click:function(){return e._onChangeRoundRobinScopeClick()}}}))}},{key:"_onChangeRoundRobinScopeClick",value:function(){var e,t=this;n2.de.page.team.distributorSettings.Context.getInstance().isDirty?n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom.parent}).show({message:"You will lose all unsaved changes to your distributor, do you want to continue?",listeners:{submit:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t._navigateToTeamSettingsPage();case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}}):this._navigateToTeamSettingsPage()}},{key:"_navigateToTeamSettingsPage",value:function(){var e=n2.de.page.team.distributorSettings.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamSettings","teamId=".concat(e))}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.StickyAssignment=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=[n2.mixin.DataDriven],this._lazyLoad=!0,this._heading="Sticky Assignment",this._toggleActive=!0,this._encryptedFields=[],this._encryptedWarningTemplate='<div id="encrypted-warning-message" class="slds-m-top_xx-small">\n            '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.WARNING,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),"\n            This is an encrypted field. Please note that the value from this field will be stored unencrypted for sticky assignments.\n        </div>"),this._teamObjectFieldOptions=null}},{key:"teamObjectFieldOptions",set:function(e){this._teamObjectFieldOptions=e}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).call(this),this._encryptedFields=this._teamObjectFieldOptions.filter(function(e){return e.isEncrypted}).map(function(e){return e.value})}},{key:"_insertFields",value:function(){var s=this;this._insert(new n2.ui.component.field.Combo({id:"match-field",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_field-medium",helpText:"Select the field to be used to determine whether records are sticky with one another.",label:"Match field",required:!0,options:n2.de.data.Adapters.objectFieldOptions(this._teamObjectFieldOptions,{validTypes:[n2.de.data.FieldType.ENCRYPTEDSTRING,n2.de.data.FieldType.STRING,n2.de.data.FieldType.INTEGER,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.EMAIL,n2.de.data.FieldType.URL]}),value:{bindPath:".stickyMatchField"},validator:function(e){var t=e.model.get("stickyMatchLevel"),n="All distributors with global match level must have the same match field. Currently this match field is set to ".concat(e.model.get("globalMatchFieldLabel")),i=e.model.get("teamMatchFieldLabel"),i="Team"===t?"All distributors in this team with team match level must have the same match field. Currently this match field is set to ".concat(i):n;return s._validateMatchField(e.value,t)||i},listeners:{change:function(e){return s._onMatchFieldChange(e)},loaded:function(e){return s._onMatchFieldChange(e)}}})),this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.StickyPeriodField({id:"sticky-period",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"The time period over which sticky records will assign to the same team member.",label:"Sticky period",required:!0})),this._insert(new n2.ui.component.field.RadioButtonGroup({id:"match-level",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"Whether the sticky is scoped for within this distributor, across the team or across all teams.",label:"Match level",sort:!1,required:!0,options:["Distributor","Team","Global"],value:{bindPath:".stickyMatchLevel"},listeners:{change:function(e){return s._onMatchLevelChange(e)}}})),this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.AvailabilityAssignmentField({id:"retain-sticky",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"Determine whether to assign sticky matches when team members are unavailable or toggled offline.",label:"Retain sticky",disabled:{bindPath:".stickyMatchLevel",adapter:function(e){return"Global"===e}},sort:!1,options:[{label:"Retain sticky when user is unavailable",value:"retainUserUnavailable"},{label:"Retain sticky when user toggled off in widget",value:"retainUserToggleOff"}]})),this._insert(new n2.ui.component.field.Checkbox({id:"disable-round-robin",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium",helpText:"Only allow assignment to be determined by a sticky record.",label:"Disable Round Robin",value:{bindPath:".roundRobinDisabled"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("isSticky").value=e.value,this._hideStickySettingsFields()}},{key:"_validateMatchField",value:function(e,t){var n=this._model.get("stickySettings");return n2.isUndefined(n.teamMatchFieldName)||"Team"!==t?!(!n2.isUndefined(n.globalMatchFieldName)&&"Global"===t)||e===n.globalMatchFieldName:e===n.teamMatchFieldName}},{key:"_onMatchFieldChange",value:function(e){var t=!n2.isUndefined(e.value)&&-1!==this._encryptedFields.indexOf(e.value),n=e.components["encrypted-warning"];n2.isUndefined(n)&&t?e.insert(new n2.ui.component.HTML({id:"encrypted-warning",template:this._encryptedWarningTemplate,renderTo:{target:".slds-form-element__control",position:"afterend"}})):n2.isUndefined(n)||t||e.remove(n,{destroy:!0})}},{key:"_onMatchLevelChange",value:function(e){var e="Global"===e.value,t=this._components["retain-sticky"];(t.disabled=e)&&(t.components["option-0"].value=!0,t.components["option-1"].value=!0),this._components["match-field"].validate()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["toggle-active"].value={value:e.get("isSticky"),silent:!0},t=this._getStickyModel(),this._components["match-field"].model=t,this._components["match-field"].clearInvalid(),this._components["sticky-period"].model=t,this._components["match-level"].model=t,this._components["retain-sticky"].model=t,this._components["disable-round-robin"].model=t,n2.isEmpty(this._components["match-field"].value)||this._components["match-field"].validate(),this._hideStickySettingsFields())}},{key:"_getStickyModel",value:function(){var e=new n2.dataProvider.Model({value:{}}),t=this._model.getProperty("stickySettings");return e.insert(t.getProperty("stickyMatchField",{defaultValue:null}),{key:"stickyMatchField"}),e.insert(t.getProperty("stickyPeriod",{defaultValue:1}),{key:"stickyPeriod"}),e.insert(t.getProperty("stickyPeriodUnit",{defaultValue:"Minutes"}),{key:"stickyPeriodUnit"}),e.insert(t.getProperty("stickyMatchLevel",{defaultValue:"Distributor"}),{key:"stickyMatchLevel"}),e.insert(t.getProperty("roundRobinDisabled",{defaultValue:!1}),{key:"roundRobinDisabled"}),e.insert(t.getProperty("teamMatchFieldName"),{key:"teamMatchFieldName"}),e.insert(t.getProperty("teamMatchFieldLabel"),{key:"teamMatchFieldLabel"}),e.insert(t.getProperty("globalMatchFieldName"),{key:"globalMatchFieldName"}),e.insert(t.getProperty("globalMatchFieldLabel"),{key:"globalMatchFieldLabel"}),e.insert(t.getProperty("retainStickyOnOutOfOffice",{defaultValue:!1}),{key:"assignOnOutOfOffice"}),e.insert(t.getProperty("retainStickyOnWidgetOff",{defaultValue:!1}),{key:"assignOnWidgetOff"}),e.insert(this._model.getProperty("userTogglesEnabled"),{key:"userTogglesEnabled"}),e}},{key:"_hideStickySettingsFields",value:function(){var t=this,n=n2.de.enum.distributor.Method;this._forEachField(function(e){"disable-round-robin"!==e.id?"toggle-active"!==e.id&&(e.hidden=!t._model.get("isSticky")):e.hidden=!t._model.get("isSticky")||t._model.get("method")!==n.ROUND_ROBIN})}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.StickyPeriodField=function(){_inherits(n,n2.ui.component.Field);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertValueField(),this._insertUnitField()}},{key:"_insertValueField",value:function(){var e=this;this._insert(new n2.ui.component.field.Number({id:"sticky-period-value",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.fieldContainer,cls:"n2_sticky-period-value",label:{text:"Sticky Period Value",hidden:!0},value:{bindPath:".stickyPeriod"},listeners:{blur:function(){return e._onBlur()},change:function(){return e._onChange()}}}))}},{key:"_insertUnitField",value:function(){var e=this;this._insert(new n2.ui.component.field.RadioButtonGroup({id:"sticky-period-unit",mixins:[n2.mixin.DataDriven],renderTo:this.SELECTORS.fieldContainer,cls:"n2_sticky-period-unit",label:{text:"Sticky Period Unit",hidden:!0},sort:!1,options:["Minutes","Hours","Days"],value:{bindPath:".stickyPeriodUnit"},listeners:{blur:function(){return e._onBlur()},change:function(){return e._onChange()}}}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-sticky-period-field"),this._components["sticky-period-value"].element("field").attribute("min",1)}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["sticky-period-value"].model=e,this._components["sticky-period-unit"].model=e,this.clearInvalid())}},{key:"clear",value:function(){this._components["sticky-period-value"].clear(),this._components["sticky-period-unit"].clear()}},{key:"reset",value:function(){this._components["sticky-period-value"].reset(),this._components["sticky-period-unit"].reset()}},{key:"_enableChildren",value:function(){this._components["sticky-period-value"].disabled=!1,this._components["sticky-period-unit"].disabled=!1}},{key:"_disableChildren",value:function(){this._components["sticky-period-value"].disabled=!0,this._components["sticky-period-unit"].disabled=!0}},{key:"_validateRequired",value:function(){return""!==this._components["sticky-period-value"].value&&!n2.isEmpty(this._components["sticky-period-unit"].value)}},{key:"_validateCustom",value:function(){var e=this._components["sticky-period-value"].value;return n2.isNull(e)?"Sticky period is mandatory":999<e?"Sticky period must be less than 999":0!==e||"Sticky period must be greater than zero."}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignPillList=function(){_inherits(t,n2.ui.component.field.PillList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_addEditablePillList",value:function(){var n=this;this.insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.campaignPillList.NonEditablePillList({id:"editable-pills",cls:"slds-pill_container slds-is-relative",renderTo:{target:".slds-form-element__control",position:"afterbegin"},delimiter:this.delimiter,pills:this._value,minHeight:this.minHeight,min:0,max:this._max,maxPillLength:this._maxPillLength,disabled:this._disabled,listeners:{duplicateFilterStart:function(){n._setDuplicateMessage("")},duplicatesFound:function(e,t){n._setDuplicateMessage('The following items were not added as they already exist: "'+t.join('", "')+'"')},remove:function(e,t){n._setDuplicateMessage(""),n.validate(),n.setEmptyMessage(),n._onChange(),n.fire("pillRemove",n,t)},add:function(e,t){n.validate(),n._onChange(),n.fire("pillAdd",n,t)}}}))}},{key:"setEmptyMessage",value:function(){n2.isEmpty(this.value)?this.setMessage("No Campaign selected"):this.setMessage("")}},{key:"_getValue",value:function(){var t=[];return this.editablePillList.forEachPill(function(e){t.push({text:e.text,value:e.value})}),t}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelection=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._heading="Campaign-based filter",this._toggleActive=!0,this._helpText="If defined, only records matching the selected campaigns will be distributed.",this._componentCls="n2-de-campaign-selection"}},{key:"campaignSelection",get:function(){return this._components["campaign-selection"]}},{key:"addCampaigns",get:function(){return this._components["add-campaigns"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertCampaignSelection(),this._insertAddCampaigns()}},{key:"_insertCampaignSelection",value:function(){return this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignPillList({id:"campaign-selection",mixins:[n2.mixin.DataDriven],hidden:!0,required:!0,label:{text:"Campaign selection",hidden:!0},cls:"n2_field-large slds-m-bottom_xxx-small n2_campaign-selection",value:{bindPath:".campaigns"}}))}},{key:"_insertAddCampaigns",value:function(){return this.insert(new n2.ui.component.Button({id:"add-campaigns",theme:n2.ui.component.button.Theme.LINK,text:"Add Campaigns",cls:"n2_add-campaigns",listeners:{click:this._openCampaignSelectionModal,scope:this}}))}},{key:"_openCampaignSelectionModal",value:function(){n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelectionModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root}).show({currentSelection:this._model.get("campaigns"),listeners:{submit:this._setCampaignSelection,scope:this}})}},{key:"_setCampaignSelection",value:function(e){var t=_toConsumableArray(this.campaignSelection.value);this.campaignSelection.value=[].concat(_toConsumableArray(t),_toConsumableArray(e.data)),this.campaignSelection.setEmptyMessage()}},{key:"_onToggleActiveChange",value:function(e){e=e.value;this.campaignSelection.setEmptyMessage(),this._model.getProperty("hasCampaignFilter").value=e,this._refreshCampaignSelection()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._setToggleState(),this._refreshCampaignSelection())}},{key:"_setToggleState",value:function(){var e=this._model.get("hasCampaignFilter");this._components["toggle-active"].value={value:e,silent:!0}}},{key:"_refreshCampaignSelection",value:function(){this.campaignSelection.model=this._model;var e=this._model.get("hasCampaignFilter");this.campaignSelection.hidden=!e,this.addCampaigns.hidden=!e}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelectionDataTable=function(){_inherits(t,n2.de.component.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_applySelection",value:function(){var n=this;n2.isEmpty(this._cachedRowSelection)||this.forEachRow(function(t){var e=n._cachedRowSelection.find(function(e){return e.id===t.data.id});t.select(!n2.isUndefined(e),{silent:!0})})}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelectionModal=function(){_inherits(n,n2.de.component.Modal);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{message:".n2_message_container"}),this.id="campaign-selection-modal",this.dataProviders=["get-campaign-options"],this.header="Select Campaigns",this._bodyTemplate='<div class="slds-modal__container">\n            <div class="slds-modal__header{{#theme}} slds-theme_{{theme}} slds-theme_alert-texture{{/theme}}{{^header}} slds-modal__header_empty{{/header}}">\n                {{> headerTemplate}}\n            </div>\n            <div class="slds-modal__content slds-p-around_medium slds-is-relative" id="{{id}}_content">\n                <div class="n2_message_container slds-grid slds-m-bottom_small slds-hide">\n                    '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n                    <div class="slds-col">\n                        <p>Displaying 500 campaigns, use the filters to find others.</p>\n                    </div>\n                </div>\n                <div class="n2_toolbar_container"></div>\n                <div class="n2_campaigns_container"></div>\n            </div>\n            <div id="{{id}}_footer" class="slds-modal__footer slds-is-relative"></div>\n        </div>'),this._componentCls="n2-campaign-selection-modal",this._currentSelection=[]}},{key:"toolbar",get:function(){return this._components.toolbar}},{key:"activeFilter",get:function(){return this.toolbar.components["active-filter"]}},{key:"nameFilter",get:function(){return this.toolbar._components["name-filter"]}},{key:"campaigns",get:function(){return this._components.campaigns}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"data",get:function(){return this.campaigns.selection.map(function(e){return{value:e.value,text:e.label}})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertToolbar(),this._insertCampaigns()}},{key:"_insertToolbar",value:function(){return this._insert(new n2.ui.component.HTML({id:"toolbar",renderTo:".n2_toolbar_container",template:'<div id="{{id}}" class="n2_toolbar">\n                <div class="n2_left"></div>\n                <div class="n2_right"></div>\n            </div>',components:[this._getActiveFilter(),this._getNameFilter()]}))}},{key:"_getActiveFilter",value:function(){return new n2.ui.component.field.Combo({id:"active-filter",label:{text:"filter active campaigns",hidden:!0},renderTo:".n2_left",cls:"n2_active-filter",placeholder:"All Campaigns",options:[{label:"Active Campaigns",value:!0}],listeners:{change:this._loadCampaignOptions,scope:this}})}},{key:"_getNameFilter",value:function(){return new n2.ui.component.field.TextBox({id:"name-filter",renderTo:".n2_right",cls:"n2_name-filter",label:{text:"Campaign name filter",hidden:!0},placeholder:"Find Campaigns...",icon:n2.ui.enum.Icon.SEARCH,allowClear:!0,listeners:{type:this._loadCampaignOptions,change:this._loadCampaignOptions,scope:this}})}},{key:"_insertCampaigns",value:function(){this._insert(new n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CampaignSelectionDataTable({id:"campaigns",renderTo:".n2_campaigns_container",columns:[{header:"Campaigns",bindPath:"label",sortable:!0}],selectable:!0,sortBy:{column:0,direction:"asc"},cls:"slds-is-relative",listeners:{selectionChange:this._onCampaignSelectionChange,scope:this}}))}},{key:"_onCampaignSelectionChange",value:function(e){var t=this.campaigns.selection.length;this.submitButton.text=t?"Add Campaigns (".concat(t,")"):"Add Campaigns",this._updateSubmitButtonState()}},{key:"_getOKButtonConfig",value:function(){return{text:"Add Campaigns",disabled:!0}}},{key:"show",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).currentSelection,e=void 0===e?[]:e;_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._currentSelection=e,this._updateSubmitButtonState(),this._loadCampaignOptions()}},{key:"_loadCampaignOptions",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,t=void 0!==t&&t,e=e.silent,e=void 0!==e&&e,n=this.nameFilter.value,i=!0===this.activeFilter.value,n=""===n?null:n,s="".concat(i,"-").concat(n);return this._loadDataProvider("get-campaign-options",{params:[i,n],requestId:s,force:t,silent:e})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),"get-campaign-options"===t.id&&(this.campaigns.data=this._getTableData(e),this._showMessage(499<e.length))}},{key:"_getTableData",value:function(e){var n=this;return e.filter(function(t){return n._currentSelection.findIndex(function(e){return e.value===t.value})<0}).map(function(e){return{value:e.value,label:e.label,id:e.value}})}},{key:"_onSubmit",value:function(){_get(_getPrototypeOf(n.prototype),"_onSubmit",this).call(this),this.hide(),this._reset()}},{key:"_reset",value:function(){_get(_getPrototypeOf(n.prototype),"_reset",this).call(this),this.activeFilter.clear(),this.nameFilter.clear(),this._clearCampaignsSelection(),this._showMessage(!1)}},{key:"_showMessage",value:function(e){e?this.element("message").show():this.element("message").hide()}},{key:"_updateSubmitButtonState",value:function(){n2.isEmpty(this.campaigns.selection)?this.submitButton.disable():this.submitButton.enable()}},{key:"_clearCampaignsSelection",value:function(){this.campaigns.forEachRow(function(e){e.selected=!1},{includeHeaderRow:!0}),this._tempSelectedIds=[]}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.CustomSortOrders=function(){_inherits(t,n2.de.component.field.DataTable);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._newRowData={type:n2.dataProvider.Model,value:{fieldName:null,direction:"Asc"}},this._fieldOptions=null,this._min=1,this._max=3,this.required=!0}},{key:"fieldOptions",set:function(e){n2.compare(e,this._fieldOptions||[])||(this._fieldOptions=e)}},{key:"_onDefined",value:function(){this._columns=[{header:"Sort field",bindPath:".fieldName",editField:{type:n2.ui.component.field.Combo,required:!0,options:this._fieldOptions}},{header:"Sort direction",bindPath:".direction",editField:{type:n2.de.component.field.RadioButtonGroup,options:[{label:"Ascending",value:"Asc"},{label:"Descending",value:"Desc"}]}}],_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments)}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-custom-sort-orders"),this._components["data-table"].dom.addClass("slds-no-row-hover")}},{key:"_validateCustom",value:function(){var t,n,e=this._model.get("sortOrders");return!!n2.isEmpty(e)||(t=!1,n=null,e.forEach(function(e){if(n===e.fieldName)return!(t=!0);n=e.fieldName}),!t)||"Sort order fields cannot be selected more than once."}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.TagFilter=function(){_inherits(a,n2.ui.component.field.DataTable);var n,e=_createSuper(a);function a(){return _classCallCheck(this,a),e.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).apply(this,arguments),this._componentCls="n2-de-tag-filters",this._columns=[{header:"Filter type",bindPath:"type",editField:{type:n2.de.component.field.RadioButtonGroup,sort:!1,options:[]}},{header:"Tag Collection",bindPath:"categoryId",editField:{type:n2.ui.component.field.Combo,placeholder:"Select tag collection",options:[],required:!0}},{header:"Operator",bindPath:"operator",editField:{type:n2.ui.component.field.Combo,options:[],required:!0}},{header:"User Tag",cell:{type:n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.ValueCell}}],this._mixins=[n2.mixin.DataDriven],this._max=5,this._dataTableClass=n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.DataTable,this._newRowData={type:n2.dataProvider.Model,value:{categoryId:"",type:"Static",operator:""}}}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=this,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(a.prototype),"_onLoaded",this).apply(this,s),n2.isNull(n)&&(t.getProperty("tagFilters").listen("change",function(e){return i._onChange({sync:!1})},this),this._setFieldValue(t.get("tagFilters")));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_getDataTableDataBindPath",value:function(){return"."}}]),a}(),n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.TeamMemberExclusionFieldGroup=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this._heading="Exclude Team Members",this._toggleActive=!0}},{key:"_insertFields",value:function(){this._insertTeamMemberExclusionFieldCombo()}},{key:"_insertTeamMemberExclusionFieldCombo",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"exclusion-field-selection",mixins:[n2.mixin.DataDriven],dataProviders:["get-team-member-user-exclusion-field-options"],cls:"n2_field-medium",label:"Exclusion field",required:!0,options:{bindPath:"get-team-member-user-exclusion-field-options",adapter:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}},value:{bindPath:".userExclusionField"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("isExcludingTeamMemberUsersByField").value=e.value,this._components["exclusion-field-selection"].hidden=!e.value}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["toggle-active"].value={value:e.get("isExcludingTeamMemberUsersByField"),silent:!0},this._loadTeamMemberUserExclusionFieldOptions(),this._components["exclusion-field-selection"].model=e,this._components["exclusion-field-selection"].hidden=!e.get("isExcludingTeamMemberUsersByField"))}},{key:"_loadTeamMemberUserExclusionFieldOptions",value:function(){this._fetchDataProvider("get-team-member-user-exclusion-field-options",{params:[this._model.get("objectName")]})}},{key:"_hideTeamMemberExclusionFieldSelection",value:function(){this._components["exclusion-field-selection"].hidden=!this._model.get("isExcludingTeamMemberUsersByField")}}]),n}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.Context=function(){_inherits(t,n2.Object);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.Singleton],this.selectedTagData=null}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.ModifyAssignments=function(){_inherits(s,n2.de.component.tags.AbstractModifyTagAssignments);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"context",get:function(){return n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.Context.getInstance()}},{key:"ToolbarClass",get:function(){return n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.Toolbar}},{key:"saveDataProviderId",get:function(){return null}},{key:"show",value:function(e){e.userIds;var t=e.updateValuesOnShow,t=void 0===t||t;e.model;_get(_getPrototypeOf(s.prototype),"show",this).apply(this,arguments),t&&this.load()}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0===n||n,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i),e.next=4,this._loadDataProvider("get-collection-tag-assignments",{params:[this._userIds],silent:t,force:n});case 4:return e.t0=e.sent,e.abrupt("return",{collectionTagAssignments:e.t0});case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.collectionTagAssignments;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this._collectionTagAssignments=e.response,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,arguments),"get-collection-tag-assignments"===t.id&&(this._collectionTagAssignments=e,this._refresh())}},{key:"reset",value:function(){this.assignmentsToolbar.clear(),this.assignmentsForm.forEach({type:n2.de.component.tags.modifyTagAssignments.FieldGroup,fcn:function(e){e.forEach({type:n2.de.component.tags.modifyTagAssignments.Checkbox,fcn:function(e){e.value={value:!1,silent:!0}}})}})}}]),s}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.TagCollectionFilterCombo=function(){_inherits(s,n2.ui.component.field.Combo);var e,t=_createSuper(s);function s(){return _classCallCheck(this,s),t.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-collection-tag-assignments"],this._componentCls="n2-tag-collection-filter",this.label={text:"Tag collection filter",hidden:!0},this._placeholder="All collections"}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<i.length&&void 0!==i[0]?i[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(s.prototype),"_load",this).apply(this,i);case 3:return e.next=5,this._loadDataProvider("get-collection-tag-assignments",{params:[[]],silent:n,force:t});case 5:return e.t0=e.sent,e.abrupt("return",{tagCollections:e.t0});case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){e=e.tagCollections;_get(_getPrototypeOf(s.prototype),"_onLoadComplete",this).apply(this,arguments),this.options=e.response.map(function(e){return{value:e.id,label:e.name}}),this.disabled||this._enable()}}]),s}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTags.Toolbar=function(){_inherits(t,n2.de.component.tags.modifyTagAssignments.AbstractToolbar);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"TagCollectionFilterClass",get:function(){return n2.de.page.team.teamMemberList.addStandardMemberWizard.TagCollectionFilterCombo}}]),t}(),n2.de.page.team.teamMemberList.addStandardMemberWizard.assignTeamMemberHours.ShiftCombo=function(){_inherits(r,n2.ui.component.field.Combo);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-shift-names","get-team-hours"],this._componentCls="n2-de-shift-selector-combo",this.label={text:"Change shift",hidden:!0},this._sort=!1,this._shiftOptions=null,this._teamHours=null,this.individualShiftId=null,this._REFRESH=n2.merge(this._REFRESH,{DEFAULT:["shiftOptions"],shiftOptions:["shiftOptions"],teamHours:["shiftPlaceholder"],individualShiftId:["individualShiftId"]})}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return i=n2.de.page.team.Context.getInstance().teamId,e.next=6,Promise.all([this._loadDataProvider("get-shift-names",{silent:n,force:t}),this._loadDataProvider("get-team-hours",{params:[i],silent:n,force:t,requestId:i})]);case 6:return i=e.sent,a=_slicedToArray(i,2),s=a[0],a=a[1],e.abrupt("return",{shiftOptions:s,teamHours:a});case 11:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.shiftOptions,e=e.teamHours;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this.disabled||this._enable(),this._setProperties({shiftOptions:t.response,teamHours:e.response})}},{key:"_refreshShiftOptions",value:function(){this.options=this._shiftOptions}},{key:"_refreshShiftPlaceholder",value:function(){var t=this._teamHours.shiftHoursId,e=this._shiftOptions.find(function(e){return e.value===t});this.placeholder=n2.isUndefined(e)?"Team hours":"Team hours (".concat(e.label,")")}},{key:"_refreshIndividualShiftId",value:function(){n2.isNull(this.individualShiftId)?this.options=this._options.filter(function(e){return"Individual hours"!==e.label}):this.options=[{label:"Individual hours",value:this.individualShiftId}].concat(_toConsumableArray(this._options))}}]),r}(),n2.de.page.team.teamPerformance.teamPerformanceRecordList.dataTable.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="",this._contentTemplate='<p>The Performance page lets you view your team members\' performance so that you can assign appropriate tags. This page will display conversion rate for Lead teams, close rate for Case or Opportunity Teams or <span class="n2_link-container"></span> for any team that has this feature enabled.</p>',this._hasPerformanceMetrics=null,this._hasTeamMembers=null}},{key:"hasPerformanceMetrics",set:function(e){this._hasPerformanceMetrics!==e&&(this._hasPerformanceMetrics=e,this._refresh())}},{key:"hasTeamMembers",set:function(e){this._hasTeamMembers!==e&&(this._hasTeamMembers=e,this._refresh())}},{key:"_refresh",value:function(){n2.isUndefined(this._components["action-tracking-link"])||this._components["action-tracking-link"].destroy(),n2.isUndefined(this._components["action-tracking-text"])||this._components["action-tracking-text"].destroy(),n2.isUndefined(this._components["add-team-member"])||this._components["add-team-member"].destroy(),this._insertEmptyState()}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertEmptyState()}},{key:"_insertEmptyState",value:function(){n2.de.page.team.teamPerformance.Context.getInstance().isQ2QTeam?this._insertQ2QEmptyState():this._hasTeamMembers?this._insertMetricsEmptyState():this._insertTeamMembersEmptyState()}},{key:"_insertTeamMembersEmptyState",value:function(){this._heading="Your team doesn't have any team members yet",this._contentTemplate='<p>Team members are the users who receive assignments from this team. <span class="n2_link-container"></span> to get started.</p>',this._insertAddTeamMemberButton()}},{key:"_insertMetricsEmptyState",value:function(){this._heading="No performance data available",this._contentTemplate='<p>The Performance page lets you view your team members\' performance so that you can assign appropriate tags. This page will display conversion rate for Lead teams, close rate for Case or Opportunity Teams or <span class="n2_link-container"></span> for any team that has this feature enabled.</p>',this._insertActionTrackingLinkOrText()}},{key:"_insertQ2QEmptyState",value:function(){this._heading="Team Performance",this._contentTemplate="<p>Team Performance is unavailable for Q2Q teams. The Performance page lets you view your team members' performance so that you can assign appropriate tags. This page will display conversion rate for Lead teams, close rate for Case or Opportunity Teams or Time to Action for any team that has this feature enabled.</p>"}},{key:"_insertAddTeamMemberButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-team-member",renderTo:this.SELECTORS.linkContainer,text:"Add team members",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTeamMemberClick(e)}}}))}},{key:"_insertActionTrackingLinkOrText",value:function(){return n2.de.ApplicationContext.getInstance().isTeamManager?this._insert(new n2.ui.component.HTML({id:"action-tracking-text",renderTo:this.SELECTORS.linkContainer,template:'<span id="{{id}}">{{model}}</span>',mixins:[n2.mixin.DataDriven],model:"Time to Action"})):this._insert(new n2.ui.component.Button({id:"action-tracking-link",renderTo:this.SELECTORS.linkContainer,text:"Time to Action",theme:n2.ui.component.button.Theme.LINK,listeners:{click:this._onTimeToActionClick,scope:this}}))}},{key:"_onAddTeamMemberClick",value:function(e){var t=n2.de.page.team.teamPerformance.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t))}},{key:"_onTimeToActionClick",value:function(e){var t=n2.de.page.team.teamPerformance.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TrackingAndSlas","teamId=".concat(t))}}]),t}(),n2.de.page.team.teamPerformance.teamPerformanceRecordList.dataTable.Row=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._template='<tr id="{{id}}" class="n2-data-table-row{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}{{#inactiveCls}} {{inactiveCls}}{{/inactiveCls}}"{{#title}} title="{{title}}"{{/title}}></tr>'}},{key:"_getTemplateData",value:function(){var e="";return n2.isNull(this._data)||this._data.isActive||(e=" n2-user-inactive"),n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{inactiveCls:e})}}]),t}(),n2.de.page.team.trackingAndSlas.distributorSettings.distributorSettingsForm.SlasFieldGroup=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._heading="SLAs",this._toggleActive=!0,this._helpText={text:"Whether the SLAs defined at Team level are tracked for this team.",position:n2.ui.enum.Position.BELOW}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertAutoReassignFieldGroup()}},{key:"_insertAutoReassignFieldGroup",value:function(){return this._insert(new n2.de.page.team.trackingAndSlas.distributorSettings.distributorSettingsForm.slasFieldGroup.AutoReassignFieldGroup({id:"auto-reassign",cls:"n2_small-heading n2_flush-left slds-m-vertical_medium",mixins:[n2.mixin.DataDriven]}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("slasEnabled").value=e.isChecked(),this._refreshFieldVisibility()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["auto-reassign"].model=e,this._components["toggle-active"].value={silent:!0,value:e.get("slasEnabled")},this._refreshFieldVisibility())}},{key:"_refreshFieldVisibility",value:function(){var t=this;this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t._model.get("slasEnabled"))})}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.AutoAction=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Auto action"}},{key:"_insertFields",value:function(){this._insertAutoActionOnEvent(),this._insertAutoActionOnTask(),this._insertActionToSet()}},{key:"_insertAutoActionOnEvent",value:function(){var t=this;return this._insert(new n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.autoAction.AutoActionOnEvent({id:"auto-action-on-event",cls:"n2_small-heading n2_flush-left",listeners:{change:function(e){"toggle-active"===e.target.id&&t._refreshFieldVisibility()}}}))}},{key:"_insertAutoActionOnTask",value:function(){var t=this;return this._insert(new n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.autoAction.AutoActionOnTask({id:"auto-action-on-task",cls:"n2_small-heading n2_flush-left",listeners:{change:function(e){"toggle-active"===e.target.id&&t._refreshFieldVisibility()}}}))}},{key:"_insertActionToSet",value:function(){var t=this;return this._insert(new n2.ui.component.field.Combo({id:"action-to-set",label:"Action to set",mixins:[n2.mixin.DataDriven],dataProviders:["get-picklist-field-select-options"],cls:"n2_field-medium slds-m-bottom_medium",options:{bindPath:"get-picklist-field-select-options:action-to-set",adapter:function(e){return e.filter(function(e){return t._model.get("trackedActions").includes(e.value)})}},required:!0,value:{bindPath:".autoActionValue"},listeners:{loaded:function(e){t._model.get("autoActionValue")&&e.clearInvalid()}}}))}},{key:"_refreshFieldVisibility",value:function(){this._components["action-to-set"].hidden=!this._model.get("autoActionOnEvents")&&!this._model.get("autoActionOnTasks")}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["auto-action-on-event"].model=e,this._components["auto-action-on-task"].model=e,this._components["action-to-set"].model=e,this._refreshFieldVisibility(),this._model.get("actionTrackingField"))&&this._loadActionsToTrackOptions()}},{key:"_loadActionsToTrackOptions",value:function(){n2.DataProviderManager.getInstance().get("get-picklist-field-select-options").get({params:[this._model.get("objectName"),this._model.get("actionTrackingField")],requestId:"action-to-set",force:!0})}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.LogicFilter=function(){_inherits(n,n2.ui.component.field.LogicFilter);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._dataTableClass=n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.Filters,this._logicHidden=!0,this._addRowButtonConfig={text:"Add SLA"},this._errorTemplate='{{#hasValidation}}<div class="slds-form-element__help n2__field-error n2-de-logic-filter-error{{#hideCls}} {{hideCls}}{{/hideCls}}" id="{{id}}_error"></div>{{/hasValidation}}',this._slaOrderIsvalid=null,this._currentDate=new Date}},{key:"dataTable",get:function(){return this._components["data-table"]}},{key:"_resolveValueDataBinding",value:function(){_get(_getPrototypeOf(n.prototype),"_resolveValueDataBinding",this).apply(this,arguments),this.clearInvalid()}},{key:"_bindDataTableEvents",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"_bindDataTableEvents",this).call(this),this._components["data-table"].listen("blur",function(e){e.relatedTarget.components["td-0"].editField.validate(),t.validate()},this)}},{key:"_hasValueChanged",value:function(e){return!n2.compare(this.value,n2.merge({logic:this.value.logic,logicEnabled:this.value.logicEnabled,slaType:this._model.get("slaType")},e))}},{key:"_getValue",value:function(){return n2.merge({slaType:this._model.get("slaType")},_get(_getPrototypeOf(n.prototype),"_getValue",this).call(this))}},{key:"validate",value:function(){return!n2.isNull(this.value.filters)&&this.value.filters.length<=1||(this._validateSlaOrder(),this._slaOrderIsvalid)?_get(_getPrototypeOf(n.prototype),"validate",this).apply(this,arguments):(this.markInvalid("Each SLA must have a longer SLA check time than previous SLAs"),!1)}},{key:"_showError",value:function(e){var t;this._rendered&&((t=this.element("error")).text(e),t.show())}},{key:"_validateSlaOrder",value:function(){var a=this,o=[],r=null;this.value.filters.forEach(function(e,t){var n=n2.de.page.team.trackingAndSlas.teamSettings.slas.Util.convertPeriodUnitToDate(a._currentDate,e.slaPeriod,e.slaUnit);if(0!==t)for(var i=0,s=o;i<s.length;i++)if(n<s[i]){r=t;break}o.push(n)}),n2.isNull(r)||(this.dataTable.element("filtersMessage").hide(),this._markInvalidSlas(r)),this._slaOrderIsvalid=!r}},{key:"_markInvalidSlas",value:function(t){this.dataTable.forEachRow(function(e){Number(e.id.slice(3))<=t&&e.components["td-0"].editField.markInvalid("")})}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.Util={convertPeriodUnitToDate:function(e,t,n){var i=new Date(e);switch(n.toLowerCase()){case"year":case"years":return i.setFullYear(i.getFullYear()+t);case"month":case"months":return i.setDate(i.getDate()+31*t);case"week":case"weeks":return i.setDate(i.getDate()+7*t);case"day":case"days":return i.setDate(i.getDate()+t);case"hour":case"hours":return i.setHours(i.getHours()+t);case"minute":case"minutes":return i.setMinutes(i.getMinutes()+t);default:return i}}},n2.de.page.team.weightingAndCaps.CriteriaCapModal=function(){_inherits(a,n2.de.component.Modal);var e,t=_createSuper(a);function a(){return _classCallCheck(this,a),t.apply(this,arguments)}return _createClass(a,[{key:"_define",value:function(){_get(_getPrototypeOf(a.prototype),"_define",this).call(this,arguments),this._EVENTS=n2.merge(this._EVENTS,[n2.event.EventType.CHANGE]),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this.id="criteria-caps-modal",this._cls="n2-de-criteria-cap-modal"}},{key:"criteriaCapsForm",get:function(){return this._components["criteria-caps-form"]}},{key:"criteriaTypeField",get:function(){return this.criteriaCapsForm.components["criteria-type"]}},{key:"customFilterField",get:function(){return this.criteriaCapsForm.components["field-filter"]}},{key:"submitButton",get:function(){return this._components["submit-button"]}},{key:"cancelButton",get:function(){return this._components["cancel-button"]}},{key:"data",get:function(){return this._isUseDistributorFilters()?{useDistributorFilters:!0}:{useDistributorFilters:!1,customFilter:this.customFilterField.model.get("logicAndFilters")}}},{key:"_isUseDistributorFilters",value:function(){return"Distributor Filters"===this.criteriaTypeField.value}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(a.prototype),"_onDefined",this).call(this,arguments),this._insertComponents()}},{key:"_insertComponents",value:function(){var e=this;this.insert(new n2.de.component.Form({id:"criteria-caps-form",cls:"slds-grid slds-wrap slds-grid_align-spread slds-p-bottom_small",includeFooter:!1,components:[{type:n2.de.component.field.RadioButtonGroup,id:"criteria-type",cls:"slds-m-bottom_medium",label:"Criteria type",options:["Distributor Filters","Field"],listeners:{change:function(){return e._onTypeChange()}}},{type:n2.de.component.form.FieldFilter,id:"field-filter",heading:"Criteria filter",helpText:"Only objects that match the filter criteria will count towards the criteria cap.",mixins:[n2.mixin.DataDriven],cls:"slds-m-bottom_medium n2_small-heading",maxRows:1,minRows:1,includeParents:!0,hidden:!0,toggleActive:!1}]}))}},{key:"_refreshCustomFilter",value:function(){this.customFilterField.hidden=this._isUseDistributorFilters()}},{key:"_onTypeChange",value:function(){this.fire("change"),this._refreshCustomFilter()}},{key:"_onSubmit",value:function(){this.criteriaCapsForm.validate()&&(_get(_getPrototypeOf(a.prototype),"_onSubmit",this).call(this),this.hide())}},{key:"show",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(t=0<s.length&&void 0!==s[0]?s[0]:{}).header,n=void 0===n?"Edit Criteria Cap":n,i=t.criteriaCapsConfig,t=t.teamObjectName,_get(_getPrototypeOf(a.prototype),"show",this).apply(this,s),this.header=n,this.criteriaCapsForm.clear(),this.criteriaTypeField.value={value:i.useDistributorFilters?"Distributor Filters":"Field",silent:!0},n=i.useDistributorFilters?{logic:null,logicEnabled:!1,filters:[{}]}:i.customFilter,(i=new n2.dataProvider.Model({value:{}})).insert(t,{key:"objectName"}),i.insert(!0,{key:"hasFieldFilters"}),i.insert(n,{key:"logicAndFilters"}),i.insert(!1,{key:"isAdvancedFilter"}),i.insert(!1,{key:"advancedFiltersEnabled"}),i.insert(!0,{key:"hideLogic"}),i.insert("",{key:"advancedSoql"}),this.customFilterField.model=i,this._refreshCustomFilter(),this.submitButton.reset(),this.cancelButton.enable();case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onSaving",value:function(e){this.submitButton.spinner(),this.cancelButton.disable()}},{key:"_onSaved",value:function(){var e=this;this.submitButton.spinner(!1),this.submitButton.success(),new n2.util.DelayedTask(function(){e.hide()},500).start()}}]),a}(),n2.de.page.team.weightingAndCaps.distributorSettings.weightingAndCapsForm.DistributorCaps=function(){_inherits(i,n2.de.component.form.FieldGroup);var t,n,e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"_define",value:function(){_get(_getPrototypeOf(i.prototype),"_define",this).apply(this,arguments),this._heading="Distributor caps",this._toggleActive=!0}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(i.prototype),"_onDefined",this).apply(this,arguments),this._insertCapTypeField(),this._insertCapValueField()}},{key:"_insertCapTypeField",value:function(){var t=this;this._insert(new n2.de.page.team.weightingAndCaps.CapCombo({id:"cap-type",mixins:[n2.mixin.DataDriven],cls:"n2_cap-type",label:{text:"Cap type",hidden:!0},required:!0,sort:!1,options:[],listeners:{change:function(e){return t._updateCappingPeriod(e)}}}))}},{key:"_insertCapValueField",value:function(){this._insert(new n2.ui.component.field.Number({id:"cap-value",mixins:[n2.mixin.DataDriven],cls:"n2_cap-value",label:{text:"Cap value",hidden:!0},required:!0,min:1,value:{bindPath:"."}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("hasCap").value=e.isChecked(),this._refreshFieldVisibility(),this._refreshCriteriaCapsLabel()}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(i.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-distributor-caps")}},{key:"_onLoaded",value:function(e,t){var n;_get(_getPrototypeOf(i.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&((t=this._components["cap-type"]).model=e,t.options=this._getCapTypeOptions(),t.value={value:this._getCurrentPeriodKey(),silent:!0},(n=this._components["cap-value"]).model=e.getProperty("capValue",{defaultValue:1}),this._components["toggle-active"].value={silent:!0,value:e.get("hasCap")},this._refreshFieldVisibility(),this._refreshCriteriaCapsLabel(),t.clearInvalid(),n.clearInvalid())}},{key:"_getCapTypeOptions",value:function(){return n2.de.data.PeriodOptions.get({useTotalLabel:!this._model.get("teamHasActiveStatus"),extraPeriods:this._model.get("existingCustomCappingPeriods"),includePeriodKey:this._getCurrentPeriodKey(),distributorType:this._model.get("distributorType")})}},{key:"_getCurrentPeriodKey",value:function(){return n2.de.data.PeriodOptions.cappingPeriodToKey(this._model.get("cappingPeriod"))}},{key:"_refreshFieldVisibility",value:function(){var e=this._isCapActive();this._components["cap-type"].hidden=!e,this._components["cap-value"].hidden=!e}},{key:"_updateCappingPeriod",value:function(e){this._model.getProperty("cappingPeriod",{defaultValue:{}}).set(n2.de.data.PeriodOptions.cappingPeriodFromKey(e.value),{silent:!1});e=this._isCriteriaCapSelected()?{useDistributorFilters:!0}:{};this._model.getProperty("criteriaCapsConfigEdit",{defaultValue:e}).set(e,{silent:!0}),this._model.getProperty("criteriaCapsConfig",{defaultValue:e}).set(e,{silent:!0}),this._refreshCriteriaCapsLabel()}},{key:"_refreshCriteriaCapsLabel",value:function(){var e,t,n,i=this;n2.isUndefined(this._components["criteria-type-label"])||this._components["criteria-type-label"].destroy(),this._isCapActive()&&this._isCriteriaCapSelected()&&(e=(n=this._getCriteriaCapsConfig(!1)).useDistributorFilters?"Distributor Filters":"",t=[],!n.useDistributorFilters&&n.customFilter&&n.customFilter.filters&&!n2.isUndefined(n.customFilter.filters[0])&&t.push(new n2.de.component.summary.InlineFilterSummary({id:"cap-filter",cls:"n2-de-summary",filter:n.customFilter.filters[0]})),n=new n2.ui.component.Button({id:"criteria-type-edit-link",cls:"n2_criteria-type-edit-link",text:e,components:t,renderTo:".n2_criteria-type-edit-link",listeners:{click:function(e){i._openCriteriaPeriodModal()}}}),this._insert(new n2.ui.component.HTML({id:"criteria-type-label",template:'<div id="{{id}}" class="n2_criteria-type-message{{#hidden}} {{hideCls}}{{/hidden}}"><p>Criteria based filter: <span class="n2_criteria-type-edit-link"></span></p></div>',components:[n],hidden:!1})))}},{key:"_getCriteriaCapsConfig",value:function(){return this._model.get(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?"criteriaCapsConfigEdit":"criteriaCapsConfig")||{useDistributorFilters:!0}}},{key:"_isCriteriaCapSelected",value:function(){return"criteria based"===n2.de.data.PeriodOptions.getNormalizedCapPeriodType(this._model.get("cappingPeriod"))}},{key:"_isCapActive",value:function(){return this._model.get("hasCap")}},{key:"criteriaCapModal",get:function(){return n2.de.page.team.weightingAndCaps.CriteriaCapModal.getInstance({renderTo:n2.ui.dom.Scope.getInstance().root})}},{key:"_openCriteriaPeriodModal",value:function(){var t=this;this._validateOnBlur=!1,this.criteriaCapModal.show({criteriaCapsConfig:this._getCriteriaCapsConfig(),teamObjectName:this._model.get("teamObjectName"),listeners:{submit:function(e){return t._onCriteriaCapSubmit(e)}}})}},{key:"_onCriteriaCapSubmit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,e.t0=n2.compare(this._getCriteriaCapsConfig(),n),e.t0){e.next=12;break}return this._model.getProperty("criteriaCapsConfigEdit").set(n,{silent:!1}),e.t1=this._model.getProperty("criteriaCapsConfig"),e.next=7,this._resolveFilterFieldLabel(n2.clone(n));case 7:e.t2=e.sent,e.t3={silent:!1},e.t1.set.call(e.t1,e.t2,e.t3),this._refreshCriteriaCapsLabel(),this.fire("change");case 12:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"_resolveFilterFieldLabel",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n2.isNull(t)||t.useDistributorFilters||n2.isEmpty(t.customFilter.filters)){e.next=6;break}return n=this._model.get("teamObjectName"),e.next=4,this._fetchDataProvider("get-team-object-field-options",{params:[n],silent:!0,force:!1,requestId:n});case 4:n=e.sent.response.find(function(e){return t.customFilter.filters[0].name===e.value}),n2.isUndefined(n)||(t.customFilter.filters[0].name=n.label);case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),i}(),n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.DataTable=function(){_inherits(n,n2.ui.component.EditableDataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._rowClass=n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.dataTable.Row,this._tagValueOptions=[]}},{key:"tagValueOptions",set:function(e){this._tagValueOptions=e,this._refreshTagValueOptions(),this._refreshAddRowButton()}},{key:"_refreshData",value:function(){var e,t=this;n2.isUndefined(this.headerRow)||(e=this.headerRow,this.remove(e),e.destroy()),this._addHeaderRow(),_get(_getPrototypeOf(n.prototype),"_refreshData",this).apply(this,arguments),this._refreshAddRowButton(),this._data.getProperty("tagCollectionId").listen("change",function(e){return t._onTagCollectionIdChange(e)},this)}},{key:"_onTagCollectionIdChange",value:function(e){this._refreshAddRowButton()}},{key:"_addHeaderRow",value:function(){var t=this;n2.isNull(this._data)||this._insert(new n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.dataTable.HeaderRow({id:"th-row",renderTo:this.SELECTORS.tableHeader,columns:[],data:this._data.getProperty("defaultCaps"),existingCustomCapPeriods:this._data.get("existingCustomCappingPeriods"),showTotalLabels:!this._data.get("hasActiveStatus"),listeners:{change:function(e){return t._onHeaderRowChange(e)},click:function(e){return t._onHeaderRowClick(e)}}}))}},{key:"_onHeaderRowChange",value:function(n){var i=this;"period"===n.target.id&&this.forEachRow(function(e){var t=n.data.periodCellIndex-1;i._updateCapPeriod({capModel:e.capsModel.getProperty(t),periodValueKey:n.target.value}),i._refreshEditButton(e)})}},{key:"_updateCapPeriod",value:function(e){var t=e.capModel,e=e.periodValueKey;t.getProperty("cappingPeriod").value=n2.de.data.PeriodOptions.cappingPeriodFromKey(e)}},{key:"_onHeaderRowClick",value:function(e){switch(e.target.id){case"add-period":this._onAddPeriodClick(e);break;case"remove-period":this._onRemovePeriodClick(e)}}},{key:"_onAddPeriodClick",value:function(i){var s=this;this.forEachRow(function(e){var t=s._createCapModel({cappingPeriodKey:i.relatedTarget.components.period.value}),n=i.data.periodCellIndex;e.capsModel.insert(t,{key:n-1}),e.insertCapCell(t,{insertAtIndex:n}),s._refreshEditButton(e)})}},{key:"_onRemovePeriodClick",value:function(t){var n=this;n2.de.component.ConfirmationMessageBox.getInstance({renderTo:this._dom.parent}).show({message:"Are you sure you want to remove this period? You will lose all current caps.",listeners:{submit:function(e){return n._onRemovePeriodConfirmed(t)}}})}},{key:"_onRemovePeriodConfirmed",value:function(n){var i=this;this.headerRow.removePeriodCell(n.target.parent),this.forEachRow(function(e){var t=n.data.periodCellIndex;e.capsModel.remove(t-1),e.removeCapCellAtIndex(t),i._refreshEditButton(e)})}},{key:"_addRows",value:function(){n2.isNull(this._data)||(this._insertDefaultRow(),n2.isEmpty(this._data.get("tagCaps")))||this._insertTagCapRows()}},{key:"_insertDefaultRow",value:function(){return this._insertRow({id:"default-row",columns:[],data:this._data.getProperty("defaultCaps")})}},{key:"_insertTagCapRows",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._data.getProperty("tagCaps"),t=[],n=e.json.length,i=0;i<n;)t.push(this.insertRow(this._getRowConfig(e.getProperty(i)))),i+=1;return t}},{key:"_onAddRowClick",value:function(e){var t=this._createNewRowData();this._data.getProperty("tagCaps").insert(t),this._doInsertRow(this._getRowConfig(t),{target:e}),this._refreshAddRowButton()}},{key:"_getRowConfig",value:function(e){var t=this;return{data:e,tagValueOptions:this._getFilteredTagValueOptions(),listeners:{change:function(e){return t._onTagCapRowChange(e)}}}}},{key:"_onTagCapRowChange",value:function(e){e=e.target.parent.parent;this._refreshEditButton(e),this._refreshTagValueOptions()}},{key:"_refreshEditButton",value:function(e){var t=e.components["remove-row-cell"].components["edit-tag-caps"];e.canEdit?t.enable():t.disable()}},{key:"_createRemoveCell",value:function(e){var t=[this._createEditButton({disabled:!e.canEdit})];return"default-row"!==e.id&&((e=this._createRemoveButton(e)).hidden=!1,t.push(e)),new n2.ui.component.dataTable.Cell({id:"remove-row-cell",column:{},cls:"n2_remove-cell",components:t})}},{key:"_createEditButton",value:function(){var t=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).disabled;return new n2.ui.component.Button({id:"edit-tag-caps",text:"Edit",theme:n2.ui.component.button.Theme.NEUTRAL,disabled:void 0!==e&&e||this._disabled,listeners:{click:function(e){return t._onEditTagCapsButtonClick(e)}}})}},{key:"_onEditTagCapsButtonClick",value:function(e){var t=this,n=e.parent.parent;n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.EditCapsModal.getInstance({renderTo:this._dom}).show({model:n.originalData,showActiveCapAsTotalCap:!this._data.get("hasActiveStatus"),listeners:{submit:function(e){return t._onEditModalSubmit(e,n)}}})}},{key:"_onEditModalSubmit",value:function(e,t){t.data=e.model,t.insert(this._createRemoveCell(t)),t.refreshCellIndexes()}},{key:"_removeRowData",value:function(e){e-=1;this._data.getProperty("tagCaps").remove(e)}},{key:"_removeRow",value:function(){_get(_getPrototypeOf(n.prototype),"_removeRow",this).apply(this,arguments),this._refreshTagValueOptions(),this._refreshAddRowButton()}},{key:"_onRowMouseEnter",value:function(e){}},{key:"_onRowMouseLeave",value:function(e){}},{key:"_refreshTagValueOptions",value:function(){var t=this;this.forEachRow(function(e){"default-row"!==e.id&&(e.tagValueOptions=t._getFilteredTagValueOptions({tagValueIdException:e.originalData.get("tagValueId")}))})}},{key:"_refreshAddRowButton",value:function(){var e=this._data.get("tagCollectionId"),t=this.data.length-1,t=this._tagValueOptions.length===t;!e||t?this._components["add-row-button"].disable():this._components["add-row-button"].enable()}},{key:"_getFilteredTagValueOptions",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).tagValueIdException,e=void 0===e?null:e,t=this._tagValueOptions,n=this._data.get("tagCaps").map(function(e){return e.tagValueId}),e=n.indexOf(e);return-1<e&&n.splice(e,1),t.filter(function(e){return!n.includes(e.value)})}},{key:"_createNewRowData",value:function(){var i=this,s=new n2.dataProvider.Model({value:{tagValueId:"",tagValue:null,caps:[]}});return this._components["th-row"].forEachPeriodCell(function(e,t,n){s.getProperty("caps").insert(i._createCapModel({cappingPeriodKey:e.components.period.value}))}),s}},{key:"_createCapModel",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).cappingPeriodKey;return new n2.dataProvider.Model({value:{cappingPeriod:n2.de.data.PeriodOptions.cappingPeriodFromKey(void 0===e?null:e),cap:null,isUnlimited:!0}})}},{key:"_hideEmptyState",value:function(){}},{key:"_showEmptyState",value:function(){}},{key:"validate",value:function(){var e=this.headerRow.validate(),t=_get(_getPrototypeOf(n.prototype),"validate",this).apply(this,arguments);return n2.isString(e)||!1===e?e:t}},{key:"clear",value:function(){for(var e=this._componentIds.length-1;0<=e;e--){var t=this._componentIds[e];this._components[t]instanceof this._rowClass&&"default-row"!==t&&this.removeRow(this._components[t])}}}]),n}(),n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.EditCapsModal=function(){_inherits(n,n2.de.component.Modal);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this.id="edit-cap-modal",this._mixins=n2.merge([n2.mixin.DataDriven,n2.mixin.Singleton],this._mixins),this._showTotalLabels=!1}},{key:"show",value:function(e){var t=e.model,e=e.showActiveCapAsTotalCap,e=void 0!==e&&e,e=(this._model=t,this._showTotalLabels=e,n2.isUndefined(this._components["cap-form"])||this._components["cap-form"].destroy(),t.get("tagValue")||"Default");this.header="".concat(e," caps"),this._insertCapForm(),_get(_getPrototypeOf(n.prototype),"show",this).apply(this,arguments),this._forEachCapLimitField(function(e){e.components["cap-value"].element("field").attribute("min",1)})}},{key:"_insertCapForm",value:function(){var e=this._insert(new n2.ui.component.Form({id:"cap-form",renderTo:".slds-modal__content"}));return this._insertPeriodFieldGroup(),e}},{key:"_insertPeriodFieldGroup",value:function(){var e=this._components["cap-form"].insert(new n2.de.component.form.FieldGroup({id:"period",heading:"Period"}));return this._insertCapFieldGroups(),e}},{key:"_insertCapFieldGroups",value:function(){for(var e=[],t=this._getCapsModel(),n=t.json.length,i=0;i<n;)e.push(this._insertCapFieldGroup(t.getProperty(i),"cap-field-group-".concat(i))),i+=1;return e}},{key:"_insertCapFieldGroup",value:function(e,t){var n=this,t=this._components["cap-form"].components.period.insert(new n2.de.component.form.FieldGroup({id:t,heading:this._getPeriodLabel(e.get("cappingPeriod")),cls:"n2_inline-field-group"}));return t.insert(new n2.de.component.field.RadioButtonGroup({id:"limit",mixins:[n2.mixin.DataDriven],model:e,label:{text:"Limit",hidden:!0},options:[{label:"Unlimited",value:!0},{label:"Cap",value:!1}],sort:!1,value:e.get("isUnlimited"),validator:function(e){var t=e.components["cap-value"];if(!n2.isUndefined(t)&&!e.value){if(n2.isNull(t.value))return"The cap value is mandatory";if(t.value<1)return"The cap value is below the minimum, 1"}return!0},listeners:{change:function(e){return n._onLimitFieldChange(e)}}})).insert(new n2.ui.component.field.Number({id:"cap-value",mixins:[n2.mixin.DataDriven],model:e,cls:"n2_cap-value",renderTo:{target:".slds-radio_button-group",position:"afterend"},label:{text:"Cap value",hidden:!0},hidden:{bindPath:".isUnlimited"},value:e.get("cap")||1,listeners:{blur:function(e){return n._onCapValueBlur(e)}}})),t}},{key:"_getPeriodLabel",value:function(e){return n2.de.data.PeriodOptions.getPeriodLabel(e,{teamHasActiveStatus:!this._showTotalLabels})}},{key:"_onLimitFieldChange",value:function(e){var t=e.components["cap-value"];t.hidden=e.value,e.value&&n2.isNull(t.value)&&(t.value=1)}},{key:"_onCapValueBlur",value:function(e){e.parent.validate()}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-edit-caps-modal")}},{key:"_onSubmit",value:function(){this._validate()&&(this._updateModel(),_get(_getPrototypeOf(n.prototype),"_onSubmit",this).apply(this,arguments),this.hide())}},{key:"_validate",value:function(){return this._components["cap-form"].components.period.validate()}},{key:"_updateModel",value:function(){this._forEachCapLimitField(function(e){e.model.getProperty("isUnlimited").value=e.value;e=e.components["cap-value"];e.model.getProperty("cap",{defaultValue:1}).value=n2.isNull(e.value)?1:e.value})}},{key:"_reset",value:function(){_get(_getPrototypeOf(n.prototype),"_reset",this).call(this),this._forEachCapLimitField(function(e){e.reset(),e.components["cap-value"].reset()})}},{key:"_forEachCapLimitField",value:function(t){var n=this;this._components["cap-form"].components.period.forEach(function(e){return t.call(n,e.components.limit)})}},{key:"_isDefaultCaps",value:function(){return n2.isUndefined(this._model.get("tagValueId"))}},{key:"_getCapsModel",value:function(){return this._isDefaultCaps()?this._model:this._model.getProperty("caps")}}]),n}(),n2.de.page.team.weightingAndCaps.weighting.individual.EmptyState=function(){_inherits(t,n2.ui.component.dataTable.EmptyState);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your team doesn't have any team members yet",this._contentTemplate='<p>Individual weighting allows you to balance the volume of assignments each team member will receive. <span class="n2_link-container"></span> to get started.</p>'}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._insertAddTeamMemberButton()}},{key:"_insertAddTeamMemberButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-team-member",renderTo:this.SELECTORS.linkContainer,text:"Add team members",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTeamMemberClick(e)}}}))}},{key:"_onAddTeamMemberClick",value:function(e){var t=n2.de.page.team.Context.getInstance().teamId;n2.de.page.Navigation.getInstance().open("Team_TeamMemberList","teamId=".concat(t))}}]),t}(),n2.de.page.team.weightingAndCaps.weighting.tagBased.EmptyState=function(){_inherits(t,n2.ui.component.Illustration);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{linkContainer:".n2_link-container"}),this._illustration=n2.de.illustration.Desert,this._heading="Your org doesn't have any tag collections yet",this._contentTemplate='<p>{{content}}{{#isAdminOrSystemManager}} <span class="n2_link-container"></span> to get started.{{/isAdminOrSystemManager}}</p>',this._content="Tag Weighting allows you to balance assignments by the tags that each team member has."}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{isAdminOrSystemManager:n2.de.ApplicationContext.getInstance().isAdminOrSystemManager})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),n2.de.ApplicationContext.getInstance().isAdminOrSystemManager&&this._insertAddTagCollectionButton()}},{key:"_insertAddTagCollectionButton",value:function(){var t=this;this._insert(new n2.ui.component.Button({id:"add-tag-collections",renderTo:this.SELECTORS.linkContainer,text:"Add your first tag collection",theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddTagCollectionClick(e)}}}))}},{key:"_onAddTagCollectionClick",value:function(e){n2.de.page.Navigation.getInstance().open("Tags_TagCollectionList")}}]),t}(),n2.de.page.team.weightingAndCaps.weighting.tagBased.TagWeighting=function(){_inherits(n,n2.de.component.field.DataTable);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._columns=[{header:"Tag",cls:"n2_tag",bindPath:"tagId",editField:{type:n2.ui.component.field.Combo,options:[],required:!0}},{header:"Weighting",bindPath:"weighting",editField:{type:n2.ui.component.field.Slider,max:4,min:.25,step:.25,showNumberInput:!0}}],this._newRowData={type:n2.dataProvider.Model,value:{tagId:"",weighting:1}},this._tagFieldOptions=null,this._addRowButtonConfig={text:"Add tag"}}},{key:"tagFieldOptions",set:function(e){this._tagFieldOptions=e,this.max=this._tagFieldOptions.length,this._refreshTagFieldOptions(),this._columns[0].editField.options=this._tagFieldOptions}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(n.prototype),"_afterRender",this).apply(this,arguments),this._dom.addClass("n2-de-tag-weighting")}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&this._onTagWeightingModelLoaded(e)}},{key:"_onTagWeightingModelLoaded",value:function(e){(this._components["data-table"].model=e).listen("change",this._onTagWeightingModelChange,this)}},{key:"_onTagWeightingModelChange",value:function(e){e.change.bindPathMatch("tagWeightings[*]")&&(e.change.type===n2.dataProvider.model.enum.Change.REMOVE?this._refreshTagFieldOptions({excludedRowModel:e.change.item}):this._refreshTagFieldOptions())}},{key:"_refreshTagFieldOptions",value:function(){var n=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).excludedRowModel,e=void 0===e?null:e,i=n2.isNull(e)?null:e.get("tagId"),s=this._model.json,a=0;this._components["data-table"].forEachRow(function(e){var t;e.data.tagId!==i&&(e=e.components["td-0"].components["edit-field"],t=s[a],e.options=n._getFilteredTagFieldOptions({tagValueException:t?t.tagId:null}),a+=1)})}},{key:"_getFilteredTagFieldOptions",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).tagValueException,t=void 0===e?null:e,n=this._model.json.filter(function(e){return e.tagId!==t}).map(function(e){return e.tagId});return this._tagFieldOptions.filter(function(e){return!n.includes(e.value)})}}]),n}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.FilterResult=function(){_inherits(n,n2.ui.Component);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._componentCls="n2-de-filter-test-result",this._template='<div id="{{id}}" class="n2-component {{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{#hasFilters}}\n                {{#hasTeamFilters}}\n                    <div data-test-id="team-filters"> \n                        <h3 class="n2_filters-heading">Team Filters</h3>\n                        <ol class="slds-list_ordered">\n                            {{#teamFilters}}<li data-test-id="team-filter-{{filterRow}}">{{> filterResultTemplate }}</li>{{/teamFilters}}\n                        </ol>\n                        {{#teamFilterLogic}}{{> filterLogicTemplate }}{{/teamFilterLogic}}\n                    </div>\n                {{/hasTeamFilters}}\n                {{#hasDistributorFilters}}\n                    <div data-test-id="distributor-filters" class="{{#separateDistributorFilters}}n2_separator{{/separateDistributorFilters}}">\n                        <h3 class="n2_filters-heading">Distributor Filters</h3>\n                        <ol class="slds-list_ordered">\n                            {{#distributorFilters}}<li data-test-id="distributor-filter-{{filterRow}}">{{> filterResultTemplate }}</li>{{/distributorFilters}}\n                        </ol>\n                        {{#distributorFilterLogic}}{{> filterLogicTemplate }}{{/distributorFilterLogic}}\n                    </div>\n                {{/hasDistributorFilters}}\n                {{#campaignFilter}}\n                    <div class="{{#separateCampaignFilter}}n2_separator{{/separateCampaignFilter}}" data-test-id="campaign-filter">\n                        <h3 class="n2_filters-heading">Campaign Filter</h3>\n                        <div class="slds-m-left_small">{{> filterResultTemplate }}</div>\n                    </div>\n                {{/campaignFilter}}\n            {{/hasFilters}}\n            {{^hasFilters}}\n                <p class="slds-m-bottom_small slds-text-align_center">No filters have been configured for this team or distributor yet.</p>\n            {{/hasFilters}}\n        </div>',this._filterResultTemplate='<div class="n2_filter">\n            <span class="n2_field-name slds-truncate" title="{{fieldLabel}}">{{fieldLabel}} </span>\n            <span class="n2_filter-operator" title="{{operator}}">{{operator}} </span>\n            <span class="n2_filter-value slds-truncate" title="{{filterValue}}">\n                {{#filterValue}}{{filterValue}}{{/filterValue}}\n                {{^filterValue}}<span class="n2-text-weak"><i>No value</i></span>{{/filterValue}}\n            </span>\n            {{#matches}}'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/matches}}\n            {{^matches}}\n                ").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),'\n                <span class="n2_failed-filter-value slds-truncate" title="{{#actualValue}}{{actualValue}}{{/actualValue}}{{^actualValue}}No value{{/actualValue}}">\n                    {{#actualValue}}{{actualValue}}{{/actualValue}}\n                    {{^actualValue}}<i>No value</i>{{/actualValue}}\n                </span>\n            {{/matches}}\n        </div>'),this._filterLogicTemplate='<div class="n2_filter-logic">\n            <span class="n2_filter-condition">Logic </span>\n            <span class="n2_filter-value">{{filterLogic}} </span>\n            {{#matchesFilterLogic}}'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/matchesFilterLogic}}\n            {{^matchesFilterLogic}}").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),"{{/matchesFilterLogic}}\n        </div>"),this._teamFilterData=null,this._distributorFilterData=null,this._campaignFilter=null}},{key:"teamFilterData",set:function(e){this._setProperty("teamFilterData",e,{sync:!1})}},{key:"distributorFilterData",set:function(e){this._setProperty("distributorFilterData",e,{sync:!1})}},{key:"campaignFilter",set:function(e){this._setProperty("campaignFilter",e,{sync:!1})}},{key:"_getTemplateData",value:function(){var e=this._teamFilterData.filters,t=this._distributorFilterData.filters;return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplateData",this).call(this),{hasFilters:!n2.isEmpty(e)||!n2.isEmpty(t)||!n2.isEmpty(this._campaignFilter),hasTeamFilters:!n2.isEmpty(e),teamFilters:e,teamFilterLogic:this._teamFilterData.filterLogic,hasDistributorFilters:!n2.isEmpty(t),distributorFilters:t,distributorFilterLogic:this._distributorFilterData.filterLogic,separateDistributorFilters:!n2.isEmpty(e),campaignFilter:this._campaignFilter,separateCampaignFilter:!n2.isEmpty(e)||!n2.isEmpty(t)})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(n.prototype),"_getTemplatePartials",this).call(this),{filterResultTemplate:this._filterResultTemplate,filterLogicTemplate:this._filterLogicTemplate})}}]),n}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.MethodResult=function(){_inherits(t,n2.ui.Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-de-method-test-result",this._template='<div id="{{id}}" class="n2-component {{componentCls}}{{#hidden}} {{hideCls}}{{/hidden}}{{#cls}} {{cls}}{{/cls}}"{{#title}} title="{{title}}"{{/title}}>\n            {{#classifierFilterResult}}<div data-test-id="classifier-result">{{> filterResultTemplate }}</div>{{/classifierFilterResult}}\n            {{#sourceFilterResult}}<div data-test-id="source-filter">{{> filterResultTemplate }}</div>{{/sourceFilterResult}}\n            {{#stickyResult}}{{> stickyResultTemplate}}{{/stickyResult}}\n            {{#lookupOwnerResult}}{{> lookupOwnerResultTemplate }}{{/lookupOwnerResult}}\n            {{#relatedOwnerResult}}<div data-test-id="related-owner-result">{{> relatedOwnerResultTemplate }}</div>{{/relatedOwnerResult}}\n        </div>',this._filterResultTemplate='<div class="n2_filter">\n            <span class="n2_field-name slds-truncate" title="{{fieldLabel}}">{{fieldLabel}} </span>\n            <span class="n2_filter-operator" title="{{operator}}">{{operator}} </span>\n            <span class="n2_filter-value slds-truncate" title="{{filterValue}}">\n                {{#filterValue}}{{filterValue}}{{/filterValue}}\n                {{^filterValue}}<span class="n2-text-weak"><i>No value</i></span>{{/filterValue}}\n            </span>\n            {{#matches}}'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/matches}}\n            {{^matches}}\n                ").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),'\n                <span class="n2_failed-filter-value slds-truncate" title="{{#actualValue}}{{actualValue}}{{/actualValue}}{{^actualValue}}No value{{/actualValue}}">\n                    {{#actualValue}}{{actualValue}}{{/actualValue}}\n                    {{^actualValue}}<i>No value</i>{{/actualValue}}\n                </span>\n            {{/matches}}\n        </div>'),this._stickyResultTemplate='<p data-test-id="sticky-result" class="n2_separator">\n            <span class="n2_filter-condition">Sticky </span>\n            <span class="n2_field-name slds-m-right_xx-small">{{stickyField}} </span>\n            <span class="n2_filter-condition">for </span>\n            <span class="n2_filter-value">{{stickyPeriod}} </span>\n            <span class="n2_filter-condition slds-m-left_xx-small">within </span>\n            <span class="n2_filter-value">{{stickyMatchLevel}}</span>\n        </p>',this._lookupOwnerResultTemplate='<div data-test-id="lookup-owner-result" class="n2_separator">\n            {{#lookupFields}}\n                <p data-test-id="lookup-owner-field-{{index}}">\n                    {{#condition}}<span class="n2_filter-condition">{{condition}} </span>{{/condition}}\n                    <span class="n2_field-name slds-m-right_xx-small">{{fieldName}} </span>\n                    <span class="n2_filter-text">lookup to </span>\n                    <span class="n2_field-name">{{lookupObjectName}}.{{lookupFieldName}}</span>\n                </p>\n            {{/lookupFields}}\n            {{#lookupClause}}\n                <p data-test-id="lookup-owner-clause">\n                    <span class="n2_filter-condition">Where </span>\n                    <span class="n2_field-name slds-m-left_xx-small">{{objectName}}.{{fieldName}} </span>\n                    <span class="n2_filter-operator">{{operator}} </span>\n                    <span class="n2_filter-value">{{value}}</span>\n                </p>\n            {{/lookupClause}}\n        </div>',this._relatedOwnerResultTemplate='<p data-test-id="related-owner-condition-{{index}}" class="n2_separator">\n            {{#condition}}<span class="n2_filter-condition">{{condition}} </span>{{/condition}}\n            <span class="n2_field-name slds-m-right_xx-small">{{objectFieldName}} </span>\n            <span class="n2_filter-text">exists, assign using </span>\n            <span class="n2_field-name">{{relatedFieldName}}</span>\n        </p>',this._classifierFilterResult=null,this._sourceFilterResult=null,this._stickyResult=null,this._lookupOwnerResult=null,this._relatedOwnerResult=null}},{key:"stickyResult",set:function(e){this._setProperty("stickyResult",e,{sync:!1})}},{key:"sourceFilterResult",set:function(e){this._setProperty("sourceFilterResult",e,{sync:!1})}},{key:"classifierFilterResult",set:function(e){this._setProperty("classifierFilterResult",e,{sync:!1})}},{key:"lookupOwnerResult",set:function(e){this._setProperty("lookupOwnerResult",e,{sync:!1})}},{key:"relatedOwnerResult",set:function(e){this._setProperty("relatedOwnerResult",e,{sync:!1})}},{key:"_getTemplateData",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplateData",this).call(this),{classifierFilterResult:this._classifierFilterResult,sourceFilterResult:this._sourceFilterResult,stickyResult:this._stickyResult,lookupOwnerResult:this._getLookupOwnerTemplateData(),relatedOwnerResult:this._getRelatedOwnerTemplateData()})}},{key:"_getTemplatePartials",value:function(){return n2.merge(_get(_getPrototypeOf(t.prototype),"_getTemplatePartials",this).call(this),{filterResultTemplate:this._filterResultTemplate,stickyResultTemplate:this._stickyResultTemplate,lookupOwnerResultTemplate:this._lookupOwnerResultTemplate,relatedOwnerResultTemplate:this._relatedOwnerResultTemplate})}},{key:"_getLookupOwnerTemplateData",value:function(){var e;return n2.isNull(this._lookupOwnerResult)?null:(e={lookupFields:[{index:0,fieldName:this._lookupOwnerResult.lookupUniqueField,lookupObjectName:this._lookupOwnerResult.lookupObjectName,lookupFieldName:this._lookupOwnerResult.lookupObjectMatchField}],lookupClause:null},n2.isUndefined(this._lookupOwnerResult.level2UniqueField)||e.lookupFields.push({index:1,condition:"OR",fieldName:this._lookupOwnerResult.level2UniqueField,lookupObjectName:this._lookupOwnerResult.lookupObjectName,lookupFieldName:this._lookupOwnerResult.level2ObjectMatchField}),n2.isUndefined(this._lookupOwnerResult.level3UniqueField)||e.lookupFields.push({index:2,condition:"OR",fieldName:this._lookupOwnerResult.level3UniqueField,lookupObjectName:this._lookupOwnerResult.lookupObjectName,lookupFieldName:this._lookupOwnerResult.level3UniqueField}),n2.isUndefined(this._lookupOwnerResult.lookupFilterField)||(e.lookupClause={objectName:this._lookupOwnerResult.lookupObjectName,fieldName:this._lookupOwnerResult.lookupFilterField,operator:this._lookupOwnerResult.lookupFilterOp,value:this._lookupOwnerResult.lookupFilterVal}),e)}},{key:"_getRelatedOwnerTemplateData",value:function(){var e;return n2.isNull(this._relatedOwnerResult)?null:(e=[{index:0,condition:"If",objectFieldName:this._relatedOwnerResult.object1,relatedFieldName:this._relatedOwnerResult.field1}],n2.isUndefined(this._relatedOwnerResult.object2)||e.push({index:1,condition:"Else if",objectFieldName:this._relatedOwnerResult.object2,relatedFieldName:this._relatedOwnerResult.field2}),e)}}]),t}(),n2.de.page.assignmentSimulation.assignmentSimulationResults.teamResult.distributorResult.testResultPopover.TeamMemberResult=function(){_inherits(t,n2.de.component.accordion.AccordionSection);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._componentCls="n2-de-team-member-test-result",this._stickyDetailTemplate='{{#isStickyTeamMember}}\n            <div data-test-id="sticky-team-member" class="n2_filter slds-m-top_x-small">\n                <span class="n2_filter-condition">Sticky&nbsp;</span>\n                <span class="n2_filter-value">{{stickyLifespan}}</span>\n            </div>\n        {{/isStickyTeamMember}}',this._tagFilterResultsTemplate='{{#hasTags}}\n            <div data-test-id="tags" class="slds-m-top_x-small{{#isStickyTeamMember}} n2_separator{{/isStickyTeamMember}}">\n                {{#userTags}}\n                    <div data-test-id="tag-{{tagIndex}}" class="n2_filter">\n                        '.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.QUOTE,{cls:"slds-icon_x-small slds-icon-text-default slds-m-right_x-small slds-no-flex"}),'\n                        {{#isTerritoryTag}}<span data-test-id="territory-tag" class="n2_field-name">Territory&nbsp;</span>{{/isTerritoryTag}}\n                        {{^isTerritoryTag}}\n                            <span data-test-id="tag-category" class="n2_field-name">{{tagCategory}}&nbsp;</span>\n                            <span data-test-id="tag-operator" class="n2_filter-operator">{{tagOperator}}&nbsp;</span>\n                        {{/isTerritoryTag}}\n                        {{#isDynamicTag}}<span data-test-id="dynamic-tag-field" class="n2_field-name">{{tagFieldName}}&nbsp;</span>{{/isDynamicTag}}\n                        {{#tagFilterValues}}\n                            <span data-test-id="tag-value-{{tagValueIndex}}" class="{{#hasTag}}n2_filter-value{{/hasTag}}{{^hasTag}}n2_filter-text{{/hasTag}}">{{tagValue}}</span>{{^isLast}},&nbsp;{{/isLast}}\n                        {{/tagFilterValues}}\n                        {{#userMatches}}').concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/userMatches}}\n                        {{^userMatches}}").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),"{{/userMatches}}\n                    </div>\n                {{/userTags}}\n            </div>\n        {{/hasTags}}"),this._cappingResultsTemplate='{{#hasCaps}}\n            <div data-test-id="team-member-caps" class="slds-m-top_x-small{{#hasTags}} n2_separator{{/hasTags}}">\n                {{#teamMemberCaps}}\n                    <div data-test-id="team-member-cap-{{capIndex}}" class="n2_filter">\n                        {{#isTeamCap}}'.concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.PEOPLE,{cls:"slds-icon_x-small slds-icon-text-default slds-m-right_x-small slds-no-flex"}),"{{/isTeamCap}}\n                        {{^isTeamCap}}").concat(n2.ui.Icon.getSVG(n2.de.enum.Icon.RESOURCE_CAPACITY,{cls:"slds-icon_x-small slds-icon-text-default slds-m-right_x-small slds-no-flex"}),'{{/isTeamCap}}\n                        <span class="n2_field-name">{{capDuration}}&nbsp;</span>\n                        {{#capDurationDetails}}<span class="n2_filter-text">{{capDurationDetails}}&nbsp;</span>{{/capDurationDetails}}\n                        {{^error}}<span class="n2_filter-value">{{userAssignments}}/{{capValue}}&nbsp;</span>{{/error}}\n                        {{#error}}<span class="n2_failed-filter-value">{{userAssignments}}/{{capValue}}&nbsp;</span>{{/error}}\n                        {{^exceeded}}').concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/exceeded}}\n                        {{#exceeded}}").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),"{{/exceeded}}\n                    </div>\n                {{/teamMemberCaps}}\n            </div>\n        {{/hasCaps}}"),this._teamMemberData=null}},{key:"teamMemberData",set:function(e){this._setProperty("teamMemberData",e,{sync:!1})}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).call(this),this.heading=this._teamMemberData.username}},{key:"_insertOpenButton",value:function(){var e=_get(_getPrototypeOf(t.prototype),"_insertOpenButton",this).call(this);return e.insert(new n2.ui.component.Avatar({id:"avatar",avatar:this._teamMemberData.avatarUrl,displayName:this._teamMemberData.username,renderTo:{target:".slds-button__icon",position:"afterend"}})),e.insert(new n2.ui.component.HTML({id:"online-label",mixins:[n2.mixin.DataDriven],template:'<span class="n2_online-label" title="{{model.offlineReason}}"> ({{#model.isOnline}}Online{{/model.isOnline}}{{^model.isOnline}}Offline{{/model.isOnline}})</span>',model:this._teamMemberData})),e.insert(new n2.ui.component.HTML({id:"success-status",mixins:[n2.mixin.DataDriven],template:'<div class="n2_success-status">\n                {{#model.matchesDistributor}}'.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CHECK,{cls:"slds-icon_x-small slds-icon-text-success slds-m-left_x-small slds-no-flex"}),"{{/model.matchesDistributor}}\n                {{^model.matchesDistributor}}").concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.CLOSE,{cls:"slds-icon_x-small slds-icon-text-error slds-m-left_x-small slds-no-flex"}),"{{/model.matchesDistributor}}\n            </div>"),model:this._teamMemberData})),this._hasTeamMemberResults()||e.disable(),e}},{key:"_prepareDOM",value:function(){_get(_getPrototypeOf(t.prototype),"_prepareDOM",this).call(this),this._insertStickyLifeSpan(),this._insertTagFilterResults(),this._insertCappingResults()}},{key:"_insertStickyLifeSpan",value:function(){this.element("body").insert(n2.ui.Template.render(this._stickyDetailTemplate,this._teamMemberData))}},{key:"_insertTagFilterResults",value:function(){var e=this._teamMemberData.userTags.map(function(n,e){var t=n.tagFilterValues.map(function(e,t){return n2.merge(e,{tagValueIndex:t,isLast:t===n.tagFilterValues.length-1})});return n2.merge(n,{tagFilterValues:t,tagIndex:e})});this.element("body").insert(n2.ui.Template.render(this._tagFilterResultsTemplate,{userTags:e,hasTags:this._hasUserTags(),isStickyTeamMember:this._isStickyTeamMember()}))}},{key:"_insertCappingResults",value:function(){var e=this._teamMemberData.teamMemberCaps.map(function(e,t){return n2.merge(e,{capIndex:t})});this.element("body").insert(n2.ui.Template.render(this._cappingResultsTemplate,{teamMemberCaps:e,hasCaps:this._hasTeamMemberCaps(),hasTags:this._hasUserTags()}))}},{key:"_hasTeamMemberResults",value:function(){return this._isStickyTeamMember()||this._hasUserTags()||this._hasTeamMemberCaps()}},{key:"_hasUserTags",value:function(){return!n2.isEmpty(this._teamMemberData.userTags)}},{key:"_hasTeamMemberCaps",value:function(){return!n2.isEmpty(this._teamMemberData.teamMemberCaps)}},{key:"_isStickyTeamMember",value:function(){return this._teamMemberData.isStickyTeamMember}}]),t}(),n2.de.page.classifier.autoConversionSettings.autoConversionRules.ruleModal.autoConvertActionSettings.PostConversionSettings=function(){_inherits(r,n2.de.component.form.FieldGroup);var i,s,e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{accountFields:".n2_account > span.n2_fields",contactFields:".n2_contact > span.n2_fields",opportunity:".n2_opportunity",opportunityFields:".n2_opportunity > span.n2_fields",updateAllConversionObjects:".n2_update-all-conversion-objects"}),this._template='<fieldset id="{{id}}" class="n2-de-field-group{{#hidden}} {{hideCls}}{{/hidden}} {{cls}}">\n            {{>headingTemplate}}\n                <div class="n2_fields slds-hide">\n                    <ul>\n                        <li class="n2_account"><span class="slds-form-element__label">Account</span><span class="n2_fields"></span></li>\n                        <li class="n2_contact"><span class="slds-form-element__label">Contact</span><span class="n2_fields"></span></li>\n                        <li class="n2_opportunity slds-hide"><span class="slds-form-element__label">Opportunity</span><span class="n2_fields"></span></li>\n                    </ul>\n                    {{>errorTemplate}}\n                    <div class="n2_update-all-conversion-objects"/>\n                </div>\n        </fieldset>',this._componentCls="n2-de-post-conversion-settings",this._lazyLoad=!0,this._toggleActive=!0,this._autoConversionRuleSettings=null,this._accountFieldOptions=null,this._contactFieldOptions=null,this._opportunityFieldOptions=null}},{key:"accountFieldSelection",get:function(){return this._components["account-field-selection"]}},{key:"accountFieldUpdateValue",get:function(){return this._components["account-field-update-value"]}},{key:"contactFieldSelection",get:function(){return this._components["contact-field-selection"]}},{key:"contactFieldUpdateValue",get:function(){return this._components["contact-field-update-value"]}},{key:"opportunityFieldSelection",get:function(){return this._components["opportunity-field-selection"]}},{key:"opportunityFieldUpdateValue",get:function(){return this._components["opportunity-field-update-value"]}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(r.prototype),"_onDefined",this).apply(this,arguments),this._insertUpdateAllConversionObjectsCheckbox(),this._insertAccountFieldSelection(),this._insertContactFieldSelection(),this._insertOpportunityFieldSelection()}},{key:"_insertUpdateAllConversionObjectsCheckbox",value:function(){return this.insert(new n2.ui.component.field.Checkbox({id:"update-all-conversion-objects",cls:"slds-m-bottom_medium",mixins:[n2.mixin.DataDriven],label:"Update all conversion objects",value:{bindPath:".updateAllConversionObjects"},helpText:"If checked, new and existing objects involved in a lead conversion will be updated with the post-conversion updates. If unchecked, only new objects created in the lead conversion will be updated with the post-conversion updates.",hidden:!1,required:!1,renderTo:this.SELECTORS.updateAllConversionObjects}))}},{key:"_insertAccountFieldSelection",value:function(){return this._insertObjectFieldSelection({id:"account-field-selection",label:"Account field to update",renderTo:this.SELECTORS.accountFields})}},{key:"_insertContactFieldSelection",value:function(){return this._insertObjectFieldSelection({id:"contact-field-selection",label:"Contact field to update",renderTo:this.SELECTORS.contactFields})}},{key:"_insertOpportunityFieldSelection",value:function(){return this._insertObjectFieldSelection({id:"opportunity-field-selection",label:"Opportunity field to update",renderTo:this.SELECTORS.opportunityFields})}},{key:"_insertObjectFieldSelection",value:function(e){var t=e.id,n=e.label,e=e.renderTo;return this._insert(new n2.ui.component.field.Combo({id:t,mixins:[n2.mixin.DataDriven],renderTo:e,label:{text:n,hidden:!0},options:[],placeholder:"None",listeners:{change:this._onFieldSelectionChange,scope:this},value:{bindPath:".name",defaultValue:""}}))}},{key:"_onFieldSelectionChange",value:function(e){switch(n2.isEmpty(e.value)?this.validate():this.clearInvalid(),e.id){case"account-field-selection":this._onAccountFieldSelectionChange(e);break;case"contact-field-selection":this._onContactFieldSelectionChange(e);break;case"opportunity-field-selection":this._onOpportunityFieldChange(e)}}},{key:"_onAccountFieldSelectionChange",value:function(t){var e=this._accountFieldOptions.find(function(e){return e.value===t.value});n2.isUndefined(e)||this._getFieldUpdateModel("Account").set({name:e.value,type:e.type,value:null}),this._refresh({account:!0})}},{key:"_onContactFieldSelectionChange",value:function(t){var e=this._contactFieldOptions.find(function(e){return e.value===t.value});n2.isUndefined(e)||this._getFieldUpdateModel("Contact").set({name:e.value,type:e.type,value:null}),this._refresh({contact:!0})}},{key:"_onOpportunityFieldChange",value:function(t){var e=this._opportunityFieldOptions.find(function(e){return e.value===t.value});n2.isUndefined(e)||this._getFieldUpdateModel("Opportunity").set({name:e.value,type:e.type,value:null}),this._refresh({opportunity:!0})}},{key:"_onToggleActiveChange",value:function(e){this._autoConversionRuleSettings.set(e.value,{key:"hasFieldUpdates"}),this._refresh({fieldGroupBody:!0})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(r.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._autoConversionRuleSettings=e,this.load({force:!1}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).silent,t=void 0===t||t,n.force,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return e.t0=Promise,e.next=6,this._loadDataProvider("get-update-field-options",{params:["Account"],force:!1,silent:t,requestId:"Account"});case 6:return e.t1=e.sent,e.next=9,this._loadDataProvider("get-update-field-options",{params:["Contact"],force:!1,silent:t,requestId:"Contact"});case 9:return e.t2=e.sent,e.next=12,this._loadDataProvider("get-update-field-options",{params:["Opportunity"],force:!1,silent:t,requestId:"Opportunity"});case 12:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=16,e.t0.all.call(e.t0,e.t4);case 16:return n=e.sent,a=_slicedToArray(n,3),i=a[0],s=a[1],a=a[2],e.abrupt("return",{accountFieldOptions:i,contactFieldOptions:s,opportunityFieldOptions:a});case 22:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.accountFieldOptions,n=e.contactFieldOptions,e=e.opportunityFieldOptions;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._accountFieldOptions=this._filterFieldOptionsForUpdate(t.response),this._contactFieldOptions=this._filterFieldOptionsForUpdate(n.response),this._opportunityFieldOptions=this._filterFieldOptionsForUpdate(e.response),this._refresh()}},{key:"validate",value:function(){var e=!0;return(e=this._autoConversionRuleSettings.get("hasFieldUpdates")?this._validateFieldUpdates():e)&&_get(_getPrototypeOf(r.prototype),"validate",this).apply(this,arguments)}},{key:"_validateFieldUpdates",value:function(){var e=this._autoConversionRuleSettings.get("fieldUpdates"),e=Object.entries(e).some(function(e){e=_slicedToArray(e,2),e[0],e=e[1][0];return!n2.isEmpty(e.name)&&!n2.isEmpty(e.type)});return e?this.clearInvalid():this.markInvalid("At least one of these objects must have a populated field to update when post-conversion is enabled."),e}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.toggleActive,i=e.fieldGroupBody,i=void 0!==i&&i,s=e.account,s=void 0!==s&&s,a=e.contact,a=void 0!==a&&a,e=e.opportunity,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshToggleActive(),(t||i)&&this._refreshFieldGroupBody(),(t||s)&&this._refreshAccount(),(t||a)&&this._refreshContact(),(t||e)&&this._refreshOpportunity(),this._refreshUpdateAllConversionObjects()}},{key:"_refreshToggleActive",value:function(){_get(_getPrototypeOf(r.prototype),"_refreshToggleActive",this).call(this),this.components["toggle-active"].value={value:this._autoConversionRuleSettings.get("hasFieldUpdates"),silent:!0}}},{key:"_refreshFieldGroupBody",value:function(){this._autoConversionRuleSettings.get("hasFieldUpdates")?this.element("body").show():(this.element("body").hide(),this.clearInvalid())}},{key:"_refreshAccount",value:function(){this.accountFieldSelection.model=this._getFieldUpdateModel("Account"),this.accountFieldSelection.options=this._getFieldUpdateOptions(this._accountFieldOptions),this._refreshAccountFieldUpdateValue()}},{key:"_refreshAccountFieldUpdateValue",value:function(){n2.isUndefined(this.accountFieldUpdateValue)||this.accountFieldUpdateValue.destroy();var e=this._getFieldUpdateModel("Account");n2.isEmpty(e.get("name"))||this._insertUpdateValueField("Account",e,{id:"account-field-update-value",renderTo:this.element("accountFields")})}},{key:"_refreshContact",value:function(){this.contactFieldSelection.model=this._getFieldUpdateModel("Contact"),this.contactFieldSelection.options=this._getFieldUpdateOptions(this._contactFieldOptions),this._refreshContactFieldUpdateValue()}},{key:"_refreshContactFieldUpdateValue",value:function(){n2.isUndefined(this.contactFieldUpdateValue)||this.contactFieldUpdateValue.destroy();var e=this._getFieldUpdateModel("Contact");n2.isEmpty(e.get("name"))||this._insertUpdateValueField("Contact",e,{id:"contact-field-update-value",renderTo:this.element("contactFields")})}},{key:"_refreshOpportunity",value:function(){this._autoConversionRuleSettings.get("isCreateOpportunity")?(this.element("opportunity").show(),this.opportunityFieldSelection.model=this._getFieldUpdateModel("Opportunity"),this.opportunityFieldSelection.options=this._getFieldUpdateOptions(this._opportunityFieldOptions),this._refreshOpportunityFieldUpdateValue()):this.element("opportunity").hide()}},{key:"_refreshUpdateAllConversionObjects",value:function(){this.components["update-all-conversion-objects"].model=this._autoConversionRuleSettings}},{key:"_refreshOpportunityFieldUpdateValue",value:function(){n2.isUndefined(this.opportunityFieldUpdateValue)||this.opportunityFieldUpdateValue.destroy();var e=this._getFieldUpdateModel("Opportunity");n2.isEmpty(e.get("name"))||this._insertUpdateValueField("Opportunity",e,{id:"opportunity-field-update-value",renderTo:this.element("opportunityFields")})}},{key:"_insertUpdateValueField",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,i){var s,a,o,r,l;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=i.id,a=i.renderTo,o=n.get("type"),r=n.get("name"),l=null,e.t0=o,e.next=e.t0===n2.de.data.FieldType.BOOLEAN?6:e.t0===n2.de.data.FieldType.PICKLIST?8:e.t0===n2.de.data.FieldType.MULTIPICKLIST?12:16;break;case 6:return l=this._insertUpdateValueCombo({id:s,options:["true","false"],required:!0,renderTo:a}),e.abrupt("break",17);case 8:return l=this._insertUpdateValueCombo({id:s,renderTo:a,placeholder:"None"}),e.next=11,this._loadPickListFieldUpdateOptions(t,r,l);case 11:return e.abrupt("break",17);case 12:return l=this._insertUpdateValueCombo({id:s,multiple:!0,renderTo:a,placeholder:"None"}),e.next=15,this._loadPickListFieldUpdateOptions(t,r,l);case 15:return e.abrupt("break",17);case 16:l=this._insertUpdateValueTextBox({id:s,renderTo:a});case 17:return e.abrupt("return",(l.model=n,l.listen("change",this._onUpdateValueFieldChange,this),l));case 18:case"end":return e.stop()}},e,this)})),function(e,t,n){return s.apply(this,arguments)})},{key:"_onUpdateValueFieldChange",value:function(e){this.validate()}},{key:"_insertUpdateValueCombo",value:function(e){var t=e.id,n=e.options,i=e.multiple,s=e.required,a=e.renderTo,e=e.placeholder;return this._insert(new n2.ui.component.field.Combo({id:t,renderTo:void 0===a?null:a,mixins:[n2.mixin.DataDriven],label:{text:"Select update value",hidden:!0},options:void 0===n?null:n,placeholder:e,multiple:void 0!==i&&i,required:void 0!==s&&s,value:{bindPath:".value"}}))}},{key:"_insertUpdateValueTextBox",value:function(e){var t=e.id,e=e.renderTo;return this._insert(new n2.ui.component.field.TextBox({id:t,renderTo:e,mixins:[n2.mixin.DataDriven],label:{text:"Enter update value",hidden:!0},value:{bindPath:".value"}}))}},{key:"_loadPickListFieldUpdateOptions",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n,i){var s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(t,"-").concat(n),i.spinner(!0),e.next=4,this._fetchDataProvider("get-picklist-field-options",{params:[t,n],force:!1,silent:!1,requestId:s});case 4:s=e.sent,i.options=s.response,i.spinner(!1);case 6:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"_getFieldUpdateModel",value:function(e){return this._autoConversionRuleSettings.getProperty("fieldUpdates",{defaultValue:{}}).getProperty(e,{defaultValue:[]}).getProperty(0,{defaultValue:{}})}},{key:"_filterFieldOptionsForUpdate",value:function(e){var t=[n2.de.data.FieldType.BOOLEAN,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.STRING];return n2.de.data.Adapters.objectFieldOptionsWithType(e,{validTypes:t})}},{key:"_getFieldUpdateOptions",value:function(e){return e.map(function(e){return{label:e.label,value:e.value}})}}]),r}(),n2.de.page.settings.appSettings.appSettingsForm.distributionSettings.userAvailabilitySettings.RequireToggleOffReason=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).call(this),this._mixins=[n2.mixin.DataDriven],this._heading="Require toggle off reason",this._helpText="If enabled, users will be required to provide a reason when they toggle offline. This reason is captured for audit in the user activity history report.",this._toggleActive=!0}},{key:"toggleOffReasonsPillList",get:function(){return this._components["toggle-off-reasons-pill-list"]}},{key:"_insertFields",value:function(){this._insertToggleOffReasonsPillList()}},{key:"_insertToggleOffReasonsPillList",value:function(){return this._insert(new n2.ui.component.field.PillList({id:"toggle-off-reasons-pill-list",label:"Toggle off reasons",mixins:[n2.mixin.DataDriven],cls:"n2_field-large slds-m-bottom_medium",required:!0,delimiter:",",maxLength:255,value:{bindPath:".toggleOffReasons"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("requireToggleOffReasonOn").value=e.value,this._refresh()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._model=e,this._components["toggle-active"].value={value:e.get("requireToggleOffReasonOn"),silent:!0},this._refresh())}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.toggleOffReasonsPillList,t=void 0!==t&&t;(n2.isEmpty(e)||t)&&this._refreshToggleOffReasonsPillList()}},{key:"_refreshToggleOffReasonsPillList",value:function(){this.toggleOffReasonsPillList.model=this._model,this.toggleOffReasonsPillList.hidden=!this._model.get("requireToggleOffReasonOn")}}]),n}(),n2.de.page.team.distributionHours.teamMemberHours.shiftPlanner.shiftSelector.ShiftCombo=function(){_inherits(r,n2.ui.component.field.Combo);var e,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).call(this),this._mixins=n2.merge([n2.mixin.DataDriven],this._mixins),this.dataProviders=["get-shift-names"],this._componentCls="n2-de-shift-selector-combo",this.label={text:"Change shift",hidden:!0},this._required=!0,this._shiftId=null,this._teamShiftName="Team hours",this._sort=!1}},{key:"shiftId",set:function(e){this._shiftId!==e&&(this._shiftId=e,this.load({force:!0}))}},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0!==n&&n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return this.spinner(),e.next=6,n2.DataProviderManager.getInstance().get("get-shift-names").get({force:t,silent:n});case 6:return i=e.sent,s=n2.de.page.team.distributionHours.Context.getInstance().teamShiftHoursId,a=i.find(function(e){return e.value===s}),e.abrupt("return",(this._teamShiftName="Team hours",n2.isUndefined(a)||(this._teamShiftName="".concat(this._teamShiftName," (").concat(a.label,")")),{shiftNames:i}));case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).call(this,e),this._model=e.shiftNames,this.options=this._getOptions(),this.spinner(!1)}},{key:"_getOptions",value:function(){return n2.merge([],[{label:this._teamShiftName,value:null}],this._model)}},{key:"_validateRequired",value:function(){return!0}}]),r}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.lookupOwnerFields.EqualsCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._cellTemplate="Equals",this._editable=!1}},{key:"_applyConfig",value:function(e){e.editable=!1,_get(_getPrototypeOf(t.prototype),"_applyConfig",this).apply(this,arguments)}},{key:"editable",set:function(e){this._editable=!1}},{key:"_createEditView",value:function(){this._createStaticView()}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.methodSettings.lookupOwnerFields.OrCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).call(this),this._cellTemplate="<span>OR</span>",this._editable=!1}},{key:"_applyConfig",value:function(e){e.editable=!1,_get(_getPrototypeOf(t.prototype),"_applyConfig",this).apply(this,arguments)}},{key:"editable",set:function(e){this._editable=!1}},{key:"_createEditView",value:function(){this._createStaticView()}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.sourceSettings.campaignPillList.NonEditablePillList=function(){_inherits(t,n2.ui.component.field.pillList.EditablePillList);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_bindEvents",value:function(){}}]),t}(),n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.DataTable=function(){_inherits(r,n2.ui.component.EditableDataTable);var e,n,t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"_define",value:function(){_get(_getPrototypeOf(r.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this.dataProviders=["get-tag-options"],this._rowClass=n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.Row,this._hideHeaderRow=!0,this._tagCollectionModel={},this._teamObjectOptions=[],this._supportsTerritories=!1,this._lazyLoad=!0}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_get(_getPrototypeOf(r.prototype),"_onLoaded",this).apply(this,i),n2.isNull(n)||"get-tag-options"!==n.id||(this._tagCollectionModel=t,this._refresh({tagCollectionOptions:!0})),n2.isNull(n)&&(this._distributorSettings=this._getDataProviderById("get-distributor-settings").getResponse(),this.load({force:!1}));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a,o=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<o.length&&void 0!==o[0]?o[0]:{}).force,t=void 0!==t&&t,n=n.silent,n=void 0===n||n,e.next=3,_get(_getPrototypeOf(r.prototype),"_load",this).apply(this,o);case 3:return i=this._distributorSettings.get("objectName"),e.next=6,Promise.all([this._loadDataProvider("get-tag-options",{force:t,silent:n}),this._loadDataProvider("get-team-object-field-options",{params:[i],silent:n,force:t,requestId:i})]);case 6:return i=e.sent,a=_slicedToArray(i,2),s=a[0],a=a[1],e.abrupt("return",{tagOptions:s,teamObjectOptions:a});case 11:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.tagOptions,e=e.teamObjectOptions;_get(_getPrototypeOf(r.prototype),"_onLoadComplete",this).apply(this,arguments),this._tagCollectionModel=t.response,this._teamObjectOptions=e.response,this._supportsTerritories=this._distributorSettings.get("supportsTerritories"),this._refresh()}},{key:"_refreshData",value:function(){_get(_getPrototypeOf(r.prototype),"_refreshData",this).apply(this,arguments),this._refresh({filterTypeSelection:!0})}},{key:"_insertRow",value:function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).index;var t=_get(_getPrototypeOf(r.prototype),"_insertRow",this).apply(this,arguments);return this._refresh({filterTypeSelection:!0}),t}},{key:"_createRow",value:function(e){var t=this,e=(e.tagCollectionModel=this._tagCollectionModel,e.teamObjectOptions=this._teamObjectOptions,e.showTerritoryOption=this._supportsTerritories,_get(_getPrototypeOf(r.prototype),"_createRow",this).apply(this,arguments));return e.components["td-0"].editField.listen("change",function(){t._refresh({filterTypeSelection:!0})},this),e}},{key:"_doRemoveRow",value:function(e){_get(_getPrototypeOf(r.prototype),"_doRemoveRow",this).apply(this,arguments),this._refreshFilterTypeSelection()}},{key:"_refresh",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n2.isEmpty(e),n=e.filterTypeSelection,i=e.tagCollectionOptions,i=void 0!==i&&i,e=e.teamObjectOptions,e=void 0!==e&&e;(t||void 0!==n&&n)&&this._refreshFilterTypeSelection(),(t||i)&&this._refreshTagCollectionOptions(),(t||e)&&this._refreshTeamObjectOptions()}},{key:"_refreshFilterTypeSelection",value:function(){var n,i;this._supportsTerritories&&(n=n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType.TERRITORY,i=!n2.isUndefined(this.data.find(function(e){return e.type===n})),this.forEachRow(function(e){var t=e.data.type===n;e.showTerritoryOption=!i||t}))}},{key:"_refreshTagCollectionOptions",value:function(){var t=this;this.forEachRow(function(e){e.tagCollectionModel=t._tagCollectionModel})}},{key:"_refreshTeamObjectOptions",value:function(){var t=this;this.forEachRow(function(e){e.teamObjectOptions=t._teamObjectOptions})}}]),r}(),n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType={STATIC:"Static",DYNAMIC:"Dynamic",TERRITORY:"Territory"},n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.Row=function(){_inherits(n,n2.ui.component.dataTable.Row);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._OPERATOR_OPTIONS={STATIC:["includes","does not include","includes all"],DYNAMIC:["includes"],TERRITORY:[]},this._tagCollectionModel={},this._teamObjectOptions=[],this._showTerritoryOption=!1,this._tagType=null,this._cachedStaticOperator="",this._cachedDynamicOperator=""}},{key:"tagCollectionModel",set:function(e){n2.compare(this._tagCollectionModel,e)||(this._tagCollectionModel=e,this._refreshTagCollectionFieldOptions(),this._refreshValueFieldOptions())}},{key:"teamObjectOptions",set:function(e){n2.compare(this._teamObjectOptions,e)||(this._teamObjectOptions=e,this._refreshValueFieldOptions())}},{key:"showTerritoryOption",set:function(e){this._showTerritoryOption!==e&&(this._showTerritoryOption=e,this._refreshFilterTypeOptions())}},{key:"_addCells",value:function(){_get(_getPrototypeOf(n.prototype),"_addCells",this).apply(this,arguments),this._refreshCellVisibility()}},{key:"_addCell",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_addCell",this).apply(this,arguments);switch(e.id){case"td-0":this._onFilterTypeCellAdd(t);break;case"td-1":this._onTagCollectionCellAdd(t);break;case"td-2":this._onOperatorCellAdd(t);break;case"td-3":this._onValueCellAdd(t)}return t}},{key:"_onFilterTypeCellAdd",value:function(e){var t=this;e.listen("change",function(){return t._onFilterTypeCellChange(e)},this),this._tagType=this._data.get("type"),this._refreshFilterTypeOptions()}},{key:"_refreshFilterTypeOptions",value:function(){var e=n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType,t=[e.STATIC,e.DYNAMIC];(this._showTerritoryOption||this._isTerritoryFilter())&&t.push(e.TERRITORY),this._components["td-0"].editField.options=t,this._components["td-0"].editField.refreshOptionNames()}},{key:"_onFilterTypeCellChange",value:function(e){this._cacheCurrentOperator(),this._isStaticFilter()?(this._refreshOperatorOptions(),this._setOperatorValue(this._cachedStaticOperator)):this._isDynamicFilter()&&(this._setOperatorValue(this._cachedDynamicOperator),this._refreshOperatorOptions()),this._tagType=this._data.get("type"),this._refreshValueField(),this._refreshCellVisibility(),this._refreshStaticValueEnabledState()}},{key:"_cacheCurrentOperator",value:function(){this._isStaticFilter(this._tagType)?this._cachedStaticOperator=this._components["td-2"].editField.value:this._isDynamicFilter(this._tagType)&&(this._cachedDynamicOperator=this._components["td-2"].editField.value)}},{key:"_setOperatorValue",value:function(e){n2.isEmpty(e)?this._components["td-2"].editField.clear():this._components["td-2"].editField.value=e}},{key:"_refreshCellVisibility",value:function(){var t=this;this.forEachCell(function(e){"td-0"!==e.id&&"remove-row-cell"!==e.id&&(e.editField.hidden=t._isTerritoryFilter())})}},{key:"_onTagCollectionCellAdd",value:function(e){var t=this;e.listen("change",function(){return t._onTagCollectionCellChange(e)},this),this._refreshTagCollectionFieldOptions()}},{key:"_onTagCollectionCellChange",value:function(e){this._isStaticFilter()&&this._components["td-3"].editField.clear(),this._refreshValueFieldOptions(),this._refreshStaticValueEnabledState()}},{key:"_refreshStaticValueEnabledState",value:function(){this._components["td-3"].disabled=this._isStaticFilter()&&n2.isEmpty(this._data.get("categoryId"))}},{key:"_refreshTagCollectionFieldOptions",value:function(){var t=[];n2.forEach(this._tagCollectionModel,function(e){t.push(e.tagCollectionOption)}),this._components["td-1"].editField.options=t}},{key:"_onOperatorCellAdd",value:function(){this._refreshOperatorOptions()}},{key:"_refreshOperatorOptions",value:function(){var e=this._OPERATOR_OPTIONS.STATIC;if(this._isDynamicFilter())switch(e=this._OPERATOR_OPTIONS.DYNAMIC,this._data.get("operator")){case"does not include":e.includes("does not include")||e.push("does not include");break;case"includes all":this._data.get("fieldType")!==n2.de.data.FieldType.MULTIPICKLIST||e.includes("includes all")||e.push("includes all")}this._components["td-2"].editField.options=e}},{key:"_onValueCellAdd",value:function(e){var t=this;e.listen("change",function(){return t._onValueCellChange(e)},this),this._refreshValueField(),this._refreshValueFieldOptions(),this._components["td-3"].disabled=this._isStaticFilter()&&n2.isEmpty(this._data.get("categoryId"))}},{key:"_onValueCellChange",value:function(e){var t,n=this;this._isDynamicFilter()&&(t=this._teamObjectOptions.find(function(e){return e.value===n._data.get("fieldName")}),this._data.getProperty("fieldType",{defaultValue:""}).value=t.type,t.type===n2.de.data.FieldType.MULTIPICKLIST)&&n2.ui.component.Toast.getInstance().show({theme:n2.ui.enum.Theme.INFO,message:"Multi select picklists are compared as ordered by Salesforce, with semicolon-separated values."})}},{key:"_refreshValueField",value:function(){this._components["td-3"].refreshEditField()}},{key:"_refreshValueFieldOptions",value:function(){var e=this._components["td-3"],t=(n2.isEmpty(this._data.get("categoryId"))||n2.isEmpty(this._tagCollectionModel)||(e.tagCollectionOptions=this._tagCollectionModel[this._data.get("categoryId")].tagValueOptions),[n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.MULTIPICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.TEXTAREA]);e.teamObjectOptions=n2.de.data.Adapters.objectFieldOptions(this._teamObjectOptions,{includeFilterable:!0,validTypes:t})}},{key:"validate",value:function(){return!!this._isTerritoryFilter()||_get(_getPrototypeOf(n.prototype),"validate",this).apply(this,arguments)}},{key:"_isStaticFilter",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._data.get("type"))===n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType.STATIC}},{key:"_isDynamicFilter",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._data.get("type"))===n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType.DYNAMIC}},{key:"_isTerritoryFilter",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._data.get("type"))===n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType.TERRITORY}}]),n}(),n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.ValueCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._tagCollectionOptions=[],this._teamObjectOptions=[]}},{key:"tagCollectionOptions",set:function(e){n2.compare(this._tagCollectionOptions,e)||(this._tagCollectionOptions=e,this._refreshEditFieldOptions())}},{key:"teamObjectOptions",set:function(e){n2.compare(this._teamObjectOptions,e)||(this._teamObjectOptions=e,this._refreshEditFieldOptions())}},{key:"refreshEditField",value:function(){n2.isNull(this._editField)||this._editField.destroy(),this._editField=this._insertEditField()}},{key:"_refreshEditFieldOptions",value:function(){this._isStaticFilter()?this._editField.options=this._tagCollectionOptions:this._editField.options=this._teamObjectOptions}},{key:"_createEditField",value:function(){return this._isStaticFilter()?this._createStaticValueSelection():this._createDynamicValueSelection()}},{key:"_createStaticValueSelection",value:function(){return new n2.ui.component.field.Combo({id:"static-edit-field",cls:"n2_static-edit-field",label:{text:"User tags",hidden:!0},placeholder:"Select user tags",required:!0,multiple:!0,options:this._tagCollectionOptions,value:this._data.get("tagValueIds")})}},{key:"_createDynamicValueSelection",value:function(){return new n2.ui.component.field.Combo({id:"dynamic-edit-field",label:{text:"Value",hidden:!0},placeholder:"Select field",required:!0,options:this._teamObjectOptions,value:this._data.get("fieldName")})}},{key:"_onEditFieldChange",value:function(e){this._isStaticFilter()?this._data.getProperty("tagValueIds",{defaultValue:[]}).value=e.value:this._data.getProperty("fieldName",{defaultValue:""}).value=e.value}},{key:"_isStaticFilter",value:function(){return this._data.get("type")===n2.de.page.team.distributorSettings.distributorSettingsForm.teamMemberFilter.tagFilter.FilterType.STATIC}}]),t}(),n2.de.page.team.trackingAndSlas.distributorSettings.distributorSettingsForm.slasFieldGroup.AutoReassignFieldGroup=function(){_inherits(n,n2.de.component.form.FieldGroup);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._heading="Auto reassign",this._toggleActive=!0,this._helpText={text:"If an SLA is failed, reassign the record.",position:n2.ui.enum.Position.BELOW}}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(n.prototype),"_onDefined",this).apply(this,arguments),this._insertAssignmentField(),this._insertReassignFromSla(),this._insertUserOrQueueFieldGroup(),this._insertUpdateField(),this._insertToggleUserOff(),this._insertRemoveSticky()}},{key:"_insertAssignmentField",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"assignment-field",label:"Assignment field",cls:"n2_field-medium slds-m-bottom_x-small",disabled:!0,hidden:!0}))}},{key:"_insertReassignFromSla",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"reassign-from-sla",label:"Reassign from SLA",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",helpText:"The first SLA that will trigger reassignment if failed.",options:[],required:!0,value:{bindPath:".reassignOnSlaSequence"}}))}},{key:"_insertUserOrQueueFieldGroup",value:function(){return this._insert(new n2.de.component.field.UserOrQueueField({id:"reassign-to",mixins:[n2.mixin.DataDriven],label:"Reassign to",required:!0,cls:"slds-m-vertical_medium",allowNoneOption:!1,teamId:n2.de.page.team.Context.getInstance().teamId,modalParent:".n2_container"}))}},{key:"_insertUpdateField",value:function(){return this._insert(new n2.de.component.form.updateFields.UpdateFields({id:"update-fields",cls:"slds-p-horizontal_medium slds-p-vertical_small n2_small-heading",heading:"Update fields on reassignment",helpText:"Updates fields on the record if reassigned."}))}},{key:"_insertToggleUserOff",value:function(){return this._insert(new n2.ui.component.field.Checkbox({id:"toggle-user-off",mixins:[n2.mixin.DataDriven],label:"Toggle user off",cls:"slds-m-bottom_medium slds-p-top_xx-small",helpText:"Toggles owner of a reassigned record off.",hidden:!0,value:{bindPath:".toggleOffAfterReassign"}}))}},{key:"_insertRemoveSticky",value:function(){var t=this;return this.insert(new n2.ui.component.field.Combo({id:"remove-sticky",mixins:[n2.mixin.DataDriven],label:{text:"Remove sticky from reassigned records"},options:["Always","New sticky only","Never"],required:!0,sort:!1,hidden:!0,value:{bindPath:".removeStickyOnReassignment"},listeners:{loaded:function(e){return t._setDefaultStickyType(e)}}}))}},{key:"_setDefaultStickyType",value:function(e){this._model.get("removeStickyOnReassignment")||(e.value={value:"New sticky only",silent:!0})}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("autoReassign").value=e.isChecked(),this._refreshFieldVisibility()}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["reassign-from-sla"].model=e,this._components["reassign-to"].model=this._getUserOrQueueModel(),this._components["update-fields"].model=this._getUpdateFieldsModel(),this._components["toggle-user-off"].model=e,this._components["remove-sticky"].model=e,this._components["toggle-active"].value={silent:!0,value:e.get("autoReassign")},this._components["reassign-from-sla"].options=this._getReassignFromSlaOptions(),this._components["assignment-field"].value={value:this._model.get("assignmentField"),silent:!0},this._refreshFieldVisibility())}},{key:"_getReassignFromSlaOptions",value:function(){for(var e=this._model.get("teamSlaCount"),t=[],n=0;n<e;n++){var i=n+1;t.push({label:"SLA ".concat(i),value:i})}return t}},{key:"_getUserOrQueueModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("objectName"),{key:"objectName"}),e.insert(this._model.getProperty("supportsQueues"),{key:"supportsQueues"}),e.insert(this._model.getProperty("reassignToType",{defaultValue:this._model.get("supportsQueues")?"Queue":"User"}),{key:"selectionType"}),e.insert(this._model.getProperty("reassignTo",{defaultValue:""}),{key:"selectedId"}),e.insert(this._model.getProperty("reassignToLabel",{defaultValue:""}),{key:"selectedName"}),e}},{key:"_getUpdateFieldsModel",value:function(){var e=new n2.dataProvider.Model({value:{}});return e.insert(this._model.getProperty("fieldUpdateEnabled",{defaultValue:!1}),{key:"isEnabled"}),e.insert(this._model.getProperty("fieldUpdateConfig",{defaultValue:{fields:[]}}),{key:"fieldUpdateConfig"}),e.insert(this._model.getProperty("objectName"),{key:"objectName"}),e.insert(this._model.getProperty("isPersonAccounts"),{key:"isPersonAccounts"}),e}},{key:"_refreshFieldVisibility",value:function(){var t=this._model.get("autoReassign");this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t)}),this._components["remove-sticky"].hidden=!t||!this._model.get("isSticky"),this._components["toggle-user-off"].hidden=!t||!this._model.get("loginModeEnabled"),this._components["assignment-field"].hidden=!t||!this._model.get("assignmentField")}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.autoAction.AutoActionOnEvent=function(){_inherits(n,n2.de.component.form.FieldGroup);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Auto action on event",this._toggleActive=!0,this._helpText="Trigger an action automatically when an event is created."}},{key:"_insertFields",value:function(){this._insertEventTypeField(),this._insertEventTypesToAutoAction()}},{key:"_insertEventTypeField",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"event-type-field",label:"Event type field",mixins:[n2.mixin.DataDriven],dataProviders:["get-event-type-field-options"],cls:"n2_field-medium slds-m-bottom_medium",options:{bindPath:"get-event-type-field-options"},required:!0,value:{bindPath:".autoActionEventTypeField"},listeners:{change:function(){return e._refreshEventTypeOptions()}}}))}},{key:"_insertEventTypesToAutoAction",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"event-types-to-auto-action",label:"Event types to auto action",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",placeholder:"All event types",multiple:!0,options:[],value:{bindPath:".eventTypesToAutoAction"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("autoActionOnEvents").value=e.value,this._refreshFieldVisibility()}},{key:"_refreshFieldVisibility",value:function(){var t=this;this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t._model.get("autoActionOnEvents"))})}},{key:"_refreshEventTypeOptions",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._model.get("eventTypesToAutoAction").value=[],t=this._model.get("autoActionEventTypeField"),e.next=4,n2.DataProviderManager.getInstance().get("get-event-type-options").get({params:[t],silent:!0,requestId:t});case 4:t=e.sent,this._components["event-types-to-auto-action"].options=t,this._components["event-types-to-auto-action"].model=this._model;case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["toggle-active"].value={value:e.get("autoActionOnEvents"),silent:!0},this._components["event-type-field"].model=e,this._components["event-types-to-auto-action"].model=e,this._refreshFieldVisibility(),n2.DataProviderManager.getInstance().get("get-event-type-field-options").get({params:[]}),this._refreshEventTypeOptions())}},{key:"_onFieldChange",value:function(e){this.fire("change",{target:e})}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.actionTracking.autoAction.AutoActionOnTask=function(){_inherits(n,n2.de.component.form.FieldGroup);var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"_define",value:function(){_get(_getPrototypeOf(n.prototype),"_define",this).apply(this,arguments),this._mixins=[n2.mixin.DataDriven],this._heading="Auto action on task",this._toggleActive=!0,this._helpText="Trigger an action automatically when a task is created."}},{key:"_insertFields",value:function(){this._insertTaskTypeField(),this._insertTaskTypesToAutoAction()}},{key:"_insertTaskTypeField",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"task-type-field",label:"Task type field",mixins:[n2.mixin.DataDriven],dataProviders:["get-task-type-field-options"],cls:"n2_field-medium slds-m-bottom_medium",options:{bindPath:"get-task-type-field-options"},required:!0,value:{bindPath:".autoActionTaskTypeField"},listeners:{change:function(){return e._refreshTaskTypeOptions()}}}))}},{key:"_insertTaskTypesToAutoAction",value:function(){return this._insert(new n2.ui.component.field.Combo({id:"task-types-to-auto-action",label:"Task types to auto action",mixins:[n2.mixin.DataDriven],cls:"n2_field-medium slds-m-bottom_medium",placeholder:"All task types",multiple:!0,options:[],value:{bindPath:".taskTypesToAutoAction"}}))}},{key:"_onToggleActiveChange",value:function(e){this._model.getProperty("autoActionOnTasks").value=e.value,this._refreshFieldVisibility()}},{key:"_refreshFieldVisibility",value:function(){var t=this;this._forEachField(function(e){"toggle-active"!==e.id&&(e.hidden=!t._model.get("autoActionOnTasks"))})}},{key:"_onLoaded",value:function(e,t){_get(_getPrototypeOf(n.prototype),"_onLoaded",this).apply(this,arguments),n2.isNull(t)&&(this._components["toggle-active"].value={value:e.get("autoActionOnTasks"),silent:!0},this._components["task-type-field"].model=e,this._refreshFieldVisibility(),n2.DataProviderManager.getInstance().get("get-task-type-field-options").get({params:[]}),this._refreshTaskTypeOptions())}},{key:"_refreshTaskTypeOptions",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._model.get("taskTypesToAutoAction").value=[],t=this._model.get("autoActionTaskTypeField"),e.next=4,n2.DataProviderManager.getInstance().get("get-task-type-options").get({params:[t],silent:!0,requestId:t});case 4:t=e.sent,this._components["task-types-to-auto-action"].options=t,this._components["task-types-to-auto-action"].model=this._model;case 6:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onFieldChange",value:function(e){this.fire("change",{target:e})}}]),n}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.Filters=function(){_inherits(o,n2.ui.component.field.logicFilter.Filters);var e,n,t=_createSuper(o);function o(){return _classCallCheck(this,o),t.apply(this,arguments)}return _createClass(o,[{key:"_define",value:function(){_get(_getPrototypeOf(o.prototype),"_define",this).apply(this,arguments),this.SELECTORS=n2.merge(this.SELECTORS,{filtersMessage:".n2_filters-message"}),this._mixins=[n2.mixin.DataDriven],this._lazyLoad=!0,this.columns=[],this._newRowBlankValue={slaPeriod:1,slaUnit:"",customDateTimeField:"",slaCondition:{name:"",type:"",op:"",val:""}},this._newRowData={type:n2.dataProvider.Model,value:this._newRowBlankValue},this._rowClass=n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.Row,this._dateTimeFieldOptions=null,this._filtersMessageTemplate='<div class="n2_filters-message slds-grid{{^.}} slds-hide{{/.}}">\n            '.concat(n2.ui.Icon.getSVG(n2.ui.enum.Icon.INFO,{cls:"slds-icon_x-small slds-m-right_xx-small slds-col slds-no-flex slds-icon-text-default"}),'\n            <div class="slds-col">\n                {{> filtersMessageTemplate }}\n            </div>\n        </div>'),this._timePeriodFilterMessageTemplate="<p>{{#.}}SLA {{count}} will fail if {{slaCondition.name}} {{slaCondition.op}} {{slaCondition.val}} after {{slaPeriod}} {{slaUnit}}{{^isLast}}, {{/isLast}}{{/.}}</p>",this._continuousFilterMessageTemplate="<p>{{#.}}The SLA will fail if at any point over {{slaPeriod}} {{slaUnit}}, {{slaCondition.name}} {{slaCondition.op}} {{slaCondition.val}}{{/.}}</p>",this._customDateFilterMessageTemplate="<p>{{#.}}SLA {{count}} will fail after the date/time specified by {{customDateTimeField}}{{#hasCondition}} if {{slaCondition.name}} {{slaCondition.op}} {{slaCondition.val}}{{/hasCondition}}{{^isLast}}, {{/isLast}}{{/.}}</p>",this._DEFAULT_PLACEHOLDER="--Please select--",this._EMPTY_PLACEHOLDER="None"}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n2.isNull(n),e.t0)return this._newRowData.value=this._newRowBlankValue,n2.isNull(this._model)||this._model.getProperty("filters").removeListeners("change"),this._model=t,n2.isEmpty(this._model.get("filters"))&&this._model.getProperty("filters").insert(this._createNewRowData(),{silent:!0}),e.next=8,this.load();e.next=12;break;case 8:this.columns=this._getColumns(),this._refreshHeaderRow(),this._refreshFiltersMessage(),this._model.getProperty("filters").listen("change",this._onFilterChange,this);case 12:_get(_getPrototypeOf(o.prototype),"_onLoaded",this).apply(this,i);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_load",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,i,s,a=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(n=0<a.length&&void 0!==a[0]?a[0]:{}).silent,t=void 0===t||t,n=n.force,n=void 0!==n&&n,_get(_getPrototypeOf(o.prototype),"_load",this).apply(this,a),i=this._model.get("objectName"),e.next=5,Promise.all([this._loadDataProvider("get-sla-field-options",{params:[i,this._model.get("isPersonAccounts")],silent:t,force:n,requestId:i}),this._loadDataProvider("get-date-time-field-options",{params:[i],silent:t,force:n,requestId:i})]);case 5:return t=e.sent,n=_slicedToArray(t,2),i=n[0],s=n[1],e.abrupt("return",{slaFieldOptions:i,dateTimeFieldOptions:s});case 10:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"_onLoadComplete",value:function(e){var t=e.slaFieldOptions,e=e.dateTimeFieldOptions,n=(_get(_getPrototypeOf(o.prototype),"_onLoadComplete",this).apply(this,arguments),[n2.de.data.FieldType.BOOLEAN,n2.de.data.FieldType.PICKLIST,n2.de.data.FieldType.STRING,n2.de.data.FieldType.DOUBLE,n2.de.data.FieldType.DATE,n2.de.data.FieldType.DATETIME]);this._fieldOptions=n2.de.data.Adapters.objectFieldOptionsWithType(t.response,{includeFilterable:!0,includeRecordTypeId:!0,includeFiltersOnly:!0,validTypes:n}),this._dateTimeFieldOptions=e.response}},{key:"_onAddRowClick",value:function(e){var t=this.data;this._newRowData.value=t.length?t.slice(-1)[0]:this._newRowBlankValue,_get(_getPrototypeOf(o.prototype),"_onAddRowClick",this).apply(this,arguments)}},{key:"_onFilterChange",value:function(e){this._refreshFiltersMessage()}},{key:"_getColumns",value:function(){var e=this._getAdditionalColumns(),t=this._getFieldComparisonColumns();return[].concat(_toConsumableArray(e),_toConsumableArray(t))}},{key:"_getAdditionalColumns",value:function(){switch(this._model.get("slaType")){case n2.de.enum.team.AlertType.TIME_PERIOD_ALERT:return this._getCheckpointColumns();case n2.de.enum.team.AlertType.CONTINUOUS_ALERT:return this._getMonitoredColumns();case n2.de.enum.team.AlertType.CUSTOM_DT_ALERT:return this._getCustomDateTimeColumns();default:return[]}}},{key:"_getCheckpointColumns",value:function(){return[{header:"SLA check after",cell:{type:n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.PeriodCell,cls:"n2_period",min:1}}]}},{key:"_getMonitoredColumns",value:function(){return[{header:"SLA checks for",cell:{type:n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.PeriodCell,cls:"n2_period",min:1,max:14,allowDaysOnly:!0}}]}},{key:"_getCustomDateTimeColumns",value:function(){return[{header:"SLA check after",bindPath:".customDateTimeField",cell:{cls:"n2_custom-date-time"},editField:{id:"custom-date-time",type:n2.ui.component.field.Combo,required:!0,options:this._dateTimeFieldOptions}}]}},{key:"_getFieldComparisonColumns",value:function(){var n=this,e=this._isCustomDateTimeSLA()?this._EMPTY_PLACEHOLDER:this._DEFAULT_PLACEHOLDER;return[{header:{data:"SLA failed if",colspan:3},bindPath:".slaCondition.name",cell:{cls:"n2_name"},editField:{id:"field-options",type:n2.ui.component.field.Combo,required:!this._isCustomDateTimeSLA(),placeholder:e,options:[],listeners:{change:this._onConditionFieldNameChange,scope:this}}},{bindPath:".slaCondition.op",cell:{cls:"n2_operator"},editField:{id:"operator-options",type:n2.ui.component.field.Combo,required:!0,sort:!1,options:[],placeholder:e}},{cell:{type:n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.ValueCell,cls:"n2_value",loadComboOptions:function(e,t){return n._loadComboOptions(e,t)}}}]}},{key:"_onConditionFieldNameChange",value:function(e){this._refreshRow(e.parent.parent),this._refreshFiltersMessage()}},{key:"_refreshHeaderRow",value:function(){this._components["th-row"].destroy(),this._addHeaderRow()}},{key:"_createRow",value:function(e){var t=this,n=(e.fieldOptions=this._fieldOptions,e.allowNotOperators=this._allowNotOperators,e.includeFiscalPeriods=this._includeFiscalPeriods,e.dateTimeFieldOptions=this._dateTimeFieldOptions,_get(_getPrototypeOf(o.prototype),"_createRow",this).apply(this,arguments));return n.components["td-0"].editField.listen("blur",function(){t.fire("blur",t._createEvent(t,{relatedTarget:n}))},this),n}},{key:"_insertRow",value:function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).index;var t=_get(_getPrototypeOf(o.prototype),"_insertRow",this).apply(this,arguments);return this._refreshRow(t),t}},{key:"_refreshData",value:function(){_get(_getPrototypeOf(o.prototype),"_refreshData",this).apply(this,arguments),this._isCustomDateTimeSLA()&&this._refreshRows()}},{key:"_refreshRows",value:function(){var t=this;this.forEachRow(function(e){return t._refreshRow(e)})}},{key:"_refreshRow",value:function(e){var t;this._isCustomDateTimeSLA()&&(t=""!==e.fieldCell.editField.value,e.operatorCell.editField.required=t,e.operatorCell.editField.disabled=!t,e.operatorCell.editField.placeholder=t?this._DEFAULT_PLACEHOLDER:this._EMPTY_PLACEHOLDER,t||e.valueCell.editField.clear())}},{key:"_isCustomDateTimeSLA",value:function(){return this._model.get("slaType")===n2.de.enum.team.AlertType.CUSTOM_DT_ALERT}},{key:"_refreshFiltersMessage",value:function(){var e=this._model.json;n2.isNull(this.element("filtersMessage"))||this.element("filtersMessage").remove(),this._filtersComplete(e.filters)&&(e=n2.ui.Template.render(this._filtersMessageTemplate,this._getFiltersMessageTemplateData(e.filters),{filtersMessageTemplate:this._getFiltersMessageTemplate()}),n2.isEmpty(e)||this.element("addRow").insert(e,"beforebegin"))}},{key:"_filtersComplete",value:function(e){var t=this;return!(n2.isEmpty(e)||1===e.length&&""===e[0]||e.some(function(e){return!t._isValidFilter(e)}))}},{key:"_isValidFilter",value:function(e){return this._isCustomDateTimeSLA()?!n2.isEmpty(e.customDateTimeField)&&this._isValidCondition(e.slaCondition):!n2.isEmpty(e.slaUnit)&&this._isValidCondition(e.slaCondition)}},{key:"_isValidCondition",value:function(e){var t=e.name,t=void 0===t?"":t,n=e.type,n=void 0===n?"":n,i=e.op,i=void 0===i?"":i,e=e.val,e=void 0===e?"":e;return!(!n2.isEmpty(t)||this._model.get("slaType")!==n2.de.enum.team.AlertType.CUSTOM_DT_ALERT)||!n2.isNull(i)&&0<i.length&&this._isValidConditionValue({name:t,type:n,op:i,val:e})}},{key:"_isValidConditionValue",value:function(e){e.name;var t=e.type,t=void 0===t?"":t,n=e.op,n=void 0===n?"":n,e=e.val,e=void 0===e?"":e;return this._isDateOrDateTimeField(t)?""===e||e===this._getDateValueOption().value||e===this._getDateTimeValueOption().value:this._isFieldType(t,n2.ui.component.field.logicFilter.enum.Type.BOOLEAN)?""!==e:this._isEqualOrNotEqualOperator(n)||!n2.isEmpty(e)}},{key:"_getFiltersMessageTemplate",value:function(){switch(this._model.get("slaType")){case n2.de.enum.team.AlertType.TIME_PERIOD_ALERT:return this._timePeriodFilterMessageTemplate;case n2.de.enum.team.AlertType.CONTINUOUS_ALERT:return this._continuousFilterMessageTemplate;case n2.de.enum.team.AlertType.CUSTOM_DT_ALERT:return this._customDateFilterMessageTemplate}}},{key:"_getFiltersMessageTemplateData",value:function(n){var i=this;return n.map(function(e,t){return e.count=t+1,e.isLast=e.count===n.length,e.hasCondition=!n2.isEmpty(e.slaCondition)&&!n2.isEmpty(e.slaCondition.name),n2.isEmpty(e.customDateTimeField)||(e.customDateTimeField=i._getCustomDateTimeFieldLabel(e.customDateTimeField)),n2.isUndefined(e.slaUnit)||(e.slaUnit=i._getPeriodUnit(e.slaPeriod,e.slaUnit)),e.slaCondition.name=i._getConditionNameLabel(e.slaCondition.name),i._isDateOrDateTimeField(e.slaCondition.type)&&(e.slaCondition.val=i._getDateTimeLabel(e.slaCondition)),e.slaCondition.val=n2.isEmpty(e.slaCondition.val)?"No value":e.slaCondition.val,e})}},{key:"_isEqualOrNotEqualOperator",value:function(e){var t=e===n2.ui.component.field.logicFilter.enum.Operator.EQUAL,e=e===n2.ui.component.field.logicFilter.enum.Operator.NOT_EQUAL;return t||e}},{key:"_getCustomDateTimeFieldLabel",value:function(t){var e=this._dateTimeFieldOptions.find(function(e){return e.value===t});return n2.isUndefined(e)?"":e.label}},{key:"_getPeriodUnit",value:function(e,t){return t=""===t?"days":t.toLowerCase(),1===e&&t.endsWith("s")?t.substring(0,t.length-1):t}},{key:"_getConditionNameLabel",value:function(t){var e=this._fieldOptions.find(function(e){return e.value===t});return n2.isUndefined(e)?"":e.label}},{key:"_getDateTimeLabel",value:function(e){e.name;var t=e.type,n=e.op,e=e.val,i=void 0===e?"":e;return""===i?(e=this._isDateField(t)?this._getDateValueOption():this._getDateTimeValueOption(),this._isEqualOrNotEqualOperator(n)?i:e.label):(t=[this._getDateValueOption(),this._getDateTimeValueOption()].find(function(e){return e.value===i}),n2.isUndefined(t)?"":t.label)}},{key:"_getDateValueOption",value:function(){return n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.DateOption.CURRENT_DATE_OPTION}},{key:"_getDateTimeValueOption",value:function(){return n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.DateOption.CURRENT_DATE_TIME_OPTION}},{key:"_isDateOrDateTimeField",value:function(e){return this._isDateField(e)||this._isDateTimeField(e)}},{key:"_isDateField",value:function(e){return this._isFieldType(e,n2.ui.component.field.logicFilter.enum.Type.DATE)}},{key:"_isDateTimeField",value:function(e){return this._isFieldType(e,n2.ui.component.field.logicFilter.enum.Type.DATETIME)}},{key:"_isFieldType",value:function(e,t){return n2.ui.component.field.logicFilter.enum.Type[e]===t}},{key:"_validateLogic",value:function(){return!!this._logicHidden||_get(_getPrototypeOf(o.prototype),"_validateLogic",this).apply(this,arguments)}}]),o}(),n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.dataTable.HeaderRow=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{click:function(e){},change:function(e){}}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this.headerRow=!0,this.MAX_PERIODS=3,this._periodOptions=null,this._showTotalLabels=!1,this._existingCustomCapPeriods=[]}},{key:"showTotalLabels",set:function(e){this._showTotalLabels!==e&&(this._showTotalLabels=e,this._refreshPeriodOptions())}},{key:"existingCustomCapPeriods",set:function(e){this._existingCustomCapPeriods!==e&&(this._existingCustomCapPeriods=e,this._refreshPeriodOptions())}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(t.prototype),"_onDefined",this).apply(this,arguments),this._refreshPeriodOptions(),this._enforceMaxPeriods()}},{key:"_addHeaderCells",value:function(){var n=this;this._insertCapsTagCell(),this._insertAddPeriodCell(),this._hasPeriods()&&this._data.items.forEach(function(e,t){return n._insertPeriodCell({cappingPeriod:e.get("cappingPeriod")})})}},{key:"_insertCapsTagCell",value:function(){return this._insert(new n2.ui.component.dataTable.HeaderCell({id:"th-caps-tag",column:{}}))}},{key:"_insertAddPeriodCell",value:function(){var t=this;return this._insert(new n2.ui.component.dataTable.HeaderCell({id:"th-add-period",column:{},cls:"n2_add-period",cellTemplate:"",components:[new n2.ui.component.Button({id:"add-period",text:"Add Period",icon:n2.ui.enum.Icon.ADD,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onAddPeriodButtonClick(e)}}})]}))}},{key:"_onAddPeriodButtonClick",value:function(e){var t=this.getComponentIndex("th-add-period"),n=this._insertPeriodCell({insertAtIndex:t});this.fire("click",{target:e,relatedTarget:n,data:{periodCellIndex:t}}),this._enforceMaxPeriods(),this._enforceMinPeriods()}},{key:"_insertPeriodCell",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.cappingPeriod,n=void 0===n?{period:"",length:1,rolling:!1}:n,e=e.insertAtIndex,e=void 0===e?this.getComponentIndex("th-add-period"):e,n=this._insert(new n2.ui.component.dataTable.HeaderCell({id:this._generatePeriodCellId(),column:{},cls:"n2_period",cellTemplate:"",components:[new n2.de.page.team.weightingAndCaps.CapCombo({id:"period",cls:"n2_period-field",label:{text:"Period",hidden:!0},required:!0,sort:!1,options:this._getFilteredPeriodOptions({includePeriodKey:n2.de.data.PeriodOptions.cappingPeriodToKey(n)}),customCapPeriodsInUse:this._getCustomCapPeriodsInUse(),value:n2.de.data.PeriodOptions.cappingPeriodToKey(n),listeners:{change:function(e){return t._onPeriodChange(e)}}}),new n2.ui.component.Button({id:"remove-period",cls:"n2_remove-period-button",title:"Remove Period",icon:n2.ui.enum.Icon.CLEAR,theme:n2.ui.component.button.Theme.LINK,listeners:{click:function(e){return t._onRemovePeriodButtonClick(e)}}})]}),e);return this._refreshCellIndexes(),n}},{key:"_generatePeriodCellId",value:function(){for(var e=0,t="th-".concat(e);-1<this._componentIds.indexOf(t);)t="th-".concat(e+=1);return t}},{key:"_onPeriodChange",value:function(e){var t=e.parent;this.fire("change",{target:e,data:{periodCellIndex:this._getPeriodCellIndex(t)}}),this._refreshPeriodOptions()}},{key:"_onRemovePeriodButtonClick",value:function(e){var t=e.parent;this.fire("click",{target:e,relatedTarget:t.components.period,data:{periodCellIndex:this._getPeriodCellIndex(t)}})}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this._enforceMinPeriods(),this._refreshCellIndexes()}},{key:"removePeriodCell",value:function(e){this.remove(e),e.destroy(),this._enforceMaxPeriods(),this._enforceMinPeriods(),this._refreshPeriodOptions(),this._refreshCellIndexes()}},{key:"_refreshCellIndexes",value:function(){var t;this._rendered&&(t=0,this.forEachCell(function(e){e.dom.attribute("data-cell-index",t),t+=1}))}},{key:"_enforceMaxPeriods",value:function(){var e=this._components["th-add-period"].components["add-period"];this._getPeriodCellCount()===this.MAX_PERIODS?e.disable():e.enable()}},{key:"_enforceMinPeriods",value:function(){var t=this._getPeriodCellCount();this.forEachPeriodCell(function(e){1===t?(e.dom.addClass("n2_hover-disabled"),e.components["remove-period"].hidden=!0):(e.dom.removeClass("n2_hover-disabled"),e.components["remove-period"].hidden=!1)})}},{key:"_getPeriodCellCount",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeDestroyed,n=0;return this.forEachPeriodCell(function(e,t){n+=1},{includeDestroyed:void 0!==e&&e}),n}},{key:"_refreshPeriodOptions",value:function(){var n=this;this.forEachPeriodCell(function(e,t){e.components.period.options=n._getFilteredPeriodOptions({includePeriodKey:e.components.period.value}),e.components.period.customCapPeriodsInUse=n._getCustomCapPeriodsInUse(e)})}},{key:"_getFilteredPeriodOptions",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includePeriodKey,n=void 0===e?null:e,i=n2.de.data.PeriodOptions.get({useTotalLabel:this._showTotalLabels,includePeriodKey:n,extraPeriods:this._existingCustomCapPeriods,isTeamLevelCaps:!0});return this.forEachPeriodCell(function(t,e){i=i.filter(function(e){return e.value===n||e.value!==t.components.period.value})}),i}},{key:"_getPeriodCellIndex",value:function(n){var i=null;return this.forEachPeriodCell(function(e,t){if(e===n)return i=t,!1}),i}},{key:"forEachPeriodCell",value:function(n){var i=this,e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).includeDestroyed;this.forEach({includeDestroyed:void 0!==e&&e,fcn:function(e,t){if("th-caps-tag"!==e.id&&"th-add-period"!==e.id)return n.apply(i,[e,t])}})}},{key:"validate",value:function(){return this._hasPeriods()?this._validatePeriodCells():"You need to add at least one period to your team caps."}},{key:"_hasPeriods",value:function(){return!n2.isEmpty(this._data.json)}},{key:"_validatePeriodCells",value:function(){var t=!0;return this.forEachPeriodCell(function(e){e.components.period.validate()||(t=!1)}),t}},{key:"_getCustomCapPeriodsInUse",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n=[];return this.forEachPeriodCell(function(e){e!==t&&(e=n2.de.data.PeriodOptions.cappingPeriodFromKey(e.components.period.value))&&e.rolling&&n.push(e)}),n}}]),t}(),n2.de.page.team.weightingAndCaps.teamCaps.tagCaps.dataTable.Row=function(){_inherits(t,n2.ui.component.dataTable.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this.EVENTS=n2.merge(this.EVENTS,{change:function(e){}}),this._mixins=n2.merge(this._mixins,[n2.mixin.Observable]),this._tagValueOptions=[]}},{key:"tagValueOptions",set:function(e){n2.compare(this._tagValueOptions,e)||(this._tagValueOptions=e,this._refreshTagValueOptions())}},{key:"canEdit",get:function(){var e=this._hasEmptyPeriods();return(this._isDefaultCaps()||!n2.isEmpty(this._data.get("tagValueId")))&&!e}},{key:"originalData",get:function(){return this._data}},{key:"capsModel",get:function(){return this._isDefaultCaps()?this._data:this._data.getProperty("caps")}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(t.prototype),"_afterRender",this).apply(this,arguments),this.refreshCellIndexes()}},{key:"_refreshData",value:function(){var t=this;this.forEachCell(function(e){t.remove(e),e.destroy()}),this._addCells()}},{key:"_addCells",value:function(){this._isDefaultCaps()?this._insertDefaultCell():this._insertTagCell(),this._insertCapCells(this.capsModel)}},{key:"_insertDefaultCell",value:function(){return this._insert(new n2.ui.component.dataTable.Cell({id:"td-tag-value",cls:"n2_text-only n2-default",column:{},cellTemplate:"",components:[{id:"default-text",cls:"n2_default-text",type:n2.ui.component.HTML,template:'<span class="{{cls}}"><strong id="{{id}}">Default</span>'},{id:"default-button",cls:"slds-m-left_xx-small n2_help-icon n2_default-icon",type:n2.ui.component.Button,icon:n2.ui.enum.Icon.INFO,tooltip:{id:"tooltip",text:"Default caps are used when a team member has none of the tags defined below.",position:n2.ui.enum.Position.BELOW}}]}))}},{key:"_insertTagCell",value:function(){var t=this;return this._insert(new n2.ui.component.dataTable.Cell({id:"td-tag-value",column:{},cellTemplate:"",components:[new n2.ui.component.field.Combo({id:"tag",mixins:[n2.mixin.DataDriven],model:this._data.getProperty("tagValueId"),cls:"n2_tag",label:{text:"Tag",hidden:!0},required:!0,options:this._tagValueOptions,value:{bindPath:"."},listeners:{change:function(e){return t._onTagFieldChange(e)}}})]}))}},{key:"_onTagFieldChange",value:function(t){var e=this._tagValueOptions.find(function(e){return e.value===t.value});this._data.getProperty("tagValue").value=e.label,this.fire("change",{target:t})}},{key:"_insertCapCells",value:function(e){for(var t=[],n=0,i=e.json.length,s=e.getProperty(n);!n2.isUndefined(s)&&n<i;)t.push(this.insertCapCell(s,{insertAtIndex:n+1})),s=e.getProperty(n+=1);return t}},{key:"insertCapCell",value:function(e,t){t=t.insertAtIndex,t=void 0===t?null:t,e=this._insert(new n2.ui.component.dataTable.Cell({id:this._generateCapCellId(),cls:"n2_text-only",data:e.get("isUnlimited")?"Unlimited":e.get("cap"),column:{}}),t);return this.refreshCellIndexes(),e}},{key:"_generateCapCellId",value:function(){for(var e=0,t="td-".concat(e);-1<this._componentIds.indexOf(t);)t="td-".concat(e+=1);return t}},{key:"removeCapCellAtIndex",value:function(e){e=this.getComponentAtIndex(e);this.remove(e),e.destroy(),this.refreshCellIndexes()}},{key:"refreshCellIndexes",value:function(){var t;this._rendered&&(t=0,this.forEachCell(function(e){e.dom.attribute("data-cell-index",t),t+=1}))}},{key:"_refreshTagValueOptions",value:function(){this._components["td-tag-value"].components.tag.options=this._tagValueOptions}},{key:"_getLastComponent",value:function(){return this._components[this._componentIds.length-1]}},{key:"getComponentAtIndex",value:function(e){return this._components[this._componentIds[e]]}},{key:"validate",value:function(){return!!this._isDefaultCaps()||this._components["td-tag-value"].components.tag.validate()}},{key:"_isDefaultCaps",value:function(){return n2.isUndefined(this._data.get("tagValueId"))}},{key:"_hasEmptyPeriods",value:function(){var e=this.capsModel.json;return!!n2.isEmpty(e)||this.capsModel.json.find(function(e){return n2.isEmpty(e.cappingPeriod.period)})}}]),t}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.DateOption={CURRENT_DATE_OPTION:{label:"Current Date",value:"CURRENTDATE"},CURRENT_DATE_TIME_OPTION:{label:"Current Date Time",value:"CURRENTDATETIME"}},n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.Period=function(){_inherits(s,n2.ui.component.Field);var n,e=_createSuper(s);function s(){return _classCallCheck(this,s),e.apply(this,arguments)}return _createClass(s,[{key:"_define",value:function(){_get(_getPrototypeOf(s.prototype),"_define",this).call(this),this.SELECTORS=n2.merge(this.SELECTORS,{logDurationErrorMessage:"#{{id}}_error .n2_log-duration-error-message",logDurationErrorLink:"#{{id}}_error .n2_error-link",errorMessage:"#{{id}}_error .n2_error-message"}),this._mixins=[n2.mixin.DataDriven],this._errorTemplate='{{#hasValidation}}\n            <div class="slds-form-element__help n2__field-error {{hideCls}}" id="{{id}}_error">\n                <span class="n2_log-duration-error-message {{hideCls}}">SLA should be set before log expiry (currently <span class="n2_error-link"></span>)</span>\n                <span class="n2_error-message {{hideCls}}"></span>\n            </div>\n        {{/hasValidation}}',this._max=null,this._min=null,this._allowDaysOnly=!1,this._comboOptions=null,this._currentDate=new Date,this._distributorLogDuration=null}},{key:"comboOptions",set:function(e){this._comboOptions!==e&&(this._comboOptions=e,this._refreshComboOptions())}},{key:"max",set:function(e){this._max!==e&&(this._max=e,this._refreshMaxPeriod())}},{key:"min",set:function(e){this._min!==e&&(this._min=e,this._refreshMinPeriod())}},{key:"allowDaysOnly",set:function(e){this._allowDaysOnly!==e&&(this._allowDaysOnly=e,this._refreshUnitOptions())}},{key:"periodInput",get:function(){return this._components.period}},{key:"unitComponent",get:function(){return this._components.unit}},{key:"_onDefined",value:function(){_get(_getPrototypeOf(s.prototype),"_onDefined",this).call(this),this._insertPeriodInput(),this._insertUnitComponent()}},{key:"_refreshMaxPeriod",value:function(){this.periodInput.max=this._max}},{key:"_refreshMinPeriod",value:function(){this.periodInput.min=this._min}},{key:"_refreshUnitOptions",value:function(){n2.isUndefined(this.unitComponent)||this.unitComponent.destroy(),this._insertUnitComponent()}},{key:"_insertPeriodInput",value:function(){var e=this;return this._insert(new n2.ui.component.field.Number({id:"period",label:{text:"Period value",hidden:!0},cls:"n2_sla-period",required:this.required,disabled:this._disabled,renderTo:this.SELECTORS.fieldContainer,min:this._min,max:this._max,listeners:{change:function(){e.clearInvalid(),e._onChange()}}}))}},{key:"_insertUnitComponent",value:function(){return this._allowDaysOnly?this._insertDaysOnlyUnit():this._insertUnitInputSelection()}},{key:"_insertDaysOnlyUnit",value:function(){return this._insert(new n2.de.component.field.ReadOnly({id:"unit",label:{text:"Unit value",hidden:!0},cls:"n2_sla-unit-read-only",renderTo:this.SELECTORS.fieldContainer,value:"Days"}))}},{key:"_insertUnitInputSelection",value:function(){var e=this;return this._insert(new n2.ui.component.field.Combo({id:"unit",label:{text:"Unit value",hidden:!0},cls:"n2_sla-unit",renderTo:this.SELECTORS.fieldContainer,options:["Minutes","Hours","Days"],sort:!1,required:this.required,disabled:this._disabled,listeners:{change:function(){e.clearInvalid(),e._onChange()}}}))}},{key:"_afterRender",value:function(){_get(_getPrototypeOf(s.prototype),"_afterRender",this).call(this),this._setRawValue(this._value)}},{key:"_onBlur",value:function(){this._updateDataBinding("value",this.value),this._onChange()}},{key:"_setRawValue",value:function(e){this.periodInput.value={value:e.slaPeriod,silent:!0},this._allowDaysOnly||(this.unitComponent.value={value:e.slaUnit,silent:!0})}},{key:"_getRawValue",value:function(){return{slaPeriod:this.periodInput.value,slaUnit:this.unitComponent.value}}},{key:"_showError",value:function(e){this._rendered&&this.periodInput.isValid&&this.unitComponent.isValid&&(this._applyContainerErrorClass(),this._isSlaPeriodGreaterThanLogDuration()?(this.element("errorMessage").hide(),this._insertValidationLink(),this.element("logDurationErrorMessage").show()):(this.element("logDurationErrorMessage").hide(),this.element("errorMessage").show(),this.element("errorMessage").text(e)),this.element("error").show())}},{key:"_insertValidationLink",value:function(){return n2.isUndefined(this._components["validation-link"])||this._components["validation-link"].destroy(),this._insert(new n2.ui.component.Button({id:"validation-link",cls:"n2_validation-link",theme:n2.ui.component.button.Theme.LINK,renderTo:this.element("logDurationErrorLink"),text:this._distributorLogDuration,listeners:{click:function(){n2.de.page.Navigation.getInstance().open("Settings_AppSettings")}}}))}},{key:"_hideError",value:function(){var e;this._rendered&&(e=this.element("error"),this._removeContainerErrorClass(),e.hide()),this.periodInput.clearInvalid(),this.unitComponent.clearInvalid()}},{key:"_disable",value:function(){_get(_getPrototypeOf(s.prototype),"_disable",this).apply(this,arguments),this.periodInput.disabled=!0,this.unitComponent.disabled=!0}},{key:"_enable",value:function(){_get(_getPrototypeOf(s.prototype),"_enable",this).apply(this,arguments),this.periodInput.disabled=!1,this.unitComponent.disabled=!1}},{key:"validate",value:function(){var e=this.periodInput.validate()&&this.unitComponent.validate(),t=this._validateCustom();return!0!==t?(t=n2.isString(t)?t:this.errorMessage,this.markInvalid(t),!1):(e?this.clearInvalid():this.markInvalid(),e)}},{key:"_validateCustom",value:function(){return!this._isSlaPeriodGreaterThanLogDuration()}},{key:"_isSlaPeriodGreaterThanLogDuration",value:function(){var e=this._getDistributorLogDurationAsDate(),t=this._getSlaAsDate();return!!e&&e<t}},{key:"_getDistributorLogDurationAsDate",value:function(){var e,t=this._distributorLogDuration.toLowerCase();return"no logging"===t||"forever"===t?null:(e=t.replace(/[^0-9]/g,""),t=t.replace(/^[\s\d]+/,""),n2.de.page.team.trackingAndSlas.teamSettings.slas.Util.convertPeriodUnitToDate(this._currentDate,parseInt(e,10),t))}},{key:"_getSlaAsDate",value:function(){var e=this.periodInput.value,t=this.unitComponent.value;return n2.de.page.team.trackingAndSlas.teamSettings.slas.Util.convertPeriodUnitToDate(this._currentDate,e,t)}},{key:"_onLoaded",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var i=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_get(_getPrototypeOf(s.prototype),"_onLoaded",this).apply(this,i),e.t0=n2.isNull(n),e.t0)return e.next=5,this._getDistributorLogDuration();e.next=6;break;case 5:this._distributorLogDuration=e.sent;case 6:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"_getDistributorLogDuration",value:function(){return n2.DataProviderManager.getInstance().get("get-distribution-log-duration").get()}}]),s}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.PeriodCell=function(){_inherits(t,n2.ui.component.dataTable.Cell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._editable=!0,this.max=null,this.min=null,this.allowDaysOnly=!1}},{key:"_refreshData",value:function(){n2.isNull(this._editField)||this._editField.destroy(),this._editField=this._insertEditField()}},{key:"_onEditFieldChange",value:function(e){var t=e.value.slaPeriod,e=e.value.slaUnit;this._data.getProperty("slaPeriod",{defaultValue:t}).value=t,this._data.getProperty("slaUnit",{defaultValue:e}).value=e}},{key:"_createEditField",value:function(e){return new n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.Period(n2.merge(e,{required:!0,allowDaysOnly:this.allowDaysOnly,max:this.max,min:this.min}))}}]),t}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.Row=function(){_inherits(t,n2.ui.component.field.logicFilter.filters.Row);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"_define",value:function(){_get(_getPrototypeOf(t.prototype),"_define",this).apply(this,arguments),this._dateTimeFieldOptions=null,this._fieldCellId="td-1",this._operatorCellId="td-2",this._valueCellId="td-3"}},{key:"dateTimeFieldOptions",set:function(e){this._dateTimeFieldOptions!==e&&(this._dateTimeFieldOptions=e,this._refreshDateTimeFieldOptions())}},{key:"_onFieldCellChange",value:function(e){this._setFieldType(this._fieldOptionTypes[e.data]),this.operatorCell.components["operator-options"].clear(),this._refreshOperatorOptions()}},{key:"_refreshDateTimeFieldOptions",value:function(){var t;this._editable&&(t=[],this._dateTimeFieldOptions.forEach(function(e){t.push({label:e.label,value:e.value})}),this.components["td-0"].components["custom-date-time"].options=t)}},{key:"_refreshFieldOptions",value:function(){var t,n=this;this._editable&&(this._fieldOptionTypes={},t=[],this._fieldOptions.forEach(function(e){n._fieldOptionTypes[e.value]=e.type,t.push({label:e.label,value:e.value})}),this.fieldCell.components["field-options"].options=t)}},{key:"_getDataPropertyValue",value:function(e){return this._data.getProperty("slaCondition").get(e,{defaultValue:""})}},{key:"_setFieldType",value:function(e){this._data.getProperty("slaCondition").getProperty("type",{defaultValue:e}).value=e}}]),t}(),n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.ValueCell=function(){_inherits(t,n2.ui.component.field.logicFilter.filters.ValueCell);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"disabled",set:function(e){this._disabled=e,this._editable&&(!this._isDateTimeFieldType()&&!this._isDateFieldType()||this._isEqualOrNotEqualOperator()?this._editField.disabled=e:this._editField.disabled=!0)}},{key:"_onEditFieldChange",value:function(e){e=e.value,e=n2.isArray(e)?e.join(";"):e;this._data.getProperty("slaCondition").getProperty("val",{defaultValue:e}).value=e}},{key:"_getDataPropertyValue",value:function(e){return this._data.getProperty("slaCondition").get(e,{defaultValue:""})}},{key:"_createDatePeriodPicker",value:function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).required;return new n2.ui.component.field.Combo(n2.merge(e,{disabled:!this._isEqualOrNotEqualOperator(),value:this._getDataValue(),options:this._isDateFieldType()?[this._getDateValueOption()]:[this._getDateTimeValueOption()]}))}},{key:"_refreshData",value:function(){_get(_getPrototypeOf(t.prototype),"_refreshData",this).apply(this,arguments),!this._isDateTimeFieldType()&&!this._isDateFieldType()||""===this._getFieldOperator()||this._isEqualOrNotEqualOperator()||(this._editField.value=this._getDataValue())}},{key:"_getDataValue",value:function(){var e=this._isEqualOrNotEqualOperator();return this._isDateFieldType()&&!e?this._getDateValueOption().value:this._isDateTimeFieldType()&&!e?this._getDateTimeValueOption().value:_get(_getPrototypeOf(t.prototype),"_getDataValue",this).apply(this,arguments)}},{key:"_isDateTimeFieldType",value:function(){return n2.ui.component.field.logicFilter.enum.Type[this._getFieldType()]===n2.ui.component.field.logicFilter.enum.Type.DATETIME}},{key:"_isDateFieldType",value:function(){return n2.ui.component.field.logicFilter.enum.Type[this._getFieldType()]===n2.ui.component.field.logicFilter.enum.Type.DATE}},{key:"_getDateValueOption",value:function(){return n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.DateOption.CURRENT_DATE_OPTION}},{key:"_getDateTimeValueOption",value:function(){return n2.de.page.team.trackingAndSlas.teamSettings.slas.logicFilter.filters.DateOption.CURRENT_DATE_TIME_OPTION}}]),t}();